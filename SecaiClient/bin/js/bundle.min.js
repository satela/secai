var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(){function t(e,i,n){function s(a,o){if(!i[a]){if(!e[a]){var h="function"==typeof require&&require;if(!o&&h)return h(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var _=i[a]={exports:{}};e[a][0].call(_.exports,function(t){var i=e[a][1][t];return s(i||t)},_,_.exports,t,e,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)s(n[a]);return s}return t}()({1:[function(){var t=window.Laya=function(t){var e={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(t,i){return 1==arguments.length?e.__presubstr.call(this,t):e.__presubstr.call(this,t,i>0?i:this.length+i)},__init:function(t){t.forEach(function(t){t.__init$&&t.__init$()})},__isClass:function(t){return t&&(t.__isclass||t==Object||t==String||t==Array)},__newvec:function(t,e){var i=[];i.length=t;for(var n=0;t>n;n++)i[n]=e;return i},__extend:function(t,i){function n(){e.un(this,"constructor",t)}for(var s in i)if(i.hasOwnProperty(s)){var r=Object.getOwnPropertyDescriptor(i,s),a=r.get,o=r.set;a||o?a&&o?Object.defineProperty(t,s,r):(a&&Object.defineProperty(t,s,a),o&&Object.defineProperty(t,s,o)):t[s]=i[s]}n.prototype=i.prototype,t.prototype=new n,e.un(t.prototype,"__imps",e.__copy({},i.prototype.__imps))},__copy:function(t,e){if(!e)return null;t=t||{};for(var i in e)t[i]=e[i];return t},__package:function(i,n){if(!e.__packages[i]){e.__packages[i]=!0;var s=t,r=i.split(".");if(r.length>1)for(var a=0,o=r.length-1;o>a;a++){var h=s[r[a]];s=h?h:s[r[a]]={}}s[r[r.length-1]]||(s[r[r.length-1]]=n||{})}},__hasOwnProperty:function(t,e){function i(t,e){if(Object.hasOwnProperty.call(e.prototype,t))return!0;var n=e.prototype.__super;return null==n?null:i(t,n)}return e=e||this,Object.hasOwnProperty.call(e,t)||i(t,e.__class)},__typeof:function(t,e){if(!t||!e)return!1;if(e===String)return"string"==typeof t;if(e===Number)return"number"==typeof t;if(e.__interface__)e=e.__interface__;else if("string"!=typeof e)return t instanceof e;return t.__imps&&t.__imps[e]||t.__class==e},__as:function(t,e){return this.__typeof(t,e)?t:null},__int:function(t){return t?parseInt(t):0},"interface":function(i,n){e.__package(i,{});var s=e.__internals,r=s[i]=s[i]||{self:i};if(n){var a=n.split(",");r.extend=[];for(var o=0;o<a.length;o++){var h=a[o];s[h]=s[h]||{self:h},r.extend.push(s[h])}}for(var l=t,_=i.split("."),o=0;o<_.length-1;o++)l=l[_[o]];l[_[_.length-1]]={__interface__:i}},"class":function(i,n,s,r){if(s&&e.__extend(i,s),n)if(e.__package(n,i),e.__classmap[n]=i,n.indexOf(".")>0){if(0==n.indexOf("laya.")){var a=n.split(".");r=r||a[a.length-1],e[r]&&console.log("Warning!,this class["+r+"] already exist:",e[r]),e[r]=i}}else"Main"==n?t.Main=i:(e[n]&&console.log("Error!,this class["+n+"] already exist:",e[n]),e[n]=i);var o=e.un,h=i.prototype;o(h,"hasOwnProperty",e.__hasOwnProperty),o(h,"__class",i),o(h,"__super",s),o(h,"__className",n),o(i,"__super",s),o(i,"__className",n),o(i,"__isclass",!0),o(i,"super",function(t){this.__super.call(t)})},imps:function(t,i){function n(t){var i,r;if((i=e.__internals[t])&&(s[t]=!0,r=i.extend))for(var a=0;a<r.length;a++)n(r[a].self)}if(!i)return null;var s=t.__imps||e.un(t,"__imps",{});for(var r in i)n(r)},superSet:function(t,e,i,n){var s=t.prototype["_$set_"+i];s&&s.call(e,n)},superGet:function(t,e,i){var n=t.prototype["_$get_"+i];return n?n.call(e):null},getset:function(t,i,n,s,r){t?(s&&(i["_$GET_"+n]=s),r&&(i["_$SET_"+n]=r)):(s&&e.un(i,"_$get_"+n,s),r&&e.un(i,"_$set_"+n,r)),s&&r?Object.defineProperty(i,n,{get:s,set:r,enumerable:!1,configurable:!0}):(s&&Object.defineProperty(i,n,{get:s,enumerable:!1,configurable:!0}),r&&Object.defineProperty(i,n,{set:r,enumerable:!1,configurable:!0}))},"static":function(t,e){function i(){var i=e[n],s=e[n+1];Object.defineProperty(t,i,{get:function(){return delete this[i],this[i]=s.call(this)},set:function(t){delete this[i],this[i]=t},enumerable:!0,configurable:!0})}for(var n=0,s=e.length;s>n;n+=2)"length"==e[n]?t.length=e[n+1].call(t):i()},un:function(t,i,n){return n||(n=t[i]),e.__propun.value=n,Object.defineProperty(t,i,e.__propun),n},uns:function(t,i){i.forEach(function(i){e.un(t,i)})}};return t.console=t.console||{log:function(){}},t.trace=t.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),e}(window,document);!function(t,e,i){{var n=(i.un,i.uns,i.static),s=i.class,r=i.getset;i.__newvec}i.interface("laya.ui.IItem"),i.interface("laya.ui.ISelect"),i.interface("laya.ui.IRender"),i.interface("laya.runtime.IMarket"),i.interface("laya.filters.IFilter"),i.interface("laya.resource.IDispose"),i.interface("laya.html.utils.ILayout"),i.interface("laya.webgl.submit.ISubmit"),i.interface("laya.runtime.ICPlatformClass"),i.interface("laya.webgl.canvas.save.ISaveData");var a=(function(){return r(1,i,"alertGlobalError",null,function(t){var e=0;Be.window.onerror=t?function(t,i,n,s,r){e++<5&&r&&alert("出错啦，请把此信息截图给研发商\n"+t+"\n"+r.stack)}:null}),i.init=function(e,n){for(var s=[],r=2,a=arguments.length;a>r;r++)s.push(arguments[r]);if(!i._isinit){i._isinit=!0,ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=i._arrayBufferSlice),Be.__init__(),Ni.isConchApp||N.__init__(),i.systemTimer=new hi(!1),i.startTimer=new hi(!1),i.physicsTimer=new hi(!1),i.updateTimer=new hi(!1),i.lateTimer=new hi(!1),i.timer=new hi(!1),i.loader=new cn,Ce.__init__();for(var o=!1,r=0,h=s.length;h>r;r++)s[r]&&s[r].enable&&(s[r].enable(),"WebGL"==typeof s[r]&&(o=!0));return Ni.isConchApp&&(o||laya.webgl.WebGL.enable(),qi.enableNative()),Xi.__init__(),Qi.beginCheck(),i._currentStage=i.stage=new Ts,i._getUrlPath(),i.render=new Ni(0,0),i.stage.size(e,n),t.stage=i.stage,z.__init__(),Ci.__init__(),_e.instance.__init__(i.stage,Ni.canvas),Ws.__init__(),Gi.autoStopMusic=!0,Ni.canvas}},i._getUrlPath=function(){var t=Be.window.location,e=t.pathname;e=":"==e.charAt(2)?e.substring(1):e,Mi.rootPath=Mi.basePath=Mi.getPath("file:"==t.protocol?e:t.protocol+"//"+t.host+t.pathname)},i._arrayBufferSlice=function(t,e){var i=this,n=new Uint8Array(i,t,e-t),s=new Uint8Array(n.length);return s.set(n),s.buffer},i._runScript=function(t){return Be.window[i._evcode](t)},i.enableDebugPanel=function(t){if(void 0===t&&(t="libs/laya.debugtool.js"),i.DebugPanel)i.DebugPanel.enable();else{var e=Be.createElement("script");e.onload=function(){i.DebugPanel.enable()},e.src=t,Be.document.body.appendChild(e)}},i.stage=null,i.systemTimer=null,i.startTimer=null,i.physicsTimer=null,i.updateTimer=null,i.lateTimer=null,i.timer=null,i.loader=null,i.version="2.0.0beta5",i.render=null,i._currentStage=null,i._isinit=!1,i.isWXOpenDataContext=!1,i.isWXPosMsg=!1,n(i,["conchMarket",function(){return this.conchMarket=t.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=t.PlatformClass},"_evcode",function(){return this._evcode="eval"}]),i}(),function(){function t(){}return s(t,"laya.renders.LayaGLQuickRunner"),t.__init__=function(){t.map[515]=t.alpha_transform_drawLayaGL,t.map[513]=t.alpha_drawLayaGL,t.map[514]=t.transform_drawLayaGL,t.map[8194]=t.transform_drawNodes,t.map[259]=t.alpha_transform_drawTexture,t.map[257]=t.alpha_drawTexture,t.map[258]=t.transform_drawTexture,t.map[8704]=t.drawLayaGL_drawNodes},t.transform_drawTexture=function(e,i,n,s){var r=(e._style,e.texture);i.saveTransform(t.curMat),i.transformByMatrix(e.transform,n,s),i.drawTexture(r,-e.pivotX,-e.pivotY,e._width||r.width,e._height||r.height),i.restoreTransform(t.curMat)},t.alpha_drawTexture=function(t,e,i,n){var s=t._style,r=0/0,a=t.texture;if((r=s.alpha)>.01||t._needRepaint()){var o=e.globalAlpha;e.globalAlpha*=r,e.drawTexture(a,i-s.pivotX+a.offsetX,n-s.pivotY+a.offsetY,t._width||a.width,t._height||a.height),e.globalAlpha=o}},t.alpha_transform_drawTexture=function(e,i,n,s){var r=e._style,a=0/0,o=e.texture;if((a=r.alpha)>.01||e._needRepaint()){var h=i.globalAlpha;i.globalAlpha*=a,i.saveTransform(t.curMat),i.transformByMatrix(e.transform,n,s),i.drawTexture(o,-r.pivotX+o.offsetX,-r.pivotY+o.offsetY,e._width||o.width,e._height||o.height),i.restoreTransform(t.curMat),i.globalAlpha=h}},t.alpha_transform_drawLayaGL=function(e,i,n,s){var r=e._style,a=0/0;if((a=r.alpha)>.01||e._needRepaint()){var o=i.globalAlpha;i.globalAlpha*=a,i.saveTransform(t.curMat),i.transformByMatrix(e.transform,n,s),e._graphics&&e._graphics._render(e,i,-r.pivotX,-r.pivotY),i.restoreTransform(t.curMat),i.globalAlpha=o}},t.alpha_drawLayaGL=function(t,e,i,n){var s=t._style,r=0/0;if((r=s.alpha)>.01||t._needRepaint()){var a=e.globalAlpha;e.globalAlpha*=r,t._graphics&&t._graphics._render(t,e,i-s.pivotX,n-s.pivotY),e.globalAlpha=a}},t.transform_drawLayaGL=function(e,i,n,s){var r=e._style;i.saveTransform(t.curMat),i.transformByMatrix(e.transform,n,s),e._graphics&&e._graphics._render(e,i,-r.pivotX,-r.pivotY),i.restoreTransform(t.curMat)},t.transform_drawNodes=function(e,i,n,s){var r=e._style;i.saveTransform(t.curMat),i.transformByMatrix(e.transform,n,s),n=-r.pivotX,s=-r.pivotY;var a,o=e._children,h=o.length;if(r.viewport){var l=r.viewport,_=l.x,u=l.y,c=l.right,d=l.bottom,f=0/0,p=0/0;for(m=0;h>m;++m)(a=o[m])._visible&&(f=a._x)<c&&f+a.width>_&&(p=a._y)<d&&p+a.height>u&&a.render(i,n,s)}else for(var m=0;h>m;++m)(a=o[m])._visible&&a.render(i,n,s);i.restoreTransform(t.curMat)},t.drawLayaGL_drawNodes=function(t,e,i,n){var s=t._style;i-=s.pivotX,n-=s.pivotY,t._graphics&&t._graphics._render(t,e,i,n);var r,a=t._children,o=a.length;if(s.viewport){var h=s.viewport,l=h.x,_=h.y,u=h.right,c=h.bottom,d=0/0,f=0/0;for(p=0;o>p;++p)(r=a[p])._visible&&(d=r._x)<u&&d+r.width>l&&(f=r._y)<c&&f+r.height>_&&r.render(e,i,n)}else for(var p=0;o>p;++p)(r=a[p])._visible&&r.render(e,i,n)},t.map={},n(t,["curMat",function(){return this.curMat=new fi}]),t}()),o=function(){function t(e){if(this.arrColor=[],null==e)return this.strColor="#00000000",this.numColor=0,this.arrColor=[0,0,0,0],void 0;var i=0,n=0,s=0;if("string"==typeof e)if(e.indexOf("rgba(")>=0||e.indexOf("rgb(")>=0){var r=e,a=0,o=0;for(a=r.indexOf("("),o=r.indexOf(")"),r=r.substring(a+1,o),this.arrColor=r.split(","),n=this.arrColor.length,i=0;n>i;i++)this.arrColor[i]=parseFloat(this.arrColor[i]),3>i&&(this.arrColor[i]=Math.round(this.arrColor[i]));s=4==this.arrColor.length?256*(256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2])+Math.round(255*this.arrColor[3]):256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2],this.strColor=e}else{if(this.strColor=e,"#"===e.charAt(0)&&(e=e.substr(1)),n=e.length,3===n||4===n){var h="";for(i=0;n>i;i++)h+=e[i]+e[i];e=h}s=parseInt(e,16)}else s=e,this.strColor=ee.toHexColor(s);this.strColor.indexOf("rgba")>=0||9===this.strColor.length?(this.arrColor=[((4278190080&s)>>>24)/255,((16711680&s)>>16)/255,((65280&s)>>8)/255,(255&s)/255],this.numColor=(4278190080&s)>>>24|(16711680&s)>>8|(65280&s)<<8|(255&s)<<24):(this.arrColor=[((16711680&s)>>16)/255,((65280&s)>>8)/255,(255&s)/255,1],this.numColor=4278190080|(16711680&s)>>16|65280&s|(255&s)<<16),this.arrColor.__id=++t._COLODID}return s(t,"laya.utils.ColorUtils"),t._initDefault=function(){t._DEFAULT={};for(var e in t._COLOR_MAP)t._SAVE[e]=t._DEFAULT[e]=new t(t._COLOR_MAP[e]);return t._DEFAULT},t._initSaveMap=function(){t._SAVE_SIZE=0,t._SAVE={};for(var e in t._DEFAULT)t._SAVE[e]=t._DEFAULT[e]},t.create=function(e){var i=e+"",n=t._SAVE[i];return null!=n?n:(t._SAVE_SIZE<1e3&&t._initSaveMap(),t._SAVE[i]=new t(e))},t._SAVE={},t._SAVE_SIZE=0,t._COLOR_MAP={purple:"#800080",orange:"#ffa500",white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#808080"},t._DEFAULT=t._initDefault(),t._COLODID=1,t}(),h=function(){function t(){}s(t,"laya.webgl.canvas.save.SaveBase");var e=t.prototype;return i.imps(e,{"laya.webgl.canvas.save.ISaveData":!0}),e.isSaveMark=function(){return!1},e.restore=function(e){this._dataObj[this._valueName]=this._value,t.POOL[t.POOL._length++]=this,this._newSubmit&&(e._curSubmit=K.RENDERBASE)},t._createArray=function(){var t=[];return t._length=0,t},t._init=function(){var e=t._namemap={};return e[1]="ALPHA",e[2]="fillStyle",e[8]="font",e[256]="lineWidth",e[512]="strokeStyle",e[8192]="_mergeID",e[1024]=e[2048]=e[4096]=[],e[16384]="textBaseline",e[32768]="textAlign",e[65536]="_nBlendType",e[1048576]="shader",e[2097152]="filters",e[8388608]="_colorFiler",e},t.save=function(e,i,n,s){if((e._saveMark._saveuse&i)!==i){e._saveMark._saveuse|=i;var r=t.POOL,a=r._length>0?r[--r._length]:new t;a._value=n[a._valueName=t._namemap[i]],a._dataObj=n,a._newSubmit=s;var o=e._save;o[o._length++]=a}},t.POOL=laya.webgl.canvas.save.SaveBase._createArray(),t._namemap=t._init(),t}(),l=function(){function t(){this._events=null}var e;s(t,"laya.events.EventDispatcher");var i=t.prototype;return i.hasListener=function(t){var e=this._events&&this._events[t];return!!e},i.event=function(t,e){if(!this._events||!this._events[t])return!1;var i=this._events[t];if(i.run)i.once&&delete this._events[t],null!=e?i.runWith(e):i.run();else{for(var n=0,s=i.length;s>n;n++){var r=i[n];r&&(null!=e?r.runWith(e):r.run()),(!r||r.once)&&(i.splice(n,1),n--,s--)}0===i.length&&this._events&&delete this._events[t]}return!0},i.on=function(t,e,i,n){return this._createListener(t,e,i,n,!1)},i.once=function(t,e,i,n){return this._createListener(t,e,i,n,!0)},i._createListener=function(t,i,n,s,r,a){void 0===a&&(a=!0),a&&this.off(t,i,n,r);var o=e.create(i||this,n,s,r);this._events||(this._events={});var h=this._events;return h[t]?h[t].run?h[t]=[h[t],o]:h[t].push(o):h[t]=o,this},i.off=function(t,e,i,n){if(void 0===n&&(n=!1),!this._events||!this._events[t])return this;var s=this._events[t];if(null!=s)if(s.run)e&&s.caller!==e||null!=i&&s.method!==i||n&&!s.once||(delete this._events[t],s.recover());else{for(var r=0,a=0,o=s.length;o>a;a++){var h=s[a];h?!h||e&&h.caller!==e||null!=i&&h.method!==i||n&&!h.once||(r++,s[a]=null,h.recover()):r++}r===o&&delete this._events[t]}return this},i.offAll=function(t){var e=this._events;if(!e)return this;if(t)this._recoverHandlers(e[t]),delete e[t];else{for(var i in e)this._recoverHandlers(e[i]);this._events=null}return this},i.offAllCaller=function(t){if(t&&this._events)for(var e in this._events)this.off(e,t,null);return this},i._recoverHandlers=function(t){if(t)if(t.run)t.recover();else for(var e=t.length-1;e>-1;e--)t[e]&&(t[e].recover(),t[e]=null)},i.isMouseEvent=function(e){return t.MOUSE_EVENTS[e]||!1},t.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},t.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0}),e=function(t){function e(t,i,n,s){e.__super.call(this,t,i,n,s)}s(e,"",t);var i=e.prototype;return i.recover=function(){this._id>0&&(this._id=0,e._pool.push(this.clear()))},e.create=function(t,i,n,s){return void 0===s&&(s=!0),e._pool.length?e._pool.pop().setTo(t,i,n,s):new e(t,i,n,s)},e._pool=[],e}(_)},t}(),_=function(){function t(t,e,i,n){this.once=!1,this._id=0,void 0===n&&(n=!1),this.setTo(t,e,i,n)}s(t,"laya.utils.Handler");var e=t.prototype;return e.setTo=function(e,i,n,s){return this._id=t._gid++,this.caller=e,this.method=i,this.args=n,this.once=s,this},e.run=function(){if(null==this.method)return null;var t=this._id,e=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),e},e.runWith=function(t){if(null==this.method)return null;var e=this._id;if(null==t)var i=this.method.apply(this.caller,this.args);else i=this.args||t.unshift?this.args?this.method.apply(this.caller,this.args.concat(t)):this.method.apply(this.caller,t):this.method.call(this.caller,t);return this._id===e&&this.once&&this.recover(),i},e.clear=function(){return this.caller=null,this.method=null,this.args=null,this},e.recover=function(){this._id>0&&(this._id=0,t._pool.push(this.clear()))},t.create=function(e,i,n,s){return void 0===s&&(s=!0),t._pool.length?t._pool.pop().setTo(e,i,n,s):new t(e,i,n,s)},t._pool=[],t._gid=1,t}(),u=function(){function t(){this._id=ee.getGID(),this._resetComp()}s(t,"laya.components.Component");var e=t.prototype;return i.imps(e,{"laya.resource.ISingletonElement":!0,"laya.resource.IDestroy":!0}),e._resetComp=function(){this._indexInList=-1,this._enabled=!0,this._active=!1,this._awaked=!1,this.owner=null},e._getIndexInList=function(){return this._indexInList},e._setIndexInList=function(t){this._indexInList=t},e._onAdded=function(){},e._onAwake=function(){},e._onEnable=function(){},e._onDisable=function(){},e._onEnableInScene=function(){},e._onDisableInScene=function(){},e._onDestroy=function(){},e.onReset=function(){},e._parse=function(){},e._cloneTo=function(){},e._setActive=function(t){this._active!==t&&this.owner.activeInHierarchy&&(this._active=t,t?(this._awaked||(this._awaked=!0,this._onAwake()),this._enabled&&this._onEnable()):this._enabled&&this._onDisable())},e._setActiveInScene=function(t){t?this._onEnableInScene():this._onDisableInScene()},e.destroy=function(){this.owner&&this.owner._destroyComponent(this)},e._destroy=function(){this._active&&this._setActive(!1),this.owner._scene&&this._setActiveInScene(!1),this._onDestroy(),this._destroyed=!0,this.onReset!==laya.components.Component.prototype.onReset?(this.onReset(),this._resetComp(),Ji.recoverByClass(this)):this._resetComp()},r(0,e,"id",function(){return this._id}),r(0,e,"enabled",function(){return this._enabled},function(t){this._enabled=t,this.owner&&(t?this.owner.activeInHierarchy&&this._onEnable():this._active&&this._onDisable())}),r(0,e,"isSingleton",function(){return!0}),r(0,e,"destroyed",function(){return this._destroyed}),t}(),c=function(){function t(t){this.receiverName="王晓明",this.phone="15256565485",this.zoneid="",this.searchZoneid="",this.address="汇腾南苑612好23号",this.id=null,this.preAddName=null,this.receiverName=t.cnee,this.phone=t.pn,this.address=t.addr,this.id=t.id,this.preAddName=t.zonename;var e=t.zone.split("|");this.zoneid=e[0],this.searchZoneid=e[1]}s(t,"model.users.AddressVo");var e=t.prototype;return r(0,e,"proCityArea",function(){return this.preAddName+" "+this.address}),r(0,e,"addressDetail",function(){return this.receiverName+"-"+this.phone+" "+this.preAddName+this.address}),t.ADDRESS_DELETE="delete",t.ADDRESS_UPDATE="update",t.ADDRESS_INSERT="insert",t.ADDRESS_LIST="list",t}(),d=function(){function t(){}return s(t,"GameConfig"),t.init=function(){var t=Pe.regClass;t("utils.LoadingPrgControl",$n),t("script.login.LogPanelControl",Gn),t("laya.display.Text",Cs),t("script.prefabScript.LinkTextControl",zn),t("script.login.RegisterCntrol",hs),t("script.login.ResetPwdControl",es),t("script.MainPageControl",Fn),t("utils.AddMsgControl",Hn),t("script.order.PayTypeSelectControl",ts),t("script.order.SelectAddressControl",ns),t("script.order.SelectAttchesControl",is),t("script.order.SelectDeliveryControl",rs),t("script.order.SelectFactoryControl",ss),t("script.order.SelectMaterialControl",_s),t("script.order.SelectPicControl",Wn),t("laya.html.dom.HTMLDivElement",xs),t("script.prefabScript.TopBannerControl",Xn),t("script.order.PaintOrderControl",Jn),t("script.picUpload.PicManagerControl",jn),t("script.picUpload.PictureCheckControl",qn),t("utils.PopUpWindowControl",Kn),t("script.product.BuyProductControl",Vn),t("script.product.ProductMarketControl",Zn),t("script.product.ProductMainControl",Yn),t("script.picUpload.UpLoadAndOrderContrl",ls),t("script.usercenter.AddressMgrControl",us),t("script.usercenter.ChargeControl",cs),t("script.usercenter.EnterPrizeInfoControl",Qn),t("script.usercenter.MyOrderControl",as),t("script.usercenter.AddressEditControl",ds),t("script.usercenter.OrderDetailControl",os),t("script.usercenter.UserMainControl",Un)},t.width=640,t.height=1136,t.scaleMode="fixedwidth",t.screenMode="none",t.alignV="top",t.alignH="left",t.startScene="product/ProductMarketPanel.scene",t.sceneRoot="",t.debug=!1,t.stat=!1,t.physicsDebug=!1,t.exportSceneToJson=!0,t.__init$=function(){t.init()},t}(),f=function(){function t(){this.userId=0,this.userSession=null,this.userAccount=null,this.userName=null,this.company=null,this.addressList=[],this.defaultAddId="",this.money=0/0,this.isLogin=!1,this.defaultAddrid="0"}s(t,"model.Userdata");var e=t.prototype;return e.initMyAddress=function(t){this.addressList=[];for(var e=0;e<t.length;e++)this.addressList.push(new c(t[e]))},e.addNewAddress=function(t){null==this.addressList&&(this.addressList=[]),this.addressList.push(new c(t))},e.updateAddress=function(t){for(var e=0;e<this.addressList.length;e++)if(this.addressList[e].id==t.id){this.addressList[e]=new c(t);break}},e.deleteAddr=function(t){for(var e=0;e<this.addressList.length;e++)if(this.addressList[e].id==t){this.addressList.splice(e,1);break}},e.getDefaultAddress=function(){if(null==this.addressList||0==this.addressList.length)return null;for(var t=0;t<this.addressList.length;t++)if(this.addressList[t].id==this.defaultAddId)return this.addressList[t];return this.addressList[0]},r(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),t._instance=null,t}(),p=function(){function t(e){if(this.preProc_Code="",this.preProc_Name="",this.preProc_attachmentTypeList="",this.preProc_Price=0,this.is_mandatory=0,this.measure_unit="",this.procLvl=0,this.is_startProc=0,this.is_endProc=0,this.nextMatList=null,this.selected=!1,this.attchMentFileId="",this.attchFileId="",this.attachList=null,this.selectAttachVoList=null,null!=e){for(var i in e)this.hasOwnProperty(i)&&(this[i]=e[i]);var n=e.procProcList;if(this.nextMatList=[],console.log(this.preProc_Name+","+this.preProc_attachmentTypeList),n&&n.length>0)for(var s=0;s<n.length;s++)if(null!=I.instance.getProcDataByProcName(n[s].postProc_name))this.nextMatList.push(new t(I.instance.getProcDataByProcName(n[s].postProc_name)));else{var r=new t({});r.is_mandatory=0,r.preProc_attachmentTypeList=n[s].preProc_attachmentTypeList,r.preProc_Code=n[s].postProc_code,r.preProc_Name=n[s].postProc_name,r.procLvl=2,r.preProc_Price=n[s].postProc_price,r.measure_unit=n[s].measure_unit,this.nextMatList.push(r)}}}s(t,"model.orderModel.MaterialItemVo");var e=t.prototype;return e.onAccCatlistBack=function(t){var e=JSON.parse(t);e.hasOwnProperty("status")||null!=e[0]&&R.instance.Request(R.httpUrl+"business/accessorylist?manufacturer_code="+I.instance.curSelectMat.manufacturer_code+"&accessoryCat_name="+e[0].accessoryCat_Name,this,this.onGetAccessorylistBack,null,null)},e.onGetAccessorylistBack=function(t){var e=JSON.parse(t);if(e){this.attachList=[];for(var i=0;i<e.length;i++){var n=new S(e[i]);n.materialItemVo=this,this.attachList.push(n)}}},e.resetData=function(){if(this.selected=!1,this.attchMentFileId="",this.attchFileId="",null!=this.nextMatList)for(var t=0;t<this.nextMatList.length;t++)this.nextMatList[t].resetData()},t}(),m=(function(){function t(){}return s(t,"model.ChinaAreaModel"),t}(),function(){function t(t){this.matclassname="喷绘材料",this.childMatList=null,this.matclassname=t}return s(t,"model.orderModel.MatetialClassVo"),t}()),g=function(){function t(){}s(t,"utils.WaitingRespond");var e=t.prototype;return e.showWaitingView=function(e){void 0===e&&(e=15e3),null==t.gui.parent&&i.stage.addChild(t.gui),i.timer.clear(t,t.rotatecircle),i.timer.clear(t,t.requestTimeOut),i.timer.loop(10,t,t.rotatecircle),i.timer.once(e,t,t.requestTimeOut)},e.hideWaitingView=function(){null!=t.gui.parent&&i.stage.removeChild(t.gui),i.timer.clear(t,t.rotatecircle),i.timer.clear(t,t.requestTimeOut)},r(1,t,"instance",function(){return null==t._instance&&(t._instance=new t,t.initView()),t._instance}),t.initView=function(){t.gui=new ks},t.rotatecircle=function(){t.gui.zhuanq.rotation+=10},t.requestTimeOut=function(){null!=t.gui.parent&&i.stage.removeChild(t.gui),i.timer.clear(t,t.rotatecircle)},t._instance=null,t.gui=null,t}(),v=function(){function e(){this.viewContainer=null,this.openViewList=null,this.viewDict=null,this.viewContainer=new kn,i.stage.addChild(this.viewContainer);t.screen.height,t.screen.width;this.openViewList={},this.viewDict=new Object,this.viewDict.VIEW_FIRST_PAGE=Ns,this.viewDict.VIEW_lOGPANEL=yr,this.viewDict.VIEW_REGPANEL=Ar,this.viewDict.VIEW_CHANGEPWD=Br,this.viewDict.VIEW_MYPICPANEL=Nr,this.viewDict.VIEW_PICMANAGER=Ir,this.viewDict.VIEW_USERCENTER=br,this.viewDict.VIEW_PICTURE_CHECK=Gr,this.viewDict.VIEW_POPUPDIALOG=Vr,this.viewDict.VIEW_PAINT_ORDER=dr,this.viewDict.VIEW_SELECT_ADDRESS=sr,this.viewDict.VIEW_SELECT_FACTORY=or,this.viewDict.VIEW_SELECT_PIC_TO_ORDER=Er,this.viewDict.VIEW_SELECT_MATERIAL=wr,this.viewDict.VIEW_SELECT_DELIVERY_TYPE=Rr,this.viewDict.VIEW_SELECT_ATTACH=xr,this.viewDict.VIEW_ADD_MESSAGE=Sr,this.viewDict.VIEW_ADD_NEW_ADDRESS=Dr,this.viewDict.VIEW_LOADING_PRO=Ur,this.viewDict.VIEW_PRODUCT_VIEW=Fr,this.viewDict.VIEW_BUY_PRODUCT_VIEW=Or,this.viewDict.VIEW_ORDER_DETAIL_PANEL=pr,this.viewDict.VIEW_SELECT_PAYTYPE_PANEL=mr}s(e,"script.ViewManager");var n=e.prototype;return n.openView=function(t,e,i){if(void 0===e&&(e=!1),e){var n;for(var s in this.openViewList)n=this.openViewList[s],null!=n&&(this.viewContainer.removeChild(n),n.destroy(!0));this.openViewList={}}if(null!=this.viewDict[t]&&null==this.openViewList[t]){var r=new this.viewDict[t];r.param=i,this.viewContainer.addChild(r),this.openViewList[t]=r}},n.closeView=function(t){null!=this.openViewList[t]&&(this.viewContainer.removeChild(this.openViewList[t]),this.openViewList[t].destroy(!0),this.openViewList[t]=null,delete this.openViewList[t])},r(1,e,"instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e.showAlert=function(t){Be.window.alert(t)},e._instance=null,e.VIEW_FIRST_PAGE="VIEW_FIRST_PAGE",e.VIEW_lOGPANEL="VIEW_lOGPANEL",e.VIEW_REGPANEL="VIEW_REGPANEL",e.VIEW_CHANGEPWD="VIEW_CHANGEPWD",e.VIEW_MYPICPANEL="VIEW_MYPICPANEL",e.VIEW_PICMANAGER="VIEW_PICMANAGER",e.VIEW_PICTURE_CHECK="VIEW_PICTURE_CHECK",e.VIEW_PAINT_ORDER="VIEW_PAINT_ORDER",e.VIEW_USERCENTER="VIEW_USERCENTER",e.VIEW_SELECT_ADDRESS="VIEW_SELECT_ADDRESS",e.VIEW_SELECT_FACTORY="VIEW_SELECT_FACTORY",e.VIEW_SELECT_PIC_TO_ORDER="VIEW_SELECT_PIC_TO_ORDER",e.VIEW_SELECT_MATERIAL="VIEW_SELECT_MATERIAL",e.VIEW_ADD_MESSAGE="VIEW_ADD_MESSAGE",e.VIEW_SELECT_DELIVERY_TYPE="VIEW_SELECT_DELIVERY_TYPE",e.VIEW_SELECT_ATTACH="VIEW_SELECT_ATTACH",e.VIEW_PRODUCT_VIEW="VIEW_PRODUCT_VIEW",e.VIEW_BUY_PRODUCT_VIEW="VIEW_BUY_PRODUCT_VIEW",e.VIEW_LOADING_PRO="VIEW_LOADING_PRO",e.VIEW_ADD_NEW_ADDRESS="VIEW_ADD_NEW_ADDRESS",e.VIEW_ORDER_DETAIL_PANEL="VIEW_ORDER_DETAIL_PANEL",e.VIEW_SELECT_PAYTYPE_PANEL="VIEW_SELECT_PAYTYPE_PANEL",e.VIEW_POPUPDIALOG="VIEW_POPUPDIALOG",e}(),y=function(){function t(){}return s(t,"utils.UtilTool"),t.oneCutNineAdd=function(t){var e=t.toFixed(1),i=parseInt(e.split(".")[1]);return 1==i?parseInt(e.split(".")[0]):9==i?parseInt(e.split(".")[0])+1:parseFloat(e)},t.getLocalVar=function(t,e){var i=Ee.getItem(t);if(null===i)return null==e?null:(i=e,Ee.setItem(t,i+""),i);if(null!=e){if(Math.floor(e)===e)return""==i&&(i="0"),parseInt(i);if(parseFloat(e+"")===e)return""==i&&(i="0"),parseFloat(i)}return i},t.setLocalVar=function(e,i){return null==i?(t.removeLocalVar(e),void 0):(Ee.setItem(e,i+""),void 0)},t.removeLocalVar=function(t){Ee.removeItem(t)},t.formatFullDateTime=function(t,e){void 0===e&&(e=!0);var i="";return i+=t.getFullYear()+"-",i+=t.getMonth()+1>=10?t.month+1+"-":"0"+(t.getMonth()+1)+"-",i+=t.getDate()>=10?t.getDate():"0"+t.getDate(),0==e?i:(i+=" ",i+=t.getHours()>=10?t.getHours()+":":"0"+t.getHours()+":",i+=t.getMinutes()>=10?t.getMinutes()+":":"0"+t.getMinutes()+":",i+=t.getSeconds()>=10?t.getSeconds():"0"+t.getSeconds())},t.checkFileIsImg=function(t){return 0==t.picType||"JPEG"!=t.picClass.toLocaleUpperCase()&&"JPG"!=t.picClass.toLocaleUpperCase()&&"TIF"!=t.picClass.toLocaleUpperCase()&&"PNG"!=t.picClass.toLocaleUpperCase()?!1:!0},t}(),E=(function(){function t(){this.partIndex=0,this.partId=0,this.partName="X展架",this.partSize="60*160",this.partNum=1,this.price=0/0,this.total=0/0}return s(t,"model.orderModel.PartItemVo"),t}(),function(){function t(t,e){if(this.picType=0,this.directName="",this.parentDirect="",this.directId="",this.fid="",this.picWidth=0,this.picHeight=0,this.picPhysicWidth=0/0,this.picPhysicHeight=0/0,this.colorspace="",this.picClass="",this.dpi=0/0,this.isProcessing=!1,this.picType=e,0==this.picType)this.directName=t.dname,this.parentDirect=t.dpath,this.directId=t.did;else{this.fid=t.fid;try{var i=JSON.parse(t.fattr);this.picWidth=Number(i.width),this.picHeight=Number(i.height),this.colorspace=i.colorspace,this.dpi=y.oneCutNineAdd(i.dpi),this.picPhysicWidth=y.oneCutNineAdd(this.picWidth/this.dpi*2.54),this.picPhysicHeight=y.oneCutNineAdd(this.picHeight/this.dpi*2.54)}catch(n){this.isProcessing=!0}this.picClass=t.ftype,this.directName=t.fname,this.parentDirect=t.fpath}}s(t,"model.picmanagerModel.PicInfoVo");var e=t.prototype;return r(0,e,"dpath",function(){return this.parentDirect+this.directId+"|"}),t}()),S=function(){function t(t){if(this.accessory_code="",this.accessory_name="",this.accessory_color="",this.accessory_brand="",this.accessory_ssupplier="",this.measure_unit="",this.unit_weight=0,this.accessory_price=0,this.materialItemVo=null,null!=t)for(var e in t)this.hasOwnProperty(e)&&(this[e]=t[e])}return s(t,"model.orderModel.AttchCatVo"),t}(),A=function(){function t(t){this.procCat_Seq=0,this.procCat_Name="",this.selected=!1,this.nextMatList=null;for(var e in t)this.hasOwnProperty(e)&&(this[e]=t[e])}s(t,"model.orderModel.ProcessCatVo");var e=t.prototype;return e.initProcFlow=function(t){var e=t;this.nextMatList=[];for(var i=0;i<e.length;i++)1==e[i].is_mandatory&&this.nextMatList.push(new p(e[i]))},e.resetData=function(){if(this.selected=!1,null!=this.nextMatList)for(var t=0;t<this.nextMatList.length;t++)this.nextMatList[t].resetData()},r(0,e,"isMandatory",function(){if(null==this.nextMatList)return!1;for(var t=0;t<this.nextMatList.length;t++)if(1==this.nextMatList[t].is_mandatory)return!0;return!1}),t}(),C=function(){function t(t){this.prod_code="",this.prod_name="",this.min_length=0,this.max_length=0,this.min_width=0,this.max_width=0,this.material_code="",this.material_name="",this.material_color="",this.material_brand="",this.material_supplier="",this.measure_unit="",this.unit_weight=0,this.manufacturer_code="",this.manufacturer_name="",this.unit_price=0,this.additional_unitFee=0,this.prcessCatList=null,this.hasDoublePrint=1;for(var e in t)this[e]=t[e]}s(t,"model.orderModel.ProductVo");var e=t.prototype;return e.getTechDes=function(){if(null==this.prcessCatList)return"";for(var t="",e=0;e<this.prcessCatList.length;e++)if(this.prcessCatList[e].selected){var i=this.getTechStr(this.prcessCatList[e].nextMatList);""!=i&&(t+=i.substr(0,i.length-1)),t+="-"}return t.length>0?t.substring(0,t.length-1):""},e.getAllSelectedTech=function(){for(var t=[],e=0;e<this.prcessCatList.length;e++)if(this.prcessCatList[e].selected){var i=this.getChildSelectedTech(this.prcessCatList[e].nextMatList);t=t.concat(i)}return t},e.getChildSelectedTech=function(t){for(var e=[],i=0;i<t.length;i++)t[i].selected&&(e.push(t[i]),e=e.concat(this.getChildSelectedTech(t[i].nextMatList)));return e},e.getTechStr=function(t){for(var e=0;e<t.length;e++)if(t[e].selected){var i="";if(null!=t[e].selectAttachVoList)for(var n=0;n<t[e].selectAttachVoList.length;n++)i+=t[e].selectAttachVoList[n].accessory_name+",";return""!=i?t[e].preProc_Name+"("+i.substr(0,i.length-1)+")-"+this.getTechStr(t[e].nextMatList):t[e].preProc_Name+"-"+this.getTechStr(t[e].nextMatList)}return""},e.getTotalPrice=function(t,e){if("平方米"==this.measure_unit)var i=t*(this.unit_price+this.additional_unitFee);
else i=e*(this.unit_price+this.additional_unitFee);this.hasDoublePrint=1;for(var n=[],s=0;s<this.prcessCatList.length;s++)this.prcessCatList[s].selected&&(n=n.concat(this.getTechPrice(this.prcessCatList[s].nextMatList,t,e)));for(i*=this.hasDoublePrint,s=0;s<n.length;s++)i+=n[s];return parseFloat(i.toFixed(2))},e.getTechPrice=function(t,e,i){var n=[];if(null==t)return[];for(var s=0;s<t.length;s++)if(t[s].selected){var r=0;t[s].preProc_Price>0&&"平方米"==t[s].measure_unit?r=t[s].preProc_Price*e:t[s].preProc_Price>0&&(r=t[s].preProc_Price*i),t[s].preProc_Price<0&&(this.hasDoublePrint=2),null!=t[s].selectAttachVoList&&t[s].selectAttachVoList.length>0&&(r+="平方米"==t[s].selectAttachVoList[0].measure_unit?t[s].selectAttachVoList[0].accessory_price*e:t[s].selectAttachVoList[0].accessory_price*i),n.push(r),n=n.concat(this.getTechPrice(t[s].nextMatList,e,i))}return n},e.getMaterialProInfoList=function(t){var e=[];if(null==t)return[];for(var i=0;i<t.length;i++)if(t[i].selected){var n=t[i].preProc_Name;null!=t[i].selectAttachVoList&&t[i].selectAttachVoList.length>0&&(n+="("+t[i].selectAttachVoList[0].accessory_name+")"),e.push({proc_Code:t[i].preProc_Code,proc_description:n,proc_attachpath:t[i].attchMentFileId}),e=e.concat(this.getMaterialProInfoList(t[i].nextMatList))}return e},e.getProInfoList=function(){for(var t=[],e=0;e<this.prcessCatList.length;e++)this.prcessCatList[e].selected&&(t=t.concat(this.getMaterialProInfoList(this.prcessCatList[e].nextMatList)));return t},e.resetData=function(){if(null!=this.prcessCatList)for(var t=0;t<this.prcessCatList.length;t++)this.prcessCatList[t].resetData()},t}(),D=function(){function t(){this.topDirectList=[],this.directoryList=null,this.curFileList=[],this.curSelectDir=null,this.haselectPic={},this.rootDir=null,this.rootDir=new E({dname:"根目录",dpath:"",did:"0"},0)}s(t,"model.picmanagerModel.DirectoryFileModel");var e=t.prototype;return e.initTopDirectoryList=function(t){this.topDirectList=[];for(var e=t.dirs,i=0;i<e.length;i++)this.topDirectList.push(new E(e[i],0));var n=t.files;for(i=0;i<n.length;i++)this.topDirectList.push(new E(n[i],1))},e.addNewTopDir=function(t){this.topDirectList.push(new E(t,0))},e.initCurDirFiles=function(t){this.curFileList=[];for(var e=t.dirs,i=0;i<e.length;i++)this.curFileList.push(new E(e[i],0));var n=t.files;for(i=0;i<n.length;i++)this.curFileList.push(new E(n[i],1))},r(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),t._instance=null,t}(),x=function(){function t(t){this.indexNum=0,this.picinfo=null,this.materialID=0,this.materialName=null,this.orderData=null,this.orderPrice=0,this.manufacturer_code=null,this.manufacturer_name=null,this.editWidth=0/0,this.editHeight=0/0,this.technolegs=null,this.techStr="",this.vipPrice=0/0,this.price=0/0,this.paitNum=1,this.totalPrice=0/0,this.comment="",this.picinfo=t}return s(t,"model.orderModel.PicOrderItemVo"),t}(),R=(function(){function t(){}return s(t,"model.orderModel.OrderConstant"),t.MEASURE_UNIT_AREA="平方米",t.MEASURE_UNIT_PERIMETER="米",t.MEASURE_UNIT_KILOMETER="千克",t.MEASURE_UNIT_KILO="克",t.ATTACH_NO="SPNO",t.ATTACH_JPG="SPJPG",t.ATTACH_PNG="SPPNG",t.ATTACH_PEIJIAN="SPPEIJIAN",t.DOUBLE_SIDE_SAME_TECHNO="SPTE10320",t.DOUBLE_SIDE_UNSAME_TECHNO="SPTE10330",t.UNNORMAL_CUT_TECHNO="SPTE10420",t.MANUFACTURE_TYPE_PAINT=2,t.MANUFACTURE_TYPE_TEXT_PAINT=5,t}(),function(){function t(){}s(t,"model.HttpRequestUtil");var e=t.prototype;return e.newRequest=function(t,e,n,s,r,a){function o(t,e,i,n,s,r){h.onHttpRequestError(t,e,i,n,s,r)}var h=this;void 0===r&&(r="text");var l=new fn;if(l.on("progress",this,function(t){null!=a&&a(t)}),l.on("complete",this,this.onRequestCompete,[e,n,l]),i.timer.once(5e3,l,o,[t,e,n,s,r,l]),l.on("error",this,this.onHttpRequestError,[t,e,n,s,r,l]),null!=s)if("string"==typeof s);else if(s instanceof ArrayBuffer);else{var _=[];for(var u in s)_.push(u+"="+encodeURIComponent(s[u]));s=_.join("&")}console.log(t+s),l.retrytime=0,l.send(t,s,r?"post":"get","text")},e.onHttpRequestError=function(){},e.onHttpRequestProgress=function(t){console.log(t)},e.onRequestCompete=function(t,e,n,s){g.instance.hideWaitingView();try{var r=JSON.parse(s);r&&r.hasOwnProperty("status")&&0!=r.status&&L.ErrorTips.hasOwnProperty(r.status)&&v.showAlert(L.ErrorTips[r.status])}catch(a){}i.timer.clearAll(n),t&&e&&e.call(t,s),n.offAll()},e.Request=function(t,e,i,n,s,r,a){void 0===s&&(s="get"),void 0===a&&(a=!0),a&&g.instance.showWaitingView(),this.newRequest(t,e,i,n,s)},e.RequestBin=function(t,e,i,n){this.newRequest(t,e,i,n,"arraybuffer")},r(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),t._instance=null,t.httpUrl="../scfy/",t.registerUrl="account/create?",t.loginInUrl="account/login?",t.loginOutUrl="account/logout?",t.getVerifyCode="api/getcode?",t.createDirectory="dir/create?",t.deleteDirectory="dir/remove?",t.getDirectoryList="dir/list?",t.uploadPic="file/add",t.deletePic="file/remove?",t.getCapacity="get-info?",t.createGroup="group/create-group?",t.addressManageUrl="group/opt-group-express?",t.biggerPicUrl="http://large-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/",t.smallerrPicUrl="http://small-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/",t.originPicPicUrl="http://original-image.oss-cn-hangzhou.aliyuncs.com/",t.addCompanyInfo="group/create?",t.getAuditInfo="group/get-request?",t.getOuputAddr="business/manufacturers?client_code=CL10200&",t.getProdCategory="business/prodcategory?client_code=CL10200&",t.getProdList="business/prodlist?client_code=CL10200&addr_id=",t.getProcessCatList="business/processcatlist?prod_code=",t.getProcessFlow="business/procflowlist?manufacturer_code=",t.GetAccCatlist="business/acccatlist?",t.GetAccessorylist="business/accessorylist?",t.getDeliveryList="business/deliverylist?manufacturer_code=",t.placeOrder="business/placeorder?",t.cancelOrder="business/cancelorder?",t.authorUploadUrl="file/authinfo",t.noticeServerPreUpload="file/preupload?",t.getAddressFromServer="group/get-addr-list?",t.abortUpload="file/abortadd?",t.getCompanyInfo="group/get-info?",t.chargeRequest="group/recharge?",t.orderOnlinePay="group/recharge?",t.payOrderByMoney="group/pay-order?",t.checkOrderList="business/list-order?",t}()),T=function(){function e(){this.tt=0/0,t.Laya3D?t.Laya3D.init(1920,1080):i.init(1920,1080,i.WebGL),i.stage.scaleMode="noscale",i.stage.screenMode=d.screenMode,i.stage.alignV=d.alignV,i.stage.alignH="center",Mi.exportSceneToJson=d.exportSceneToJson,(d.debug||"true"==ee.getQueryString("debug"))&&i.enableDebugPanel(),d.physicsDebug&&i.PhysicsDebugDraw&&i.PhysicsDebugDraw.enable(),d.stat&&wi.show(),i.alertGlobalError=!0,Fe.enable("version.json",_.create(this,this.onVersionLoaded),2),i.stage.on("resize",this,this.onResizeBrower)}s(e,"Main");var n=e.prototype;return n.startInit=function(){t.Laya3D?t.Laya3D.init(1920,1080):i.init(1920,1080,i.WebGL),i.stage.scaleMode="noscale",i.stage.screenMode=d.screenMode,i.stage.alignV=d.alignV,i.stage.alignH="center",Mi.exportSceneToJson=d.exportSceneToJson,(d.debug||"true"==ee.getQueryString("debug"))&&i.enableDebugPanel(),d.physicsDebug&&i.PhysicsDebugDraw&&i.PhysicsDebugDraw.enable(),d.stat&&wi.show(),i.alertGlobalError=!0,Fe.enable("version.json",_.create(this,this.onVersionLoaded),2),i.stage.on("resize",this,this.onResizeBrower)},n.onVersionLoaded=function(){i.loader.load([{url:"res/atlas/comp.atlas",type:"atlas"},{url:"res/atlas/commers.atlas",type:"atlas"},{url:"res/atlas/order.atlas",type:"atlas"},{url:"res/atlas/upload.atlas",type:"atlas"},{url:"res/atlas/usercenter.atlas",type:"atlas"},{url:"res/atlas/mainpage.atlas",type:"atlas"}],_.create(this,this.onLoadedComp),null,"atlas")},n.onLoadedComp=function(){this.onConfigLoaded()},n.onConfigLoaded=function(){var t=Be.window.location.href;R.httpUrl=t.indexOf("cmyk")>=0?"../scfy/":"http://www.cmyk.com.cn/scfy/",v.instance.openView("VIEW_FIRST_PAGE")},n.onResizeBrower=function(){on.instance.event("BROWER_WINDOW_RESIZE")},e}(),b=function(){function t(t){this.addr="",this.name="测试输入地址1",this.org_code="368525478",this.contactor="368525478",this.contact_phone="18956589865",this.manufacture_priority=0;for(var e in t)this[e]=t[e]}return s(t,"model.users.FactoryInfoVo"),t}(),P=function(){function t(t){this.delivery_code="",this.delivery_name="",this.start_weight=0,this.post_weight=0,this.first_volume=0,this.post_volume=0,this.factor=0,this.limit_weight=0,this.limit_length=0,this.limit_width=0,this.limit_height=0,this.deliverynet_code="",this.deliverynet_name="",this.firstweight_price=0,this.addedweight_price=0,this.firstvol_price=0,this.addedvol_price=0;for(var e in t)this[e]=t[e]}s(t,"model.orderModel.DeliveryTypeVo");var e=t.prototype;return r(0,e,"deliveryDesc",function(){return this.delivery_name+"，"+this.deliverynet_name+"，首重:"+this.start_weight+"kg,续重"+this.post_weight+"kg，首重价格:"+this.firstweight_price+"元/kg，续重价格:"+this.addedweight_price+"元/kg。"}),t}(),L=(function(){function t(){this.id="",this.parentid="",this.areaName=null,this.childArea=null}return s(t,"model.users.CityAreaVo"),t}(),function(){function t(){}return s(t,"model.ErrorCode"),n(t,["ErrorTips",function(){return this.ErrorTips={0:"操作成功",100:"内部错误",101:"验证码空",102:"验证码超时",103:"验证码异常",104:"参数错误",201:"用户已存在",202:"用户不存在",203:"未登录",204:"登录失败",205:"用户未加入公司",206:"邀请用户不存在",207:"被邀请用户已加入公司",208:"邀请已发送",301:"上传失败",302:"目录已存在",303:"文件不存在",304:"文件已存在",305:"您有异常上传操作，请10分钟后重试",401:"您已加入公司",402:"公司已存在",403:"已发送创建公司请求",404:"您尚未加入公司",405:"您不是公司创立者",501:"参数非法",601:"权限错误",666:"数据异常",667:"数据异常",701:"设置默认地址失败",801:"订单正在支付中或已经支付成功，请勿重复支付"}}]),t}()),I=function(){function t(){this.curSelectOrderItem=null,this.selectAddress=null,this.selectFactoryAddress=null,this.selectFactoryInMat=null,this.curSelectPic=null,this.curSelectMat=null,this.outPutAddr=null,this.productList=null,this.deliveryList=null,this.selectDelivery=null,this.curSelectProcList=null,this.batchChangeMatItems=null}s(t,"model.orderModel.PaintOrderModel");var e=t.prototype;return e.resetData=function(){this.selectAddress=null,this.selectFactoryAddress=null,this.curSelectMat=null,this.outPutAddr=null,this.productList=null,this.deliveryList=null,this.selectDelivery=null},e.initOutputAddr=function(t){this.outPutAddr=[];for(var e=0;e<t.length;e++){var i=new b(t[e]);this.outPutAddr.push(i)}},e.getProcDataByProcName=function(t){if(null==this.curSelectProcList)return null;for(var e=0;e<this.curSelectProcList.length;e++)if(this.curSelectProcList[e].preProc_Name==t)return this.curSelectProcList[e];return null},r(1,t,"instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),t.getOrderSn=function(){for(var e="",i=0;20>i;i++){var n=Math.round(Math.random()*t.VOCABURARY.length);e+=t.VOCABURARY.charAt(n)}return e},t._instance=null,t.VOCABURARY="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t}(),M=function(){function t(t,e,i){this._value=0,this._name2int=t,this._int2name=e,this._int2nameMap=i}s(t,"laya.webgl.shader.ShaderDefinesBase");var e=t.prototype;return e.add=function(t){return"string"==typeof t&&(t=this._name2int[t]),this._value|=t,this._value},e.addInt=function(t){return this._value|=t,this._value},e.remove=function(t){return"string"==typeof t&&(t=this._name2int[t]),this._value&=~t,this._value},e.isDefine=function(t){return(this._value&t)===t},e.getValue=function(){return this._value},e.setValue=function(t){this._value=t},e.toNameDic=function(){var e=this._int2nameMap[this._value];return e?e:t._toText(this._value,this._int2name,this._int2nameMap)},t._reg=function(t,e,i,n){i[t]=e,n[e]=t},t._toText=function(t,e,i){var n=i[t];if(n)return n;for(var s={},r=1,a=0;32>a&&(r=1<<a,!(r>t));a++)if(t&r){var o=e[r];o&&(s[o]="")}return i[t]=s,s},t._toInt=function(t,e){for(var i=t.split("."),n=0,s=0,r=i.length;r>s;s++){var a=e[i[s]];if(!a)throw new Error("Defines to int err:"+t+"/"+i[s]);n|=a}return n},t}(),w=function(){function t(){}s(t,"laya.display.cmd.ClipRectCmd");var e=t.prototype;return e.recover=function(){Ji.recover("ClipRectCmd",this)},e.run=function(t,e,i){t.clipRect(this.x+e,this.y+i,this.width,this.height)},r(0,e,"cmdID",function(){return"ClipRect"}),t.create=function(e,i,n,s){var r=Ji.getItemByClass("ClipRectCmd",t);return r.x=e,r.y=i,r.width=n,r.height=s,r},t.ID="ClipRect",t}(),O=(function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._paramData=null,this._texture=null,this._pos=null,this._rectNum=0,this._vbSize=0,this.vbBuffer=null}s(t,"laya.layagl.cmdNative.DrawTexturesCmdNative");var e=t.prototype;return e.recover=function(){this._texture=null,this._pos=null,Ji.recover("DrawTexturesCmd",this)},r(0,e,"cmdID",function(){return"DrawTextures"}),r(0,e,"texture",function(){return this._texture},function(e){this._texture=e;for(var i=this._texture.bitmap.width,n=this._texture.bitmap.height,s=this._texture.uv,r=this.vbBuffer._float32Data,a=this.vbBuffer._int32Data,o=0,h=0;h<this._rectNum;h++){var l=this.pos[2*h],_=this.pos[2*h+1];r[o++]=l,r[o++]=_,r[o++]=s[0],r[o++]=s[1],a[o++]=4294967295,a[o++]=4294967295,r[o++]=l+i,r[o++]=_,r[o++]=s[2],r[o++]=s[3],a[o++]=4294967295,a[o++]=4294967295,r[o++]=l+i,r[o++]=_+n,r[o++]=s[4],r[o++]=s[5],a[o++]=4294967295,a[o++]=4294967295,r[o++]=l,r[o++]=_+n,r[o++]=s[6],r[o++]=s[7],a[o++]=4294967295,a[o++]=4294967295}var u=this._paramData._int32Data;u[t._PARAM_TEXLOCATION_POS_]=33984,u[t._PARAM_TEXTURE_POS_]=this._texture.bitmap._glTexture.id,we.syncBufferToRenderThread(this.vbBuffer),we.syncBufferToRenderThread(this._paramData)}),r(0,e,"pos",function(){return this._pos},function(e){this._pos=e;var i=this._pos.length/2,n=this._texture.bitmap.width,s=this._texture.bitmap.height,r=this._texture.uv;(!this.vbBuffer||this.vbBuffer.getByteLength()<24*i*4)&&(this.vbBuffer=new ParamData(24*i*4,!0)),this._vbSize=24*i*4,this._rectNum=i;for(var a=this.vbBuffer._float32Data,o=this.vbBuffer._int32Data,h=0,l=0;i>l;l++){var _=this.pos[2*l],u=this.pos[2*l+1];a[h++]=_,a[h++]=u,a[h++]=r[0],a[h++]=r[1],o[h++]=4294967295,o[h++]=4294967295,a[h++]=_+n,a[h++]=u,a[h++]=r[2],a[h++]=r[3],o[h++]=4294967295,o[h++]=4294967295,a[h++]=_+n,a[h++]=u+s,a[h++]=r[4],a[h++]=r[5],o[h++]=4294967295,o[h++]=4294967295,a[h++]=_,a[h++]=u+s,a[h++]=r[6],a[h++]=r[7],o[h++]=4294967295,o[h++]=4294967295}var c=(this._paramData._float32Data,this._paramData._int32Data);c[t._PARAM_RECT_NUM_POS_]=this._rectNum,c[t._PARAM_VB_POS_]=this.vbBuffer.getPtrID(),c[t._PARAM_VB_SIZE_POS_]=this._vbSize,we.syncBufferToRenderThread(this.vbBuffer),we.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i){var n=Ji.getItemByClass("DrawTexturesCmd",t);n._graphicsCmdEncoder=this._commandEncoder,t._DRAW_TEXTURES_CMD_ENCODER_||(t._DRAW_TEXTURES_CMD_ENCODER_=we.instance.createCommandEncoder(124,32,!0),t._DRAW_TEXTURES_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_TEXTURES_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),t._DRAW_TEXTURES_CMD_ENCODER_.useVDO(he.VDO_MESHQUADTEXTURE),t._DRAW_TEXTURES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_TEXTURES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_TEXTURES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_TEXTURES_CMD_ENCODER_.uniformTextureByParamData(t._PARAM_UNIFORMLOCATION_POS_,4*t._PARAM_TEXLOCATION_POS_,4*t._PARAM_TEXTURE_POS_),t._DRAW_TEXTURES_CMD_ENCODER_.setRectMeshExByParamData(4*t._PARAM_RECT_NUM_POS_,4*t._PARAM_VB_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_VB_OFFSET_POS_),t._DRAW_TEXTURES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_TEXTURES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_TEXTURES_CMD_ENCODER_)),n._paramData||(n._paramData=new ParamData(28,!0)),n._texture=e,n._pos=i;var s=e.bitmap.width,r=e.bitmap.height,a=e.uv,o=i.length/2;(!n.vbBuffer||n.vbBuffer.getByteLength()<24*o*4)&&(n.vbBuffer=new ParamData(24*o*4,!0)),n._vbSize=24*o*4,n._rectNum=o;for(var h=n.vbBuffer._float32Data,l=n.vbBuffer._int32Data,_=0,u=0;o>u;u++){var c=i[2*u],d=i[2*u+1];h[_++]=c,h[_++]=d,h[_++]=a[0],h[_++]=a[1],l[_++]=4294967295,l[_++]=4294967295,h[_++]=c+s,h[_++]=d,h[_++]=a[2],h[_++]=a[3],l[_++]=4294967295,l[_++]=4294967295,h[_++]=c+s,h[_++]=d+r,h[_++]=a[4],h[_++]=a[5],l[_++]=4294967295,l[_++]=4294967295,h[_++]=c,h[_++]=d+r,h[_++]=a[6],h[_++]=a[7],l[_++]=4294967295,l[_++]=4294967295}var f=(n._paramData._float32Data,n._paramData._int32Data);return f[t._PARAM_UNIFORMLOCATION_POS_]=3,f[t._PARAM_TEXLOCATION_POS_]=33984,f[t._PARAM_TEXTURE_POS_]=e.bitmap._glTexture.id,f[t._PARAM_RECT_NUM_POS_]=n._rectNum,f[t._PARAM_VB_POS_]=n.vbBuffer.getPtrID(),f[t._PARAM_VB_SIZE_POS_]=n._vbSize,f[t._PARAM_VB_OFFSET_POS_]=0,we.syncBufferToRenderThread(n.vbBuffer),we.syncBufferToRenderThread(n._paramData),n._graphicsCmdEncoder.useCommandEncoder(t._DRAW_TEXTURES_CMD_ENCODER_.getPtrID(),n._paramData.getPtrID(),-1),we.syncBufferToRenderThread(n._graphicsCmdEncoder),n},t.ID="DrawTextures",t._DRAW_TEXTURES_CMD_ENCODER_=null,t._PARAM_UNIFORMLOCATION_POS_=0,t._PARAM_TEXLOCATION_POS_=1,t._PARAM_TEXTURE_POS_=2,t._PARAM_RECT_NUM_POS_=3,t._PARAM_VB_POS_=4,t._PARAM_VB_SIZE_POS_=5,t._PARAM_VB_OFFSET_POS_=6,t}(),function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._paramData=null,this._texture=null,this._x=0/0,this._y=0/0,this._width=0/0,this._height=0/0}s(t,"laya.layagl.cmdNative.DrawCanvasCmdNative");var e=t.prototype;return e.recover=function(){this._graphicsCmdEncoder=null,Ji.recover("DrawCanvasCmd",this)},r(0,e,"cmdID",function(){return"DrawCanvas"}),r(0,e,"y",function(){return this._y},function(e){this._y=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,i[t._PARAM_CLIP_SIZE+1]=e+16,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"texture",function(){return this._texture},function(e){this._texture=e,this._paramData._int32Data[t._PARAM_TEXTURE_POS_]=this._texture._getSource().id;var i=this._paramData._float32Data,n=ir.flipyuv;i[t._PARAM_VB_POS_+2]=n[0],i[t._PARAM_VB_POS_+3]=n[1],i[t._PARAM_VB_POS_+8]=n[2],i[t._PARAM_VB_POS_+9]=n[3],i[t._PARAM_VB_POS_+14]=n[4],i[t._PARAM_VB_POS_+15]=n[5],i[t._PARAM_VB_POS_+20]=n[6],i[t._PARAM_VB_POS_+21]=n[7],we.syncBufferToRenderThread(this._paramData)}),r(0,e,"width",function(){return this._width},function(e){this._width=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,i[t._PARAM_CLIP_SIZE+2]=e-32,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"x",function(){return this._x},function(e){this._x=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,i[t._PARAM_CLIP_SIZE]=e+16,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"height",function(){return this._height},function(e){this._height=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,i[t._PARAM_CLIP_SIZE+3]=e-32,we.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,n,s,r){var a=Ji.getItemByClass("DrawCanvasCmd",t);a._graphicsCmdEncoder=this._commandEncoder,t.createCommandEncoder(),a._paramData||(a._paramData=new ParamData(132,!0)),a._texture=e,a._x=i,a._y=n,a._width=s,a._height=r,t.setParamData(a._paramData,e,i,n,s,r);var o=t._DRAW_CANVAS_CMD_ENCODER_.getPtrID(),h=a._paramData.getPtrID();return a._graphicsCmdEncoder.useCommandEncoder(o,h,-1),we.syncBufferToRenderThread(a._graphicsCmdEncoder),a},t.createCommandEncoder=function(){t._DRAW_CANVAS_CMD_ENCODER_||(t._DRAW_CANVAS_CMD_ENCODER_=we.instance.createCommandEncoder(172,32,!0),t._DRAW_CANVAS_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_CANVAS_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),t._DRAW_CANVAS_CMD_ENCODER_.useVDO(he.VDO_MESHQUADTEXTURE),t._DRAW_CANVAS_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_CANVAS_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_CANVAS_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_CANVAS_CMD_ENCODER_.uniformTextureByParamData(0,4,4*t._PARAM_TEXTURE_POS_),t._DRAW_CANVAS_CMD_ENCODER_.setRectMeshByParamData(12,4*t._PARAM_VB_POS_,16),t._DRAW_CANVAS_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_CANVAS_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_CANVAS_CMD_ENCODER_))},t.setParamData=function(e,i,n,s,r,a){var o=e._float32Data,h=e._int32Data;h[0]=3,h[1]=33984,h[t._PARAM_TEXTURE_POS_]=i._getSource().id,h[3]=1,h[4]=96;var l=0!=r?r:i.width,_=0!=a?a:i.height,u=ir.flipyuv,c=t._PARAM_VB_POS_;o[c++]=n,o[c++]=s,o[c++]=u[0],o[c++]=u[1],h[c++]=4294967295,h[c++]=4294967295,o[c++]=n+l,o[c++]=s,o[c++]=u[2],o[c++]=u[3],h[c++]=4294967295,h[c++]=4294967295,o[c++]=n+l,o[c++]=s+_,o[c++]=u[4],o[c++]=u[5],h[c++]=4294967295,h[c++]=4294967295,o[c++]=n,o[c++]=s+_,o[c++]=u[6],o[c++]=u[7],h[c++]=4294967295,h[c++]=4294967295,o[t._PARAM_CLIP_SIZE]=n+16,o[t._PARAM_CLIP_SIZE+1]=s+16,o[t._PARAM_CLIP_SIZE+2]=r-32,o[t._PARAM_CLIP_SIZE+3]=a-32,we.syncBufferToRenderThread(e)},t.ID="DrawCanvas",t._DRAW_CANVAS_CMD_ENCODER_=null,t._PARAM_TEXTURE_POS_=2,t._PARAM_VB_POS_=5,t._PARAM_CLIP_SIZE=29,t}()),B=function(){function t(){}s(t,"laya.display.cmd.DrawPolyCmd");var e=t.prototype;return e.recover=function(){this.points=null,this.fillColor=null,this.lineColor=null,Ji.recover("DrawPolyCmd",this)},e.run=function(t,e,i){t._drawPoly(this.x+e,this.y+i,this.points,this.fillColor,this.lineColor,this.lineWidth,this.isConvexPolygon,this.vid)},r(0,e,"cmdID",function(){return"DrawPoly"}),t.create=function(e,i,n,s,r,a,o,h){var l=Ji.getItemByClass("DrawPolyCmd",t);return l.x=e,l.y=i,l.points=n,l.fillColor=s,l.lineColor=r,l.lineWidth=a,l.isConvexPolygon=o,l.vid=h,l},t.ID="DrawPoly",t}(),N=function(){function t(){}s(t,"laya.resource.Context");var e=t.prototype;return e.drawCanvas=function(t,e,i,n,s){wi.drawCall++,this.drawImage(t._source,e,i,n,s)},e._drawRect=function(t,e,i,n,s){wi.drawCall++,s&&(this.fillStyle=s),this.fillRect(t,e,i,n)},e.drawText=function(t,e,i,n,s,r){wi.drawCall++,arguments.length>3&&null!=n&&(this.font=n,this.fillStyle=s,this.textAlign=r,this.textBaseline="top"),this.fillText(t,e,i)},e.fillBorderText=function(t,e,i,n,s,r,a,o){wi.drawCall++,this.font=n,this.fillStyle=s,this.textBaseline="top",this.strokeStyle=r,this.lineWidth=a,this.textAlign=o,this.strokeText(t,e,i),this.fillText(t,e,i)},e.fillWords=function(t,e,i,n,s){n&&(this.font=n),s&&(this.fillStyle=s),this.textBaseline="top",this.textAlign="left";for(var r=0,a=t.length;a>r;r++){var o=t[r];this.fillText(o.char,o.x+e,o.y+i)}},e.fillBorderWords=function(t,e,i,n,s,r,a){n&&(this.font=n),s&&(this.fillStyle=s),this.textBaseline="top",this.lineWidth=a,this.textAlign="left",this.strokeStyle=r;for(var o=0,h=t.length;h>o;o++){var l=t[o];this.strokeText(l.char,l.x+e,l.y+i),this.fillText(l.char,l.x+e,l.y+i)}},e.strokeWord=function(t,e,i,n,s,r,a){wi.drawCall++,arguments.length>3&&null!=n&&(this.font=n,this.strokeStyle=s,this.lineWidth=r,this.textAlign=a,this.textBaseline="top"),this.strokeText(t,e,i)},e.setTransformByMatrix=function(t){this.setTransform(t.a,t.b,t.c,t.d,t.tx,t.ty)},e.clipRect=function(t,e,i,n){wi.drawCall++,this.beginPath(),this.rect(t,e,i,n),this.clip()},e.drawTextureWithTransform=function(t,e,i,n,s,r,a,o,h,l){if(t._getSource()){wi.drawCall++;var _=1!==h;if(_){var u=this.globalAlpha;this.globalAlpha*=h}l&&(this.globalCompositeOperation=l);var c=t.uv,d=t.bitmap._width,f=t.bitmap._height;r?(this.save(),this.transform(r.a,r.b,r.c,r.d,r.tx+a,r.ty+o),this.drawImage(t.bitmap._source,c[0]*d,c[1]*f,(c[2]-c[0])*d,(c[5]-c[3])*f,e,i,n,s),this.restore()):this.drawImage(t.bitmap._source,c[0]*d,c[1]*f,(c[2]-c[0])*d,(c[5]-c[3])*f,a+e,o+i,n,s),_&&(this.globalAlpha=u),l&&(this.globalCompositeOperation="source-over")}},e.drawTexture2=function(t,e,i,n,s,r){var a=r[0];wi.drawCall++;var o=a.uv,h=a.bitmap._width,l=a.bitmap._height;s?(this.save(),this.transform(s.a,s.b,s.c,s.d,s.tx+t,s.ty+e),this.drawImage(a.bitmap._source,o[0]*h,o[1]*l,(o[2]-o[0])*h,(o[5]-o[3])*l,r[1]-i,r[2]-n,r[3],r[4]),this.restore()):this.drawImage(a.bitmap._source,o[0]*h,o[1]*l,(o[2]-o[0])*h,(o[5]-o[3])*l,r[1]-i+t,r[2]-n+e,r[3],r[4])},e.fillTexture=function(t,e,i,n,s,r,a,o){if(!o.pat){if(t.uv!=_n.DEF_UV){var h=new Is;h.getContext("2d"),h.size(t.width,t.height),h.context.drawTexture(t,0,0,t.width,t.height),t=new _n(h)}o.pat=this.createPattern(t.bitmap._source,r)}var l=e,_=i,u=0,c=0;a&&(l+=a.x%t.width,_+=a.y%t.height,u-=a.x%t.width,c-=a.y%t.height),this.translate(l,_),this._drawRect(u,c,n,s,o.pat),this.translate(-l,-_)},e.flush=function(){return 0},e.destroy=function(){this.canvas.width=this.canvas.height=0},e.clear=function(){Ni.isConchApp||this.clearRect(0,0,Ni._mainCanvas.width,Ni._mainCanvas.height)},e.drawTriangle=function(t,e,i,n,s,r,a,o){var h=t.bitmap,l=h._getSource(),_=t.width,u=t.height,c=h.width,d=h.height,f=i[n]*c,p=i[s]*c,m=i[r]*c,g=i[n+1]*d,v=i[s+1]*d,y=i[r+1]*d,E=e[n],S=e[s],A=e[r],C=e[n+1],D=e[s+1],x=e[r+1];if(o){var R=1,T=1,b=(E+S+A)/3,P=(C+D+x)/3,L=E-b,I=C-P,M=Math.sqrt(L*L+I*I);E=b+L/M*(M+R),C=P+I/M*(M+T),L=S-b,I=D-P,M=Math.sqrt(L*L+I*I),S=b+L/M*(M+R),D=P+I/M*(M+T),L=A-b,I=x-P,M=Math.sqrt(L*L+I*I),A=b+L/M*(M+R),x=P+I/M*(M+T)}this.save(),a&&this.transform(a.a,a.b,a.c,a.d,a.tx,a.ty),this.beginPath(),this.moveTo(E,C),this.lineTo(S,D),this.lineTo(A,x),this.closePath(),this.clip();var w=f*v+g*m+p*y-v*m-g*p-f*y,O=1/w,B=E*v+g*A+S*y-v*A-g*S-E*y,N=f*S+E*m+p*A-S*m-E*p-f*A,k=f*v*A+g*S*m+E*p*y-E*v*m-g*p*A-f*S*y,F=C*v+g*x+D*y-v*x-g*D-C*y,V=f*D+C*m+p*x-D*m-C*p-f*x,U=f*v*x+g*D*m+C*p*y-C*v*m-g*p*x-f*D*y;this.transform(B*O,F*O,N*O,V*O,k*O,U*O),this.drawImage(l,t.uv[0]*c,t.uv[1]*d,_,u,t.uv[0]*c,t.uv[1]*d,_,u),this.restore()},e.transformByMatrix=function(t,e,i){this.transform(t.a,t.b,t.c,t.d,t.tx+e,t.ty+i)},e.saveTransform=function(){this.save()},e.restoreTransform=function(){this.restore()},e.drawRect=function(t,e,i,n,s,r,a){var o=this;null!=s&&(o.fillStyle=s,o.fillRect(t,e,i,n)),null!=r&&(o.strokeStyle=r,o.lineWidth=a,o.strokeRect(t,e,i,n))},e.drawTexture=function(t,e,i,n,s){var r=t._getSource();if(r){wi.drawCall++;var a=t.uv,o=t.bitmap.width,h=t.bitmap.height;this.drawImage(r,a[0]*o,a[1]*h,(a[2]-a[0])*o,(a[5]-a[3])*h,e,i,n,s)}},e.drawTextures=function(t,e,i,n){wi.drawCall+=e.length/2;for(var s=t.width,r=t.height,a=0,o=e.length;o>a;a+=2)this.drawTexture(t,e[a]+i,e[a+1]+n,s,r)},e.drawTriangles=function(t,e,i,n,s,r,a){var o=0,h=r.length;for(this.translate(e,i),o=0;h>o;o+=3){var l=2*r[o],_=2*r[o+1],u=2*r[o+2];this.drawTriangle(t,n,s,l,_,u,a,!0)}this.translate(-e,-i)},e.alpha=function(t){this.globalAlpha*=t},e._transform=function(t,e,i){this.translate(e,i),this.transform(t.a,t.b,t.c,t.d,t.tx,t.ty),this.translate(-e,-i)},e._rotate=function(t,e,i){this.translate(e,i),this.rotate(t),this.translate(-e,-i)},e._scale=function(t,e,i,n){this.translate(i,n),this.scale(t,e),this.translate(-i,-n)},e._drawLine=function(t,e,i,n,s,r,a,o){this.beginPath(),this.strokeStyle=a,this.lineWidth=o,this.moveTo(t+i,e+n),this.lineTo(t+s,e+r),this.stroke()},e._drawLines=function(t,e,i,n,s,r){Ni.isWebGL&&this.setPathId(r),this.beginPath(),this.strokeStyle=n,this.lineWidth=s;var a=2,o=i.length;if(Ni.isWebGL)this.addPath(i.slice(),!1,!1,t,e);else for(this.moveTo(t+i[0],e+i[1]);o>a;)this.lineTo(t+i[a++],e+i[a++]);this.stroke()},e.drawCurves=function(t,e,i,n,s){this.beginPath(),this.strokeStyle=n,this.lineWidth=s,this.moveTo(t+i[0],e+i[1]);for(var r=2,a=i.length;a>r;)this.quadraticCurveTo(t+i[r++],e+i[r++],t+i[r++],e+i[r++]);this.stroke()},e._fillAndStroke=function(t,e,i,n){void 0===n&&(n=!1),null!=t&&(this.fillStyle=t,this.fill()),null!=e&&i>0&&(this.strokeStyle=e,this.lineWidth=i,this.stroke())},e._drawCircle=function(e,i,n,s,r,a){wi.drawCall++,Ni.isWebGL?this.beginPath(!0):this.beginPath(),this.arc(e,i,n,0,t.PI2),this.closePath(),this._fillAndStroke(s,r,a)},e._drawPie=function(t,e,i,n,s,r,a,o){this.beginPath(),this.moveTo(t,e),this.arc(t,e,i,n,s),this.closePath(),this._fillAndStroke(r,a,o)},e._drawPoly=function(t,e,i,n,s,r,a,o){var h=2,l=i.length;if(this.beginPath(),Ni.isWebGL)this.setPathId(o),this.addPath(i.slice(),!0,a,t,e);else for(this.moveTo(t+i[0],e+i[1]);l>h;)this.lineTo(t+i[h++],e+i[h++]);this.closePath(),this._fillAndStroke(n,s,r,a)},e._drawPath=function(t,e,i,n,s){this.beginPath();for(var r=0,a=i.length;a>r;r++){var o=i[r];switch(o[0]){case"moveTo":this.moveTo(t+o[1],e+o[2]);break;case"lineTo":this.lineTo(t+o[1],e+o[2]);break;case"arcTo":this.arcTo(t+o[1],e+o[2],t+o[3],e+o[4],o[5]);break;case"closePath":this.closePath()}}null!=n&&(this.fillStyle=n.fillStyle,this.fill()),null!=s&&(this.strokeStyle=s.strokeStyle,this.lineWidth=s.lineWidth||1,this.lineJoin=s.lineJoin,this.lineCap=s.lineCap,this.miterLimit=s.miterLimit,this.stroke())},e.drawParticle=function(){},t.__init__=function(t){var e=laya.resource.Context.prototype;if(t=t||CanvasRenderingContext2D.prototype,!t.init2d){t.init2d=!0;var i=["saveTransform","restoreTransform","transformByMatrix","drawTriangles","drawTriangle","drawTextures","fillWords","fillBorderWords","drawRect","strokeWord","drawText","fillTexture","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves","_drawRect","alpha","_transform","_rotate","_scale","_drawLine","_drawLines","_drawCircle","_fillAndStroke","_drawPie","_drawPoly","_drawPath","drawTextureWithTransform"];i.forEach(function(i){t[i]=e[i]})}},t.ENUM_TEXTALIGN_DEFAULT=0,t.ENUM_TEXTALIGN_CENTER=1,t.ENUM_TEXTALIGN_RIGHT=2,t.PI2=2*Math.PI,t}(),k=function(){function t(){}s(t,"laya.display.cmd.FillWordsCmd");var e=t.prototype;return e.recover=function(){this.words=null,Ji.recover("FillWordsCmd",this)},e.run=function(t,e,i){t.fillWords(this.words,this.x+e,this.y+i,this.font,this.color)},r(0,e,"cmdID",function(){return"FillWords"}),t.create=function(e,i,n,s,r){var a=Ji.getItemByClass("FillWordsCmd",t);return a.words=e,a.x=i,a.y=n,a.font=s,a.color=r,a},t.ID="FillWords",t}(),F=function(){function t(){}s(t,"laya.display.cmd.TransformCmd");var e=t.prototype;return e.recover=function(){this.matrix=null,Ji.recover("TransformCmd",this)},e.run=function(t,e,i){t._transform(this.matrix,this.pivotX+e,this.pivotY+i)},r(0,e,"cmdID",function(){return"Transform"}),t.create=function(e,i,n){var s=Ji.getItemByClass("TransformCmd",t);return s.matrix=e,s.pivotX=i,s.pivotY=n,s},t.ID="Transform",t}(),V=function(){function t(t){this._par=null,this._loaded=!0,this.bitmap={},this.bitmap.id=t.id,this._par=t}s(t,"laya.webgl.resource.CharInternalTexture");var e=t.prototype;return e._getSource=function(){return this._par._source},t}(),U=function(){function t(){}s(t,"laya.webgl.resource.ICharRender");var e=t.prototype;return e.getWidth=function(){return 0},e.scale=function(){},e.getCharBmp=function(){return null},t}(),W=function(){function t(){}return s(t,"laya.layagl.ConchPropertyAdpt"),t.rewriteProperties=function(){laya.layagl.ConchPropertyAdpt.rewriteNumProperty(He.prototype,"x"),laya.layagl.ConchPropertyAdpt.rewriteNumProperty(He.prototype,"y"),laya.layagl.ConchPropertyAdpt.rewriteNumProperty(He.prototype,"width"),laya.layagl.ConchPropertyAdpt.rewriteNumProperty(He.prototype,"height"),laya.layagl.ConchPropertyAdpt.rewriteFunc(He.prototype,"recover")},t.rewriteNumProperty=function(t,e){Object.defineProperty(t,e,{get:function(){return this["_"+e]||0},set:function(t){this["_"+e]=t,this.onPropertyChanged&&this.onPropertyChanged(this)}})},t.rewriteFunc=function(t,e){t["__"+e]=t[e],t[e]=function(){t["__"+e].call(this),this.onPropertyChanged&&(this.onPropertyChanged=null)}},t}(),G=function(){function t(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=0/0,this._http=null}s(t,"laya.net.TTFLoader");var e=t.prototype;
return e.load=function(t){this._url=t;var e=t.split(".ttf")[0].split("/");this.fontName=e[e.length-1],Ni.isConchApp?this._loadConch():Be.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},e._loadConch=function(){this._http=new fn,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},e._onHttpLoaded=function(t){Be.window.conchTextCanvas.setFontFaceFromBuffer(this.fontName,t),this._clearHttp(),this._complete()},e._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},e._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},e._complete=function(){i.systemTimer.clear(this,this._complete),i.systemTimer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},e._checkComplete=function(){qi.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},e._loadWithFontFace=function(){var t=new Be.window.FontFace(this.fontName,"url('"+this._url+"')");Be.window.document.fonts.add(t);var e=this;t.loaded.then(function(){e._complete()}),t.load()},e._createDiv=function(){this._div=Be.createElement("div"),this._div.innerHTML="laya";var t=this._div.style;t.fontFamily=this.fontName,t.position="absolute",t.left="-100px",t.top="-100px",Be.document.body.appendChild(this._div)},e._loadWithCSS=function(){var t=this,e=Be.createElement("style");e.type="text/css",Be.document.body.appendChild(e),e.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=qi.measureText("LayaTTFFont",this._fontTxt).width;var n=this;e.onload=function(){i.systemTimer.once(1e4,n,t._complete)},i.systemTimer.loop(20,this,this._checkComplete),this._createDiv()},t._testString="LayaTTFFont",t}(),z=function(){function t(e,i){if(a.map[e])return this._fun=a.map[e],this._next=t.NORENDER,void 0;switch(this._next=i||t.NORENDER,e){case 0:return this._fun=this._no,void 0;case 1:return this._fun=this._alpha,void 0;case 2:return this._fun=this._transform,void 0;case 4:return this._fun=this._blend,void 0;case 8:return this._fun=this._canvas,void 0;case 32:return this._fun=this._mask,void 0;case 64:return this._fun=this._clip,void 0;case 128:return this._fun=this._style,void 0;case 512:return this._fun=this._graphics,void 0;case 8192:return this._fun=this._children,void 0;case 2048:return this._fun=this._custom,void 0;case 256:return this._fun=this._texture,void 0;case 16:return this._fun=Q._filter,void 0;case 69905:return this._fun=t._initRenderFun,void 0}this.onCreate(e)}s(t,"laya.renders.RenderSprite");var e=t.prototype;return e.onCreate=function(){},e._style=function(t,e,i,n){var s=t._style;null!=s.render&&s.render(t,e,i,n);var r=this._next;r._fun.call(r,t,e,i,n)},e._no=function(){},e._custom=function(t,e,i,n){t.customRender(e,i,n),this._next._fun.call(this._next,t,e,i-t.pivotX,n-t.pivotY)},e._clip=function(e,i,n,s){var r=this._next;if(r!=t.NORENDER){var a=e._style.scrollRect;i.save(),i.clipRect(n,s,a.width,a.height),r._fun.call(r,e,i,n-a.x,s-a.y),i.restore()}},e._blend=function(t,e,i,n){var s=t._style;s.blendMode&&(e.globalCompositeOperation=s.blendMode);var r=this._next;r._fun.call(r,t,e,i,n),e.globalCompositeOperation="source-over"},e._mask=function(t,e,i,n){var s=this._next;s._fun.call(s,t,e,i,n);var r=t.mask;r&&(e.globalCompositeOperation="destination-in",(r.numChildren>0||!r.graphics._isOnlyOne())&&(r.cacheAs="bitmap"),r.render(e,i-t._style.pivotX,n-t._style.pivotY)),e.globalCompositeOperation="source-over"},e._texture=function(t,e,i,n){var s=t.texture;s._getSource()&&e.drawTexture(s,i-t.pivotX+s.offsetX,n-t.pivotY+s.offsetY,t._width||s.width,t._height||s.height);var r=this._next;r._fun.call(r,t,e,i,n)},e._graphics=function(t,e,i,n){t._graphics&&t._graphics._render(t,e,i-t.pivotX,n-t.pivotY);var s=this._next;s._fun.call(s,t,e,i,n)},e._image=function(t,e,i,n){var s=t._style;e.drawTexture2(i,n,s.pivotX,s.pivotY,t.transform,t._graphics._one)},e._image2=function(t,e,i,n){var s=t._style;e.drawTexture2(i,n,s.pivotX,s.pivotY,t.transform,t._graphics._one)},e._alpha=function(t,e,i,n){var s,r=t._style;if((s=r.alpha)>.01||t._needRepaint()){var a=e.globalAlpha;e.globalAlpha*=s;var o=this._next;o._fun.call(o,t,e,i,n),e.globalAlpha=a}},e._transform=function(e,i,n,s){{var r=e.transform,a=this._next;e._style}r&&a!=t.NORENDER?(i.save(),i.transform(r.a,r.b,r.c,r.d,r.tx+n,r.ty+s),a._fun.call(a,e,i,0,0),i.restore()):a._fun.call(a,e,i,n,s)},e._children=function(t,e,i,n){var s,r=t._style,a=t._children,o=a.length;if(i-=t.pivotX,n-=t.pivotY,r.viewport){var h=r.viewport,l=h.x,_=h.y,u=h.right,c=h.bottom,d=0/0,f=0/0;for(p=0;o>p;++p)(s=a[p])._visible&&(d=s._x)<u&&d+s.width>l&&(f=s._y)<c&&f+s.height>_&&s.render(e,i,n)}else for(var p=0;o>p;++p)(s=a[p])._visible&&s.render(e,i,n)},e._canvas=function(t,e,n,s){var r=t._cacheStyle,a=this._next;if(!r.enableCanvasRender)return a._fun.call(a,t,e,n,s),void 0;"bitmap"===r.cacheAs?wi.canvasBitmap++:wi.canvasNormal++;var o=!1,h=!1;if(Ni.isWebGL&&r.canvas){var l=r.canvas,_=(l.context,l.touches);if(_)for(var u=0;u<_.length;u++)if(_[u].deleted){h=!0;break}o=l.isCacheValid&&!l.isCacheValid()}if(t._needRepaint()||!r.canvas||h||o||i.stage.isGlobalRepaint())if(Ni.isWebGL&&"normal"===r.cacheAs){if(e._targets)return a._fun.call(a,t,e,n,s),void 0;this._canvas_webgl_normal_repaint(t,e)}else this._canvas_repaint(t,e,n,s);var c=r.cacheRect;e.drawCanvas(r.canvas,n+c.x,s+c.y,c.width,c.height)},e._canvas_repaint=function(t,e,i,n){var s,r,a,o,h,l,_,u,c,d=t._cacheStyle,f=this._next,p=d.canvas,m=d.cacheAs;if(c=d._calculateCacheRect(t,m,i,n),_=c.x,u=c.y,o=d.cacheRect,h=o.width*_,l=o.height*u,r=o.x,a=o.y,Ni.isWebGL&&"bitmap"===m&&(h>2048||l>2048))return console.warn("cache bitmap size larger than 2048,cache ignored"),d.releaseContext(),f._fun.call(f,t,e,i,n),void 0;if(p||(d.createContext(),p=d.canvas),s=p.context,s.sprite=t,(p.width!=h||p.height!=l)&&p.size(h,l),"bitmap"===m?s.asBitmap=!0:"normal"===m&&(s.asBitmap=!1),s.clear(),1!=_||1!=u){var g=s;g.save(),g.scale(_,u),f._fun.call(f,t,s,-r,-a),g.restore(),t._applyFilters()}else g=s,f._fun.call(f,t,s,-r,-a),t._applyFilters();d.staticCache&&(d.reCache=!1),wi.canvasReCache++},e._canvas_webgl_normal_repaint=function(t,e){{var n=t._cacheStyle,s=this._next,r=n.canvas,a=n.cacheAs;n._calculateCacheRect(t,a,0,0)}r||(r=n.canvas=new i.WebGLCacheAsNormalCanvas(e,t));var o=r.context;r.startRec(),s._fun.call(s,t,o,t.pivotX,t.pivotY),t._applyFilters(),wi.canvasReCache++,r.endRec()},t.__init__=function(){a.__init__();var e,i=0,n=0;for(e=qi.createRenderSprite(69905,null),n=t.renders.length=16384,i=0;n>i;i++)t.renders[i]=e;t.renders[0]=qi.createRenderSprite(0,null)},t._initRenderFun=function(e,i,n,s){var r=e._renderType,a=t.renders[r]=t._getTypeRender(r);a._fun(e,i,n,s)},t._getTypeRender=function(t){if(a.map[t])return qi.createRenderSprite(t,null);for(var e=null,i=8192;i>0;)i&t&&(e=qi.createRenderSprite(i,e)),i>>=1;return e},t.INIT=69905,t.renders=[],t.NORENDER=new t(0,null),t}(),X=function(){function t(){this._creates(),this.reset()}s(t,"laya.html.dom.HTMLElement");var e=t.prototype;return e._creates=function(){this._style=Hi.create()},e.reset=function(){if(this.URI=null,this.parent=null,this._style.reset(),this._style.ower=this,this._style.valign="middle",this._text&&this._text.words){var e=this._text.words,i=0,n=0;n=e.length;var s;for(i=0;n>i;i++)s=e[i],s&&s.recover()}return this._text=t._EMPTYTEXT,this._children&&(this._children.length=0),this._x=this._y=this._width=this._height=0,this},e._getCSSStyle=function(){return this._style},e._addChildsToLayout=function(t){var e=this._getWords();if(null==e&&(!this._children||0==this._children.length))return!1;if(e)for(var i=0,n=e.length;n>i;i++)t.push(e[i]);return this._children&&this._children.forEach(function(e){var i=e._style;i._enableLayout&&i._enableLayout()&&e._addToLayout(t)}),!0},e._addToLayout=function(t){if(this._style){var e=this._style;e.absolute||(e.block?t.push(this):this._addChildsToLayout(t)&&(this.x=this.y=0))}},e.repaint=function(t){void 0===t&&(t=!1),this.parentRepaint(t)},e.parentRepaint=function(t){void 0===t&&(t=!1),this.parent&&this.parent.repaint(t)},e._setParent=function(t){if(t instanceof laya.html.dom.HTMLElement){var e=t;this.URI||(this.URI=e.URI),this.style&&this.style.inherit(e.style)}},e.appendChild=function(t){return this.addChild(t)},e.addChild=function(t){return t.parent&&t.parent.removeChild(t),this._children||(this._children=[]),this._children.push(t),t.parent=this,t._setParent(this),this.repaint(),t},e.removeChild=function(t){if(!this._children)return null;var e=0,i=0;for(i=this._children.length,e=0;i>e;e++)if(this._children[e]==t)return this._children.splice(e,1),t;return null},e.destroy=function(){this._children&&(this.destroyChildren(),this._children.length=0),Ji.recover(t.getClassName(this),this.reset())},e.destroyChildren=function(){if(this._children){for(var t=this._children.length-1;t>-1;t--)this._children[t].destroy();this._children.length=0}},e._getWords=function(){if(!this._text)return null;var t=this._text.text;if(!t||0===t.length)return null;var e=this._text.words;if(e&&e.length===t.length)return e;null===e&&(this._text.words=e=[]),e.length=t.length;for(var i,n=this.style,s=n.font,r=0,a=t.length;a>r;r++)i=ee.measureText(t.charAt(r),s),e[r]=sn.create().setData(t.charAt(r),i.width,i.height||n.fontSize,n);return e},e._isChar=function(){return!1},e._layoutLater=function(){var t=this.style;512&t._type||(t.widthed(this)&&(this._children&&this._children.length>0||null!=this._getWords())&&t.block?(me.later(this),t._type|=512):this.parent&&this.parent._layoutLater())},e._setAttributes=function(t,e){switch(t){case"style":this.style.cssText(e);break;case"class":this.className=e;break;case"x":this.x=parseFloat(e);break;case"y":this.y=parseFloat(e);break;case"width":this.width=parseFloat(e);break;case"height":this.height=parseFloat(e);break;default:this[t]=e}},e.formatURL=function(e){return this.URI?t.formatURL1(e,this.URI?this.URI.path:null):e},e.drawToGraphic=function(t,e,i,n){e+=this.x,i+=this.y;var s=this.style;s.paddingLeft&&(e+=s.paddingLeft),s.paddingTop&&(i+=s.paddingTop),(null!=s.bgColor||s.borderColor)&&t.drawRect(e,i,this.width,this.height,s.bgColor,s.borderColor,1),this.renderSelfToGraphic(t,e,i,n);var r,a=0,o=0;if(this._children&&this._children.length>0)for(o=this._children.length,a=0;o>a;a++)r=this._children[a],null!=r.drawToGraphic&&r.drawToGraphic(t,e,i,n)},e.renderSelfToGraphic=function(t,e,i,n){var s=this.style,r=this._getWords(),a=0;if(r){a=r.length;if(s){var o=s.font,h=s.color;if(s.stroke){var l=s.stroke;l=parseInt(l);var _=s.strokeColor;t.fillBorderWords(r,e,i,o,h,_,l)}else t.fillWords(r,e,i,o,h);if(this.href){var u=r.length-1,c=r[u],d=c.y+c.height;"none"!=s.textDecoration&&t.drawLine(r[0].x,d,c.x+c.width,d,h,1);var f=$e.create();f.rec.setTo(r[0].x,c.y,c.x+c.width-r[0].x,c.height),f.href=this.href,n.push(f)}}}},r(0,e,"href",function(){return this._style?this._style.href:null},function(t){this._style&&t!=this._style.href&&(this._style.href=t,this.repaint())}),r(0,e,"color",null,function(t){this.style.color=t}),r(0,e,"id",null,function(t){Y.document.setElementById(t,this)}),r(0,e,"innerTEXT",function(){return this._text.text},function(e){this._text===t._EMPTYTEXT?this._text={text:e,words:null}:(this._text.text=e,this._text.words&&(this._text.words.length=0)),this.repaint()}),r(0,e,"style",function(){return this._style}),r(0,e,"width",function(){return this._width},function(t){this._width!==t&&(this._width=t,this.repaint())}),r(0,e,"x",function(){return this._x},function(t){this._x!=t&&(this._x=t,this.parentRepaint())}),r(0,e,"y",function(){return this._y},function(t){this._y!=t&&(this._y=t,this.parentRepaint())}),r(0,e,"height",function(){return this._height},function(t){this._height!==t&&(this._height=t,this.repaint())}),r(0,e,"className",null,function(t){this.style.attrs(Y.document.styleSheets["."+t])}),t.formatURL1=function(t,e){if(!t)return"null path";if(e||(e=Mi.basePath),t.indexOf(":")>0)return t;if(null!=Mi.customFormat&&(t=Mi.customFormat(t)),t.indexOf(":")>0)return t;var i=t.charAt(0);if("."===i)return Mi._formatRelativePath(e+t);if("~"===i)return Mi.rootPath+t.substring(1);if("d"===i){if(0===t.indexOf("data:image"))return t}else if("/"===i)return t;return e+t},t.getClassName=function(t){return"function"==typeof t?t.name:t.constructor.name},t._EMPTYTEXT={text:null,words:null},t}(),H=function(){function t(){this.reset()}s(t,"laya.html.utils.HTMLExtendStyle");var e=t.prototype;return e.reset=function(){return this.stroke=0,this.strokeColor="#000000",this.leading=0,this.lineHeight=0,this.letterSpacing=0,this.href=null,this},e.recover=function(){this!=t.EMPTY&&Ji.recover("HTMLExtendStyle",this.reset())},t.create=function(){return Ji.getItemByClass("HTMLExtendStyle",t)},t.EMPTY=new t,t}(),Y=function(){function t(){this.all=new Array,this.styleSheets=Hi.styleSheets}s(t,"laya.html.dom.HTMLDocument");var e=t.prototype;return e.getElementById=function(t){return this.all[t]},e.setElementById=function(t,e){this.all[t]=e},n(t,["document",function(){return this.document=new t}]),t}(),j=function(){function t(t){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=t;for(var e=0,i=0,n=0;;){if(e=t.indexOf("#begin",e),0>e)break;for(n=e+5;;){if(n=t.indexOf("#end",n),0>n)break;if("i"!==t.charAt(n+4))break;n+=5}if(0>n)throw"add include err,no #end:"+t;i=t.indexOf("\n",e);var s=ce.splitToWords(t.substr(e,i-e),null);"code"==s[1]?this.codes[s[2]]=t.substr(i+1,n-i-1):"function"==s[1]&&(i=t.indexOf("function",e),i+="function".length,this.funs[s[3]]=t.substr(i+1,n-i-1),this.funnames+=s[3]+";"),e=n+1}}s(t,"laya.webgl.utils.InlcudeFile");var e=t.prototype;return e.getWith=function(t){var e=t?this.codes[t]:this.script;if(!e)throw"get with error:"+t;return e},e.getFunsScript=function(t){var e="";for(var i in this.funs)t.indexOf(i+";")>=0&&(e+=this.funs[i]);return e},t}(),Z=(function(){function t(){}return s(t,"laya.Const"),t.NOT_ACTIVE=1,t.ACTIVE_INHIERARCHY=2,t.AWAKED=4,t.NOT_READY=8,t.DISPLAY=16,t.HAS_ZORDER=32,t.HAS_MOUSE=64,t.DISPLAYED_INSTAGE=128,t}(),function(){function t(t,e,i){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=t,this._vb=new Qs(t,35048),e?this._vb._resizeBuffer(e,!1):Ti.webGL2D_MeshAllocMaxMem&&this._vb._resizeBuffer(65536*t,!1),this._ib=new tr,i&&this._ib._resizeBuffer(i,!1)}s(t,"laya.webgl.utils.Mesh2D");var e=t.prototype;return e.cloneWithNewVB=function(){var e=new t(this._stride,0,0);return e._ib=this._ib,e._quadNum=this._quadNum,e._attribInfo=this._attribInfo,e},e.cloneWithNewVBIB=function(){var e=new t(this._stride,0,0);return e._attribInfo=this._attribInfo,e},e.getVBW=function(){return this._vb.setNeedUpload(),this._vb},e.getVBR=function(){return this._vb},e.getIBR=function(){return this._ib},e.getIBW=function(){return this._ib.setNeedUpload(),this._ib},e.createQuadIB=function(t){this._quadNum=t,this._ib._resizeBuffer(6*t*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var e=this._ib.getUint16Array(),i=0,n=0,s=0;t>s;s++)e[i++]=n,e[i++]=n+2,e[i++]=n+1,e[i++]=n,e[i++]=n+3,e[i++]=n+2,n+=4;this._ib.setNeedUpload()},e.setAttributes=function(t){if(this._attribInfo=t,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},e.configVAO=function(t){if(!this._applied){this._applied=!0,this._vao||(this._vao=new wn),this._vao.bind(),this._vb._bindForVAO(),this._ib.setNeedUpload(),this._ib._bind_uploadForVAO();for(var e=this._attribInfo.length/3,i=0,n=0;e>n;n++){var s=this._attribInfo[i+1],r=this._attribInfo[i],a=this._attribInfo[i+2];t.enableVertexAttribArray(n),t.vertexAttribPointer(n,s,r,!1,this._stride,a),i+=3}this._vao.unBind()}},e.useMesh=function(t){this._applied||this.configVAO(t),this._vao.bind(),this._vb.bind(),this._ib._bind_upload()||this._ib.bind(),this._vb._bind_upload()||this._vb.bind()},e.getEleNum=function(){return this._ib.getBuffer().byteLength/2},e.releaseMesh=function(){},e.destroy=function(){},e.clearVB=function(){this._vb.clear()},t._gvaoid=0,t}()),q=function(){function t(){}return s(t,"laya.maths.GrahamScan"),t.multiply=function(t,e,i){return(t.x-i.x)*(e.y-i.y)-(e.x-i.x)*(t.y-i.y)},t.dis=function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)},t._getPoints=function(e,i,n){for(void 0===i&&(i=!1),t._mPointList||(t._mPointList=[]);t._mPointList.length<e;)t._mPointList.push(new $i);return n||(n=[]),n.length=0,i?t.getFrom(n,t._mPointList,e):t.getFromR(n,t._mPointList,e),n},t.getFrom=function(t,e,i){var n=0;for(n=0;i>n;n++)t.push(e[n]);return t},t.getFromR=function(t,e,i){var n=0;for(n=0;i>n;n++)t.push(e.pop());return t},t.pListToPointList=function(e,i){void 0===i&&(i=!1);var n=0,s=e.length/2,r=t._getPoints(s,i,t._tempPointList);for(n=0;s>n;n++)r[n].setTo(e[n+n],e[n+n+1]);return r},t.pointListToPlist=function(e){var i,n=0,s=e.length,r=t._temPList;for(r.length=0,n=0;s>n;n++)i=e[n],r.push(i.x,i.y);return r},t.scanPList=function(e){return ee.copyArray(e,t.pointListToPlist(t.scan(t.pListToPointList(e,!0))))},t.scan=function(e){var i,n,s,r=0,a=0,o=0,h=e.length,l={};for(n=t._temArr,n.length=0,h=e.length,r=h-1;r>=0;r--)i=e[r],s=i.x+"_"+i.y,l.hasOwnProperty(s)||(l[s]=!0,n.push(i));for(h=n.length,ee.copyArray(e,n),r=1;h>r;r++)(e[r].y<e[o].y||e[r].y==e[o].y&&e[r].x<e[o].x)&&(o=r);for(i=e[0],e[0]=e[o],e[o]=i,r=1;h-1>r;r++){for(o=r,a=r+1;h>a;a++)(t.multiply(e[a],e[o],e[0])>0||0==t.multiply(e[a],e[o],e[0])&&t.dis(e[0],e[a])<t.dis(e[0],e[o]))&&(o=a);i=e[r],e[r]=e[o],e[o]=i}if(n=t._temArr,n.length=0,e.length<3)return ee.copyArray(n,e);for(n.push(e[0],e[1],e[2]),r=3;h>r;r++){for(;n.length>=2&&t.multiply(e[r],n[n.length-1],n[n.length-2])>=0;)n.pop();e[r]&&n.push(e[r])}return n},t._mPointList=null,t._tempPointList=[],t._temPList=[],t._temArr=[],t}(),K=function(){function t(e){this.clipInfoID=-1,this._numEle=0,this._ref=1,this._key=new Ze,void 0===e&&(e=1e4),this._renderType=e,this._id=++t.ID}s(t,"laya.webgl.submit.Submit");var e=t.prototype;return i.imps(e,{"laya.webgl.submit.ISubmit":!0}),e.getID=function(){return this._id},e.releaseRender=function(){t.RENDERBASE!=this&&--this._ref<1&&(t.POOL[t._poolSize++]=this,this.shaderValue.release(),this.shaderValue=null,this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))},e.getRenderType=function(){return this._renderType},e.renderSubmit=function(){if(0===this._numEle||!this._mesh||0==this._numEle)return 1;var t=this.shaderValue.textureHost;if(t){var e=t._getSource();if(!e)return 1;this.shaderValue.texture=e}var i=Oi.mainContext;return this._mesh.useMesh(i),this.shaderValue.upload(),fe.activeBlendFunction!==this._blendFn&&(ye.setBlend(i,!0),this._blendFn(i),fe.activeBlendFunction=this._blendFn),i.drawElements(4,this._numEle,5123,this._startIdx),wi.drawCall++,wi.trianglesFaces+=this._numEle/3,1},e._cloneInit=function(t,e,i,n){t._ref=1,t._mesh=i,t._id=this._id,t._key.copyFrom(this._key),t._parent=this,t._blendFn=this._blendFn,t._renderType=this._renderType,t._startIdx=n*Ie.BYTES_PIDX,t._numEle=this._numEle,t.shaderValue=this.shaderValue,this.shaderValue.ref++,this._ref++},e.clone=function(){return null},e.reUse=function(){return 0},e.toString=function(){return"ibindex:"+this._startIdx+" num:"+this._numEle+" key="+this._key},t.__init__=function(){var e=t.RENDERBASE=new t(-1);e.shaderValue=new mi(0,0),e.shaderValue.ALPHA=1,e._ref=4294967295},t.create=function(e,i,n){var s=t._poolSize?t.POOL[--t._poolSize]:new t;s._ref=1,s._mesh=i,s._key.clear(),s._startIdx=i.indexNum*Ie.BYTES_PIDX,s._numEle=0;var r=e._nBlendType;s._blendFn=e._targets?fe.targetFns[r]:fe.fns[r],s.shaderValue=n,s.shaderValue.setValue(e._shader2D);var a=e._shader2D.filters;return a&&s.shaderValue.setFilters(a),s},t.createShape=function(e,i,n,s){var r=t._poolSize?t.POOL[--t._poolSize]:new t;r._mesh=i,r._numEle=n,r._startIdx=2*i.indexNum,r._ref=1,r.shaderValue=s,r.shaderValue.setValue(e._shader2D);var a=e._nBlendType;return r._blendFn=e._targets?fe.targetFns[a]:fe.fns[a],r},t.TYPE_2D=1e4,t.TYPE_CANVAS=10003,t.TYPE_CMDSETRT=10004,t.TYPE_CUSTOM=10005,t.TYPE_BLURRT=10006,t.TYPE_CMDDESTORYPRERT=10007,t.TYPE_DISABLESTENCIL=10008,t.TYPE_OTHERIBVB=10009,t.TYPE_PRIMITIVE=10010,t.TYPE_RT=10011,t.TYPE_BLUR_RT=10012,t.TYPE_TARGET=10013,t.TYPE_CHANGE_VALUE=10014,t.TYPE_SHAPE=10015,t.TYPE_TEXTURE=10016,t.TYPE_FILLTEXTURE=10017,t.KEY_ONCE=-1,t.KEY_FILLRECT=1,t.KEY_DRAWTEXTURE=2,t.KEY_VG=3,t.KEY_TRIANGLES=4,t.RENDERBASE=null,t.ID=1,t.preRender=null,t._poolSize=0,t.POOL=[],t}(),$=function(){function t(){}s(t,"laya.display.cmd.DrawCurvesCmd");var e=t.prototype;return e.recover=function(){this.points=null,this.lineColor=null,Ji.recover("DrawCurvesCmd",this)},e.run=function(t,e,i){t.drawCurves(this.x+e,this.y+i,this.points,this.lineColor,this.lineWidth)},r(0,e,"cmdID",function(){return"DrawCurves"}),t.create=function(e,i,n,s,r){var a=Ji.getItemByClass("DrawCurvesCmd",t);return a.x=e,a.y=i,a.points=n,a.lineColor=s,a.lineWidth=r,a},t.ID="DrawCurves",t}(),J=function(){function t(){}return s(t,"laya.utils.Mouse"),r(1,t,"cursor",function(){return t._style.cursor},function(e){t._style.cursor=e}),t.hide=function(){"none"!=t.cursor&&(t._preCursor=t.cursor,t.cursor="none")},t.show=function(){"none"==t.cursor&&(t.cursor=t._preCursor?t._preCursor:"auto")},t._preCursor=null,n(t,["_style",function(){return this._style=Be.document.body.style}]),t}(),Q=function(){function t(){this._action=null,this._glRender=null}s(t,"laya.filters.Filter");var e=t.prototype;return i.imps(e,{"laya.filters.IFilter":!0}),r(0,e,"type",function(){return-1}),t.BLUR=16,t.COLOR=32,t.GLOW=8,t._filter=null,t._recycleScope=null,t}(),te=function(){function t(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new se}s(t,"laya.events.TouchManager");var e=t.prototype;return e._clearTempArrs=function(){t._oldArr.length=0,t._newArr.length=0,t._tEleArr.length=0},e.getTouchFromArr=function(t,e){var i=0,n=0;n=e.length;var s;for(i=0;n>i;i++)if(s=e[i],s.id==t)return s;return null},e.removeTouchFromArr=function(t,e){var i=0;for(i=e.length-1;i>=0;i--)e[i].id==t&&e.splice(i,1)},e.createTouchO=function(t,e){var i;return i=Ji.getItem("TouchData")||{},i.id=e,i.tar=t,i},e.onMouseDown=function(e,i,n){if(void 0===n&&(n=!1),this.enable){var s,r,a;s=this.getTouchFromArr(i,this.preOvers),a=this.getEles(e,null,t._tEleArr),s?s.tar=e:(r=this.createTouchO(e,i),this.preOvers.push(r)),Be.onMobile&&this.sendEvents(a,"mouseover");var o;o=n?this.preDowns:this.preRightDowns,s=this.getTouchFromArr(i,o),s?s.tar=e:(r=this.createTouchO(e,i),o.push(r)),this.sendEvents(a,n?"mousedown":"rightmousedown"),this._clearTempArrs()}},e.sendEvents=function(t,e){var i=0,n=0;n=t.length,this._event._stoped=!1;var s;s=t[0];var r;for(i=0;n>i;i++){if(r=t[i],r.destroyed)return;if(r.event(e,this._event.setTo(e,r,s)),this._event._stoped)break}},e.getEles=function(t,e,i){for(i?i.length=0:i=[];t&&t!=e;)i.push(t),t=t.parent;return i},e.checkMouseOutAndOverOfMove=function(e,i,n){if(void 0===n&&(n=0),i!=e){var s,r,a=0,o=0;if(i.contains(e))r=this.getEles(e,i,t._tEleArr),this.sendEvents(r,"mouseover");else if(e.contains(i))r=this.getEles(i,e,t._tEleArr),this.sendEvents(r,"mouseout");else{r=t._tEleArr,r.length=0;var h;h=this.getEles(i,null,t._oldArr);var l;l=this.getEles(e,null,t._newArr),o=h.length;var _=0;for(a=0;o>a;a++){if(s=h[a],_=l.indexOf(s),_>=0){l.splice(_,l.length-_);break}r.push(s)}r.length>0&&this.sendEvents(r,"mouseout"),l.length>0&&this.sendEvents(l,"mouseover")}}},e.onMouseMove=function(e,i){if(this.enable){var n;n=this.getTouchFromArr(i,this.preOvers);var s;n?(this.checkMouseOutAndOverOfMove(e,n.tar),n.tar=e,s=this.getEles(e,null,t._tEleArr)):(s=this.getEles(e,null,t._tEleArr),this.sendEvents(s,"mouseover"),this.preOvers.push(this.createTouchO(e,i))),this.sendEvents(s,"mousemove"),this._clearTempArrs()}},e.getLastOvers=function(){return t._tEleArr.length=0,this.preOvers.length>0&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,t._tEleArr):(t._tEleArr.push(i.stage),t._tEleArr)},e.stageMouseOut=function(){var t;t=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(t,"mouseout")},e.onMouseUp=function(e,i,n){if(void 0===n&&(n=!1),this.enable){var s,r,a,o,h,l=0,_=0,u=Be.onMobile;r=this.getEles(e,null,t._tEleArr),this.sendEvents(r,n?"mouseup":"rightmouseup");var c;if(c=n?this.preDowns:this.preRightDowns,s=this.getTouchFromArr(i,c)){var d=!1,f=Be.now();if(d=f-this._lastClickTime<300,this._lastClickTime=f,e==s.tar)h=r;else for(a=this.getEles(s.tar,null,t._oldArr),h=t._newArr,h.length=0,_=a.length,l=0;_>l;l++)o=a[l],r.indexOf(o)>=0&&h.push(o);h.length>0&&this.sendEvents(h,n?"click":"rightclick"),n&&d&&this.sendEvents(h,"doubleclick"),this.removeTouchFromArr(i,c),s.tar=null,Ji.recover("TouchData",s)}else;s=this.getTouchFromArr(i,this.preOvers),s&&u&&(h=this.getEles(s.tar,null,h),h&&h.length>0&&this.sendEvents(h,"mouseout"),this.removeTouchFromArr(i,this.preOvers),s.tar=null,Ji.recover("TouchData",s)),this._clearTempArrs()}},t._oldArr=[],t._newArr=[],t._tEleArr=[],n(t,["I",function(){return this.I=new t}]),t}(),ee=function(){function e(){}return s(e,"laya.utils.Utils"),e.toRadian=function(t){return t*e._pi2},e.toAngle=function(t){return t*e._pi},e.toHexColor=function(t){if(0>t||isNaN(t))return null;for(var e=t.toString(16);e.length<6;)e="0"+e;return"#"+e},e.getGID=function(){return e._gid++},e.concatArray=function(t,e){if(!e)return t;if(!t)return e;var i=0,n=e.length;for(i=0;n>i;i++)t.push(e[i]);return t},e.clearArray=function(t){return t?(t.length=0,t):t},e.copyArray=function(t,e){if(t||(t=[]),!e)return t;t.length=e.length;var i=0,n=e.length;for(i=0;n>i;i++)t[i]=e[i];return t},e.getGlobalRecByPoints=function(t,e,i,n,s){var r;r=$i.create().setTo(e,i),r=t.localToGlobal(r);var a;a=$i.create().setTo(n,s),a=t.localToGlobal(a);var o=He._getWrapRec([r.x,r.y,a.x,a.y]);return r.recover(),a.recover(),o},e.getGlobalPosAndScale=function(t){return e.getGlobalRecByPoints(t,0,0,1,1)},e.bind=function(t,e){var i=t;return i=t.bind(e)},e.measureText=function(t,e){return qi.measureText(t,e)},e.updateOrder=function(t){if(!t||t.length<2)return!1;for(var e,i=1,n=0,s=t.length,r=0/0;s>i;){for(n=i,e=t[n],r=t[n]._zOrder;--n>-1&&t[n]._zOrder>r;)t[n+1]=t[n];t[n+1]=e,i++}return!0},e.transPointList=function(t,e,i){var n=0,s=t.length;for(n=0;s>n;n+=2)t[n]+=e,t[n+1]+=i},e.parseInt=function(t,e){void 0===e&&(e=0);var i=Be.window.parseInt(t,e);return isNaN(i)?0:i},e.getFileExtension=function(t){e._extReg.lastIndex=t.lastIndexOf(".");var i=e._extReg.exec(t);return i&&i.length>1?i[1].toLowerCase():null},e.getTransformRelativeToWindow=function(t,e,n){var s=i.stage,r=laya.utils.Utils.getGlobalPosAndScale(t),a=s._canvasTransform.clone(),o=a.tx,h=a.ty;a.rotate(-Math.PI/180*i.stage.canvasDegree),a.scale(i.stage.clientScaleX,i.stage.clientScaleY);var l=i.stage.canvasDegree%180!=0,_=0/0,u=0/0;l?(_=n+r.y,u=e+r.x,_*=a.d,u*=a.a,90==i.stage.canvasDegree?(_=o-_,u+=h):(_+=o,u=h-u)):(_=e+r.x,u=n+r.y,_*=a.a,u*=a.d,_+=o,u+=h),u+=i.stage._safariOffsetY;var c=0/0,d=0/0;return l?(c=a.d*r.height,d=a.a*r.width):(c=a.a*r.width,d=a.d*r.height),{x:_,y:u,scaleX:c,scaleY:d}},e.fitDOMElementInArea=function(t,n,s,r,a,o){t._fitLayaAirInitialized||(t._fitLayaAirInitialized=!0,t.style.transformOrigin=t.style.webKittransformOrigin="left top",t.style.position="absolute");var h=e.getTransformRelativeToWindow(n,s,r);t.style.transform=t.style.webkitTransform="scale("+h.scaleX+","+h.scaleY+") rotate("+i.stage.canvasDegree+"deg)",t.style.width=a+"px",t.style.height=o+"px",t.style.left=h.x+"px",t.style.top=h.y+"px"},e.isOkTextureList=function(t){if(!t)return!1;var e,i=0,n=t.length;for(i=0;n>i;i++)if(e=t[i],!e||!e._getSource())return!1;return!0},e.isOKCmdList=function(t){if(!t)return!1;var e,i=0,n=t.length;for(i=0;n>i;i++)e=t[i];return!0},e.getQueryString=function(e){if(Be.onMiniGame)return null;var i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=t.location.search.substr(1).match(i);return null!=n?unescape(n[2]):null},e._gid=1,e._pi=180/Math.PI,e._pi2=Math.PI/180,e._extReg=/\.(\w+)\??/g,e.parseXMLFromString=function(t){var e;if(t=t.replace(/>\s+</g,"><"),e=(new DOMParser).parseFromString(t,"text/xml"),e.firstChild.textContent.indexOf("This page contains the following errors")>-1)throw new Error(e.firstChild.firstChild.textContent);return e},e}(),ie=function(){function t(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}s(t,"laya.display.BitmapFont");var e=t.prototype;return e.loadFont=function(t,e){return this._path=t,this._complete=e,t&&-1!==t.indexOf(".fnt")?(i.loader.load([{url:t,type:"xml"},{url:t.replace(".fnt",".png"),type:"image"}],_.create(this,this._onLoaded)),void 0):(console.error('Bitmap font configuration information must be a ".fnt" file'),void 0)},e._onLoaded=function(){this.parseFont(un.getRes(this._path),un.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.run()},e.parseFont=function(t,e){if(null!=t&&null!=e){this._texture=e;var i=1,n=t.getElementsByTagName("info");if(!n[0].getAttributeNode)return this.parseFont2(t,e);this.fontSize=parseInt(n[0].getAttributeNode("size").nodeValue);var s=n[0].getAttributeNode("padding").nodeValue,r=s.split(",");this._padding=[parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];var a;a=t.getElementsByTagName("char");var o=0;for(o=0;o<a.length;o++){var h=a[o],l=parseInt(h.getAttributeNode("id").nodeValue),_=parseInt(h.getAttributeNode("xoffset").nodeValue)/i,u=parseInt(h.getAttributeNode("yoffset").nodeValue)/i,c=parseInt(h.getAttributeNode("xadvance").nodeValue)/i,d=new He;d.x=parseInt(h.getAttributeNode("x").nodeValue),d.y=parseInt(h.getAttributeNode("y").nodeValue),d.width=parseInt(h.getAttributeNode("width").nodeValue),d.height=parseInt(h.getAttributeNode("height").nodeValue);var f=_n.create(e,d.x,d.y,d.width,d.height,_,u);this._maxWidth=Math.max(this._maxWidth,c+this.letterSpacing),this._fontCharDic[l]=f,this._fontWidthMap[l]=c}}},e.parseFont2=function(t,e){if(null!=t&&null!=e){this._texture=e;var i=1,n=t.getElementsByTagName("info");this.fontSize=parseInt(n[0].attributes.size.nodeValue);var s=n[0].attributes.padding.nodeValue,r=s.split(",");this._padding=[parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];var a=t.getElementsByTagName("char"),o=0;for(o=0;o<a.length;o++){var h=a[o].attributes,l=parseInt(h.id.nodeValue),_=parseInt(h.xoffset.nodeValue)/i,u=parseInt(h.yoffset.nodeValue)/i,c=parseInt(h.xadvance.nodeValue)/i,d=new He;d.x=parseInt(h.x.nodeValue),d.y=parseInt(h.y.nodeValue),d.width=parseInt(h.width.nodeValue),d.height=parseInt(h.height.nodeValue);var f=_n.create(e,d.x,d.y,d.width,d.height,_,u);this._maxWidth=Math.max(this._maxWidth,c+this.letterSpacing),this._fontCharDic[l]=f,this._fontWidthMap[l]=c}}},e.getCharTexture=function(t){return this._fontCharDic[t.charCodeAt(0)]},e.destroy=function(){if(this._texture){for(var t in this._fontCharDic){var e=this._fontCharDic[t];e&&e.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null,this._complete=null,this._padding=null}},e.setSpaceWidth=function(t){this._spaceWidth=t},e.getCharWidth=function(t){var e=t.charCodeAt(0);return this._fontWidthMap[e]?this._fontWidthMap[e]+this.letterSpacing:" "===t?this._spaceWidth+this.letterSpacing:0},e.getTextWidth=function(t){for(var e=0,i=0,n=t.length;n>i;i++)e+=this.getCharWidth(t.charAt(i));return e},e.getMaxWidth=function(){return this._maxWidth},e.getMaxHeight=function(){return this.fontSize},e._drawText=function(t,e,i,n,s,r){var a,o=this.getTextWidth(t),h=0;"center"===s&&(h=(r-o)/2),"right"===s&&(h=r-o);
for(var l=0,_=0,u=t.length;u>_;_++)a=this.getCharTexture(t.charAt(_)),a&&(e.graphics.drawImage(a,i+l+h,n),l+=this.getCharWidth(t.charAt(_)))},t}(),ne=function(){function t(){}return s(t,"laya.layagl.ConchCmdReplace"),t.__init__=function(){var t,e=laya.display.cmd,i=laya.layagl.cmdNative;for(t in e)i[t+"Native"]&&(e[t].create=i[t+"Native"].create)},t}(),se=(function(){function t(){this._draw_texture_cmd_encoder_=we.instance.createCommandEncoder(64,32,!0)}s(t,"laya.layagl.cmdNative.FillWordsCmdNative");var e=t.prototype;return e.createFillText=function(e,i,n,s,r,a){var h=o.create(a),l=(h.numColor,{});l._curMat=new fi,l._italicDeg=0,l._drawTextureUseColor=4294967295,l.fillStyle=a,l._fillColor=4294967295,l.setFillColor=function(t){l._fillColor=t},l.getFillColor=function(){return l._fillColor},l.mixRGBandAlpha=function(t){return t},l._drawTextureM=function(t,i,n,s,r,a,o,h){e.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),e.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),e.useVDO(he.VDO_MESHQUADTEXTURE),e.uniformEx(he.GLOBALVALUE_VIEWS,0),e.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),e.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),e.uniformTexture(3,33984,t.bitmap._glTexture);var l=new Float32Array([i,n,h[0],h[1],0,0,i+s,n,h[2],h[3],0,0,i+s,n+r,h[4],h[5],0,0,i,n+r,h[6],h[7],0,0]),_=new Int32Array(l.buffer);_[4]=_[10]=_[16]=_[22]=4294967295,_[5]=_[11]=_[17]=_[23]=4294967295,e.setRectMesh(1,l,l.length),e.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),e.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(e)},t.cbook.filltext_native(l,null,i,n,s,r,a,null,0,null)},e.recover=function(){this._graphicsCmdEncoder=null,this.words=null,Ji.recover("FillWordsCmd",this)},r(0,e,"cmdID",function(){return"FillWords"}),t.create=function(e,i,n,s,r){t.cbook||new Error("Error:charbook not create!");var a=Ji.getItemByClass("FillWordsCmd",t),o=a._graphicsCmdEncoder=this._commandEncoder;return a.words=e,a.x=i,a.y=n,a.font=s,a.color=r,a._draw_texture_cmd_encoder_.clearEncoding(),a.createFillText(a._draw_texture_cmd_encoder_,e,i,n,s,r),we.syncBufferToRenderThread(a._draw_texture_cmd_encoder_),o.useCommandEncoder(a._draw_texture_cmd_encoder_.getPtrID(),-1,-1),we.syncBufferToRenderThread(o),a},t.ID="FillWords",n(t,["cbook",function(){return this.cbook=xe.charbookInst}]),t}(),function(){function t(){}s(t,"laya.events.Event");var e=t.prototype;return e.setTo=function(t,e,i){return this.type=t,this.currentTarget=e,this.target=i,this},e.stopPropagation=function(){this._stoped=!0},r(0,e,"stageY",function(){return i.stage.mouseY}),r(0,e,"charCode",function(){return this.nativeEvent.charCode}),r(0,e,"touches",function(){if(!this.nativeEvent)return null;var t=this.nativeEvent.touches;if(t)for(var e=i.stage,n=0,s=t.length;s>n;n++){var r=t[n],a=$i.TEMP;a.setTo(r.clientX,r.clientY),e._canvasTransform.invertTransformPoint(a),e.transform.invertTransformPoint(a),r.stageX=a.x,r.stageY=a.y}return t}),r(0,e,"keyLocation",function(){return this.nativeEvent.location||this.nativeEvent.keyLocation}),r(0,e,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),r(0,e,"altKey",function(){return this.nativeEvent.altKey}),r(0,e,"shiftKey",function(){return this.nativeEvent.shiftKey}),r(0,e,"stageX",function(){return i.stage.mouseX}),t.EMPTY=new t,t.MOUSE_DOWN="mousedown",t.MOUSE_UP="mouseup",t.CLICK="click",t.RIGHT_MOUSE_DOWN="rightmousedown",t.RIGHT_MOUSE_UP="rightmouseup",t.RIGHT_CLICK="rightclick",t.MOUSE_MOVE="mousemove",t.MOUSE_OVER="mouseover",t.MOUSE_OUT="mouseout",t.MOUSE_WHEEL="mousewheel",t.ROLL_OVER="mouseover",t.ROLL_OUT="mouseout",t.DOUBLE_CLICK="doubleclick",t.CHANGE="change",t.CHANGED="changed",t.RESIZE="resize",t.ADDED="added",t.REMOVED="removed",t.DISPLAY="display",t.UNDISPLAY="undisplay",t.ERROR="error",t.COMPLETE="complete",t.LOADED="loaded",t.READY="ready",t.PROGRESS="progress",t.INPUT="input",t.RENDER="render",t.OPEN="open",t.MESSAGE="message",t.CLOSE="close",t.KEY_DOWN="keydown",t.KEY_PRESS="keypress",t.KEY_UP="keyup",t.FRAME="enterframe",t.DRAG_START="dragstart",t.DRAG_MOVE="dragmove",t.DRAG_END="dragend",t.ENTER="enter",t.SELECT="select",t.BLUR="blur",t.FOCUS="focus",t.VISIBILITY_CHANGE="visibilitychange",t.FOCUS_CHANGE="focuschange",t.PLAYED="played",t.PAUSED="paused",t.STOPPED="stopped",t.START="start",t.END="end",t.COMPONENT_ADDED="componentadded",t.COMPONENT_REMOVED="componentremoved",t.RELEASED="released",t.LINK="link",t.LABEL="label",t.FULL_SCREEN_CHANGE="fullscreenchange",t.DEVICE_LOST="devicelost",t.TRANSFORM_CHANGED="transformchanged",t.ANIMATION_CHANGED="animationchanged",t.TRAIL_FILTER_CHANGE="trailfilterchange",t.TRIGGER_ENTER="triggerenter",t.TRIGGER_STAY="triggerstay",t.TRIGGER_EXIT="triggerexit",t}()),re=function(){function t(){}s(t,"laya.display.cmd.DrawRectCmd");var e=t.prototype;return e.recover=function(){this.fillColor=null,this.lineColor=null,Ji.recover("DrawRectCmd",this)},e.run=function(t,e,i){t.drawRect(this.x+e,this.y+i,this.width,this.height,this.fillColor,this.lineColor,this.lineWidth)},r(0,e,"cmdID",function(){return"DrawRect"}),t.create=function(e,i,n,s,r,a,o){var h=Ji.getItemByClass("DrawRectCmd",t);return h.x=e,h.y=i,h.width=n,h.height=s,h.fillColor=r,h.lineColor=a,h.lineWidth=o,h},t.ID="DrawRect",t}(),ae=function(){function t(t,e,i){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return s(t,"laya.webgl.shapes.EarcutNode"),t}(),oe=function(){function t(){this._matrix=new fi}s(t,"laya.webgl.canvas.save.SaveTransform");var e=t.prototype;return i.imps(e,{"laya.webgl.canvas.save.ISaveData":!0}),e.isSaveMark=function(){return!1},e.restore=function(e){e._curMat=this._savematrix,t.POOL[t.POOL._length++]=this},t.save=function(e){var i=e._saveMark;if(2048!==(2048&i._saveuse)){i._saveuse|=2048;var n=t.POOL,s=n._length>0?n[--n._length]:new t;s._savematrix=e._curMat,e._curMat=e._curMat.copyTo(s._matrix);var r=e._save;r[r._length++]=s}},t.POOL=h._createArray(),t}(),he=function(){function t(){}return s(t,"laya.layagl.LayaNative2D"),t._init_simple_texture_cmdEncoder_=function(){t._SIMPLE_TEXTURE_CMDENCODER_=we.instance.createCommandEncoder(172,32,!0),t._SIMPLE_TEXTURE_CMDENCODER_.useProgramEx(laya.layagl.LayaNative2D.PROGRAMEX_DRAWTEXTURE),t._SIMPLE_TEXTURE_CMDENCODER_.useVDO(laya.layagl.LayaNative2D.VDO_MESHQUADTEXTURE),t._SIMPLE_TEXTURE_CMDENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_VIEWS,0),t._SIMPLE_TEXTURE_CMDENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_CLIP_MAT_DIR,1),t._SIMPLE_TEXTURE_CMDENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_CLIP_MAT_POS,2),t._SIMPLE_TEXTURE_CMDENCODER_.uniformTextureByParamData(0,4,8),t._SIMPLE_TEXTURE_CMDENCODER_.blendFuncByGlobalValue(laya.layagl.LayaNative2D.GLOBALVALUE_BLENDFUNC_SRC,laya.layagl.LayaNative2D.GLOBALVALUE_BLENDFUNC_DEST),t._SIMPLE_TEXTURE_CMDENCODER_.setRectMeshByParamData(12,20,16),t._SIMPLE_TEXTURE_CMDENCODER_.modifyMesh(laya.layagl.LayaNative2D.GLOBALVALUE_MATRIX32,0,7),t._SIMPLE_TEXTURE_CMDENCODER_.modifyMesh(laya.layagl.LayaNative2D.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._SIMPLE_TEXTURE_CMDENCODER_)},t._init_simple_rect_cmdEncoder_=function(){t._SIMPLE_RECT_CMDENCODER_=we.instance.createCommandEncoder(136,32,!0),t._SIMPLE_RECT_CMDENCODER_.useProgramEx(laya.layagl.LayaNative2D.PROGRAMEX_DRAWTEXTURE),t._SIMPLE_RECT_CMDENCODER_.useVDO(laya.layagl.LayaNative2D.VDO_MESHQUADTEXTURE),t._SIMPLE_RECT_CMDENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_VIEWS,0),t._SIMPLE_RECT_CMDENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_CLIP_MAT_DIR,1),t._SIMPLE_RECT_CMDENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_CLIP_MAT_POS,2),t._SIMPLE_RECT_CMDENCODER_.setRectMeshByParamData(0,8,4),t._SIMPLE_RECT_CMDENCODER_.modifyMesh(laya.layagl.LayaNative2D.GLOBALVALUE_MATRIX32,0,7),t._SIMPLE_RECT_CMDENCODER_.modifyMesh(laya.layagl.LayaNative2D.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._SIMPLE_RECT_CMDENCODER_)},t._init_rect_border_cmdEncoder_=function(){t._RECT_BORDER_CMD_ENCODER_=we.instance.createCommandEncoder(152,32,!0),t._RECT_BORDER_CMD_ENCODER_.useProgramEx(laya.layagl.LayaNative2D.PROGRAMEX_DRAWVG),t._RECT_BORDER_CMD_ENCODER_.useVDO(laya.layagl.LayaNative2D.VDO_MESHVG),t._RECT_BORDER_CMD_ENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_VIEWS,0),t._RECT_BORDER_CMD_ENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_CLIP_MAT_DIR,1),t._RECT_BORDER_CMD_ENCODER_.uniformEx(laya.layagl.LayaNative2D.GLOBALVALUE_CLIP_MAT_POS,2),t._RECT_BORDER_CMD_ENCODER_.setMeshByParamData(20,0,4,140,8,12,16),t._RECT_BORDER_CMD_ENCODER_.modifyMesh(laya.layagl.LayaNative2D.GLOBALVALUE_MATRIX32,0,7),t._RECT_BORDER_CMD_ENCODER_.modifyMesh(laya.layagl.LayaNative2D.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._RECT_BORDER_CMD_ENCODER_)},t.__init__=function(){if(Ni.isConchApp){var e=we.instance;t.GLOBALVALUE_MATRIX32=e.addGlobalValueDefine(0,5126,6,new Float32Array([1,0,0,1,0,0])),t.GLOBALVALUE_DRAWTEXTURE_COLOR=e.addGlobalValueDefine(0,5124,1,new Uint32Array([4294967295])),t.GLOBALVALUE_ITALICDEG=e.addGlobalValueDefine(0,5126,1,new Float32Array([0])),t.GLOBALVALUE_CLIP_MAT_DIR=e.addGlobalValueDefine(0,5126,4,new Float32Array([1e6,0,0,1e6])),t.GLOBALVALUE_CLIP_MAT_POS=e.addGlobalValueDefine(0,5126,2,new Float32Array([0,0])),t.GLOBALVALUE_BLENDFUNC_SRC=e.addGlobalValueDefine(0,5124,1,new Int32Array([1])),t.GLOBALVALUE_BLENDFUNC_DEST=e.addGlobalValueDefine(0,5124,1,new Int32Array([771])),t.GLOBALVALUE_COLORFILTER_COLOR=e.addGlobalValueDefine(0,5126,16,new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])),t.GLOBALVALUE_COLORFILTER_ALPHA=e.addGlobalValueDefine(0,5126,4,new Float32Array([0,0,0,1])),t.GLOBALVALUE_BLURFILTER_STRENGTH=e.addGlobalValueDefine(0,5126,4,new Float32Array([0,0,0,0])),t.GLOBALVALUE_BLURFILTER_BLURINFO=e.addGlobalValueDefine(0,5126,2,new Float32Array([0,0])),t.GLOBALVALUE_GLOWFILTER_COLOR=e.addGlobalValueDefine(0,5126,4,new Float32Array([0,0,0,0])),t.GLOBALVALUE_GLOWFILTER_BLURINFO1=e.addGlobalValueDefine(0,5126,4,new Float32Array([0,0,0,0])),t.GLOBALVALUE_GLOWFILTER_BLURINFO2=e.addGlobalValueDefine(0,5126,4,new Float32Array([0,0,0,0])),e.endGlobalValueDefine(),t.PROGRAMEX_DRAWTEXTURE=we.instance.createProgramEx("/*\n	texture和fillrect使用的。\n*/\nattribute vec4 posuv;\nattribute vec4 attribColor;\nattribute vec4 attribFlags;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;		// 这个是全局的，不用再应用矩阵了。\nvarying vec2 cliped;\nuniform vec2 size;\n\n#ifdef WORLDMAT\n	uniform mat4 mmat;\n#endif\n\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\n\nvoid main() {\n\n	vec4 pos = vec4(posuv.xy,0.,1.);\n#ifdef WORLDMAT\n	pos=mmat*pos;\n#endif\n	gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\n  \n	v_texcoordAlpha.xy = posuv.zw;\n	//v_texcoordAlpha.z = attribColor.a/255.0;\n	v_color = attribColor/255.0;\n	v_color.xyz*=v_color.w;//反正后面也要预乘\n	\n	v_useTex = attribFlags.r/255.0;\n	float clipw = length(clipMatDir.xy);\n	float cliph = length(clipMatDir.zw);\n	vec2 clippos = pos.xy - clipMatPos.xy;	//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n	if(clipw>20000. && cliph>20000.)\n		cliped = vec2(0.5,0.5);\n	else {\n		//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\n		cliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n	}\n\n}","/*\n	texture和fillrect使用的。\n*/\n\nprecision mediump float;\n//precision highp float;\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\nuniform sampler2D texture;\nvarying vec2 cliped;\n\n#ifdef BLUR_FILTER\nuniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}\n#endif\n\n#ifdef COLOR_FILTER\nuniform vec4 colorAlpha;\nuniform mat4 colorMat;\n#endif\n\n#ifdef GLOW_FILTER\nuniform vec4 u_color;\nuniform vec4 u_blurInfo1;\nuniform vec4 u_blurInfo2;\n#endif\n\n#ifdef COLOR_ADD\nuniform vec4 colorAdd;\n#endif\n\n//FILLTEXTURE\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\n\nvoid main() {\n	if(cliped.x<0.) discard;\n	if(cliped.x>1.) discard;\n	if(cliped.y<0.) discard;\n	if(cliped.y>1.) discard;\n	\n#ifdef FILLTEXTURE	\n   vec4 color= texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\n#else\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\n#endif\n\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\n   color.a*=v_color.w;\n   //color.rgb*=v_color.w;\n   color.rgb*=v_color.rgb;\n   gl_FragColor=color;\n   \n   #ifdef COLOR_ADD\n	gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\n	gl_FragColor.xyz *= colorAdd.a;\n   #endif\n   \n   #ifdef BLUR_FILTER\n	gl_FragColor =   blur();\n	gl_FragColor.w*=v_color.w;   \n   #endif\n   \n   #ifdef COLOR_FILTER\n	mat4 alphaMat =colorMat;\n\n	alphaMat[0][3] *= gl_FragColor.a;\n	alphaMat[1][3] *= gl_FragColor.a;\n	alphaMat[2][3] *= gl_FragColor.a;\n\n	gl_FragColor = gl_FragColor * alphaMat;\n	gl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n   #endif\n   \n   #ifdef GLOW_FILTER\n	const float c_IterationTime = 10.0;\n	float floatIterationTotalTime = c_IterationTime * c_IterationTime;\n	vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n	vec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\n	vec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\n	float maxNum = u_blurInfo1.x * u_blurInfo1.y;\n	vec2 vec2Off = vec2(0.0,0.0);\n	float floatOff = c_IterationTime/2.0;\n	for(float i = 0.0;i<=c_IterationTime; ++i){\n		for(float j = 0.0;j<=c_IterationTime; ++j){\n			vec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n			vec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\n		}\n	}\n	gl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\n	gl_FragColor.rgb *= gl_FragColor.a;   \n   #endif\n   \n}","posuv,attribColor,attribFlags","size,clipMatDir,clipMatPos,texture,colorMat,colorAlpha,strength_sig2_2sig2_gauss1,blurInfo,u_color,u_blurInfo1,u_blurInfo2"),t.PROGRAMEX_DRAWVG=we.instance.createProgramEx("attribute vec4 position;\nattribute vec4 attribColor;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\n#ifdef WORLDMAT\n	uniform mat4 mmat;\n#endif\nuniform mat4 u_mmat2;\n//uniform vec2 u_pos;\nuniform vec2 size;\nvarying vec4 color;\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\n//vec4 clip=vec4(100.,30.,300.,600.);\nvarying vec2 cliped;\nvoid main(){\n	\n#ifdef WORLDMAT\n	vec4 pos=mmat*vec4(position.xy,0.,1.);\n	gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n#else\n	gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n#endif	\n	float clipw = length(clipMatDir.xy);\n	float cliph = length(clipMatDir.zw);\n	vec2 clippos = position.xy - clipMatPos.xy;	//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n	if(clipw>20000. && cliph>20000.)\n		cliped = vec2(0.5,0.5);\n	else {\n		//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\n		cliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n	}\n  //pos2d.x = dot(clippos,dirx);\n  color=attribColor/255.;\n}","precision mediump float;\n//precision mediump float;\nvarying vec4 color;\n//uniform float alpha;\nvarying vec2 cliped;\nvoid main(){\n	//vec4 a=vec4(color.r, color.g, color.b, 1);\n	//a.a*=alpha;\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\n	gl_FragColor.rgb*=color.a;\n	if(cliped.x<0.) discard;\n	if(cliped.x>1.) discard;\n	if(cliped.y<0.) discard;\n	if(cliped.y>1.) discard;\n}","position,attribColor","size,clipMatDir,clipMatPos"),t.PROGRAMEX_DRAWPARTICLE=we.instance.createProgramEx("attribute vec4 a_CornerTextureCoordinate;\nattribute vec3 a_Position;\nattribute vec3 a_Velocity;\nattribute vec4 a_StartColor;\nattribute vec4 a_EndColor;\nattribute vec3 a_SizeRotation;\nattribute vec2 a_Radius;\nattribute vec4 a_Radian;\nattribute float a_AgeAddScale;\nattribute float a_Time;\n\nvarying vec4 v_Color;\nvarying vec2 v_TextureCoordinate;\n\nuniform float u_CurrentTime;\nuniform float u_Duration;\nuniform float u_EndVelocity;\nuniform vec3 u_Gravity;\n\nuniform vec2 size;\nuniform mat4 u_mmat;\n\nvec4 ComputeParticlePosition(in vec3 position, in vec3 velocity,in float age,in float normalizedAge)\n{\n\n   float startVelocity = length(velocity);//起始标量速度\n   float endVelocity = startVelocity * u_EndVelocity;//结束标量速度\n\n   float velocityIntegral = startVelocity * normalizedAge +(endVelocity - startVelocity) * normalizedAge *normalizedAge/2.0;//计算当前速度的标量（单位空间），vt=v0*t+(1/2)*a*(t^2)\n   \n   vec3 addPosition = normalize(velocity) * velocityIntegral * u_Duration;//计算受自身速度影响的位置，转换标量到矢量    \n   addPosition += u_Gravity * age * normalizedAge;//计算受重力影响的位置\n   \n   float radius=mix(a_Radius.x, a_Radius.y, normalizedAge); //计算粒子受半径和角度影响（无需计算角度和半径时，可用宏定义优化屏蔽此计算）\n   float radianHorizontal =mix(a_Radian.x,a_Radian.z,normalizedAge);\n   float radianVertical =mix(a_Radian.y,a_Radian.w,normalizedAge);\n   \n   float r =cos(radianVertical)* radius;\n   addPosition.y += sin(radianVertical) * radius;\n	\n   addPosition.x += cos(radianHorizontal) *r;\n   addPosition.z += sin(radianHorizontal) *r;\n  \n   addPosition.y=-addPosition.y;//2D粒子位置更新需要取负，2D粒子坐标系Y轴正向朝上\n   position+=addPosition;\n   return  vec4(position,1.0);\n}\n\nfloat ComputeParticleSize(in float startSize,in float endSize, in float normalizedAge)\n{    \n    float size = mix(startSize, endSize, normalizedAge);\n    return size;\n}\n\nmat2 ComputeParticleRotation(in float rot,in float age)\n{    \n    float rotation =rot * age;\n    //计算2x2旋转矩阵.\n    float c = cos(rotation);\n    float s = sin(rotation);\n    return mat2(c, -s, s, c);\n}\n\nvec4 ComputeParticleColor(in vec4 startColor,in vec4 endColor,in float normalizedAge)\n{\n	vec4 color=mix(startColor,endColor,normalizedAge);\n    //硬编码设置，使粒子淡入很快，淡出很慢,6.7的缩放因子把置归一在0到1之间，可以谷歌x*(1-x)*(1-x)*6.7的制图表\n    color.a *= normalizedAge * (1.0-normalizedAge) * (1.0-normalizedAge) * 6.7;\n   \n    return color;\n}\n\nvoid main()\n{\n   float age = u_CurrentTime - a_Time;\n   age *= 1.0 + a_AgeAddScale;\n   float normalizedAge = clamp(age / u_Duration,0.0,1.0);\n   gl_Position = ComputeParticlePosition(a_Position, a_Velocity, age, normalizedAge);//计算粒子位置\n   float pSize = ComputeParticleSize(a_SizeRotation.x,a_SizeRotation.y, normalizedAge);\n   mat2 rotation = ComputeParticleRotation(a_SizeRotation.z, age);\n	\n    mat4 mat=u_mmat;\n    gl_Position=vec4((mat*gl_Position).xy,0.0,1.0);\n    gl_Position.xy += (rotation*a_CornerTextureCoordinate.xy) * pSize*vec2(mat[0][0],mat[1][1]);\n    gl_Position=vec4((gl_Position.x/size.x-0.5)*2.0,(0.5-gl_Position.y/size.y)*2.0,0.0,1.0);\n   \n   v_Color = ComputeParticleColor(a_StartColor,a_EndColor, normalizedAge);\n   v_TextureCoordinate =a_CornerTextureCoordinate.zw;\n}\n\n","#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec4 v_Color;\nvarying vec2 v_TextureCoordinate;\nuniform sampler2D u_texture;\n\nvoid main()\n{	\n	gl_FragColor=texture2D(u_texture,v_TextureCoordinate)*v_Color;\n	gl_FragColor.xyz *= v_Color.w;\n}","a_CornerTextureCoordinate,a_Position,a_Velocity,a_StartColor,a_EndColor,a_SizeRotation,a_Radius,a_Radian,a_AgeAddScale,a_Time","u_CurrentTime,u_Duration,u_EndVelocity,u_Gravity,size,u_mmat,u_texture"),t.VDO_MESHQUADTEXTURE=e.createVDO(new Int32Array([5126,0,4,24,5121,16,4,24,5121,20,4,24])),t.VDO_MESHVG=e.createVDO(new Int32Array([5126,0,2,12,5121,8,4,12])),t.VDO_MESHPARTICLE=e.createVDO(new Int32Array([5126,0,4,116,5126,16,3,116,5126,28,3,116,5126,40,4,116,5126,56,4,116,5126,72,3,116,5126,84,2,116,5126,92,4,116,5126,108,1,116,5126,112,1,116])),t._init_simple_texture_cmdEncoder_(),t._init_simple_rect_cmdEncoder_(),t._init_rect_border_cmdEncoder_(),t.SHADER_MACRO_COLOR_FILTER=we.instance.defineShaderMacro("#define COLOR_FILTER",[{uname:4,id:t.GLOBALVALUE_COLORFILTER_COLOR},{uname:5,id:t.GLOBALVALUE_COLORFILTER_ALPHA}]),t.SHADER_MACRO_BLUR_FILTER=we.instance.defineShaderMacro("#define BLUR_FILTER",[{uname:6,id:t.GLOBALVALUE_BLURFILTER_STRENGTH},{uname:7,id:t.GLOBALVALUE_BLURFILTER_BLURINFO}]),t.SHADER_MACRO_GLOW_FILTER=we.instance.defineShaderMacro("#define GLOW_FILTER",[{uname:8,id:t.GLOBALVALUE_GLOWFILTER_COLOR},{uname:9,id:t.GLOBALVALUE_GLOWFILTER_BLURINFO1},{uname:10,id:t.GLOBALVALUE_GLOWFILTER_BLURINFO2}]),bi.__init__(),bi.__init_END_(),new xe,Ue.charRender=new Pn}},t._SIMPLE_TEXTURE_CMDENCODER_=null,t._SIMPLE_RECT_CMDENCODER_=null,t._RECT_BORDER_CMD_ENCODER_=null,t.PROGRAMEX_DRAWTEXTURE=0,t.PROGRAMEX_DRAWVG=0,t.PROGRAMEX_DRAWRECT=0,t.PROGRAMEX_DRAWPARTICLE=0,t.VDO_MESHQUADTEXTURE=0,t.VDO_MESHVG=0,t.VDO_MESHPARTICLE=0,t.GLOBALVALUE_VIEWS=0,t.GLOBALVALUE_MATRIX32=0,t.GLOBALVALUE_DRAWTEXTURE_COLOR=0,t.GLOBALVALUE_ITALICDEG=0,t.GLOBALVALUE_CLIP_MAT_DIR=0,t.GLOBALVALUE_CLIP_MAT_POS=0,t.GLOBALVALUE_BLENDFUNC_SRC=0,t.GLOBALVALUE_BLENDFUNC_DEST=0,t.GLOBALVALUE_COLORFILTER_COLOR=0,t.GLOBALVALUE_COLORFILTER_ALPHA=0,t.GLOBALVALUE_BLURFILTER_STRENGTH=0,t.GLOBALVALUE_BLURFILTER_BLURINFO=0,t.SHADER_MACRO_COLOR_FILTER=0,t.SHADER_MACRO_BLUR_FILTER=0,t.SHADER_MACRO_GLOW_FILTER=0,t.GLOBALVALUE_GLOWFILTER_COLOR=0,t.GLOBALVALUE_GLOWFILTER_BLURINFO1=0,t.GLOBALVALUE_GLOWFILTER_BLURINFO2=0,t}(),le=function(){function t(){this.reset()}s(t,"laya.display.css.SpriteStyle");var e=t.prototype;return e.reset=function(){return this.scaleX=this.scaleY=1,this.skewX=this.skewY=0,this.pivotX=this.pivotY=this.rotation=0,this.alpha=1,this.scrollRect&&this.scrollRect.recover(),this.scrollRect=null,this.viewport&&this.viewport.recover(),this.viewport=null,this.hitArea=null,this.dragging=null,this.blendMode=null,this},e.recover=function(){this!==t.EMPTY&&Ji.recover("SpriteStyle",this.reset())},t.create=function(){return Ji.getItemByClass("SpriteStyle",t)},t.EMPTY=new t,t}(),_e=(function(){function t(){this._graphicsCmdEncoder=null}s(t,"laya.layagl.cmdNative.RestoreCmdNative");var e=t.prototype;return e.recover=function(){Ji.recover("RestoreCmd",this)},r(0,e,"cmdID",function(){return"Restore"}),t.create=function(){var e=Ji.getItemByClass("RestoreCmd",t),i=e._graphicsCmdEncoder=this._commandEncoder;return i.restore(),we.syncBufferToRenderThread(i),e},t.ID="Restore",t}(),function(){function t(){}return s(t,"laya.utils.Log"),t.enable=function(){t._logdiv||(t._logdiv=Be.createElement("div"),t._logdiv.style.cssText="border:white;padding:4px;overflow-y:auto;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;",Be.document.body.appendChild(t._logdiv),t._btn=Be.createElement("button"),t._btn.innerText="Hide",t._btn.style.cssText="z-index:1000001;position: absolute;left:10px;top:10px;",t._btn.onclick=t.toggle,Be.document.body.appendChild(t._btn))},t.toggle=function(){var e=t._logdiv.style;""===e.display?(t._btn.innerText="Show",e.display="none"):(t._btn.innerText="Hide",e.display="")},t.print=function(e){t._logdiv&&(t._count>=t.maxCount&&t.clear(),t._count++,t._logdiv.innerText+=e+"\n",t.autoScrollToBottom&&t._logdiv.scrollHeight-t._logdiv.scrollTop-t._logdiv.clientHeight<50&&(t._logdiv.scrollTop=t._logdiv.scrollHeight))},t.clear=function(){t._logdiv.innerText="",t._count=0},t._logdiv=null,t._btn=null,t._count=0,t.maxCount=50,t.autoScrollToBottom=!0,t}(),function(){function t(){this._draw_texture_cmd_encoder_=we.instance.createCommandEncoder(64,32,!0)}s(t,"laya.layagl.cmdNative.FillBorderWordsCmdNative");var e=t.prototype;return e.createFillBorderText=function(e,i,n,s,r,a,h,l){var _=o.create(a),u=(_.numColor,{});u._curMat=new fi,u._italicDeg=0,u._drawTextureUseColor=4294967295,u.fillStyle=a,u._fillColor=4294967295,u.setFillColor=function(t){u._fillColor=t},u.getFillColor=function(){return u._fillColor},u.mixRGBandAlpha=function(t){return t},u._drawTextureM=function(t,i,n,s,r,a,o,h){e.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),e.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),e.useVDO(he.VDO_MESHQUADTEXTURE),e.uniformEx(he.GLOBALVALUE_VIEWS,0),e.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),e.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),e.uniformTexture(3,33984,t.bitmap._glTexture);var l=new Float32Array([i,n,h[0],h[1],0,0,i+s,n,h[2],h[3],0,0,i+s,n+r,h[4],h[5],0,0,i,n+r,h[6],h[7],0,0]),_=new Int32Array(l.buffer);_[4]=_[10]=_[16]=_[22]=4294967295,_[5]=_[11]=_[17]=_[23]=4294967295,e.setRectMesh(1,l,l.length),e.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),e.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(e)},t.cbook.filltext_native(u,null,i,n,s,r,a,h,l,null,0)},e.recover=function(){this._graphicsCmdEncoder=null,this.words=null,Ji.recover("FillBorderWordsCmd",this)},r(0,e,"cmdID",function(){return"FillBorderWords"}),t.create=function(e,i,n,s,r,a,o){t.cbook||new Error("Error:charbook not create!");var h=Ji.getItemByClass("FillBorderWordsCmd",t),l=h._graphicsCmdEncoder=this._commandEncoder;return h.words=e,h.x=i,h.y=n,h.font=s,h.color=r,h.strokeColor=a,h.strokeWidth=o,h._draw_texture_cmd_encoder_.clearEncoding(),h.createFillBorderText(h._draw_texture_cmd_encoder_,e,i,n,s,r,a,o),we.syncBufferToRenderThread(h._draw_texture_cmd_encoder_),l.useCommandEncoder(h._draw_texture_cmd_encoder_.getPtrID(),-1,-1),we.syncBufferToRenderThread(l),h},t.ID="FillBorderWords",n(t,["cbook",function(){return this.cbook=xe.charbookInst}]),t}(),function(){function t(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new se,this._matrix=new fi,this._point=new $i,this._rect=new He,this._prePoint=new $i,this._curTouchID=0/0}s(t,"laya.events.MouseManager");var e=t.prototype;return e.__init__=function(e,i){var n=this;this._stage=e;var s=this;i.oncontextmenu=function(){return t.enabled?!1:void 0},i.addEventListener("mousedown",function(e){t.enabled&&(Be.onIE||e.preventDefault(),s.mouseDownTime=Be.now(),n.runEvent(e))}),i.addEventListener("mouseup",function(e){t.enabled&&(e.preventDefault(),s.mouseDownTime=-Be.now(),n.runEvent(e))},!0),i.addEventListener("mousemove",function(e){if(t.enabled){e.preventDefault();var i=Be.now();if(i-s._lastMoveTimer<10)return;s._lastMoveTimer=i,n.runEvent(e)}},!0),i.addEventListener("mouseout",function(e){t.enabled&&n.runEvent(e)}),i.addEventListener("mouseover",function(e){t.enabled&&n.runEvent(e)}),i.addEventListener("touchstart",function(e){t.enabled&&(t._isFirstTouch||Ws.isInputting||e.preventDefault(),s.mouseDownTime=Be.now(),n.runEvent(e))}),i.addEventListener("touchend",function(e){t.enabled?(t._isFirstTouch||Ws.isInputting||e.preventDefault(),t._isFirstTouch=!1,s.mouseDownTime=-Be.now(),n.runEvent(e)):n._curTouchID=0/0},!0),i.addEventListener("touchmove",function(e){t.enabled&&(e.preventDefault(),n.runEvent(e))},!0),i.addEventListener("touchcancel",function(e){t.enabled?(e.preventDefault(),n.runEvent(e)):n._curTouchID=0/0},!0),i.addEventListener("mousewheel",function(e){t.enabled&&n.runEvent(e)}),i.addEventListener("DOMMouseScroll",function(e){t.enabled&&n.runEvent(e)})},e.initEvent=function(t,e){var i=this;i._event._stoped=!1,i._event.nativeEvent=e||t,i._target=null,this._point.setTo(t.pageX||t.clientX,t.pageY||t.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),i.mouseX=this._point.x,i.mouseY=this._point.y,i._event.touchId=t.identifier||0,this._tTouchID=i._event.touchId;var n;n=te.I._event,n._stoped=!1,n.nativeEvent=i._event.nativeEvent,n.touchId=i._event.touchId},e.checkMouseWheel=function(t){this._event.delta=t.wheelDelta?.025*t.wheelDelta:-t.detail;for(var e=te.I.getLastOvers(),i=0,n=e.length;n>i;i++){var s=e[i];s.event("mousewheel",this._event.setTo("mousewheel",s,this._target))}},e.onMouseMove=function(t){te.I.onMouseMove(t,this._tTouchID)},e.onMouseDown=function(t){if(Ws.isInputting&&i.stage.focus&&i.stage.focus.focus&&!i.stage.focus.contains(this._target)){var e=i.stage.focus._tf||i.stage.focus,n=t._tf||t;n instanceof laya.display.Input&&n.multiline==e.multiline?e._focusOut():e.focus=!1}te.I.onMouseDown(t,this._tTouchID,this._isLeftMouse)},e.onMouseUp=function(t){te.I.onMouseUp(t,this._tTouchID,this._isLeftMouse)},e.check=function(t,e,i,n){this._point.setTo(e,i),t.fromParentPoint(this._point),e=this._point.x,i=this._point.y;var s=t._style.scrollRect;if(s&&(this._rect.setTo(s.x,s.y,s.width,s.height),!this._rect.contains(e,i)))return!1;if(!this.disableMouseEvent){if(t.hitTestPrior&&!t.mouseThrough&&!this.hitTest(t,e,i))return!1;for(var r=t._children.length-1;r>-1;r--){var a=t._children[r];if(null!=a&&!a.destroyed&&a._mouseState>1&&a._visible&&this.check(a,e,i,n))return!0}}var o=!t.hitTestPrior||t.mouseThrough||this.disableMouseEvent?this.hitTest(t,e,i):!0;return o?(this._target=t,n.call(this,t)):n===this.onMouseUp&&t===this._stage&&(this._target=this._stage,n.call(this,this._target)),o},e.hitTest=function(t,e,i){var n=!1;t.scrollRect&&(e-=t._style.scrollRect.x,i-=t._style.scrollRect.y);var s=t._style.hitArea;return s&&s._hit?s.contains(e,i):((t.width>0&&t.height>0||t.mouseThrough||s)&&(n=t.mouseThrough?t.getGraphicBounds().contains(e,i):(s?s:this._rect.setTo(0,0,t.width,t.height)).contains(e,i)),n)},e.runEvent=function(e){var i,n=this,s=0,r=0;switch("mousemove"!==e.type&&(this._prePoint.x=this._prePoint.y=-1e6),e.type){case"mousedown":this._touchIDs[0]=this._id++,t._isTouchRespond?t._isTouchRespond=!1:(n._isLeftMouse=0===e.button,n.initEvent(e),n.check(n._stage,n.mouseX,n.mouseY,n.onMouseDown));break;case"mouseup":n._isLeftMouse=0===e.button,n.initEvent(e),n.check(n._stage,n.mouseX,n.mouseY,n.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-e.clientX)+Math.abs(this._prePoint.y-e.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=e.clientX,this._prePoint.y=e.clientY,n.initEvent(e),n.check(n._stage,n.mouseX,n.mouseY,n.onMouseMove));break;case"touchstart":t._isTouchRespond=!0,n._isLeftMouse=!0;var a=e.changedTouches;for(s=0,r=a.length;r>s;s++)i=a[s],(t.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=i.identifier,this._id%200===0&&(this._touchIDs={}),this._touchIDs[i.identifier]=this._id++,n.initEvent(i,e),n.check(n._stage,n.mouseX,n.mouseY,n.onMouseDown));break;case"touchend":case"touchcancel":t._isTouchRespond=!0,n._isLeftMouse=!0;var o=e.changedTouches;for(s=0,r=o.length;r>s;s++)if(i=o[s],t.multiTouchEnabled||i.identifier==this._curTouchID){this._curTouchID=0/0,n.initEvent(i,e);var h=!1;h=n.check(n._stage,n.mouseX,n.mouseY,n.onMouseUp),h||n.onMouseUp(null)}break;case"touchmove":var l=e.changedTouches;for(s=0,r=l.length;r>s;s++)i=l[s],(t.multiTouchEnabled||i.identifier==this._curTouchID)&&(n.initEvent(i,e),n.check(n._stage,n.mouseX,n.mouseY,n.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":n.checkMouseWheel(e);break;case"mouseout":te.I.stageMouseOut();break;case"mouseover":n._stage.event("mouseover",n._event.setTo("mouseover",n._stage,n._stage))}},t.enabled=!0,t.multiTouchEnabled=!0,t._isTouchRespond=!1,t._isFirstTouch=!0,n(t,["instance",function(){return this.instance=new t
}]),t}()),ue=function(){function t(){}s(t,"laya.display.cmd.DrawLineCmd");var e=t.prototype;return e.recover=function(){Ji.recover("DrawLineCmd",this)},e.run=function(t,e,i){t._drawLine(e,i,this.fromX,this.fromY,this.toX,this.toY,this.lineColor,this.lineWidth,this.vid)},r(0,e,"cmdID",function(){return"DrawLine"}),t.create=function(e,i,n,s,r,a,o){var h=Ji.getItemByClass("DrawLineCmd",t);return h.fromX=e,h.fromY=i,h.toX=n,h.toY=s,h.lineColor=r,h.lineWidth=a,h.vid=o,h},t.ID="DrawLine",t}(),ce=function(){function t(t,e,i,n){function s(t){var e=[],i=new Ki(e);return r._compileToTree(i,t.split("\n"),0,e,n),i}var r=this,a=Be.now();this._VS=s(t),this._PS=s(e),this._nameMap=i,Be.now()-a>2&&console.log("ShaderCompile use time:"+(Be.now()-a)+"  size:"+t.length+"/"+e.length)}s(t,"laya.webgl.utils.ShaderCompile");var e=t.prototype;return e._compileToTree=function(e,i,n,s,r){var a,o,h,l,_,u,c,d=0,f=0,p=0,m=0;for(f=n;f<i.length;f++)if(h=i[f],!(h.length<1)&&(d=h.indexOf("//"),0!==d)){if(d>=0&&(h=h.substr(0,d)),a=c||new Ki(s),c=null,a.text=h,a.noCompile=!0,(d=h.indexOf("#"))>=0){for(l="#",m=d+1,p=h.length;p>m;m++){var g=h.charAt(m);if(" "===g||"	"===g||"?"===g)break;l+=g}switch(a.name=l,l){case"#ifdef":case"#ifndef":if(a.src=h,a.noCompile=null!=h.match(/[!&|()=<>]/),a.noCompile?console.log("function():Boolean{return "+h.substr(d+a.name.length)+"}"):(u=h.replace(/^\s*/,"").split(/\s+/),a.setCondition(u[1],"#ifdef"===l?1:2),a.text="//"+a.text),a.setParent(e),e=a,r)for(u=h.substr(m).split(t._splitToWordExps3),m=0;m<u.length;m++)h=u[m],h.length&&(r[h]=!0);continue;case"#if":if(a.src=h,a.noCompile=!0,a.setParent(e),e=a,r)for(u=h.substr(m).split(t._splitToWordExps3),m=0;m<u.length;m++)h=u[m],h.length&&"defined"!=h&&(r[h]=!0);continue;case"#else":a.src=h,e=e.parent,o=e.childs[e.childs.length-1],a.noCompile=o.noCompile,a.noCompile||(a.condition=o.condition,a.conditionType=1==o.conditionType?2:1,a.text="//"+a.text+" "+o.text+" "+a.conditionType),a.setParent(e),e=a;continue;case"#endif":e=e.parent,o=e.childs[e.childs.length-1],a.noCompile=o.noCompile,a.noCompile||(a.text="//"+a.text),a.setParent(e);continue;case"#include":u=t.splitToWords(h,null);var v=t.includes[u[1]];if(!v)throw"ShaderCompile error no this include file:"+u[1];if((d=u[0].indexOf("?"))<0){a.setParent(e),h=v.getWith("with"==u[2]?u[3]:null),this._compileToTree(a,h.split("\n"),0,s,r),a.text="";continue}a.setCondition(u[0].substr(d+1),1),a.text=v.getWith("with"==u[2]?u[3]:null);break;case"#import":u=t.splitToWords(h,null),_=u[1],s.push({node:a,file:t.includes[_],ofs:a.text.length});continue}}else{if(o=e.childs[e.childs.length-1],o&&!o.name){s.length>0&&t.splitToWords(h,o),c=a,o.text+="\n"+h;continue}s.length>0&&t.splitToWords(h,a)}a.setParent(e)}},e.createShader=function(t,e,i,n){var s={},r="";if(t)for(var a in t)r+="#define "+a+"\n",s[a]=!0;var o=this._VS.toscript(s,[]),h=this._PS.toscript(s,[]);return(i||Ls.create)(r+o.join("\n"),r+h.join("\n"),e,this._nameMap,n)},t._parseOne=function(e,i,n,s,r,a){var o={type:t.shaderParamsMap[n[s+1]],name:n[s+2],size:isNaN(parseInt(n[s+3]))?1:parseInt(n[s+3])};return a&&("attribute"==r?e.push(o):i.push(o)),":"==n[s+3]&&(o.type=n[s+4],s+=2),s+=2},t.addInclude=function(e,i){if(!i||0===i.length)throw new Error("add shader include file err:"+e);if(t.includes[e])throw new Error("add shader include file err, has add:"+e);t.includes[e]=new j(i)},t.preGetParams=function(e,i){var n=[e,i],s={},r=[],a=[],o={},h=[];s.attributes=r,s.uniforms=a,s.defines=o;for(var l=0,_=0,u=0;2>u;u++){n[u]=n[u].replace(t._removeAnnotation,"");var c,d=n[u].match(t._reg);for(l=0,_=d.length;_>l;l++){var f=d[l];if("attribute"==f||"uniform"==f)l=t._parseOne(r,a,d,l,f,!0);else{if("#define"==f){f=d[++l],h[f]=1;continue}if("#ifdef"==f){c=d[++l];{o[c]=o[c]||[]}for(l++;_>l;l++)if(f=d[l],"attribute"==f||"uniform"==f)l=t._parseOne(r,a,d,l,f,h[c]);else if("#else"==f)for(l++;_>l;l++)if(f=d[l],"attribute"==f||"uniform"==f)l=t._parseOne(r,a,d,l,f,!h[c]);else if("#endif"==f)break}}}}return s},t.splitToWords=function(t,e){for(var i,n,s=[],r=-1,a=0,o=t.length;o>a;a++)if(i=t.charAt(a)," 	=+-*/&%!<>()'\",;".indexOf(i)>=0){if(r>=0&&a-r>1&&(n=t.substr(r,a-r),s.push(n)),'"'==i||"'"==i){var h=t.indexOf(i,a+1);if(0>h)throw"Sharder err:"+t;s.push(t.substr(a+1,h-a-1)),a=h,r=-1;continue}"("==i&&e&&s.length>0&&(n=s[s.length-1]+";","vec4;main;".indexOf(n)<0&&(e.useFuns+=n)),r=-1}else 0>r&&(r=a);return o>r&&o-r>1&&(n=t.substr(r,o-r),s.push(n)),s},t.IFDEF_NO=0,t.IFDEF_YES=1,t.IFDEF_ELSE=2,t.IFDEF_PARENT=3,t._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),t._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),t._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),t.includes={},n(t,["shaderParamsMap",function(){return this.shaderParamsMap={"float":5126,"int":5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),t}(),de=function(){function t(e){this._font="14px Arial",this._family="Arial",this._size=14,this._italic=!1,this._bold=!1,this._id=t._gfontID++,this.setFont(e||this._font)}s(t,"laya.utils.FontInfo");var e=t.prototype;return e.setFont=function(t){this._font=t;var e=t.split(" "),i=e.length;if(2>i)return 1==i&&e[0].indexOf("px")>0&&(this._size=parseInt(e[0])),void 0;for(var n=-1,s=0;i>s;s++)if(e[s].indexOf("px")>0||e[s].indexOf("pt")>0){n=s,this._size=parseInt(e[s]),this._size<=0&&(console.error("font parse error:"+t),this._size=14);break}var r=n+1,a=e[r];for(r++;i>r;r++)a+=" "+e[r];this._family=a.split(",")[0],this._italic=e.indexOf("italic")>=0,this._bold=e.indexOf("bold")>=0},t.Parse=function(e){if(e===t._lastFont)return t._lastFontInfo;var i=t._cache[e];return i||(i=t._cache[e]=new t(e)),t._lastFont=e,t._lastFontInfo=i,i},t.EMPTY=new t(null),t._cache={},t._gfontID=0,t._lastFont="",t._lastFontInfo=null,t}(),fe=(function(){function t(){}return s(t,"laya.events.Keyboard"),t.NUMBER_0=48,t.NUMBER_1=49,t.NUMBER_2=50,t.NUMBER_3=51,t.NUMBER_4=52,t.NUMBER_5=53,t.NUMBER_6=54,t.NUMBER_7=55,t.NUMBER_8=56,t.NUMBER_9=57,t.A=65,t.B=66,t.C=67,t.D=68,t.E=69,t.F=70,t.G=71,t.H=72,t.I=73,t.J=74,t.K=75,t.L=76,t.M=77,t.N=78,t.O=79,t.P=80,t.Q=81,t.R=82,t.S=83,t.T=84,t.U=85,t.V=86,t.W=87,t.X=88,t.Y=89,t.Z=90,t.F1=112,t.F2=113,t.F3=114,t.F4=115,t.F5=116,t.F6=117,t.F7=118,t.F8=119,t.F9=120,t.F10=121,t.F11=122,t.F12=123,t.F13=124,t.F14=125,t.F15=126,t.NUMPAD=21,t.NUMPAD_0=96,t.NUMPAD_1=97,t.NUMPAD_2=98,t.NUMPAD_3=99,t.NUMPAD_4=100,t.NUMPAD_5=101,t.NUMPAD_6=102,t.NUMPAD_7=103,t.NUMPAD_8=104,t.NUMPAD_9=105,t.NUMPAD_ADD=107,t.NUMPAD_DECIMAL=110,t.NUMPAD_DIVIDE=111,t.NUMPAD_ENTER=108,t.NUMPAD_MULTIPLY=106,t.NUMPAD_SUBTRACT=109,t.SEMICOLON=186,t.EQUAL=187,t.COMMA=188,t.MINUS=189,t.PERIOD=190,t.SLASH=191,t.BACKQUOTE=192,t.LEFTBRACKET=219,t.BACKSLASH=220,t.RIGHTBRACKET=221,t.QUOTE=222,t.ALTERNATE=18,t.BACKSPACE=8,t.CAPS_LOCK=20,t.COMMAND=15,t.CONTROL=17,t.DELETE=46,t.ENTER=13,t.ESCAPE=27,t.PAGE_UP=33,t.PAGE_DOWN=34,t.END=35,t.HOME=36,t.LEFT=37,t.UP=38,t.RIGHT=39,t.DOWN=40,t.SHIFT=16,t.SPACE=32,t.TAB=9,t.INSERT=45,t}(),function(){function t(){}return s(t,"laya.webgl.canvas.BlendMode"),t._init_=function(){t.fns=[t.BlendNormal,t.BlendAdd,t.BlendMultiply,t.BlendScreen,t.BlendOverlay,t.BlendLight,t.BlendMask,t.BlendDestinationOut],t.targetFns=[t.BlendNormalTarget,t.BlendAddTarget,t.BlendMultiplyTarget,t.BlendScreenTarget,t.BlendOverlayTarget,t.BlendLightTarget,t.BlendMask,t.BlendDestinationOut]},t.BlendNormal=function(t){ye.setBlendFunc(t,1,771)},t.BlendAdd=function(t){ye.setBlendFunc(t,1,772)},t.BlendMultiply=function(t){ye.setBlendFunc(t,774,771)},t.BlendScreen=function(t){ye.setBlendFunc(t,1,1)},t.BlendOverlay=function(t){ye.setBlendFunc(t,1,769)},t.BlendLight=function(t){ye.setBlendFunc(t,1,1)},t.BlendNormalTarget=function(t){ye.setBlendFunc(t,1,771)},t.BlendAddTarget=function(t){ye.setBlendFunc(t,1,772)},t.BlendMultiplyTarget=function(t){ye.setBlendFunc(t,774,771)},t.BlendScreenTarget=function(t){ye.setBlendFunc(t,1,1)},t.BlendOverlayTarget=function(t){ye.setBlendFunc(t,1,769)},t.BlendLightTarget=function(t){ye.setBlendFunc(t,1,1)},t.BlendMask=function(t){ye.setBlendFunc(t,0,770)},t.BlendDestinationOut=function(t){ye.setBlendFunc(t,0,0)},t.activeBlendFunction=null,t.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],t.TOINT={normal:0,add:1,multiply:2,screen:3,overlay:4,light:5,mask:6,"destination-out":7,lighter:1},t.NORMAL="normal",t.ADD="add",t.MULTIPLY="multiply",t.SCREEN="screen",t.OVERLAY="overlay",t.LIGHT="light",t.MASK="mask",t.DESTINATIONOUT="destination-out",t.LIGHTER="lighter",t.fns=[],t.targetFns=[],t}()),pe=(function(){function t(){}s(t,"laya.html.dom.HTMLBrElement");var e=t.prototype;return e._addToLayout=function(t){t.push(this)},e.reset=function(){return this},e.destroy=function(){Ji.recover(X.getClassName(this),this.reset())},e._setParent=function(){},e._getCSSStyle=function(){return t.brStyle||(t.brStyle=new Hi,t.brStyle.setLineElement(!0),t.brStyle.block=!0),t.brStyle},e.renderSelfToGraphic=function(){},r(0,e,"URI",null,function(){}),r(0,e,"parent",null,function(){}),r(0,e,"href",null,function(){}),t.brStyle=null,t}(),function(){function t(){}var e,r;return s(t,"laya.utils.SceneUtils"),t.getBindFun=function(e){var n=t._funMap.get(e);if(null==n){var s='"'+e+'"';s=s.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"');var r="(function(data){if(data==null)return;with(data){try{\nreturn "+s+"\n}catch(e){}}})";n=i._runScript(r),t._funMap.set(e,n)}return n},t.createByData=function(e,i){var n=r.create();if(e=t.createComp(i,e,e,null,n),e._setBit(8,!0),e.hasOwnProperty("_idMap")&&(e._idMap=n._idMap),i.animations){var s,a,o=[],h=i.animations,l=0,_=h.length;for(l=0;_>l;l++){switch(s=new js,a=h[l],s._setUp(n._idMap,a),e[a.name]=s,s._setControlNode(e),a.action){case 1:s.play(0,!1);break;case 2:s.play(0,!0)}o.push(s)}e._aniList=o}return"Scene"===e._$componentType&&e._width>0&&null==i.props.hitTestPrior&&!e.mouseThrough&&(e.hitTestPrior=!0),n.beginLoad(e),e},t.createInitTool=function(){return r.create()},t.createComp=function(e,n,s,r,a){if("Scene3D"==e.type||"Sprite3D"==e.type){var o=[],h=i.Utils3D._createSceneByJsonForMaker(e,o,a);return"Sprite3D"==e.type?i.StaticBatchManager.combine(h,o):i.StaticBatchManager.combine(null,o),h}if(n=n||t.getCompInstance(e),!n)return e.props&&e.props.runtime?console.warn("runtime not found:"+e.props.runtime):console.warn("can not create:"+e.type),null;var l=e.child;if(l)for(var _="List"==n._$componentType,u=0,c=l.length;c>u;u++){var d=l[u];if(!n.hasOwnProperty("itemRender")||"render"!=d.props.name&&"render"!==d.props.renderType)if("Graphic"==d.type)Pe._addGraphicsToSprite(d,n);else if(Pe._isDrawType(d.type))Pe._addGraphicToSprite(d,n,!0);else{if(_){var f=[],p=t.createComp(d,null,s,f,a);f.length&&(p._$bindData=f)}else p=t.createComp(d,null,s,r,a);"Script"==d.type?p instanceof laya.components.Component?n._addComponentInstance(p):"owner"in p?p.owner=n:"target"in p&&(p.target=n):"mask"==d.props.renderType||"mask"==d.props.name?n.mask=p:p instanceof laya.display.Node&&n.addChild(p)}else n.itemRender=d}var m=e.props;for(var g in m){var v=m[g];"string"==typeof v&&(v.indexOf("@node:")>=0||v.indexOf("@Prefab:")>=0)?a&&a.addNodeRef(n,g,v):t.setCompValue(n,g,v,s,r)}return n._afterInited&&n._afterInited(),e.compId&&a&&a._idMap&&(a._idMap[e.compId]=n),n},t.setCompValue=function(i,n,s,r,a){if("string"==typeof s&&s.indexOf("${")>-1){if(t._sheet||(t._sheet=Pe.getClass("laya.data.Table")),!t._sheet)return console.warn("Can not find class Sheet"),void 0;if(a)a.push(i,n,s);else if(r){-1==s.indexOf("].")&&(s=s.replace(".","[0]."));var o=new e(i,n,s);o.exe(r);for(var h,l,_=s.replace(/\[.*?\]\./g,".");null!=(h=t._parseWatchData.exec(_));){for(var u=h[1];null!=(l=t._parseKeyWord.exec(u));){var c=l[0],d=r._watchMap[c]||(r._watchMap[c]=[]);d.push(o),t._sheet.I.notifer.on(c,r,r.changeData,[c])}d=r._watchMap[u]||(r._watchMap[u]=[]),d.push(o),t._sheet.I.notifer.on(u,r,r.changeData,[u])}}}else"var"===n&&r?r[s]=i:i[n]="true"===s?!0:"false"===s?!1:s},t.getCompInstance=function(e){if("UIView"==e.type&&e.props&&e.props.pageData)return t.createByData(null,e.props.pageData);var i=e.props&&e.props.runtime||e.type,n=Pe.getClass(i);if(!n)throw"Can not find class "+i;if("Script"===e.type&&n.prototype._doAwake){var s=Ji.createByClass(n);return s._destroyed=!1,s}return e.props&&e.props.hasOwnProperty("renderType")&&"instance"==e.props.renderType?(n.instance||(n.instance=new n),n.instance):new n},t._sheet=null,n(t,["_funMap",function(){return this._funMap=new Ce},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),t.__init$=function(){e=function(){function e(t,e,i){this.comp=null,this.prop=null,this.value=null,this.comp=t,this.prop=e,this.value=i}s(e,"");var i=e.prototype;return i.exe=function(e){var i=t.getBindFun(this.value);this.comp[this.prop]=i.call(this,e)},e}(),r=function(){function t(){this._nodeRefList=null,this._initList=null,this._loadList=null,this._idMap=null,this._scene=null}s(t,"");var e=t.prototype;return e.reset=function(){this._nodeRefList=null,this._initList=null,this._idMap=null,this._loadList=null,this._scene=null},e.recover=function(){this.reset(),Ji.recover("InitTool",this)},e.addLoadRes=function(t,e){this._loadList||(this._loadList=[]),e?this._loadList.push({url:t,type:e}):this._loadList.push(t)},e.addNodeRef=function(t,e,i){this._nodeRefList||(this._nodeRefList=[]),this._nodeRefList.push([t,e,i]),i.indexOf("@Prefab:")>=0&&this.addLoadRes(i.replace("@Prefab:",""),"prefab")},e.setNodeRef=function(){if(this._nodeRefList){if(!this._idMap)return this._nodeRefList=null,void 0;var t=0,e=0;e=this._nodeRefList.length;var i;for(t=0;e>t;t++)i=this._nodeRefList[t],i[0][i[1]]=this.getReferData(i[2]);this._nodeRefList=null}},e.getReferData=function(t){if(t.indexOf("@Prefab:")>=0){var e;return e=un.getRes(t.replace("@Prefab:",""))}if(t.indexOf("@arr:")>=0){t=t.replace("@arr:","");var i;i=t.split(",");var n,s=0,r=0;for(r=i.length,s=0;r>s;s++)n=i[s],i[s]=n?this._idMap[n.replace("@node:","")]:null;return i}return this._idMap[t.replace("@node:","")]},e.addInitItem=function(t){this._initList||(this._initList=[]),this._initList.push(t)},e.doInits=function(){this._initList&&(this._initList=null)},e.finish=function(){this.setNodeRef(),this.doInits(),this._scene._setBit(8,!1),this._scene.parent&&this._scene.parent.activeInHierarchy&&this._scene.active&&this._scene._activeHierarchy(),this._scene.event("onViewCreated"),this.recover()},e.beginLoad=function(t){this._scene=t,!this._loadList||this._loadList.length<1?this.finish():i.loader.load(this._loadList,_.create(this,this.finish))},t.create=function(){var e=Ji.getItemByClass("InitTool",t);return e._idMap=[],e},t}()},t}()),me=function(){function t(){}return s(t,"laya.html.utils.Layout"),t.later=function(e){null==t._will&&(t._will=[],i.stage.frameLoop(1,null,function(){if(!(t._will.length<1)){for(var e=0;e<t._will.length;e++)laya.html.utils.Layout.layout(t._will[e]);t._will.length=0}})),t._will.push(e)},t.layout=function(e){if(!e||!e._style)return null;var i=e._style;if(0===(512&i._type))return null;e.style._type&=-513;var n=t._multiLineLayout(e);return n},t._multiLineLayout=function(e){function i(){T.y=C,C+=T.h+d,T.mWidth=L,L=0,T=new en,R.push(T),T.h=0,A=0,I=!0,b=!1}var n=new Array;e._addChildsToLayout(n);var s,r,a,o,h,l=0,_=n.length,u=e._getCSSStyle(),c=u.letterSpacing,d=u.leading,f=u.lineHeight,p=u._widthAuto()||!u.wordWrap,m=p?999999:e.width,g=(e.height,0),v=u.italic?u.fontSize/3:0,y=u.align,E=u.valign,S="top"!==E||"left"!==y||0!=f,A=0,C=0,D=0,x=0,R=new Array,T=R[0]=new en,b=!1,P=!1;T.h=0,u.italic&&(m-=u.fontSize/3);var L=0,I=!0;for(l=0;_>l;l++)if(s=n[l],null!=s)if(I=!1,s instanceof laya.html.dom.HTMLBrElement)i(),T.y=C,T.h=f;else{if(s._isChar()){if(o=s,o.isWord)b=P||"\n"===o.char,T.wordStartIndex=T.elements.length;else{if(R.length>0&&A+D>m&&T.wordStartIndex>0){var M=0;M=T.elements.length-T.wordStartIndex+1,T.elements.length=T.wordStartIndex,l-=M,i();continue}b=!1,L+=o.width}D=o.width+o.style.letterSpacing,x=o.height,P=!1,b=b||A+D>m,b&&i(),T.minTextHeight=Math.min(T.minTextHeight,s.height)}else r=s._getCSSStyle(),h=s,a=r.padding,b=P||r.getLineElement(),D=h.width+a[1]+a[3]+r.letterSpacing,x=h.height+a[0]+a[2],P=r.getLineElement(),b=b||A+D>m&&r.wordWrap,b&&i();T.elements.push(s),T.h=Math.max(T.h,x),s.x=A,s.y=C,A+=D,T.w=A-c,T.y=C,g=Math.max(A+v,g)}else I||(A+=t.DIV_ELEMENT_PADDING),T.wordStartIndex=T.elements.length;if(C=T.y+T.h,S){var w=0,O=m;for(p&&e.width>0&&(O=e.width),l=0,_=R.length;_>l;l++)R[l].updatePos(0,O,l,w,y,E,f),w+=Math.max(f,R[l].h+d);C=w}return p&&(e.width=g),C>e.height&&(e.height=C),[g,C]},t.DIV_ELEMENT_PADDING=0,t._will=null,t}(),ge=function(){function t(){}s(t,"laya.display.cmd.TranslateCmd");var e=t.prototype;return e.recover=function(){Ji.recover("TranslateCmd",this)},e.run=function(t){t.translate(this.tx,this.ty)},r(0,e,"cmdID",function(){return"Translate"}),t.create=function(e,i){var n=Ji.getItemByClass("TranslateCmd",t);return n.tx=e,n.ty=i,n},t.ID="Translate",t}(),ve=function(){function t(){this._mesh=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this._ref=1,this.srcRT=null,this._key=new Ze}s(t,"laya.webgl.submit.SubmitTarget");var e=t.prototype;return i.imps(e,{"laya.webgl.submit.ISubmit":!0}),e.renderSubmit=function(){var t=Oi.mainContext;this._mesh.useMesh(t);var e=this.srcRT;return e&&(this.shaderValue.texture=e._getSource(),this.shaderValue.upload(),this.blend(),wi.drawCall++,wi.trianglesFaces+=this._numEle/3,Oi.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},e.blend=function(){if(fe.activeBlendFunction!==fe.fns[this.blendType]){var t=Oi.mainContext;t.enable(3042),fe.fns[this.blendType](t),fe.activeBlendFunction=fe.fns[this.blendType]}},e.getRenderType=function(){return 0},e.releaseRender=function(){if(--this._ref<1){var e=t.POOL;e[e._length++]=this}},e.reUse=function(t,e){return this._startIdx=e,this._ref++,e},t.create=function(e,i,n,s){var r=t.POOL._length?t.POOL[--t.POOL._length]:new t;if(r._mesh=i,r.srcRT=s,r._startIdx=i.indexNum*Ie.BYTES_PIDX,r._ref=1,r._key.clear(),r._numEle=0,r.blendType=e._nBlendType,r._key.blendShader=r.blendType,r.shaderValue=n,r.shaderValue.setValue(e._shader2D),e._colorFiler){var a=e._colorFiler;n.defines.add(a.type),n.colorMat=a._mat,n.colorAlpha=a._alpha}return r},t.POOL=(t.POOL=[],t.POOL._length=0,t.POOL),t}(),ye=function(){function e(){}s(e,"laya.webgl.WebGLContext");var i=e.prototype;return i.getContextAttributes=function(){return null},i.isContextLost=function(){},i.getSupportedExtensions=function(){return null},i.getExtension=function(){return null},i.activeTexture=function(){},i.attachShader=function(){},i.bindAttribLocation=function(){},i.bindBuffer=function(){},i.bindFramebuffer=function(){},i.bindRenderbuffer=function(){},i.bindTexture=function(){},i.useTexture=function(){},i.blendColor=function(){},i.blendEquation=function(){},i.blendEquationSeparate=function(){},i.blendFunc=function(){},i.blendFuncSeparate=function(){},i.bufferData=function(){},i.bufferSubData=function(){},i.checkFramebufferStatus=function(){return null},i.clear=function(){},i.clearColor=function(){},i.clearDepth=function(){},i.clearStencil=function(){},i.colorMask=function(){},i.compileShader=function(){},i.copyTexImage2D=function(){},i.copyTexSubImage2D=function(){},i.createBuffer=function(){},i.createFramebuffer=function(){},i.createProgram=function(){},i.createRenderbuffer=function(){},i.createShader=function(){},i.createTexture=function(){return null},i.cullFace=function(){},i.deleteBuffer=function(){},i.deleteFramebuffer=function(){},i.deleteProgram=function(){},i.deleteRenderbuffer=function(){},i.deleteShader=function(){},i.deleteTexture=function(){},i.depthFunc=function(){},i.depthMask=function(){},i.depthRange=function(){},i.detachShader=function(){},i.disable=function(){},i.disableVertexAttribArray=function(){},i.drawArrays=function(){},i.drawElements=function(){},i.enable=function(){},i.enableVertexAttribArray=function(){},i.finish=function(){},i.flush=function(){},i.framebufferRenderbuffer=function(){},i.framebufferTexture2D=function(){},i.frontFace=function(){return null},i.generateMipmap=function(){return null},i.getActiveAttrib=function(){return null},i.getActiveUniform=function(){return null},i.getAttribLocation=function(){return 0},i.getParameter=function(){return null},i.getBufferParameter=function(){return null},i.getError=function(){return null},i.getFramebufferAttachmentParameter=function(){},i.getProgramParameter=function(){return 0},i.getProgramInfoLog=function(){return null},i.getRenderbufferParameter=function(){return null},i.getShaderPrecisionFormat=function(){return null},i.getShaderParameter=function(){},i.getShaderInfoLog=function(){return null},i.getShaderSource=function(){return null},i.getTexParameter=function(){},i.getUniform=function(){},i.getUniformLocation=function(){return null},i.getVertexAttrib=function(){return null},i.getVertexAttribOffset=function(){return null},i.hint=function(){},i.isBuffer=function(){},i.isEnabled=function(){},i.isFramebuffer=function(){},i.isProgram=function(){},i.isRenderbuffer=function(){},i.isShader=function(){},i.isTexture=function(){},i.lineWidth=function(){},i.linkProgram=function(){},i.pixelStorei=function(){},i.polygonOffset=function(){},i.readPixels=function(){},i.renderbufferStorage=function(){},i.sampleCoverage=function(){},i.scissor=function(){},i.shaderSource=function(){},i.stencilFunc=function(){},i.stencilFuncSeparate=function(){},i.stencilMask=function(){},i.stencilMaskSeparate=function(){},i.stencilOp=function(){},i.stencilOpSeparate=function(){},i.texImage2D=function(){},i.texParameterf=function(){},i.texParameteri=function(){},i.texSubImage2D=function(){},i.uniform1f=function(){},i.uniform1fv=function(){},i.uniform1i=function(){},i.uniform1iv=function(){},i.uniform2f=function(){},i.uniform2fv=function(){},i.uniform2i=function(){},i.uniform2iv=function(){},i.uniform3f=function(){},i.uniform3fv=function(){},i.uniform3i=function(){},i.uniform3iv=function(){},i.uniform4f=function(){},i.uniform4fv=function(){},i.uniform4i=function(){},i.uniform4iv=function(){},i.uniformMatrix2fv=function(){},i.uniformMatrix3fv=function(){},i.uniformMatrix4fv=function(){},i.useProgram=function(){},i.validateProgram=function(){},i.vertexAttrib1f=function(){},i.vertexAttrib1fv=function(){},i.vertexAttrib2f=function(){},i.vertexAttrib2fv=function(){},i.vertexAttrib3f=function(){},i.vertexAttrib3fv=function(){},i.vertexAttrib4f=function(){},i.vertexAttrib4fv=function(){},i.vertexAttribPointer=function(){},i.viewport=function(){},i.configureBackBuffer=function(t,e,i,n,s){void 0===n&&(n=!0),void 0===s&&(s=!1)},i.compressedTexImage2D=function(){},i.createVertexArray=function(){throw"not implemented"},i.bindVertexArray=function(){throw"not implemented"},i.deleteVertexArray=function(){throw"not implemented"},i.isVertexArray=function(){throw"not implemented"},e.__init__=function(i){if(e.__init_native(),laya.webgl.WebGLContext._checkExtensions(i),!Oi._isWebGL2){t._setupVertexArrayObject&&(Be.onMiniGame?t._forceSetupVertexArrayObject(i):t._setupVertexArrayObject(i));var n=(i.rawgl||i).getExtension("OES_vertex_array_object");if(n){console.log("EXT:webgl support OES_vertex_array_object！");var s=i;s.createVertexArray=function(){return n.createVertexArrayOES()},s.bindVertexArray=function(t){n.bindVertexArrayOES(t)},s.deleteVertexArray=function(t){n.deleteVertexArrayOES(t)},s.isVertexArray=function(t){n.isVertexArrayOES(t)}}}},e._getExtension=function(t,i){var n=e._extentionVendorPrefixes;for(var s in n){var r=t.getExtension(n[s]+i);if(r)return r}return null},e._checkExtensions=function(t){return e._extTextureFilterAnisotropic=e._getExtension(t,"EXT_texture_filter_anisotropic"),e._compressedTextureS3tc=e._getExtension(t,"WEBGL_compressed_texture_s3tc"),e._compressedTexturePvrtc=e._getExtension(t,"WEBGL_compressed_texture_pvrtc"),e._compressedTextureEtc1=e._getExtension(t,"WEBGL_compressed_texture_etc1"),null},e.__init_native=function(){if(Ni.isConchApp){var t=e;t.useProgram=t.useProgramForNative,t.activeTexture=t.activeTextureForNative,t.bindTexture=t.bindTextureForNative,t.bindVertexArray=t.bindVertexArrayForNative,t.setDepthTest=t.setDepthTestForNative,t.setDepthMask=t.setDepthMaskForNative,t.setDepthFunc=t.setDepthFuncForNative,t.setBlend=t.setBlendForNative,t.setBlendFunc=t.setBlendFuncForNative,t.setCullFace=t.setCullFaceForNative,t.setFrontFace=t.setFrontFaceForNative,t._checkExtensions(Be.window.LayaGLContext.instance)}},e.useProgram=function(t,i){return e._useProgram===i?!1:(t.useProgram(i),e._useProgram=i,!0)},e.setDepthTest=function(t,i){i!==e._depthTest&&(e._depthTest=i,i?t.enable(2929):t.disable(2929))},e.setDepthMask=function(t,i){i!==e._depthMask&&(e._depthMask=i,t.depthMask(i))},e.setDepthFunc=function(t,i){i!==e._depthFunc&&(e._depthFunc=i,t.depthFunc(i))},e.setBlend=function(t,i){i!==e._blend&&(e._blend=i,i?t.enable(3042):t.disable(3042))},e.setBlendFunc=function(t,i,n){(i!==e._sFactor||n!==e._dFactor)&&(e._sFactor=i,e._dFactor=n,t.blendFunc(i,n))},e.setCullFace=function(t,i){i!==e._cullFace&&(e._cullFace=i,i?t.enable(2884):t.disable(2884))},e.setFrontFace=function(t,i){i!==e._frontFace&&(e._frontFace=i,t.frontFace(i))},e.activeTexture=function(t,i){e._activedTextureID!==i&&(t.activeTexture(i),e._activedTextureID=i)},e.bindTexture=function(t,i,n){e._activeTextures[e._activedTextureID-33984]!==n&&(t.bindTexture(i,n),e._activeTextures[e._activedTextureID-33984]=n)},e.useProgramForNative=function(t,e){return t.useProgram(e),!0},e.setDepthTestForNative=function(t,e){e?t.enable(2929):t.disable(2929)},e.setDepthMaskForNative=function(t,e){t.depthMask(e)},e.setDepthFuncForNative=function(t,e){t.depthFunc(e)},e.setBlendForNative=function(t,e){e?t.enable(3042):t.disable(3042)},e.setBlendFuncForNative=function(t,e,i){t.blendFunc(e,i)},e.setCullFaceForNative=function(t,e){e?t.enable(2884):t.disable(2884)},e.setFrontFaceForNative=function(t,e){t.frontFace(e)},e.activeTextureForNative=function(t,e){t.activeTexture(e)},e.bindTextureForNative=function(t,e,i){t.bindTexture(e,i)},e.bindVertexArrayForNative=function(t,e){t.bindVertexArray(e)},e.DEPTH_BUFFER_BIT=256,e.STENCIL_BUFFER_BIT=1024,e.COLOR_BUFFER_BIT=16384,e.POINTS=0,e.LINES=1,e.LINE_LOOP=2,e.LINE_STRIP=3,e.TRIANGLES=4,e.TRIANGLE_STRIP=5,e.TRIANGLE_FAN=6,e.ZERO=0,e.ONE=1,e.SRC_COLOR=768,e.ONE_MINUS_SRC_COLOR=769,e.SRC_ALPHA=770,e.ONE_MINUS_SRC_ALPHA=771,e.DST_ALPHA=772,e.ONE_MINUS_DST_ALPHA=773,e.DST_COLOR=774,e.ONE_MINUS_DST_COLOR=775,e.SRC_ALPHA_SATURATE=776,e.FUNC_ADD=32774,e.BLEND_EQUATION=32777,e.BLEND_EQUATION_RGB=32777,e.BLEND_EQUATION_ALPHA=34877,e.FUNC_SUBTRACT=32778,e.FUNC_REVERSE_SUBTRACT=32779,e.BLEND_DST_RGB=32968,e.BLEND_SRC_RGB=32969,e.BLEND_DST_ALPHA=32970,e.BLEND_SRC_ALPHA=32971,e.CONSTANT_COLOR=32769,e.ONE_MINUS_CONSTANT_COLOR=32770,e.CONSTANT_ALPHA=32771,e.ONE_MINUS_CONSTANT_ALPHA=32772,e.BLEND_COLOR=32773,e.ARRAY_BUFFER=34962,e.ELEMENT_ARRAY_BUFFER=34963,e.ARRAY_BUFFER_BINDING=34964,e.ELEMENT_ARRAY_BUFFER_BINDING=34965,e.STREAM_DRAW=35040,e.STATIC_DRAW=35044,e.DYNAMIC_DRAW=35048,e.BUFFER_SIZE=34660,e.BUFFER_USAGE=34661,e.CURRENT_VERTEX_ATTRIB=34342,e.FRONT=1028,e.BACK=1029,e.CULL_FACE=2884,e.FRONT_AND_BACK=1032,e.BLEND=3042,e.DITHER=3024,e.STENCIL_TEST=2960,e.DEPTH_TEST=2929,e.SCISSOR_TEST=3089,e.POLYGON_OFFSET_FILL=32823,e.SAMPLE_ALPHA_TO_COVERAGE=32926,e.SAMPLE_COVERAGE=32928,e.NO_ERROR=0,e.INVALID_ENUM=1280,e.INVALID_VALUE=1281,e.INVALID_OPERATION=1282,e.OUT_OF_MEMORY=1285,e.CW=2304,e.CCW=2305,e.LINE_WIDTH=2849,e.ALIASED_POINT_SIZE_RANGE=33901,e.ALIASED_LINE_WIDTH_RANGE=33902,e.CULL_FACE_MODE=2885,e.FRONT_FACE=2886,e.DEPTH_RANGE=2928,e.DEPTH_WRITEMASK=2930,e.DEPTH_CLEAR_VALUE=2931,e.DEPTH_FUNC=2932,e.STENCIL_CLEAR_VALUE=2961,e.STENCIL_FUNC=2962,e.STENCIL_FAIL=2964,e.STENCIL_PASS_DEPTH_FAIL=2965,e.STENCIL_PASS_DEPTH_PASS=2966,e.STENCIL_REF=2967,e.STENCIL_VALUE_MASK=2963,e.STENCIL_WRITEMASK=2968,e.STENCIL_BACK_FUNC=34816,e.STENCIL_BACK_FAIL=34817,e.STENCIL_BACK_PASS_DEPTH_FAIL=34818,e.STENCIL_BACK_PASS_DEPTH_PASS=34819,e.STENCIL_BACK_REF=36003,e.STENCIL_BACK_VALUE_MASK=36004,e.STENCIL_BACK_WRITEMASK=36005,e.VIEWPORT=2978,e.SCISSOR_BOX=3088,e.COLOR_CLEAR_VALUE=3106,e.COLOR_WRITEMASK=3107,e.UNPACK_ALIGNMENT=3317,e.PACK_ALIGNMENT=3333,e.MAX_TEXTURE_SIZE=3379,e.MAX_VIEWPORT_DIMS=3386,e.SUBPIXEL_BITS=3408,e.RED_BITS=3410,e.GREEN_BITS=3411,e.BLUE_BITS=3412,e.ALPHA_BITS=3413,e.DEPTH_BITS=3414,e.STENCIL_BITS=3415,e.POLYGON_OFFSET_UNITS=10752,e.POLYGON_OFFSET_FACTOR=32824,e.TEXTURE_BINDING_2D=32873,e.SAMPLE_BUFFERS=32936,e.SAMPLES=32937,e.SAMPLE_COVERAGE_VALUE=32938,e.SAMPLE_COVERAGE_INVERT=32939,e.NUM_COMPRESSED_TEXTURE_FORMATS=34466,e.COMPRESSED_TEXTURE_FORMATS=34467,e.DONT_CARE=4352,e.FASTEST=4353,e.NICEST=4354,e.GENERATE_MIPMAP_HINT=33170,e.BYTE=5120,e.UNSIGNED_BYTE=5121,e.SHORT=5122,e.UNSIGNED_SHORT=5123,e.INT=5124,e.UNSIGNED_INT=5125,e.FLOAT=5126,e.DEPTH_COMPONENT=6402,e.ALPHA=6406,e.RGB=6407,e.RGBA=6408,e.LUMINANCE=6409,e.LUMINANCE_ALPHA=6410,e.UNSIGNED_SHORT_4_4_4_4=32819,e.UNSIGNED_SHORT_5_5_5_1=32820,e.UNSIGNED_SHORT_5_6_5=33635,e.FRAGMENT_SHADER=35632,e.VERTEX_SHADER=35633,e.MAX_VERTEX_ATTRIBS=34921,e.MAX_VERTEX_UNIFORM_VECTORS=36347,e.MAX_VARYING_VECTORS=36348,e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,e.MAX_TEXTURE_IMAGE_UNITS=34930,e.MAX_FRAGMENT_UNIFORM_VECTORS=36349,e.SHADER_TYPE=35663,e.DELETE_STATUS=35712,e.LINK_STATUS=35714,e.VALIDATE_STATUS=35715,e.ATTACHED_SHADERS=35717,e.ACTIVE_UNIFORMS=35718,e.ACTIVE_ATTRIBUTES=35721,e.SHADING_LANGUAGE_VERSION=35724,e.CURRENT_PROGRAM=35725,e.NEVER=512,e.LESS=513,e.EQUAL=514,e.LEQUAL=515,e.GREATER=516,e.NOTEQUAL=517,e.GEQUAL=518,e.ALWAYS=519,e.KEEP=7680,e.REPLACE=7681,e.INCR=7682,e.DECR=7683,e.INVERT=5386,e.INCR_WRAP=34055,e.DECR_WRAP=34056,e.VENDOR=7936,e.RENDERER=7937,e.VERSION=7938,e.NEAREST=9728,e.LINEAR=9729,e.NEAREST_MIPMAP_NEAREST=9984,e.LINEAR_MIPMAP_NEAREST=9985,e.NEAREST_MIPMAP_LINEAR=9986,e.LINEAR_MIPMAP_LINEAR=9987,e.TEXTURE_MAG_FILTER=10240,e.TEXTURE_MIN_FILTER=10241,e.TEXTURE_WRAP_S=10242,e.TEXTURE_WRAP_T=10243,e.TEXTURE_2D=3553,e.TEXTURE_3D=32879,e.TEXTURE=5890,e.TEXTURE_CUBE_MAP=34067,e.TEXTURE_BINDING_CUBE_MAP=34068,e.TEXTURE_CUBE_MAP_POSITIVE_X=34069,e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,e.MAX_CUBE_MAP_TEXTURE_SIZE=34076,e.TEXTURE0=33984,e.TEXTURE1=33985,e.TEXTURE2=33986,e.TEXTURE3=33987,e.TEXTURE4=33988,e.TEXTURE5=33989,e.TEXTURE6=33990,e.TEXTURE7=33991,e.TEXTURE8=33992,e.TEXTURE9=33993,e.TEXTURE10=33994,e.TEXTURE11=33995,e.TEXTURE12=33996,e.TEXTURE13=33997,e.TEXTURE14=33998,e.TEXTURE15=33999,e.TEXTURE16=34e3,e.TEXTURE17=34001,e.TEXTURE18=34002,e.TEXTURE19=34003,e.TEXTURE20=34004,e.TEXTURE21=34005,e.TEXTURE22=34006,e.TEXTURE23=34007,e.TEXTURE24=34008,e.TEXTURE25=34009,e.TEXTURE26=34010,e.TEXTURE27=34011,e.TEXTURE28=34012,e.TEXTURE29=34013,e.TEXTURE30=34014,e.TEXTURE31=34015,e.ACTIVE_TEXTURE=34016,e.REPEAT=10497,e.CLAMP_TO_EDGE=33071,e.MIRRORED_REPEAT=33648,e.FLOAT_VEC2=35664,e.FLOAT_VEC3=35665,e.FLOAT_VEC4=35666,e.INT_VEC2=35667,e.INT_VEC3=35668,e.INT_VEC4=35669,e.BOOL=35670,e.BOOL_VEC2=35671,e.BOOL_VEC3=35672,e.BOOL_VEC4=35673,e.FLOAT_MAT2=35674,e.FLOAT_MAT3=35675,e.FLOAT_MAT4=35676,e.SAMPLER_2D=35678,e.SAMPLER_CUBE=35680,e.VERTEX_ATTRIB_ARRAY_ENABLED=34338,e.VERTEX_ATTRIB_ARRAY_SIZE=34339,e.VERTEX_ATTRIB_ARRAY_STRIDE=34340,e.VERTEX_ATTRIB_ARRAY_TYPE=34341,e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,e.VERTEX_ATTRIB_ARRAY_POINTER=34373,e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,e.COMPILE_STATUS=35713,e.LOW_FLOAT=36336,e.MEDIUM_FLOAT=36337,e.HIGH_FLOAT=36338,e.LOW_INT=36339,e.MEDIUM_INT=36340,e.HIGH_INT=36341,e.FRAMEBUFFER=36160,e.RENDERBUFFER=36161,e.RGBA4=32854,e.RGB5_A1=32855,e.RGB565=36194,e.DEPTH_COMPONENT16=33189,e.STENCIL_INDEX=6401,e.STENCIL_INDEX8=36168,e.DEPTH_STENCIL=34041,e.RENDERBUFFER_WIDTH=36162,e.RENDERBUFFER_HEIGHT=36163,e.RENDERBUFFER_INTERNAL_FORMAT=36164,e.RENDERBUFFER_RED_SIZE=36176,e.RENDERBUFFER_GREEN_SIZE=36177,e.RENDERBUFFER_BLUE_SIZE=36178,e.RENDERBUFFER_ALPHA_SIZE=36179,e.RENDERBUFFER_DEPTH_SIZE=36180,e.RENDERBUFFER_STENCIL_SIZE=36181,e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,e.COLOR_ATTACHMENT0=36064,e.DEPTH_ATTACHMENT=36096,e.STENCIL_ATTACHMENT=36128,e.DEPTH_STENCIL_ATTACHMENT=33306,e.NONE=0,e.FRAMEBUFFER_COMPLETE=36053,e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,e.FRAMEBUFFER_UNSUPPORTED=36061,e.FRAMEBUFFER_BINDING=36006,e.RENDERBUFFER_BINDING=36007,e.MAX_RENDERBUFFER_SIZE=34024,e.INVALID_FRAMEBUFFER_OPERATION=1286,e.UNPACK_FLIP_Y_WEBGL=37440,e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,e.CONTEXT_LOST_WEBGL=37442,e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,e.BROWSER_DEFAULT_WEBGL=37444,e._extTextureFilterAnisotropic=null,e._compressedTextureS3tc=null,e._compressedTexturePvrtc=null,e._compressedTextureEtc1=null,e._glTextureIDs=[33984,33985,33986,33987,33988,33989,33990,33991],e._useProgram=null,e._depthTest=!0,e._depthMask=!0,e._depthFunc=513,e._blend=!1,e._sFactor=1,e._dFactor=0,e._cullFace=!1,e._frontFace=2305,e._activedTextureID=33984,n(e,["_extentionVendorPrefixes",function(){return this._extentionVendorPrefixes=["","WEBKIT_","MOZ_"]
},"_activeTextures",function(){return this._activeTextures=new Array(8)}]),e}(),Ee=function(){function e(){}var i;return s(e,"laya.net.LocalStorage"),e.__init__=function(){return e._baseClass||(e._baseClass=i,i.init()),e.items=e._baseClass.items,e.support=e._baseClass.support,e.support},e.setItem=function(t,i){e._baseClass.setItem(t,i)},e.getItem=function(t){return e._baseClass.getItem(t)},e.setJSON=function(t,i){e._baseClass.setJSON(t,i)},e.getJSON=function(t){return e._baseClass.getJSON(t)},e.removeItem=function(t){e._baseClass.removeItem(t)},e.clear=function(){e._baseClass.clear()},e._baseClass=null,e.items=null,e.support=!1,e.__init$=function(){i=function(){function e(){}return s(e,""),e.init=function(){try{e.support=!0,e.items=t.localStorage,e.setItem("laya","1"),e.removeItem("laya")}catch(i){e.support=!1}e.support||console.log("LocalStorage is not supprot or browser is private mode.")},e.setItem=function(t,i){try{e.support&&e.items.setItem(t,i)}catch(n){console.warn("set localStorage failed",n)}},e.getItem=function(t){return e.support?e.items.getItem(t):null},e.setJSON=function(t,i){try{e.support&&e.items.setItem(t,JSON.stringify(i))}catch(n){console.warn("set localStorage failed",n)}},e.getJSON=function(t){return JSON.parse(e.support?e.items.getItem(t):null)},e.removeItem=function(t){e.support&&e.items.removeItem(t)},e.clear=function(){e.support&&e.items.clear()},e.items=null,e.support=!1,e}()},e}(),Se=function(){function t(){}s(t,"laya.display.cmd.FillTextureCmd");var e=t.prototype;return e.recover=function(){this.texture=null,this.offset=null,this.other=null,Ji.recover("FillTextureCmd",this)},e.run=function(t,e,i){t.fillTexture(this.texture,this.x+e,this.y+i,this.width,this.height,this.type,this.offset,this.other)},r(0,e,"cmdID",function(){return"FillTexture"}),t.create=function(e,i,n,s,r,a,o,h){var l=Ji.getItemByClass("FillTextureCmd",t);return l.texture=e,l.x=i,l.y=n,l.width=s,l.height=r,l.type=a,l.offset=o,l.other=h,l},t.ID="FillTexture",t}(),Ae=function(){function t(){}s(t,"laya.display.cmd.DrawPathCmd");var e=t.prototype;return e.recover=function(){this.paths=null,this.brush=null,this.pen=null,Ji.recover("DrawPathCmd",this)},e.run=function(t,e,i){t._drawPath(this.x+e,this.y+i,this.paths,this.brush,this.pen)},r(0,e,"cmdID",function(){return"DrawPath"}),t.create=function(e,i,n,s,r){var a=Ji.getItemByClass("DrawPathCmd",t);return a.x=e,a.y=i,a.paths=n,a.brush=s,a.pen=r,a},t.ID="DrawPath",t}(),Ce=function(){function t(){this._obj=null,this._obj=t.supportWeakMap?new Be.window.WeakMap:{},t.supportWeakMap||t._maps.push(this)}s(t,"laya.utils.WeakObject");var e=t.prototype;return e.set=function(e,i){if(null!=e)if(t.supportWeakMap){var n=e;("string"==typeof e||"number"==typeof e)&&(n=t._keys[e],n||(n=t._keys[e]={k:e})),this._obj.set(n,i)}else"string"==typeof e||"number"==typeof e?this._obj[e]=i:(e.$_GID||(e.$_GID=ee.getGID()),this._obj[e.$_GID]=i)},e.get=function(e){if(null==e)return null;if(t.supportWeakMap){var i="string"==typeof e||"number"==typeof e?t._keys[e]:e;return i?this._obj.get(i):null}return"string"==typeof e||"number"==typeof e?this._obj[e]:this._obj[e.$_GID]},e.del=function(e){if(null!=e)if(t.supportWeakMap){var i="string"==typeof e||"number"==typeof e?t._keys[e]:e;if(!i)return;this._obj.delete(i)}else"string"==typeof e||"number"==typeof e?delete this._obj[e]:delete this._obj[this._obj.$_GID]},e.has=function(e){if(null==e)return!1;if(t.supportWeakMap){var i="string"==typeof e||"number"==typeof e?t._keys[e]:e;return this._obj.has(i)}return"string"==typeof e||"number"==typeof e?null!=this._obj[e]:null!=this._obj[this._obj.$_GID]},t.__init__=function(){t.supportWeakMap=null!=Be.window.WeakMap,t.supportWeakMap||i.systemTimer.loop(t.delInterval,null,t.clearCache)},t.clearCache=function(){for(var e=0,i=t._maps.length;i>e;e++){var n=t._maps[e];n._obj={}}},t.supportWeakMap=!1,t.delInterval=6e5,t._keys={},t._maps=[],n(t,["I",function(){return this.I=new t}]),t}(),De=function(){function t(){}return s(t,"laya.html.utils.HTMLParse"),t.getInstance=function(e){var i=Ji.getItem(t._htmlClassMapShort[e]);return i||(i=Pe.getInstance(e)),i},t.parse=function(e,i,n){i=i.replace(/<br>/g,"<br/>"),i="<root>"+i+"</root>",i=i.replace(t.spacePattern,t.char255);var s=ee.parseXMLFromString(i);t._parseXML(e,s.childNodes[0].childNodes,n)},t._parseXML=function(e,i,n,s){var r=0,a=0;if(i.join||i.item)for(r=0,a=i.length;a>r;++r)t._parseXML(e,i[r],n,s);else{var o,h;if(3==i.nodeType){var l;return e instanceof laya.html.dom.HTMLDivParser?(null==i.nodeName&&(i.nodeName="#text"),h=i.nodeName.toLowerCase(),l=i.textContent.replace(/^\s+|\s+$/g,""),l.length>0&&(o=t.getInstance(h),o&&(e.addChild(o),o.innerTEXT=l.replace(t.char255AndOneSpacePattern," ")))):(l=i.textContent.replace(/^\s+|\s+$/g,""),l.length>0&&(e.innerTEXT=l.replace(t.char255AndOneSpacePattern," "))),void 0}if(h=i.nodeName.toLowerCase(),"#comment"==h)return;if(o=t.getInstance(h)){"p"==h?(e.addChild(t.getInstance("br")),o=e.addChild(o),e.addChild(t.getInstance("br"))):o=e.addChild(o),o.URI=n,o.href=s;var _=i.attributes;if(_&&_.length>0)for(r=0,a=_.length;a>r;++r){var u=_[r],c=u.nodeName,d=u.value;o._setAttributes(c,d)}t._parseXML(o,i.childNodes,n,o.href)}else t._parseXML(e,i.childNodes,n,s)}},t.char255=String.fromCharCode(255),t.spacePattern=/&nbsp;|&#160;/g,t.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),t._htmlClassMapShort={div:"HTMLDivParser",p:"HTMLElement",img:"HTMLImageElement",span:"HTMLElement",br:"HTMLBrElement",style:"HTMLStyleElement",font:"HTMLElement",a:"HTMLElement","#text":"HTMLElement",link:"HTMLLinkElement"},t}(),xe=(function(){function t(t,e){this.submitStartPos=0,this.submitEndPos=0,this.context=null,this.touches=[],this.submits=[],this.sprite=null,this._mesh=null,this._pathMesh=null,this._triangleMesh=null,this.meshlist=[],this._oldMesh=null,this._oldPathMesh=null,this._oldTriMesh=null,this._oldMeshList=null,this.oldMatrix=null,this.cachedClipInfo=new fi,this.context=t,this.sprite=e,t._globalClipMatrix.copyTo(this.cachedClipInfo)}s(t,"laya.webgl.canvas.WebGLCacheAsNormalCanvas");var e=t.prototype;return e.startRec=function(){this.touches.length=0,this.context.touches=this.touches,this.context._globalClipMatrix.copyTo(this.cachedClipInfo),this.submits.length=0,this.submitStartPos=this.context._submits._length;for(var e=0,i=this.meshlist.length;i>e;e++){var n=this.meshlist[e];n.canReuse?n.releaseMesh():n.destroy()}this.meshlist.length=0,this._mesh=In.getAMesh(),this._pathMesh=vn.getAMesh(),this._triangleMesh=bn.getAMesh(),this.meshlist.push(this._mesh),this.meshlist.push(this._pathMesh),this.meshlist.push(this._triangleMesh),this.context._curSubmit=K.RENDERBASE,this._oldMesh=this.context._mesh,this._oldPathMesh=this.context._pathMesh,this._oldTriMesh=this.context._triangleMesh,this._oldMeshList=this.context.meshlist,this.context._mesh=this._mesh,this.context._pathMesh=this._pathMesh,this.context._triangleMesh=this._triangleMesh,this.context.meshlist=this.meshlist,this.oldMatrix=this.context._curMat,this.context._curMat=t.matI},e.endRec=function(){var t=this.context._submits;this.submitEndPos=t._length;for(var e=this.submitEndPos-this.submitStartPos,i=0;e>i;i++)this.submits.push(t[this.submitStartPos+i]);t._length-=e,this.context._mesh=this._oldMesh,this.context._pathMesh=this._oldPathMesh,this.context._triangleMesh=this._oldTriMesh,this.context.meshlist=this._oldMeshList,this.context._curSubmit=K.RENDERBASE,this.context._curMat=this.oldMatrix,this.context.touches=null},e.isCacheValid=function(){var t=this.context._globalClipMatrix;return t.a!=this.cachedClipInfo.a||t.b!=this.cachedClipInfo.b||t.c!=this.cachedClipInfo.c||t.d!=this.cachedClipInfo.d||t.tx!=this.cachedClipInfo.tx||t.ty!=this.cachedClipInfo.ty?!1:!0},e.flushsubmit=function(){var t=K.RENDERBASE;this.submits.forEach(function(e){e!=K.RENDERBASE&&(K.preRender=t,t=e,e.renderSubmit())})},e.releaseMem=function(){},n(t,["matI",function(){return this.matI=new fi}]),t}(),function(){function t(){this.fontPages=[],this.fontPagesName=[],this._curPage=null,this.tempUV=[0,0,1,0,1,1,0,1],this.fontScaleX=1,this.fontScaleY=1,this._curStrPos=0,this.tempMat=new fi;var e=!1,n=i.MiniAdpter;n&&n.systemInfo&&n.systemInfo.system&&(e="ios 10.1.1"===n.systemInfo.system.toLowerCase()),Be.onMiniGame&&!e&&(t.isWan1Wan=!0),t.charbookInst=this,Ue.charRender=Ni.isConchApp?new Pn:new Rn}var e;s(t,"laya.webgl.resource.CharBook");var r=t.prototype;return r.selectFont=function(e,i){var n,s=Math.max(this.fontScaleX,this.fontScaleY),r=i*s;if(e===t._lastFont&&r===t._lastFontSz)n=t._lastCharPage;else{var a=Ue.getBmpSize(i)*s,o=Math.floor(a/t.gridSize),h=e+o,l=this.fontPagesName.indexOf(h);if(0>l){var _=new Ue(e,a,Ni.isConchApp?0:Math.ceil(i/4));this.fontPages.push(_),this.fontPagesName.push(h),n=_}else n=this.fontPages[l];n.selectSize(i,a),t._lastFont=e,t._lastFontSz=r,t._lastCharPage=n}return n},r.isEmoji=function(e){return t._emojiReg.test(e)},r.getNextChar=function(t){var e=t.length,i=this._curStrPos;if(i>=e)return null;for(var n=i,s=0;e>n;n++){var r=t.charCodeAt(n);if(r>>>11==27){if(0==s)s=1;else if(1==s)break;n++}else if(65038===r||65039===r);else if(8205==r)s=2;else if(0==s)s=1;else if(1==s)break}return this._curStrPos=n,t.substring(i,n)},r.hasFreedText=function(t,e){if(t&&t.length>0)for(var i=e,n=t.length;n>i;i++){var s=t[i];if(s)for(var r=0,a=s.length;a>r;r++){var o=s[r].ri;if(o.deleted||o.tex.__destroyed)return!0}}return!1},r._fast_filltext=function(e,i,n,s,r,a,o,h,l,_,u){if(void 0===u&&(u=0),!(i&&i.length<1||n&&n.length<1)){if(t._curFont=a._font,this.fontScaleX=this.fontScaleY=1,t.scaleFontWithCtx){var c=e.getMatScaleX(),d=e.getMatScaleY();if(1e-4>c||.1>d)return;c>1&&(this.fontScaleX=c),d>1&&(this.fontScaleY=d)}a._italic&&(e._italicDeg=12),this._curPage=this.selectFont(a._family,a._size);var f=s,p=i,m=i,g=0,v=!n&&i instanceof laya.utils.WordText,y=!!n,E=t.cacheRenderInfoInWordText&&v?p.pageChars:[];switch(v?(m=p._text,g=p.width,0>g&&(g=p.width=this._curPage.getWidth(m))):g=this._curPage.getWidth(m),_){case N.ENUM_TEXTALIGN_CENTER:f=s-g/2;break;case N.ENUM_TEXTALIGN_RIGHT:f=s-g;break;default:f=s}p&&p.lastGCCnt!=this._curPage.gcCnt&&(p.lastGCCnt=this._curPage.gcCnt,this.hasFreedText(E,p.startID)&&(E=p.pageChars=[]));var S=v?p.startID:0,A=v?p.startIDStroke:0;if(!E||E.length<1){var C=null;t.scaleFontWithCtx&&(Ue.charRender.scale(Math.max(this.fontScaleX,1),Math.max(this.fontScaleY,1)),(this.fontScaleX>1||this.fontScaleY>1)&&(C=""+(10*this.fontScaleX|0)+(10*this.fontScaleY|0))),S=-1,A=-1;var D=0,x=0;this._curStrPos=0;var R;if(y){var T=n[this._curStrPos++];R=T.char,D=T.x,x=T.y}else R=this.getNextChar(m);for(var b=a._bold;R;){var P,L=this.isEmoji(R);if(P=this._curPage.getChar(R,l,a._size,o,h,b,!1,C),!P)break;if(P.char=R,P.isSpace);else{var I=E[P.tex.id];I||(E[P.tex.id]=I=[],(0>S||S>P.tex.id)&&(S=P.tex.id)),I.push({ri:P,isEmoji:L,x:D,y:x,w:P.bmpWidth/this.fontScaleX,h:P.bmpHeight/this.fontScaleY})}y?(T=n[this._curStrPos++],T?(R=T.char,D=T.x,x=T.y):R=null):(R=this.getNextChar(m),D+=P.width)}v&&(p.startID=S,p.startIDStroke=A)}this._drawResortedWords(e,f,E,S,r),e._italicDeg=0}},r.fillWords=function(e,i,n,s,r,a,h,l){if(i&&!(i.length<=0)){var _=o.create(a).numColor,u=h?o.create(h).numColor:0;t._curFont=r;var c=de.Parse(r);this._fast_filltext(e,null,i,n,s,c,_,u,l,0,0)}},r.filltext=function(e,i,n,s,r,a,h,l,_,u){if(void 0===u&&(u=0),!(i.length<=0)){var c=o.create(a).numColor,d=h?o.create(h).numColor:0;t._curFont=r;var f=de.Parse(r),p=0;switch(_){case"center":p=N.ENUM_TEXTALIGN_CENTER;break;case"right":p=N.ENUM_TEXTALIGN_RIGHT}this._fast_filltext(e,i,null,n,s,f,c,d,l,p,u)}},r.filltext_native=function(e,i,n,s,r,a,h,l,_,u,c){if(void 0===c&&(c=0),!(i&&i.length<=0)){var d=o.create(h).numColor,f=l?o.create(l).numColor:0;if(t._curFont=a,this.fontScaleX=this.fontScaleY=1,t.scaleFontWithCtx){var p=e._curMat.getScaleX(),m=e._curMat.getScaleY();if(1e-4>p||.1>m)return;this.fontScaleX=p,this.fontScaleY=m,Ue.charRender.scale(this.fontScaleX,this.fontScaleY)}var g=de.Parse(a),v=g._family,y=g._bold;g._italic&&(e._italicDeg=12),this._curPage=this.selectFont(v,g._size*this.fontScaleX);var E=s,S=i,A=i,C=0,D=!n&&A instanceof laya.utils.WordText,x=!!n,R=t.cacheRenderInfoInWordText&&D?S.pageChars:[];switch(D?(A=S.toString(),C=S.width,0>C&&(C=S.width=this._curPage.getWidth(A))):C=this._curPage.getWidth(A),u){case"center":E=s-C/2;break;case"right":E=s-C;break;default:E=s}if(R){for(var T=!1,b=0,P=R.length;P>b;b++){var L=R[b];if(L){for(var I=0,M=L.length;M>I;I++){var w=L[I];if(w.ri.tex.__destroyed){T=!0;break}}if(T)break}}T&&(R=S.pageChars=[])}if(!R||R.length<=0){var O=null;t.scaleFontWithCtx&&(Ue.charRender.scale(Math.max(this.fontScaleX,1),Math.max(this.fontScaleY,1)),(this.fontScaleX>1||this.fontScaleY>1)&&(O=""+(10*this.fontScaleX|0)+(10*this.fontScaleY|0)));var B=0,N=0;this._curStrPos=0;var k;if(x){var F=n[this._curStrPos++];k=F.char,B=F.x,N=F.y}else k=this.getNextChar(A);for(y=g._bold;k;){var V,U=this.isEmoji(k);if(V=this._curPage.getChar(k,_,g._size,d,f,y,!1,O),V.isSpace);else{var W=R[V.tex.id];W||(R[V.tex.id]=W=[]),W.push({ri:V,isEmoji:U,x:B,y:N,color:h,nColor:d})}x?(F=n[this._curStrPos++],F?(k=F.char,B=F.x,N=F.y):k=null):(B+=V.width,k=this.getNextChar(A))}}var G=e._drawTextureUseColor;this._drawResortedWords_native(e,E,R,r),e._drawTextureUseColor=G,e._italicDeg=0}},r._drawResortedWords=function(t,e,i,n,s){var r=t.getFillColor();t.setFillColor(t.mixRGBandAlpha(16777215)),e-=this._curPage.margin_left,s-=this._curPage.margin_top;for(var a=n,o=i.length;o>a;a++){var h=i[a];if(h){var l=h.length;if(!(0>=l))for(var _=0;l>_;_++){var u=h[_],c=u.ri;c.isSpace||(c.touch(),t.drawTexAlign=!0,t._drawTextureM(c.tex.texture,e+u.x,s+u.y,u.w,u.h,null,1,c.uv),t.touches&&t.touches.push(c))}}}t.setFillColor(r)},r._drawResortedWords_native=function(t,e,i,n){for(var s=0,r=0,a=i.length;a>r;r++){var o=i[r];if(o)for(var h=0,l=o.length;l>h;h++){var _=o[h],u=_.ri;u.isSpace||(t._drawTextureUseColor=!1,s!=_.nColor&&(t.fillStyle=_.color,s=_.nColor),u.touch(),this._drawCharRenderInfo(t,_.ri,e+_.x,_.y+n))}}},r._drawCharRenderInfo=function(t,e,i,n){t._drawTextureM(e.tex.texture,i-this._curPage.margin_left,n-this._curPage.margin_top,e.bmpWidth,e.bmpHeight,null,1,e.uv),t.touches&&t.touches.push(e)},r.GC=function(){var t=this.fontPages.length;if(t){var e=wi.loopCount%t;this.fontPages[e].removeLRU()}},t.textureWidth=512,t.cacheRenderInfoInWordText=!0,t.scaleFontWithCtx=!0,t.gridSize=16,t.debug=!1,t._curFont=null,t.charbookInst=null,t._fontMem=0,t._lastFont=null,t._lastFontSz=0,t._lastCharPage=null,t.isWan1Wan=!1,n(t,["_emojiReg",function(){return this._emojiReg=/(?:0\u20E3|1\u20E3|2\u20E3|3\u20E3|4\u20E3|5\u20E3|6\u20E3|7\u20E3|8\u20E3|9\u20E3|#\u20E3|\*\u20E3|\uD83C(?:\uDDE6\uD83C(?:\uDDE8|\uDDE9|\uDDEA|\uDDEB|\uDDEC|\uDDEE|\uDDF1|\uDDF2|\uDDF4|\uDDF6|\uDDF7|\uDDF8|\uDDF9|\uDDFA|\uDDFC|\uDDFD|\uDDFF)|\uDDE7\uD83C(?:\uDDE6|\uDDE7|\uDDE9|\uDDEA|\uDDEB|\uDDEC|\uDDED|\uDDEE|\uDDEF|\uDDF1|\uDDF2|\uDDF3|\uDDF4|\uDDF6|\uDDF7|\uDDF8|\uDDF9|\uDDFB|\uDDFC|\uDDFE|\uDDFF)|\uDDE8\uD83C(?:\uDDE6|\uDDE8|\uDDE9|\uDDEB|\uDDEC|\uDDED|\uDDEE|\uDDF0|\uDDF1|\uDDF2|\uDDF3|\uDDF4|\uDDF5|\uDDF7|\uDDFA|\uDDFB|\uDDFC|\uDDFD|\uDDFE|\uDDFF)|\uDDE9\uD83C(?:\uDDEA|\uDDEC|\uDDEF|\uDDF0|\uDDF2|\uDDF4|\uDDFF)|\uDDEA\uD83C(?:\uDDE6|\uDDE8|\uDDEA|\uDDEC|\uDDED|\uDDF7|\uDDF8|\uDDF9|\uDDFA)|\uDDEB\uD83C(?:\uDDEE|\uDDEF|\uDDF0|\uDDF2|\uDDF4|\uDDF7)|\uDDEC\uD83C(?:\uDDE6|\uDDE7|\uDDE9|\uDDEA|\uDDEB|\uDDEC|\uDDED|\uDDEE|\uDDF1|\uDDF2|\uDDF3|\uDDF5|\uDDF6|\uDDF7|\uDDF8|\uDDF9|\uDDFA|\uDDFC|\uDDFE)|\uDDED\uD83C(?:\uDDF0|\uDDF2|\uDDF3|\uDDF7|\uDDF9|\uDDFA)|\uDDEE\uD83C(?:\uDDE8|\uDDE9|\uDDEA|\uDDF1|\uDDF2|\uDDF3|\uDDF4|\uDDF6|\uDDF7|\uDDF8|\uDDF9)|\uDDEF\uD83C(?:\uDDEA|\uDDF2|\uDDF4|\uDDF5)|\uDDF0\uD83C(?:\uDDEA|\uDDEC|\uDDED|\uDDEE|\uDDF2|\uDDF3|\uDDF5|\uDDF7|\uDDFC|\uDDFE|\uDDFF)|\uDDF1\uD83C(?:\uDDE6|\uDDE7|\uDDE8|\uDDEE|\uDDF0|\uDDF7|\uDDF8|\uDDF9|\uDDFA|\uDDFB|\uDDFE)|\uDDF2\uD83C(?:\uDDE6|\uDDE8|\uDDE9|\uDDEA|\uDDEB|\uDDEC|\uDDED|\uDDF0|\uDDF1|\uDDF2|\uDDF3|\uDDF4|\uDDF5|\uDDF6|\uDDF7|\uDDF8|\uDDF9|\uDDFA|\uDDFB|\uDDFC|\uDDFD|\uDDFE|\uDDFF)|\uDDF3\uD83C(?:\uDDE6|\uDDE8|\uDDEA|\uDDEB|\uDDEC|\uDDEE|\uDDF1|\uDDF4|\uDDF5|\uDDF7|\uDDFA|\uDDFF)|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C(?:\uDDE6|\uDDEA|\uDDEB|\uDDEC|\uDDED|\uDDF0|\uDDF1|\uDDF2|\uDDF3|\uDDF7|\uDDF8|\uDDF9|\uDDFC|\uDDFE)|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C(?:\uDDEA|\uDDF4|\uDDF8|\uDDFA|\uDDFC)|\uDDF8\uD83C(?:\uDDE6|\uDDE7|\uDDE8|\uDDE9|\uDDEA|\uDDEC|\uDDED|\uDDEE|\uDDEF|\uDDF0|\uDDF1|\uDDF2|\uDDF3|\uDDF4|\uDDF7|\uDDF8|\uDDF9|\uDDFB|\uDDFD|\uDDFE|\uDDFF)|\uDDF9\uD83C(?:\uDDE6|\uDDE8|\uDDE9|\uDDEB|\uDDEC|\uDDED|\uDDEF|\uDDF0|\uDDF1|\uDDF2|\uDDF3|\uDDF4|\uDDF7|\uDDF9|\uDDFB|\uDDFC|\uDDFF)|\uDDFA\uD83C(?:\uDDE6|\uDDEC|\uDDF2|\uDDF8|\uDDFE|\uDDFF)|\uDDFB\uD83C(?:\uDDE6|\uDDE8|\uDDEA|\uDDEC|\uDDEE|\uDDF3|\uDDFA)|\uDDFC\uD83C(?:\uDDEB|\uDDF8)|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C(?:\uDDEA|\uDDF9)|\uDDFF\uD83C(?:\uDDE6|\uDDF2|\uDDFC)))|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2694\u2696\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD79\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED0\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3]|\uD83E[\uDD10-\uDD18\uDD80-\uDD84\uDDC0]/g},"_uint32",function(){return this._uint32=new Uint32Array(1)},"trash",function(){return this.trash=new e(t.textureWidth)}]),t.__init$=function(){e=function(){function t(t){this.poolLen=0,this.cleanTm=0,this.texW=0,this.pool=new Array(10),this.texW=t}s(t,"");var e=t.prototype;return e.getAPage=function(t){if(this.poolLen>0){var e=this.pool[--this.poolLen];return e.setGridNum(t),this.poolLen>0&&this.clean(),e}return new Es(this.texW,this.texW,t)},e.discardPage=function(t){this.clean(),t&&(t.genID++,this.poolLen>=this.pool.length&&(this.pool=this.pool.concat(new Array(10))),t.reset(),this.pool[this.poolLen++]=t)},e.clean=function(){var t=i.stage.getFrameTm();if(0===this.cleanTm&&(this.cleanTm=t),t-this.cleanTm>3e4){for(var e=0;e<this.poolLen;e++){var n=this.pool[e];t-n._discardTm>2e4&&(n.destroy(),this.pool[e]=this.pool[this.poolLen-1],this.poolLen--,e--)}this.cleanTm=t}},t}()},t}()),Re=function(){function t(){this._commandEncoder=null}s(t,"laya.layagl.ConchGraphicsAdpt");var e=t.prototype;return e._createData=function(){this._commandEncoder=we.instance.createCommandEncoder(128,64,!0)},e._clearData=function(){this._commandEncoder&&this._commandEncoder.clearEncoding()},e._destroyData=function(){this._commandEncoder&&(this._commandEncoder.clearEncoding(),this._commandEncoder=null)},t.__init__=function(){var e=ze.prototype,i=t.prototype,n=["_createData","_clearData","_destroyData"],s=0,r=0;r=n.length;var a;for(s=0;r>s;s++)a=n[s],e[a]=i[a]},t}(),Te=function(){function t(){}s(t,"laya.display.css.BoundsStyle");var e=t.prototype;return e.reset=function(){return this.bounds&&this.bounds.recover(),this.userBounds&&this.userBounds.recover(),this.bounds=null,this.userBounds=null,this.temBM=null,this},e.recover=function(){Ji.recover("BoundsStyle",this.reset())},t.create=function(){return Ji.getItemByClass("BoundsStyle",t)},t}(),be=(function(){function t(){}return s(t,"laya.display.SpriteConst"),t.POSRENDERTYPE=0,t.POSBUFFERBEGIN=1,t.POSBUFFEREND=2,t.POSFRAMECOUNT=3,t.POSREPAINT=4,t.POSVISIBLE_NATIVE=5,t.POSX=6,t.POSY=7,t.POSPIVOTX=8,t.POSPIVOTY=9,t.POSSCALEX=10,t.POSSCALEY=11,t.POSSKEWX=12,t.POSSKEWY=13,t.POSROTATION=14,t.POSTRANSFORM_FLAG=15,t.POSMATRIX=16,t.POSCOLOR=22,t.POSGRAPICS=23,t.POSSIM_TEXTURE_ID=24,t.POSSIM_TEXTURE_DATA=25,t.POSLAYAGL3D=26,t.POSCUSTOM=27,t.POSCLIP=28,t.POSCLIP_NEG_POS=32,t.POSCOLORFILTER_COLOR=34,t.POSCOLORFILTER_ALPHA=50,t.POSCALLBACK_OBJ_ID=54,t.POSCUSTOM_CALLBACK_FUN_ID=55,t.POSCANVAS_CALLBACK_FUN_ID=56,t.POSCANVAS_CALLBACK_END_FUN_ID=57,t.POSCANVAS_BEGIN_CMD_ID=58,t.POSCANVAS_END_CMD_ID=59,t.POSCANVAS_DRAW_TARGET_CMD_ID=60,t.POSCANVAS_DRAW_TARGET_PARAM_ID=61,t.POSLAYA3D_FUN_ID=62,t.POSCACHE_CANVAS_SKIP_PAINT_FLAG=63,t.POSFILTER_BEGIN_CMD_ID=64,t.POSFILTER_CALLBACK_FUN_ID=65,t.POSFILTER_END_CMD_ID=66,t.POSFILTER_END_CALLBACK_FUN_ID=67,t.POSGRAPHICS_CALLBACK_FUN_ID=68,t.POSMASK_CALLBACK_FUN_ID=69,t.POSMASK_CMD_ID=70,t.POSBLEND_SRC=71,t.POSBLEND_DEST=72,t.POSSIM_RECT_FILL_CMD=73,t.POSSIM_RECT_FILL_DATA=74,t.POSSIM_RECT_STROKE_CMD=75,t.POSSIM_RECT_STROKE_DATA=76,t.POSSIZE=77,t.ALPHA=1,t.TRANSFORM=2,t.BLEND=4,t.CANVAS=8,t.FILTERS=16,t.MASK=32,t.CLIP=64,t.STYLE=128,t.TEXTURE=256,t.GRAPHICS=512,t.LAYAGL3D=1024,t.CUSTOM=2048,t.ONECHILD=4096,t.CHILDS=8192,t.REPAINT_NONE=0,t.REPAINT_NODE=1,t.REPAINT_CACHE=2,t.REPAINT_ALL=3,t}(),function(){function t(){}return s(t,"laya.system.System"),t.changeDefinition=function(t,e){i[t]=e;var n=t+"=classObj";i._runScript(n)},t.__init__=function(){},t}()),Pe=function(){function t(){}return s(t,"laya.utils.ClassUtils"),t.regClass=function(e,i){t._classMap[e]=i},t.regShortClassName=function(e){for(var i=0;i<e.length;i++){var n=e[i],s=n.name;t._classMap[s]=n}},t.getRegClass=function(e){return t._classMap[e]},t.getClass=function(e){var n=t._classMap[e]||e;return"string"==typeof n?i.__classmap[n]||i[e]:n},t.getInstance=function(e){var i=t.getClass(e);return i?new i:(console.warn("[error] Undefined class:",e),null)},t.createByJson=function(e,i,n,s,r){"string"==typeof e&&(e=JSON.parse(e));var a=e.props;if(!i&&(i=r?r.runWith(e):t.getInstance(a.runtime||e.type),!i))return null;var o=e.child;if(o)for(var h=0,l=o.length;l>h;h++){var _=o[h];if("render"!==_.props.name&&"render"!==_.props.renderType||!i._$set_itemRender)if("Graphic"==_.type)t._addGraphicsToSprite(_,i);else if(t._isDrawType(_.type))t._addGraphicToSprite(_,i,!0);else{var u=t.createByJson(_,null,n,s,r);"Script"===_.type?u.hasOwnProperty("owner")?u.owner=i:u.hasOwnProperty("target")&&(u.target=i):"mask"==_.props.renderType?i.mask=u:i.addChild(u)}else i.itemRender=_}if(a)for(var c in a){var d=a[c];"var"===c&&n?n[d]=i:d instanceof Array&&"function"==typeof i[c]?i[c].apply(i,d):i[c]=d}return s&&e.customProps&&s.runWith([i,e]),i.created&&i.created(),i},t._addGraphicsToSprite=function(e,i){var n=e.child;if(n&&!(n.length<1)){var s=t._getGraphicsFromSprite(e,i),r=0,a=0;e.props&&(r=t._getObjVar(e.props,"x",0),a=t._getObjVar(e.props,"y",0)),0!=r&&0!=a&&s.translate(r,a);var o=0,h=0;for(h=n.length,o=0;h>o;o++)t._addGraphicToGraphics(n[o],s);0!=r&&0!=a&&s.translate(-r,-a)}},t._addGraphicToSprite=function(e,i,n){void 0===n&&(n=!1);var s=n?t._getGraphicsFromSprite(e,i):i.graphics;t._addGraphicToGraphics(e,s)},t._getGraphicsFromSprite=function(t,e){if(!t||!t.props)return e.graphics;var i=t.props.renderType;if("hit"===i||"unHit"===i){var n=e._style.hitArea||(e.hitArea=new Ri);n[i]||(n[i]=new ze);var s=n[i]}return s||(s=e.graphics),s},t._getTransformData=function(e){var i;(e.hasOwnProperty("pivotX")||e.hasOwnProperty("pivotY"))&&(i=i||new fi,i.translate(-t._getObjVar(e,"pivotX",0),-t._getObjVar(e,"pivotY",0)));{var n=t._getObjVar(e,"scaleX",1),s=t._getObjVar(e,"scaleY",1),r=t._getObjVar(e,"rotation",0);t._getObjVar(e,"skewX",0),t._getObjVar(e,"skewY",0)}return(1!=n||1!=s||0!=r)&&(i=i||new fi,i.scale(n,s),i.rotate(.0174532922222222*r)),i},t._addGraphicToGraphics=function(e,i){var n;if(n=e.props){var s;if(s=t.DrawTypeDic[e.type]){var r=i,a=t._getParams(n,s[1],s[2],s[3]),o=t._tM;(o||1!=t._alpha)&&(r.save(),o&&r.transform(o),1!=t._alpha&&r.alpha(t._alpha)),r[s[0]].apply(r,a),(o||1!=t._alpha)&&r.restore()}}},t._adptLineData=function(t){return t[2]=parseFloat(t[0])+parseFloat(t[2]),t[3]=parseFloat(t[1])+parseFloat(t[3]),t},t._adptTextureData=function(t){return t[0]=un.getRes(t[0]),t},t._adptLinesData=function(e){return e[2]=t._getPointListByStr(e[2]),e},t._isDrawType=function(e){return"Image"===e?!1:t.DrawTypeDic.hasOwnProperty(e)},t._getParams=function(e,i,n,s){void 0===n&&(n=0);var r=t._temParam;r.length=i.length;var a=0,o=0;for(o=i.length,a=0;o>a;a++)r[a]=t._getObjVar(e,i[a][0],i[a][1]);t._alpha=t._getObjVar(e,"alpha",1);var h;return h=t._getTransformData(e),h?(n||(n=0),h.translate(r[n],r[n+1]),r[n]=r[n+1]=0,t._tM=h):t._tM=null,s&&t[s]&&(r=t[s](r)),r},t._getPointListByStr=function(t){var e=t.split(","),i=0,n=0;for(n=e.length,i=0;n>i;i++)e[i]=parseFloat(e[i]);return e},t._getObjVar=function(t,e,i){return t.hasOwnProperty(e)?t[e]:i},t._temParam=[],t._classMap={Sprite:kn,Scene:Ss,Text:Cs,Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivParser",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement",link:"laya.html.dom.HTMLLinkElement"},t._tM=null,t._alpha=0/0,n(t,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),t}(),Le=(function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._paramData=null,this._texture=null,this._x=0/0,this._y=0/0,this._width=0/0,this._height=0/0,this._matrix=null,this._alpha=0/0,this._color=null,this._blendMode=null,this._cmdCurrentPos=0,this._blend_src=0,this._blend_dest=0}s(t,"laya.layagl.cmdNative.DrawTextureCmdNative");var e=t.prototype;return e.recover=function(){this._texture=null,Ji.recover("DrawTextureCmd",this)},e._setBlendMode=function(t){switch(t){case"normal":this._blend_src=1,this._blend_dest=771;break;case"add":this._blend_src=1,this._blend_dest=772;break;case"multiply":this._blend_src=774,this._blend_dest=771;break;case"screen":this._blend_src=1,this._blend_dest=1;break;case"light":this._blend_src=1,this._blend_dest=1;break;case"overlay":this._blend_src=1,this._blend_dest=769;break;case"destination-out":this._blend_src=0,this._blend_dest=0;break;case"mask":this._blend_src=0,this._blend_dest=770;break;default:alert("_setBlendMode Unknown type")}},e._mixRGBandAlpha=function(t,e){var i=(4278190080&t)>>>24;return 0!=i?i*=e:i=255*e,16777215&t|i<<24},r(0,e,"cmdID",function(){return"DrawTexture"}),r(0,e,"matrix",function(){return this._matrix},function(e){this._matrix||(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.getPtrID(),we.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._matrix=e;var i=this._paramData._float32Data;i[t._PARAM_MATRIX_POS_]=e.a,i[t._PARAM_MATRIX_POS_+1]=e.b,i[t._PARAM_MATRIX_POS_+2]=e.c,i[t._PARAM_MATRIX_POS_+3]=e.d,i[t._PARAM_MATRIX_POS_+4]=e.tx,i[t._PARAM_MATRIX_POS_+5]=e.ty,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"y",function(){return this._y},function(e){this._y=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"texture",function(){return this._texture},function(e){if(e&&e.url){this._texture=e,this._paramData._int32Data[t._PARAM_TEXTURE_POS_]=null!=this.texture.bitmap._glTexture?this._texture.bitmap._glTexture.id:0;var i=this._paramData._float32Data,n=this.texture.uv;i[t._PARAM_VB_POS_+2]=n[0],i[t._PARAM_VB_POS_+3]=n[1],i[t._PARAM_VB_POS_+8]=n[2],i[t._PARAM_VB_POS_+9]=n[3],i[t._PARAM_VB_POS_+14]=n[4],i[t._PARAM_VB_POS_+15]=n[5],i[t._PARAM_VB_POS_+20]=n[6],i[t._PARAM_VB_POS_+21]=n[7],we.syncBufferToRenderThread(this._paramData)}}),r(0,e,"width",function(){return this._width},function(e){this._width=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"x",function(){return this._x},function(e){this._x=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"height",function(){return this._height},function(e){this._height=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"alpha",function(){return this._alpha},function(t){this._alpha=t}),t.create=function(e,i,n,s,r,a,o,h,l){var _=Ji.getItemByClass("DrawTextureCmd",t);_._graphicsCmdEncoder=this._commandEncoder,t._DRAW_TEXTURE_CMD_ENCODER_||(t._DRAW_TEXTURE_CMD_ENCODER_=we.instance.createCommandEncoder(188,32,!0),t._DRAW_TEXTURE_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_TEXTURE_CMD_ENCODER_.blendFuncByParamData(4*t._PARAM_BLEND_SRC_POS_,4*t._PARAM_BLEND_DEST_POS_),t._DRAW_TEXTURE_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),t._DRAW_TEXTURE_CMD_ENCODER_.useVDO(he.VDO_MESHQUADTEXTURE),t._DRAW_TEXTURE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_TEXTURE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_TEXTURE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_TEXTURE_CMD_ENCODER_.uniformTextureByParamData(4*t._PARAM_UNIFORM_LOCATION_POS_,4*t._PARAM_TEX_LOCATION_POS_,4*t._PARAM_TEXTURE_POS_),t._DRAW_TEXTURE_CMD_ENCODER_.setRectMeshByParamData(4*t._PARAM_RECT_NUM_POS_,4*t._PARAM_VB_POS_,4*t._PARAM_VB_SIZE_POS_),t._DRAW_TEXTURE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_TEXTURE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_TEXTURE_CMD_ENCODER_)),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_||(t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_=we.instance.createCommandEncoder(224,32,!0),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.blendFuncByParamData(4*t._PARAM_BLEND_SRC_POS_,4*t._PARAM_BLEND_DEST_POS_),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.useVDO(he.VDO_MESHQUADTEXTURE),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.save(),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.setGlobalValueByParamData(he.GLOBALVALUE_MATRIX32,7,4*t._PARAM_MATRIX_POS_),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.uniformTextureByParamData(4*t._PARAM_UNIFORM_LOCATION_POS_,4*t._PARAM_TEX_LOCATION_POS_,4*t._PARAM_TEXTURE_POS_),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.setRectMeshByParamData(4*t._PARAM_RECT_NUM_POS_,4*t._PARAM_VB_POS_,4*t._PARAM_VB_SIZE_POS_),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.restore(),we.syncBufferToRenderThread(t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_)),_._paramData||(_._paramData=new ParamData(148,!0)),_._texture=e,_._x=i,_._y=n,_._width=s,_._height=r,_._matrix=a,_._alpha=o,_._color=h,_._blendMode=l;
var u=0!=s?s:e.bitmap.width,c=0!=r?r:e.bitmap.height,d=e.uv,f=_._paramData._float32Data,p=_._paramData._int32Data;p[t._PARAM_UNIFORM_LOCATION_POS_]=3,p[t._PARAM_TEX_LOCATION_POS_]=33984,p[t._PARAM_TEXTURE_POS_]=null!=e.bitmap._glTexture?e.bitmap._glTexture.id:0,p[t._PARAM_RECT_NUM_POS_]=1,p[t._PARAM_VB_SIZE_POS_]=96,l?(_._setBlendMode(l),p[t._PARAM_BLEND_SRC_POS_]=_._blend_src,p[t._PARAM_BLEND_DEST_POS_]=_._blend_dest):(p[t._PARAM_BLEND_SRC_POS_]=-1,p[t._PARAM_BLEND_DEST_POS_]=-1);var m=4294967295;o&&(m=_._mixRGBandAlpha(m,o));var g=t._PARAM_VB_POS_;return f[g++]=i,f[g++]=n,f[g++]=d[0],f[g++]=d[1],p[g++]=m,p[g++]=4294967295,f[g++]=i+u,f[g++]=n,f[g++]=d[2],f[g++]=d[3],p[g++]=m,p[g++]=4294967295,f[g++]=i+u,f[g++]=n+c,f[g++]=d[4],f[g++]=d[5],p[g++]=m,p[g++]=4294967295,f[g++]=i,f[g++]=n+c,f[g++]=d[6],f[g++]=d[7],p[g++]=m,p[g++]=4294967295,a&&(f[t._PARAM_MATRIX_POS_]=a.a,f[t._PARAM_MATRIX_POS_+1]=a.b,f[t._PARAM_MATRIX_POS_+2]=a.c,f[t._PARAM_MATRIX_POS_+3]=a.d,f[t._PARAM_MATRIX_POS_+4]=a.tx,f[t._PARAM_MATRIX_POS_+5]=a.ty),we.syncBufferToRenderThread(_._paramData),_._cmdCurrentPos=a?_._graphicsCmdEncoder.useCommandEncoder(t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_.getPtrID(),_._paramData.getPtrID(),-1):_._graphicsCmdEncoder.useCommandEncoder(t._DRAW_TEXTURE_CMD_ENCODER_.getPtrID(),_._paramData.getPtrID(),-1),we.syncBufferToRenderThread(_._graphicsCmdEncoder),_},t.ID="DrawTexture",t._DRAW_TEXTURE_CMD_ENCODER_=null,t._DRAW_TEXTURE_CMD_ENCODER_MATRIX_=null,t._PARAM_UNIFORM_LOCATION_POS_=0,t._PARAM_TEX_LOCATION_POS_=1,t._PARAM_TEXTURE_POS_=2,t._PARAM_RECT_NUM_POS_=3,t._PARAM_VB_SIZE_POS_=4,t._PARAM_VB_POS_=5,t._PARAM_MATRIX_POS_=29,t._PARAM_BLEND_SRC_POS_=35,t._PARAM_BLEND_DEST_POS_=36,t}(),function(){function t(){this.id=0/0,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null,this.width=-1,this.pageChars=[],this.startID=0,this.startIDStroke=0,this.lastGCCnt=0}s(t,"laya.utils.WordText");var e=t.prototype;return e.setText=function(t){this.changed=!0,this._text=t,this.width=-1,this.pageChars=[]},e.toString=function(){return this._text},e.charCodeAt=function(t){return this._text?this._text.charCodeAt(t):0/0},e.charAt=function(t){return this._text?this._text.charAt(t):null},e.cleanCache=function(){this.pageChars=[],this.startID=0},r(0,e,"length",function(){return this._text?this._text.length:0}),t}()),Ie=function(){function t(){}return s(t,"laya.webgl.utils.CONST3D2D"),t.BYTES_PE=4,t.BYTES_PIDX=2,t.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],t.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],t._TMPARRAY=[],t._OFFSETX=0,t._OFFSETY=0,t}(),Me=function(){function t(){}s(t,"laya.display.cmd.DrawPieCmd");var e=t.prototype;return e.recover=function(){this.fillColor=null,this.lineColor=null,Ji.recover("DrawPieCmd",this)},e.run=function(t,e,i){t._drawPie(this.x+e,this.y+i,this.radius,this._startAngle,this._endAngle,this.fillColor,this.lineColor,this.lineWidth,this.vid)},r(0,e,"startAngle",function(){return 180*this._startAngle/Math.PI},function(t){this._startAngle=t*Math.PI/180}),r(0,e,"cmdID",function(){return"DrawPie"}),r(0,e,"endAngle",function(){return 180*this._endAngle/Math.PI},function(t){this._endAngle=t*Math.PI/180}),t.create=function(e,i,n,s,r,a,o,h,l){var _=Ji.getItemByClass("DrawPieCmd",t);return _.x=e,_.y=i,_.radius=n,_._startAngle=s,_._endAngle=r,_.fillColor=a,_.lineColor=o,_.lineWidth=h,_.vid=l,_},t.ID="DrawPie",t}(),we=function(){function t(){}s(t,"laya.layagl.LayaGL");var e=t.prototype;return e.createCommandEncoder=function(t,e,i){return void 0===t&&(t=128),void 0===e&&(e=64),void 0===i&&(i=!1),new Ye(this,t,e,i)},e.beginCommandEncoding=function(){},e.endCommandEncoding=function(){},e.calcMatrixFromScaleSkewRotation=function(){},e.setGLTemplate=function(){},e.setEndGLTemplate=function(){},e.matrix4x4Multiply=function(){},e.evaluateClipDatasRealTime=function(){},t.getFrameCount=function(){return 0},t.syncBufferToRenderThread=function(t,e){void 0===e&&(e=0)},t.createArrayBufferRef=function(){},t.createArrayBufferRefs=function(){},t.EXECUTE_JS_THREAD_BUFFER=0,t.EXECUTE_RENDER_THREAD_BUFFER=1,t.EXECUTE_COPY_TO_RENDER=2,t.EXECUTE_COPY_TO_RENDER3D=3,t.VALUE_OPERATE_ADD=0,t.VALUE_OPERATE_SUB=1,t.VALUE_OPERATE_MUL=2,t.VALUE_OPERATE_DIV=3,t.VALUE_OPERATE_M2_MUL=4,t.VALUE_OPERATE_M3_MUL=5,t.VALUE_OPERATE_M4_MUL=6,t.VALUE_OPERATE_M32_MUL=7,t.VALUE_OPERATE_SET=8,t.VALUE_OPERATE_M32_TRANSLATE=9,t.VALUE_OPERATE_M32_SCALE=10,t.VALUE_OPERATE_M32_ROTATE=11,t.VALUE_OPERATE_M32_SCALE_PIVOT=12,t.VALUE_OPERATE_M32_ROTATE_PIVOT=13,t.VALUE_OPERATE_M32_TRANSFORM_PIVOT=14,t.VALUE_OPERATE_BYTE4_COLOR_MUL=15,t.ARRAY_BUFFER_TYPE_DATA=0,t.ARRAY_BUFFER_TYPE_CMD=1,t.ARRAY_BUFFER_REF_REFERENCE=0,t.ARRAY_BUFFER_REF_COPY=1,t.UPLOAD_SHADER_UNIFORM_TYPE_ID=0,t.UPLOAD_SHADER_UNIFORM_TYPE_DATA=1,t.instance=null,t}(),Oe=function(){function t(){}return s(t,"laya.maths.MathUtil"),t.subtractVector3=function(t,e,i){i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2]},t.lerp=function(t,e,i){return t*(1-i)+e*i},t.scaleVector3=function(t,e,i){i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e},t.lerpVector3=function(t,e,i,n){var s=t[0],r=t[1],a=t[2];n[0]=s+i*(e[0]-s),n[1]=r+i*(e[1]-r),n[2]=a+i*(e[2]-a)},t.lerpVector4=function(t,e,i,n){var s=t[0],r=t[1],a=t[2],o=t[3];n[0]=s+i*(e[0]-s),n[1]=r+i*(e[1]-r),n[2]=a+i*(e[2]-a),n[3]=o+i*(e[3]-o)},t.slerpQuaternionArray=function(t,e,i,n,s,r,a){var o,h,l,_,u,c=t[e+0],d=t[e+1],f=t[e+2],p=t[e+3],m=i[n+0],g=i[n+1],v=i[n+2],y=i[n+3];return h=c*m+d*g+f*v+p*y,0>h&&(h=-h,m=-m,g=-g,v=-v,y=-y),1-h>1e-6?(o=Math.acos(h),l=Math.sin(o),_=Math.sin((1-s)*o)/l,u=Math.sin(s*o)/l):(_=1-s,u=s),r[a+0]=_*c+u*m,r[a+1]=_*d+u*g,r[a+2]=_*f+u*v,r[a+3]=_*p+u*y,r},t.getRotation=function(t,e,i,n){return Math.atan2(n-e,i-t)/Math.PI*180},t.sortBigFirst=function(t,e){return t==e?0:e>t?1:-1},t.sortSmallFirst=function(t,e){return t==e?0:e>t?-1:1},t.sortNumBigFirst=function(t,e){return parseFloat(e)-parseFloat(t)},t.sortNumSmallFirst=function(t,e){return parseFloat(t)-parseFloat(e)},t.sortByKey=function(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!0);var s;return s=i?n?t.sortNumBigFirst:t.sortBigFirst:n?t.sortNumSmallFirst:t.sortSmallFirst,function(t,i){return s(t[e],i[e])}},t}(),Be=function(){function e(){}return s(e,"laya.utils.Browser"),r(1,e,"pixelRatio",function(){if(e._pixelRatio<0)if(e.__init__(),e.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")>-1)e._pixelRatio=2;else{var t=e.context,i=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;e._pixelRatio=(e._window.devicePixelRatio||1)/i,e._pixelRatio<1&&(e._pixelRatio=1)}return e._pixelRatio}),r(1,e,"height",function(){return e.__init__(),(i.stage&&i.stage.canvasRotation?e.clientWidth:e.clientHeight)*e.pixelRatio}),r(1,e,"clientWidth",function(){return e.__init__(),e._window.innerWidth||e._document.body.clientWidth}),r(1,e,"window",function(){return e._window||e.__init__()}),r(1,e,"clientHeight",function(){return e.__init__(),e._window.innerHeight||e._document.body.clientHeight||e._document.documentElement.clientHeight}),r(1,e,"width",function(){return e.__init__(),(i.stage&&i.stage.canvasRotation?e.clientHeight:e.clientWidth)*e.pixelRatio}),r(1,e,"container",function(){return e._container||(e.__init__(),e._container=e.createElement("div"),e._container.id="layaContainer",e._document.body.appendChild(e._container)),e._container},function(t){e._container=t}),r(1,e,"document",function(){return e.__init__(),e._document}),e.__init__=function(){if(e._window)return e._window;var n=e._window=t,s=e._document=n.document,r=e.userAgent=n.navigator.userAgent,a=n._layalibs;if(a){a.sort(function(t,e){return t.i>e.i});for(var o=0;o<a.length;o++)a[o].f(n,s,i)}r.indexOf("MiniGame")>-1&&(i.MiniAdpter?i.MiniAdpter.enable():console.error("请先添加小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")),r.indexOf("SwanGame")>-1&&(i.BMiniAdapter?i.BMiniAdapter.enable():console.error("请先添加百度小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")),n.trace=console.log,n.requestAnimationFrame=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(t){return n.setTimeout(t,1e3/60)};var h=s.body.style;h.margin=0,h.overflow="hidden",h["-webkit-user-select"]="none",h["-webkit-tap-highlight-color"]="rgba(200,200,200,0)";for(var l=s.getElementsByTagName("meta"),_=0,u=!1,c="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no";_<l.length;){var d=l[_];if("viewport"==d.name){d.content=c,u=!0;break}_++}u||(d=s.createElement("meta"),d.name="viewport",d.content=c,s.getElementsByTagName("head")[0].appendChild(d)),e.onMobile=r.indexOf("Mobile")>-1,e.onIOS=!!r.match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),e.onIPhone=r.indexOf("iPhone")>-1,e.onMac=r.indexOf("Mac OS X")>-1,e.onIPad=r.indexOf("iPad")>-1,e.onAndroid=r.indexOf("Android")>-1||r.indexOf("Adr")>-1,e.onWP=r.indexOf("Windows Phone")>-1,e.onQQBrowser=r.indexOf("QQBrowser")>-1,e.onMQQBrowser=r.indexOf("MQQBrowser")>-1||r.indexOf("Mobile")>-1&&r.indexOf("QQ")>-1,e.onIE=!!n.ActiveXObject||"ActiveXObject"in n,e.onWeiXin=r.indexOf("MicroMessenger")>-1,e.onSafari=r.indexOf("Safari")>-1,e.onPC=!e.onMobile,e.onMiniGame=r.indexOf("MiniGame")>-1,e.onBDMiniGame=r.indexOf("SwanGame")>-1,e.onLimixiu=r.indexOf("limixiu")>-1,e.supportLocalStorage=Ee.__init__(),e.supportWebAudio=Gi.__init__(),Ni._mainCanvas=new Is(!0);var f=Ni._mainCanvas.source.style;f.position="absolute",f.top=f.left="0px",f.background="#000000",e.canvas=new Is(!0),e.context=e.canvas.getContext("2d");var p=new Is(!0),m=["webgl","experimental-webgl","webkit-3d","moz-webgl"],g=null;for(_=0;_<m.length;_++){try{g=p.source.getContext(m[_])}catch(v){}if(g){e._supportWebGL=!0;break}}return n},e.createElement=function(t){return e.__init__(),e._document.createElement(t)},e.getElementById=function(t){return e.__init__(),e._document.getElementById(t)},e.removeElement=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},e.now=function(){return Date.now()},e.userAgent=null,e.onMobile=!1,e.onIOS=!1,e.onMac=!1,e.onIPhone=!1,e.onIPad=!1,e.onAndroid=!1,e.onWP=!1,e.onQQBrowser=!1,e.onMQQBrowser=!1,e.onSafari=!1,e.onIE=!1,e.onWeiXin=!1,e.onPC=!1,e.onMiniGame=!1,e.onBDMiniGame=!1,e.onLimixiu=!1,e.onFirefox=!1,e.onEdge=!1,e.supportWebAudio=!1,e.supportLocalStorage=!1,e.canvas=null,e.context=null,e._window=null,e._document=null,e._container=null,e._pixelRatio=-1,e._supportWebGL=!1,e}(),Ne=function(){function t(){}return s(t,"laya.ui.UIUtils"),t.fillArray=function(t,e,i){var n=t.concat();if(e)for(var s=e.split(","),r=0,a=Math.min(n.length,s.length);a>r;r++){var o=s[r];n[r]="true"==o?!0:"false"==o?!1:o,null!=i&&(n[r]=i(o))}return n},t.toColor=function(t){return ee.toHexColor(t)},t.gray=function(e,i){void 0===i&&(i=!0),i?t.addFilter(e,t.grayFilter):t.clearFilter(e,gn)},t.addFilter=function(t,e){var i=t.filters||[];i.push(e),t.filters=i},t.clearFilter=function(t,e){var n=t.filters;if(null!=n&&n.length>0){for(var s=n.length-1;s>-1;s--){var r=n[s];i.__typeof(r,e)&&n.splice(s,1)}t.filters=n}},t._getReplaceStr=function(e){return t.escapeSequence[e]},t.adptString=function(e){return e.replace(/\\(\w)/g,t._getReplaceStr)},t.getBindFun=function(e){var n=t._funMap.get(e);if(null==n){var s='"'+e+'"';s=s.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"');var r="(function(data){if(data==null)return;with(data){try{\nreturn "+s+"\n}catch(e){}}})";n=i._runScript(r),t._funMap.set(e,n)}return n},n(t,["grayFilter",function(){return this.grayFilter=new gn([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"	"}},"_funMap",function(){return this._funMap=new Ce}]),t}(),ke=function(){function t(){}s(t,"laya.display.cmd.DrawLinesCmd");var e=t.prototype;return e.recover=function(){this.points=null,this.lineColor=null,Ji.recover("DrawLinesCmd",this)},e.run=function(t,e,i){t._drawLines(this.x+e,this.y+i,this.points,this.lineColor,this.lineWidth,this.vid)},r(0,e,"cmdID",function(){return"DrawLines"}),t.create=function(e,i,n,s,r,a){var o=Ji.getItemByClass("DrawLinesCmd",t);return o.x=e,o.y=i,o.points=n,o.lineColor=s,o.lineWidth=r,o.vid=a,o},t.ID="DrawLines",t}(),Fe=(function(){function t(){this._graphicsCmdEncoder=null,this._graphicsCmdEncoder_lines=null,this._paramData=null,this._x=0/0,this._y=0/0,this._points=null,this._fillColor=null,this._lineColor=null,this._lineWidth=0/0,this._isConvexPolygon=!1,this._vid=0,this._vertNum=0,this._line_vertNum=0,this.ibBuffer=null,this.vbBuffer=null,this.line_ibBuffer=null,this.line_vbBuffer=null,this._ibSize=0,this._vbSize=0,this._line_ibSize=0,this._line_vbSize=0,this._cmdCurrentPos=0,this._linePoints=[],this._line_vbArray=[],this._line_ibArray=[]}s(t,"laya.layagl.cmdNative.DrawPolyCmdNative");var e=t.prototype;return e.recover=function(){this._points=null,this._fillColor=null,this._lineColor=null,this._linePoints.length=0,this._line_vbArray.length=0,this._line_ibArray.length=0,Ji.recover("DrawPolyCmd",this)},r(0,e,"lineColor",function(){return this._lineColor},function(e){if(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_POLY_LINES_CMD_ENCODER_.getPtrID(),we.syncBufferToRenderThread(this._graphicsCmdEncoder),this._lineColor=e,this._lineColor&&this.line_vbBuffer){for(var i=o.create(this._lineColor),n=i.numColor,s=this.line_vbBuffer._int32Data,r=0,a=0;a<this._line_vertNum;a++)r++,r++,s[r++]=n;we.syncBufferToRenderThread(this.line_vbBuffer)}}),r(0,e,"points",function(){return this._points},function(e){this._points=e,this._vertNum=e.length/2;var i=this._vertNum,n=gi.earcut(e,null,2);if(n.length>0){(!this.ibBuffer||this.ibBuffer.getByteLength()<2*n.length)&&(this.ibBuffer=new ParamData(2*n.length,!0,!0)),this._ibSize=2*n.length;for(var s=this.ibBuffer._int16Data,r=0,a=0;a<n.length;a++)s[r++]=n[a]}(!this.vbBuffer||this.vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.vbBuffer=new ParamData(3*i*4,!0)),this._vbSize=3*this._vertNum*4;for(var h=o.create(this._fillColor),l=h.numColor,_=this.vbBuffer._float32Data,u=this.vbBuffer._int32Data,c=0,d=0;d<this._vertNum;d++)_[c++]=this._points[2*d]+this._x,_[c++]=this._points[2*d+1]+this._y,u[c++]=l;var f=this._paramData._int32Data;if(f[t._PARAM_VB_POS_]=this.vbBuffer.getPtrID(),f[t._PARAM_IB_POS_]=this.ibBuffer.getPtrID(),f[t._PARAM_VB_SIZE_POS_]=this._vbSize,f[t._PARAM_IB_SIZE_POS_]=this._ibSize,we.syncBufferToRenderThread(this.vbBuffer),we.syncBufferToRenderThread(this.ibBuffer),we.syncBufferToRenderThread(this._paramData),this.lineColor){var p=0;for(this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0,d=0;d<e.length;d++)this._linePoints.push(e[d]);this._linePoints.push(e[0]),this._linePoints.push(e[1]),ii.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length,p=this._line_vertNum,(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(p-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;var m=this.line_ibBuffer._int16Data;for(r=0,a=0;a<3*(this._line_vertNum-2);a++)m[r++]=this._line_ibArray[a];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*p*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var g=o.create(this._lineColor),v=g.numColor,y=this.line_vbBuffer._float32Data,E=this.line_vbBuffer._int32Data;for(c=0,d=0;d<this._line_vertNum;d++)y[c++]=this._line_vbArray[2*d]+this._x,y[c++]=this._line_vbArray[2*d+1]+this._y,E[c++]=v;f=this._paramData._int32Data,f[t._PARAM_LINE_VB_POS_]=this.line_vbBuffer.getPtrID(),f[t._PARAM_LINE_IB_POS_]=this.line_ibBuffer.getPtrID(),f[t._PARAM_LINE_VB_SIZE_POS_]=this._line_vbSize,f[t._PARAM_LINE_IB_SIZE_POS_]=this._line_ibSize,we.syncBufferToRenderThread(this.line_vbBuffer),we.syncBufferToRenderThread(this.line_ibBuffer)}}),r(0,e,"cmdID",function(){return"DrawPoly"}),r(0,e,"fillColor",function(){return this._fillColor},function(t){this._fillColor=t;for(var e=o.create(this._fillColor),i=e.numColor,n=this.vbBuffer._int32Data,s=0,r=0;r<this._vertNum;r++)s++,s++,n[s++]=i;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)e[i++]=this._points[2*n]+this._x,i++,i++;if(this._lineColor){var s=this.line_vbBuffer._float32Data;for(i=0,n=0;n<this._line_vertNum;n++)s[i++]=this._line_vbArray[2*n]+this._x,i++,i++;we.syncBufferToRenderThread(this.line_vbBuffer)}we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"isConvexPolygon",function(){return this._isConvexPolygon},function(t){this._isConvexPolygon=t}),r(0,e,"vid",function(){return this._vid},function(t){this._vid=t}),r(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)i++,e[i++]=this._points[2*n+1]+this._y,i++;if(this._lineColor){var s=this.line_vbBuffer._float32Data;for(i=0,n=0;n<this._line_vertNum;n++)i++,s[i++]=this._line_vbArray[2*n+1]+this._y,i++;we.syncBufferToRenderThread(this.line_vbBuffer)}we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"lineWidth",function(){return this._lineWidth},function(e){this.lineColor&&(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_POLY_LINES_CMD_ENCODER_.getPtrID(),we.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._lineWidth=e,this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0;for(var i=0;i<this._points.length;i++)this._linePoints.push(this._points[i]);this._linePoints.push(this._points[0]),this._linePoints.push(this._points[1]),ii.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1);var n=this.line_vbBuffer._float32Data,s=0;for(i=0;i<this._line_vertNum;i++)n[s++]=this._line_vbArray[2*i]+this._x,n[s++]=this._line_vbArray[2*i+1]+this._y,s++;we.syncBufferToRenderThread(this.line_vbBuffer)}),t.create=function(e,i,n,s,r,a,h){var l=Ji.getItemByClass("DrawPolyCmd",t);l._graphicsCmdEncoder=this._commandEncoder,t._DRAW_POLY_CMD_ENCODER_||(t._DRAW_POLY_CMD_ENCODER_=we.instance.createCommandEncoder(168,32,!0),t._DRAW_POLY_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_POLY_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_POLY_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_POLY_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_POLY_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_POLY_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_POLY_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_POLY_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_POLY_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_POLY_CMD_ENCODER_)),t._DRAW_POLY_LINES_CMD_ENCODER_||(t._DRAW_POLY_LINES_CMD_ENCODER_=we.instance.createCommandEncoder(244,32,!0),t._DRAW_POLY_LINES_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_POLY_LINES_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_POLY_LINES_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_POLY_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_POLY_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_POLY_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_POLY_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_POLY_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_POLY_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_POLY_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_LINE_VB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINE_VB_SIZE_POS_,4*t._PARAM_LINE_IB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINE_IB_SIZE_POS_,4*t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_POLY_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_POLY_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_POLY_LINES_CMD_ENCODER_)),l._paramData||(l._paramData=new ParamData(68,!0)),l._x=e,l._y=i,l._points=n,l._fillColor=s,l._lineColor=r,l._lineWidth=a,l._isConvexPolygon=h,l._vertNum=n.length/2;var _=l._vertNum,u=gi.earcut(n,null,2);if(u.length>0){(!l.ibBuffer||l.ibBuffer.getByteLength()<2*u.length)&&(l.ibBuffer=new ParamData(2*u.length,!0,!0)),l._ibSize=2*u.length;for(var c=l.ibBuffer._int16Data,d=0,f=0;f<u.length;f++)c[d++]=u[f]}var p=o.create(s),m=p.numColor;(!l.vbBuffer||l.vbBuffer.getByteLength()<3*l._vertNum*4)&&(l.vbBuffer=new ParamData(3*_*4,!0)),l._vbSize=3*l._vertNum*4;for(var g=l.vbBuffer._float32Data,v=l.vbBuffer._int32Data,y=0,E=0;E<l._vertNum;E++)g[y++]=n[2*E]+e,g[y++]=n[2*E+1]+i,v[y++]=m;for(E=0;E<n.length;E++)l._linePoints.push(n[E]);if(l._linePoints.push(n[0]),l._linePoints.push(n[1]),r){ii.createLine2(l._linePoints,l._line_ibArray,a,0,l._line_vbArray,!1),l._line_vertNum=l._linePoints.length;var S=l._line_vertNum;(!l.line_ibBuffer||l.line_ibBuffer.getByteLength()<3*(l._line_vertNum-2)*2)&&(l.line_ibBuffer=new ParamData(3*(S-2)*2,!0,!0)),l._line_ibSize=3*(l._line_vertNum-2)*2;var A=l.line_ibBuffer._int16Data;for(d=0,f=0;f<3*(l._line_vertNum-2);f++)A[d++]=l._line_ibArray[f];(!l.line_vbBuffer||l.line_vbBuffer.getByteLength()<3*l._line_vertNum*4)&&(l.line_vbBuffer=new ParamData(3*S*4,!0)),l._line_vbSize=3*l._line_vertNum*4;var C=o.create(r),D=C.numColor,x=l.line_vbBuffer._float32Data,R=l.line_vbBuffer._int32Data;for(y=0,E=0;E<l._line_vertNum;E++)x[y++]=l._line_vbArray[2*E]+e,x[y++]=l._line_vbArray[2*E+1]+i,R[y++]=D}else{l._lineWidth=1;var T="#ffffff";for(ii.createLine2(l._linePoints,l._line_ibArray,l._lineWidth,0,l._line_vbArray,!1),l._line_vertNum=l._linePoints.length,S=l._line_vertNum,(!l.line_ibBuffer||l.line_ibBuffer.getByteLength()<3*(l._line_vertNum-2)*2)&&(l.line_ibBuffer=new ParamData(3*(S-2)*2,!0,!0)),l._line_ibSize=3*(l._line_vertNum-2)*2,A=l.line_ibBuffer._int16Data,d=0,f=0;f<3*(l._line_vertNum-2);f++)A[d++]=l._line_ibArray[f];for((!l.line_vbBuffer||l.line_vbBuffer.getByteLength()<3*l._line_vertNum*4)&&(l.line_vbBuffer=new ParamData(3*S*4,!0)),l._line_vbSize=3*l._line_vertNum*4,C=o.create(T),D=C.numColor,x=l.line_vbBuffer._float32Data,R=l.line_vbBuffer._int32Data,y=0,E=0;E<l._line_vertNum;E++)x[y++]=l._line_vbArray[2*E]+e,x[y++]=l._line_vbArray[2*E+1]+i,R[y++]=D}var b=l._paramData._float32Data,P=l._paramData._int32Data;return P[0]=1,P[1]=32,null==l.ibBuffer?null:(P[t._PARAM_VB_POS_]=l.vbBuffer.getPtrID(),P[t._PARAM_IB_POS_]=l.ibBuffer.getPtrID(),P[t._PARAM_VB_SIZE_POS_]=l._vbSize,P[t._PARAM_IB_SIZE_POS_]=l._ibSize,P[t._PARAM_VB_OFFSET_POS_]=0,P[t._PARAM_IB_OFFSET_POS_]=0,P[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0,b[t._PARAM_ISCONVEXT_POS_]=h,we.syncBufferToRenderThread(l.vbBuffer),we.syncBufferToRenderThread(l.ibBuffer),P[t._PARAM_LINE_VB_POS_]=l.line_vbBuffer.getPtrID(),P[t._PARAM_LINE_IB_POS_]=l.line_ibBuffer.getPtrID(),P[t._PARAM_LINE_VB_SIZE_POS_]=l._line_vbSize,P[t._PARAM_LINE_IB_SIZE_POS_]=l._line_ibSize,P[t._PARAM_LINE_VB_OFFSET_POS_]=0,P[t._PARAM_LINE_IB_OFFSET_POS_]=0,P[t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_]=0,we.syncBufferToRenderThread(l.line_vbBuffer),we.syncBufferToRenderThread(l.line_ibBuffer),we.syncBufferToRenderThread(l._paramData),l._cmdCurrentPos=r?l._graphicsCmdEncoder.useCommandEncoder(t._DRAW_POLY_LINES_CMD_ENCODER_.getPtrID(),l._paramData.getPtrID(),-1):l._graphicsCmdEncoder.useCommandEncoder(t._DRAW_POLY_CMD_ENCODER_.getPtrID(),l._paramData.getPtrID(),-1),we.syncBufferToRenderThread(l._graphicsCmdEncoder),l)},t.ID="DrawPoly",t._DRAW_POLY_CMD_ENCODER_=null,t._DRAW_POLY_LINES_CMD_ENCODER_=null,t._PARAM_VB_POS_=2,t._PARAM_IB_POS_=3,t._PARAM_VB_SIZE_POS_=4,t._PARAM_IB_SIZE_POS_=5,t._PARAM_LINE_VB_POS_=6,t._PARAM_LINE_IB_POS_=7,t._PARAM_LINE_VB_SIZE_POS_=8,t._PARAM_LINE_IB_SIZE_POS_=9,t._PARAM_ISCONVEXT_POS_=10,t._PARAM_VB_OFFSET_POS_=11,t._PARAM_IB_OFFSET_POS_=12,t._PARAM_LINE_VB_OFFSET_POS_=13,t._PARAM_LINE_IB_OFFSET_POS_=14,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=15,t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_=16,t}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._x=0/0,this._y=0/0,this._points=null,this._lineColor=null,this._lineWidth=0/0,this._vid=0,this._vertNum=0,this.ibBuffer=null,this.vbBuffer=null,this._ibSize=0,this._vbSize=0,this._ibArray=[],this._vbArray=[]}s(t,"laya.layagl.cmdNative.DrawLinesCmdNative");var e=t.prototype;return e.recover=function(){this._points=null,this._lineColor=null,this._ibArray.length=0,this._vbArray.length=0,Ji.recover("DrawLinesCmd",this)},r(0,e,"lineColor",function(){return this._lineColor},function(t){this._lineColor=t;for(var e=o.create(this._lineColor),i=e.numColor,n=this.vbBuffer._int32Data,s=0,r=0;r<this._vertNum;r++)s++,s++,n[s++]=i;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"points",function(){return this._points},function(e){this._points=e,this._ibArray.length=0,this._vbArray.length=0,ii.createLine2(this._points,this._ibArray,this._lineWidth,0,this._vbArray,!1);var i=o.create(this._lineColor),n=i.numColor;this._vertNum=this._points.length;var s=this._vertNum;(!this.vbBuffer||this.vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.vbBuffer=new ParamData(3*s*4,!0)),this._vbSize=3*this._vertNum*4;for(var r=this.vbBuffer._float32Data,a=this.vbBuffer._int32Data,h=0,l=0;l<this._vertNum;l++)r[h++]=this._vbArray[2*l]+this.x,r[h++]=this._vbArray[2*l+1]+this.y,a[h++]=n;(!this.ibBuffer||this.ibBuffer.getByteLength()<3*(this._vertNum-2)*2)&&(this.ibBuffer=new ParamData(3*(s-2)*2,!0,!0)),this._ibSize=3*(this._vertNum-2)*2;for(var _=this.ibBuffer._int16Data,u=0;u<3*(this._vertNum-2);u++)_[u]=this._ibArray[u];a=this._paramData._int32Data,a[t._PARAM_VB_SIZE_POS_]=this._vbSize,a[t._PARAM_IB_SIZE_POS_]=this._ibSize,we.syncBufferToRenderThread(this.ibBuffer),we.syncBufferToRenderThread(this.vbBuffer),we.syncBufferToRenderThread(this._paramData)}),r(0,e,"cmdID",function(){return"DrawLines"}),r(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)e[i++]=this._vbArray[2*n]+this._x,i++,i++;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"vid",function(){return this._vid},function(t){this._vid=t}),r(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)i++,e[i++]=this._vbArray[2*n+1]+this._y,i++;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"lineWidth",function(){return this._lineWidth},function(t){this._lineWidth=t,this._ibArray.length=0,this._vbArray.length=0,ii.createLine2(this._points,this._ibArray,this._lineWidth,0,this._vbArray,!1);for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)e[i++]=this._vbArray[2*n]+this.x,e[i++]=this._vbArray[2*n+1]+this.y,i++;we.syncBufferToRenderThread(this.vbBuffer)}),t.create=function(e,i,n,s,r,a){var h=Ji.getItemByClass("DrawLinesCmd",t);h._graphicsCmdEncoder=this._commandEncoder,t._DRAW_LINES_CMD_ENCODER_||(t._DRAW_LINES_CMD_ENCODER_=we.instance.createCommandEncoder(152,32,!0),t._DRAW_LINES_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_LINES_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_LINES_CMD_ENCODER_)),h._paramData||(h._paramData=new ParamData(44,!0)),h._x=e,h._y=i,h._points=n,h._lineColor=s,h._lineWidth=r,h._vid=a,ii.createLine2(n,h._ibArray,r,0,h._vbArray,!1);var l=o.create(s),_=l.numColor;h._vertNum=n.length;var u=h._vertNum;(!h.vbBuffer||h.vbBuffer.getByteLength()<3*h._vertNum*4)&&(h.vbBuffer=new ParamData(3*u*4,!0)),h._vbSize=3*h._vertNum*4;for(var c=h.vbBuffer._float32Data,d=h.vbBuffer._int32Data,f=0,p=0;p<h._vertNum;p++)c[f++]=h._vbArray[2*p]+e,c[f++]=h._vbArray[2*p+1]+i,d[f++]=_;(!h.ibBuffer||h.ibBuffer.getByteLength()<3*(h._vertNum-2)*2)&&(h.ibBuffer=new ParamData(3*(u-2)*2,!0,!0)),h._ibSize=3*(h._vertNum-2)*2;for(var m=h.ibBuffer._int16Data,g=0;g<3*(h._vertNum-2);g++)m[g]=h._ibArray[g];var v=h._paramData._float32Data;return d=h._paramData._int32Data,d[0]=1,d[t._PARAM_VB_POS_]=h.vbBuffer.getPtrID(),d[t._PARAM_IB_POS_]=h.ibBuffer.getPtrID(),v[t._PARAM_LINECOLOR_POS_]=s?s:4278190335,v[t._PARAM_LINEWIDTH_POS_]=r,v[t._PARAM_VID_POS_]=a,d[t._PARAM_VB_SIZE_POS_]=h._vbSize,d[t._PARAM_IB_SIZE_POS_]=h._ibSize,d[t._PARAM_VB_OFFSET_POS_]=0,d[t._PARAM_IB_OFFSET_POS_]=0,d[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0,we.syncBufferToRenderThread(h.vbBuffer),we.syncBufferToRenderThread(h.ibBuffer),we.syncBufferToRenderThread(h._paramData),h._graphicsCmdEncoder.useCommandEncoder(t._DRAW_LINES_CMD_ENCODER_.getPtrID(),h._paramData.getPtrID(),-1),we.syncBufferToRenderThread(h._graphicsCmdEncoder),h},t.ID="DrawLines",t._DRAW_LINES_CMD_ENCODER_=null,t._PARAM_VB_POS_=1,t._PARAM_IB_POS_=2,t._PARAM_LINECOLOR_POS_=3,t._PARAM_LINEWIDTH_POS_=4,t._PARAM_VID_POS_=5,t._PARAM_VB_SIZE_POS_=6,t._PARAM_IB_SIZE_POS_=7,t._PARAM_VB_OFFSET_POS_=8,t._PARAM_IB_OFFSET_POS_=9,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=10,t}(),function(){function t(){}return s(t,"laya.net.ResourceVersion"),t.enable=function(e,n,s){void 0===s&&(s=2),laya.net.ResourceVersion.type=s,i.loader.load(e,_.create(null,t.onManifestLoaded,[n]),null,"json"),Mi.customFormat=t.addVersionPrefix},t.onManifestLoaded=function(e,i){t.manifest=i,e.run(),i||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},t.addVersionPrefix=function(e){return e=Mi.getAdptedFilePath(e),t.manifest&&t.manifest[e]?2==t.type?t.manifest[e]:t.manifest[e]+"/"+e:e},t.FOLDER_VERSION=1,t.FILENAME_VERSION=2,t.manifest=null,t.type=1,t}()),Ve=(function(){function t(){}return s(t,"laya.webgl.shader.ShaderValue"),t}(),function(){function t(){}return s(t,"laya.utils.Ease"),t.linearNone=function(t,e,i,n){return i*t/n+e},t.linearIn=function(t,e,i,n){return i*t/n+e},t.linearInOut=function(t,e,i,n){return i*t/n+e},t.linearOut=function(t,e,i,n){return i*t/n+e},t.bounceIn=function(e,i,n,s){return n-t.bounceOut(s-e,0,n,s)+i},t.bounceInOut=function(e,i,n,s){return.5*s>e?.5*t.bounceIn(2*e,0,n,s)+i:.5*t.bounceOut(2*e-s,0,n,s)+.5*n+i},t.bounceOut=function(t,e,i,n){return(t/=n)<1/2.75?7.5625*i*t*t+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},t.backIn=function(t,e,i,n,s){return void 0===s&&(s=1.70158),i*(t/=n)*t*((s+1)*t-s)+e},t.backInOut=function(t,e,i,n,s){return void 0===s&&(s=1.70158),(t/=.5*n)<1?.5*i*t*t*(((s*=1.525)+1)*t-s)+e:i/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+e},t.backOut=function(t,e,i,n,s){return void 0===s&&(s=1.70158),i*((t=t/n-1)*t*((s+1)*t+s)+1)+e},t.elasticIn=function(e,i,n,s,r,a){void 0===r&&(r=0),void 0===a&&(a=0);var o;return 0==e?i:1==(e/=s)?i+n:(a||(a=.3*s),!r||n>0&&n>r||0>n&&-n>r?(r=n,o=a/4):o=a/t.PI2*Math.asin(n/r),-(r*Math.pow(2,10*(e-=1))*Math.sin((e*s-o)*t.PI2/a))+i)},t.elasticInOut=function(e,i,n,s,r,a){void 0===r&&(r=0),void 0===a&&(a=0);var o;return 0==e?i:2==(e/=.5*s)?i+n:(a||(a=.3*s*1.5),!r||n>0&&n>r||0>n&&-n>r?(r=n,o=a/4):o=a/t.PI2*Math.asin(n/r),1>e?-.5*r*Math.pow(2,10*(e-=1))*Math.sin((e*s-o)*t.PI2/a)+i:r*Math.pow(2,-10*(e-=1))*Math.sin((e*s-o)*t.PI2/a)*.5+n+i)
},t.elasticOut=function(e,i,n,s,r,a){void 0===r&&(r=0),void 0===a&&(a=0);var o;return 0==e?i:1==(e/=s)?i+n:(a||(a=.3*s),!r||n>0&&n>r||0>n&&-n>r?(r=n,o=a/4):o=a/t.PI2*Math.asin(n/r),r*Math.pow(2,-10*e)*Math.sin((e*s-o)*t.PI2/a)+n+i)},t.strongIn=function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},t.strongInOut=function(t,e,i,n){return(t/=.5*n)<1?.5*i*t*t*t*t*t+e:.5*i*((t-=2)*t*t*t*t+2)+e},t.strongOut=function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},t.sineInOut=function(t,e,i,n){return.5*-i*(Math.cos(Math.PI*t/n)-1)+e},t.sineIn=function(e,i,n,s){return-n*Math.cos(e/s*t.HALF_PI)+n+i},t.sineOut=function(e,i,n,s){return n*Math.sin(e/s*t.HALF_PI)+i},t.quintIn=function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},t.quintInOut=function(t,e,i,n){return(t/=.5*n)<1?.5*i*t*t*t*t*t+e:.5*i*((t-=2)*t*t*t*t+2)+e},t.quintOut=function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},t.quartIn=function(t,e,i,n){return i*(t/=n)*t*t*t+e},t.quartInOut=function(t,e,i,n){return(t/=.5*n)<1?.5*i*t*t*t*t+e:.5*-i*((t-=2)*t*t*t-2)+e},t.quartOut=function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},t.cubicIn=function(t,e,i,n){return i*(t/=n)*t*t+e},t.cubicInOut=function(t,e,i,n){return(t/=.5*n)<1?.5*i*t*t*t+e:.5*i*((t-=2)*t*t+2)+e},t.cubicOut=function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e},t.quadIn=function(t,e,i,n){return i*(t/=n)*t+e},t.quadInOut=function(t,e,i,n){return(t/=.5*n)<1?.5*i*t*t+e:.5*-i*(--t*(t-2)-1)+e},t.quadOut=function(t,e,i,n){return-i*(t/=n)*(t-2)+e},t.expoIn=function(t,e,i,n){return 0==t?e:i*Math.pow(2,10*(t/n-1))+e-.001*i},t.expoInOut=function(t,e,i,n){return 0==t?e:t==n?e+i:(t/=.5*n)<1?.5*i*Math.pow(2,10*(t-1))+e:.5*i*(-Math.pow(2,-10*--t)+2)+e},t.expoOut=function(t,e,i,n){return t==n?e+i:i*(-Math.pow(2,-10*t/n)+1)+e},t.circIn=function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e},t.circInOut=function(t,e,i,n){return(t/=.5*n)<1?.5*-i*(Math.sqrt(1-t*t)-1)+e:.5*i*(Math.sqrt(1-(t-=2)*t)+1)+e},t.circOut=function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e},t.HALF_PI=.5*Math.PI,t.PI2=2*Math.PI,t}()),Ue=(function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._paramData=null,this._x=0/0,this._y=0/0,this._width=0/0,this._height=0/0,this._fillColor=null,this._lineColor=null,this._lineWidth=0/0,this._line_vertNum=0,this._cmdCurrentPos=0,this._linePoints=[],this._line_ibArray=[],this._line_vbArray=[]}s(t,"laya.layagl.cmdNative.DrawRectCmdNative");var e=t.prototype;return e.recover=function(){this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0,this._graphicsCmdEncoder=null,Ji.recover("DrawRectCmd",this)},r(0,e,"lineColor",function(){return this._lineColor},function(e){this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_RECT_LINE_CMD_ENCODER_.getPtrID(),we.syncBufferToRenderThread(this._graphicsCmdEncoder),this._lineColor=e;for(var i=this._paramData._int32Data,n=o.create(e),s=n.numColor,r=t._PARAM_LINE_VB_POS_,a=0;a<this._line_vertNum;a++)r++,r++,i[r++]=s;we.syncBufferToRenderThread(this._paramData)}),r(0,e,"cmdID",function(){return"DrawRect"}),r(0,e,"fillColor",function(){return this._fillColor},function(e){if(this._fillColor=e,"string"==typeof e){var i=o.create(this._fillColor),n=i.numColor,s=this._paramData._int32Data;s[t._PARAM_VB_POS_+4]=n,s[t._PARAM_VB_POS_+10]=n,s[t._PARAM_VB_POS_+16]=n,s[t._PARAM_VB_POS_+22]=n}else s=this._paramData._int32Data,s[t._PARAM_VB_POS_+4]=e,s[t._PARAM_VB_POS_+10]=e,s[t._PARAM_VB_POS_+16]=e,s[t._PARAM_VB_POS_+22]=e;we.syncBufferToRenderThread(this._paramData)}),r(0,e,"width",function(){return this._width},function(e){this._width=e;var i=this._paramData._float32Data;if(i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,this.lineColor){this._line_ibArray.length=0,this._line_vbArray.length=0,this._linePoints[2]=this._x+this._width,this._linePoints[4]=this._x+this._width,ii.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length;for(var n=t._PARAM_LINE_VB_POS_,s=0;s<this._line_vertNum;s++)i[n++]=this._line_vbArray[2*s],i[n++]=this._line_vbArray[2*s+1],n++}we.syncBufferToRenderThread(this._paramData)}),r(0,e,"x",function(){return this._x},function(e){this._x=e;var i=this._paramData._float32Data;if(i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,this.lineColor){this._line_ibArray.length=0,this._line_vbArray.length=0,this._linePoints[0]=this._x,this._linePoints[2]=this._x+this._width,this._linePoints[4]=this._x+this._width,this._linePoints[6]=this._x,this._linePoints[8]=this._x,ii.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1);for(var n=t._PARAM_LINE_VB_POS_,s=0;s<this._line_vertNum;s++)i[n++]=this._line_vbArray[2*s],i[n++]=this._line_vbArray[2*s+1],n++}we.syncBufferToRenderThread(this._paramData)}),r(0,e,"y",function(){return this._y},function(e){this._y=e;var i=this._paramData._float32Data;if(i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,this.lineColor){this._line_ibArray.length=0,this._line_vbArray.length=0,this._linePoints[1]=this._y,this._linePoints[3]=this._y,this._linePoints[5]=this._y+this._height,this._linePoints[7]=this._y+this._height,this._linePoints[9]=this._y-this._lineWidth/2,ii.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1);for(var n=t._PARAM_LINE_VB_POS_,s=0;s<this._line_vertNum;s++)i[n++]=this._line_vbArray[2*s],i[n++]=this._line_vbArray[2*s+1],n++}we.syncBufferToRenderThread(this._paramData)}),r(0,e,"height",function(){return this._height},function(e){this._height=e;var i=this._paramData._float32Data;if(i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,this.lineColor){this._line_ibArray.length=0,this._line_vbArray.length=0,this._linePoints[5]=this._y+this._height,this._linePoints[7]=this._y+this._height,ii.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1);for(var n=t._PARAM_LINE_VB_POS_,s=0;s<this._line_vertNum;s++)i[n++]=this._line_vbArray[2*s],i[n++]=this._line_vbArray[2*s+1],n++}we.syncBufferToRenderThread(this._paramData)}),r(0,e,"lineWidth",function(){return this._lineWidth},function(e){this.lineColor&&(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_RECT_LINE_CMD_ENCODER_.getPtrID(),we.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._lineWidth=e,this._line_ibArray.length=0,this._line_vbArray.length=0,this._linePoints[9]=this._y-this._lineWidth/2,ii.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length;for(var i=this._paramData._float32Data,n=t._PARAM_LINE_VB_POS_,s=0;s<this._line_vertNum;s++)i[n++]=this._line_vbArray[2*s],i[n++]=this._line_vbArray[2*s+1],n++;we.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,n,s,r,a,h){var l=Ji.getItemByClass("DrawRectCmd",t);l._graphicsCmdEncoder=this._commandEncoder,t._DRAW_RECT_LINE_CMD_ENCODER_||(t._DRAW_RECT_LINE_CMD_ENCODER_=we.instance.createCommandEncoder(300,32,!0),t._DRAW_RECT_LINE_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_RECT_LINE_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),t._DRAW_RECT_LINE_CMD_ENCODER_.useVDO(he.VDO_MESHQUADTEXTURE),t._DRAW_RECT_LINE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_RECT_LINE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_RECT_LINE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_RECT_LINE_CMD_ENCODER_.setRectMeshByParamData(4*t._PARAM_RECT_NUM_POS_,4*t._PARAM_VB_POS_,4*t._PARAM_VB_SIZE_POS_),t._DRAW_RECT_LINE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_RECT_LINE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_RECT_LINE_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_RECT_LINE_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_RECT_LINE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_RECT_LINE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_RECT_LINE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_RECT_LINE_CMD_ENCODER_.setMeshByParamData(4*t._PARAM_LINE_VB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINE_VB_SIZE_POS_,4*t._PARAM_LINE_IB_POS_,4*t._PARAM_LINE_IB_OFFSET_POS_,4*t._PARAM_LINE_IB_SIZE_POS_,4*t._PARAM_LINE_IBELEMENT_OFFSET_POS_),t._DRAW_RECT_LINE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_RECT_LINE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_RECT_LINE_CMD_ENCODER_)),t._DRAW_RECT_CMD_ENCODER_||(t._DRAW_RECT_CMD_ENCODER_=we.instance.createCommandEncoder(152,32,!0),t._DRAW_RECT_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_RECT_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),t._DRAW_RECT_CMD_ENCODER_.useVDO(he.VDO_MESHQUADTEXTURE),t._DRAW_RECT_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_RECT_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_RECT_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_RECT_CMD_ENCODER_.setRectMeshByParamData(4*t._PARAM_RECT_NUM_POS_,4*t._PARAM_VB_POS_,4*t._PARAM_VB_SIZE_POS_),t._DRAW_RECT_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_RECT_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_RECT_CMD_ENCODER_)),l._paramData||(l._paramData=new ParamData(292,!0)),l._x=e,l._y=i,l._width=n,l._height=s,l._fillColor=r,l._lineColor=a,l._lineWidth=h;var _=o.create(r),u=_.numColor,c=l._paramData._float32Data,d=l._paramData._int32Data;d[t._PARAM_RECT_NUM_POS_]=1,d[t._PARAM_VB_SIZE_POS_]=96;var f=t._PARAM_VB_POS_;if(c[f++]=e,c[f++]=i,c[f++]=0,c[f++]=0,d[f++]=u,c[f++]=4294967295,c[f++]=e+n,c[f++]=i,c[f++]=0,c[f++]=0,d[f++]=u,c[f++]=4294967295,c[f++]=e+n,c[f++]=i+s,c[f++]=0,c[f++]=0,d[f++]=u,c[f++]=4294967295,c[f++]=e,c[f++]=i+s,c[f++]=0,c[f++]=0,d[f++]=u,c[f++]=4294967295,l._linePoints.push(e),l._linePoints.push(i),l._linePoints.push(e+n),l._linePoints.push(i),l._linePoints.push(e+n),l._linePoints.push(i+s),l._linePoints.push(e),l._linePoints.push(i+s),l._linePoints.push(e),l._linePoints.push(i-h/2),a){ii.createLine2(l._linePoints,l._line_ibArray,h,0,l._line_vbArray,!1),l._line_vertNum=l._linePoints.length,d[t._PARAM_LINE_VB_SIZE_POS_]=120;var p=o.create(a),m=p.numColor;f=t._PARAM_LINE_VB_POS_;for(var g=0;g<l._line_vertNum;g++)c[f++]=l._line_vbArray[2*g],c[f++]=l._line_vbArray[2*g+1],d[f++]=m;d[t._PARAM_LINE_IB_SIZE_POS_]=2*l._line_ibArray.length;var v=l._paramData._int16Data;f=2*t._PARAM_LINE_IB_POS_;for(var y=0;y<l._line_ibArray.length;y++)v[f++]=l._line_ibArray[y]}else{l._lineWidth=1;var E="#ffffff";for(ii.createLine2(l._linePoints,l._line_ibArray,l._lineWidth,0,l._line_vbArray,!1),l._line_vertNum=l._linePoints.length,d[t._PARAM_LINE_VB_SIZE_POS_]=120,p=o.create(E),m=p.numColor,f=t._PARAM_LINE_VB_POS_,g=0;g<l._line_vertNum;g++)c[f++]=l._line_vbArray[2*g],c[f++]=l._line_vbArray[2*g+1],d[f++]=m;for(d[t._PARAM_LINE_IB_SIZE_POS_]=2*l._line_ibArray.length,v=l._paramData._int16Data,f=2*t._PARAM_LINE_IB_POS_,y=0;y<l._line_ibArray.length;y++)v[f++]=l._line_ibArray[y]}return d[t._PARAM_LINE_VB_OFFSET_POS_]=0,d[t._PARAM_LINE_IB_OFFSET_POS_]=0,d[t._PARAM_LINE_IBELEMENT_OFFSET_POS_]=0,we.syncBufferToRenderThread(l._paramData),l._cmdCurrentPos=a?l._graphicsCmdEncoder.useCommandEncoder(t._DRAW_RECT_LINE_CMD_ENCODER_.getPtrID(),l._paramData.getPtrID(),-1):l._graphicsCmdEncoder.useCommandEncoder(t._DRAW_RECT_CMD_ENCODER_.getPtrID(),l._paramData.getPtrID(),-1),we.syncBufferToRenderThread(l._graphicsCmdEncoder),l},t.ID="DrawRect",t._DRAW_RECT_CMD_ENCODER_=null,t._DRAW_RECT_LINE_CMD_ENCODER_=null,t._PARAM_RECT_NUM_POS_=0,t._PARAM_VB_SIZE_POS_=1,t._PARAM_VB_POS_=2,t._PARAM_LINE_VB_SIZE_POS_=26,t._PARAM_LINE_VB_POS_=27,t._PARAM_LINE_IB_SIZE_POS_=57,t._PARAM_LINE_IB_POS_=58,t._PARAM_LINE_VB_OFFSET_POS_=70,t._PARAM_LINE_IB_OFFSET_POS_=71,t._PARAM_LINE_IBELEMENT_OFFSET_POS_=72,t}(),function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._text=null,this._x=0/0,this._y=0/0,this._font=null,this._color=null,this._textAlign=null,this._draw_texture_cmd_encoder_=we.instance.createCommandEncoder(64,32,!0)}s(t,"laya.layagl.cmdNative.FillTextCmdNative");var e=t.prototype;return e.createFillText=function(e,i,n,s,r,a,h){var l=o.create(a),_=(l.numColor,{});_._curMat=new fi,_._italicDeg=0,_._drawTextureUseColor=4294967295,_.fillStyle=a,_._fillColor=4294967295,_.setFillColor=function(t){_._fillColor=t},_.getFillColor=function(){return _._fillColor},_.mixRGBandAlpha=function(t){return t},_._drawTextureM=function(t,i,n,s,r,a,o,h){e.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),e.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),e.useVDO(he.VDO_MESHQUADTEXTURE),e.uniformEx(he.GLOBALVALUE_VIEWS,0),e.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),e.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),e.uniformTexture(3,33984,t.bitmap._glTexture);var l=new Float32Array([i,n,h[0],h[1],0,0,i+s,n,h[2],h[3],0,0,i+s,n+r,h[4],h[5],0,0,i,n+r,h[6],h[7],0,0]),_=new Int32Array(l.buffer);_[4]=_[10]=_[16]=_[22]=4294967295,_[5]=_[11]=_[17]=_[23]=4294967295,e.setRectMesh(1,l,l.length),e.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),e.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(e)},t.cbook.filltext_native(_,i,null,n,s,r,a,null,0,h)},e.recover=function(){this._graphicsCmdEncoder=null,Ji.recover("FillTextCmd",this)},r(0,e,"text",function(){return this._text},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._text=t,this.createFillText(e,this._text,this._x,this._y,this._font,this._color,this._textAlign),we.syncBufferToRenderThread(e)}),r(0,e,"cmdID",function(){return"FillText"}),r(0,e,"font",function(){return this._font},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._font=t,this.createFillText(e,this._text,this._x,this._y,this._font,this._color,this._textAlign),we.syncBufferToRenderThread(e)}),r(0,e,"color",function(){return this._color},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._color=t,this.createFillText(e,this._text,this._x,this._y,this._font,this._color,this._textAlign),we.syncBufferToRenderThread(e)}),r(0,e,"textAlign",function(){return this._textAlign},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._textAlign=t,this.createFillText(e,this._text,this._x,this._y,this._font,this._color,this._textAlign),we.syncBufferToRenderThread(e)}),r(0,e,"x",function(){return this._x},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._x=t,this.createFillText(e,this._text,this._x,this._y,this._font,this._color,this._textAlign),we.syncBufferToRenderThread(e)}),r(0,e,"y",function(){return this._y},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._y=t,this.createFillText(e,this._text,this._x,this._y,this._font,this._color,this._textAlign),we.syncBufferToRenderThread(e)}),t.create=function(e,i,n,s,r,a){t.cbook||new Error("Error:charbook not create!");var o=Ji.getItemByClass("FillTextCmd",t),h=o._graphicsCmdEncoder=this._commandEncoder;return o._text=e,o._x=i,o._y=n,o._font=s,o._color=r,o._textAlign=a,o._draw_texture_cmd_encoder_.clearEncoding(),o.createFillText(o._draw_texture_cmd_encoder_,e,i,n,s,r,a),we.syncBufferToRenderThread(o._draw_texture_cmd_encoder_),h.useCommandEncoder(o._draw_texture_cmd_encoder_.getPtrID(),-1,-1),we.syncBufferToRenderThread(h),o},t.ID="FillText",n(t,["cbook",function(){return this.cbook=xe.charbookInst}]),t}(),function(){function t(t,e,i){this.pages=[],this.fontFamily=null,this._slotW=0,this._gridW=0,this._gridNum=0,this._baseSize=0,this._lastSz=0,this._spaceWidthMap=[],this._minScoreID=-1,this._selectedSizeIdx=0,this.margin_left=0,this.margin_top=0,this.margin_bottom=0,this.margin_right=0,this.gcCnt=0,this._textureWidth=xe.textureWidth,this.fontFamily=t,this.margin_top=this.margin_left=this.margin_right=this.margin_bottom=i,this._baseSize=Math.floor(e/xe.gridSize)*xe.gridSize,this._selectedSizeIdx=e-this._baseSize|0,this._slotW=Math.ceil(e/xe.gridSize)*xe.gridSize,this._gridW=Math.floor(this._textureWidth/this._slotW),this._gridW<=0&&(console.error("文字太大,需要修改texture大小"),this._gridW=1),this._gridNum=this._gridW*this._gridW,console.log("gridInfo:slotW="+this._slotW+",gridw="+this._gridW+",gridNum="+this._gridNum+",textureW="+this._textureWidth)}s(t,"laya.webgl.resource.CharPages");var e=t.prototype;return e.getWidth=function(e){return t.charRender.getWidth(e)},e.selectSize=function(t,e){this._selectedSizeIdx=e-this._baseSize|0},e.getSpaceChar=function(){if(this._spaceWidthMap[this._selectedSizeIdx])return this._spaceWidthMap[this._selectedSizeIdx];var t=new Ge;return this._spaceWidthMap[this._selectedSizeIdx]=t,t.width=this.getWidth(" "),t.isSpace=!0,t},e.getChar=function(t,e,i,n,s,r,a,o){if(" "===t)return this.getSpaceChar(a);var h,l=e>0?t+"_"+e+s:t;n=16777215&n,s=16777215&s,l+=16777215===n?"#w":16711680===n?"#b":1048320===n?"#g":255===n?"#r":"#"+n.toString(16),r&&(l+="B"),o&&(l+=o);for(var _=0,u=this.pages.length;u>_;_++){var c=this.pages[_],d=c.charMaps[this._selectedSizeIdx];if(d&&(h=d.get(l)))return a&&h.touch(),h}if(h=this._getASlot(),!h)return null;var f=h.tex.charMaps[this._selectedSizeIdx];!f&&(f=h.tex.charMaps[this._selectedSizeIdx]=new Map),f.set(l,h),a&&h.touch();var p="",m="";p=((65280&n)+((255&n)<<16)+((16711680&n)>>16)).toString(16),p="#000000".substr(0,7-p.length)+p,e&&(m=((65280&s)+((255&s)<<16)+((16711680&s)>>16)).toString(16),m="#000000".substr(0,7-m.length)+m),h.height=i;var g=this.getCharBmp(t,xe._curFont,e,p,m,h);h.bmpWidth=g.width,h.bmpHeight=g.height;var v=Math.floor(h.pos/this._gridW),y=h.pos%this._gridW,E=y*this._slotW,S=v*this._slotW,A=this._textureWidth,C=E/A,D=S/A,x=(E+g.width)/A,R=(S+g.height)/A,T=h.uv;return T[0]=C,T[1]=D,T[2]=x,T[3]=D,T[4]=x,T[5]=R,T[6]=C,T[7]=R,h.tex.addChar(g,E,S),h},e._getASlot=function(){for(var t,e,i=this.pages.length,n=0;i>n;n++)if(t=this.pages[n],e=t.findAGrid())return e;return t=xe.trash.getAPage(this._gridNum),this.pages.push(t),e=t.findAGrid(),e||console.error("_getASlot error!"),e},e.getAllPageScore=function(){for(var t=0,e=this.pages.length,i=wi.loopCount,n=0,s=1e4;e>t;t++){var r=this.pages[t];r._scoreTick==i?n+=r._score:r._score=0,r._score<s&&(s=r._score,this._minScoreID=t)}return n},e.removeLRU=function(){var t=this._gridNum*this.pages.length-this.getAllPageScore();if(t>=this._gridNum){if(this._minScoreID>=0){var e=this.pages[this._minScoreID];console.log("remove fontpage: delpageid="+this._minScoreID+", total="+this.pages.length+",gcCnt:"+(this.gcCnt+1));var i=e._score;e.printDebugInfo(),xe.trash.discardPage(e),this.pages[this._minScoreID]=this.pages[this.pages.length-1],this.pages.pop();for(var n=wi.loopCount,s=0,r=this.pages.length;r>s&&i>0;s++){e=this.pages[s],console.log("clean page "+s);var a=e.removeOld(n);i-=a}}return this.gcCnt++,!0}return!1},e.getCharBmp=function(e,i,n,s,r,a){return t.charRender.getCharBmp(e,i,n,s,r,a,this.margin_left,this.margin_top,this.margin_right,this.margin_bottom)},t.getBmpSize=function(t){return 1.5*t},t.charRender=null,t}()),We=(function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._paramData=null,this._texture=null,this._x=0/0,this._y=0/0,this._width=0/0,this._height=0/0}s(t,"laya.layagl.cmdNative.DrawImageCmdNative");var e=t.prototype;return e.recover=function(){this._graphicsCmdEncoder=null,Ji.recover("DrawImageCmd",this)},r(0,e,"cmdID",function(){return"DrawImage"}),r(0,e,"y",function(){return this._y},function(e){this._y=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"texture",function(){return this._texture},function(e){this._texture=e,this._paramData._int32Data[t._PARAM_TEXTURE_POS_]=this._texture.bitmap._glTexture.id;var i=this._paramData._float32Data,n=this._texture.uv;i[t._PARAM_VB_POS_+2]=n[0],i[t._PARAM_VB_POS_+3]=n[1],i[t._PARAM_VB_POS_+8]=n[2],i[t._PARAM_VB_POS_+9]=n[3],i[t._PARAM_VB_POS_+14]=n[4],i[t._PARAM_VB_POS_+15]=n[5],i[t._PARAM_VB_POS_+20]=n[6],i[t._PARAM_VB_POS_+21]=n[7],we.syncBufferToRenderThread(this._paramData)}),r(0,e,"width",function(){return this._width},function(e){this._width=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"x",function(){return this._x},function(e){this._x=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_]=this._x,i[t._PARAM_VB_POS_+6]=this._x+this._width,i[t._PARAM_VB_POS_+12]=this._x+this._width,i[t._PARAM_VB_POS_+18]=this._x,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"height",function(){return this._height},function(e){this._height=e;var i=this._paramData._float32Data;i[t._PARAM_VB_POS_+1]=this._y,i[t._PARAM_VB_POS_+7]=this._y,i[t._PARAM_VB_POS_+13]=this._y+this._height,i[t._PARAM_VB_POS_+19]=this._y+this._height,we.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,n,s,r){var a=Ji.getItemByClass("DrawImageCmd",t);a._graphicsCmdEncoder=this._commandEncoder,t._DRAW_IMAGE_CMD_ENCODER_||(t._DRAW_IMAGE_CMD_ENCODER_=we.instance.createCommandEncoder(172,32,!0),t._DRAW_IMAGE_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_IMAGE_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),t._DRAW_IMAGE_CMD_ENCODER_.useVDO(he.VDO_MESHQUADTEXTURE),t._DRAW_IMAGE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_IMAGE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_IMAGE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_IMAGE_CMD_ENCODER_.uniformTextureByParamData(0,4,4*t._PARAM_TEXTURE_POS_),t._DRAW_IMAGE_CMD_ENCODER_.setRectMeshByParamData(12,4*t._PARAM_VB_POS_,16),t._DRAW_IMAGE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_IMAGE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_IMAGE_CMD_ENCODER_)),a._paramData||(a._paramData=new ParamData(116,!0)),a._texture=e,a._x=i,a._y=n,a._width=s,a._height=r;var o=a._paramData._float32Data,h=a._paramData._int32Data;h[0]=3,h[1]=33984,h[t._PARAM_TEXTURE_POS_]=e.getIsReady()?e.bitmap._glTexture.id:0,h[3]=1,h[4]=96;var l=0!=s?s:e.bitmap.width,_=0!=r?r:e.bitmap.height,u=e.uv,c=t._PARAM_VB_POS_;return o[c++]=i,o[c++]=n,o[c++]=u[0],o[c++]=u[1],h[c++]=4294967295,h[c++]=4294967295,o[c++]=i+l,o[c++]=n,o[c++]=u[2],o[c++]=u[3],h[c++]=4294967295,h[c++]=4294967295,o[c++]=i+l,o[c++]=n+_,o[c++]=u[4],o[c++]=u[5],h[c++]=4294967295,h[c++]=4294967295,o[c++]=i,o[c++]=n+_,o[c++]=u[6],o[c++]=u[7],h[c++]=4294967295,h[c++]=4294967295,we.syncBufferToRenderThread(a._paramData),a._graphicsCmdEncoder.useCommandEncoder(t._DRAW_IMAGE_CMD_ENCODER_.getPtrID(),a._paramData.getPtrID(),-1),we.syncBufferToRenderThread(a._graphicsCmdEncoder),a},t.ID="DrawImage",t._DRAW_IMAGE_CMD_ENCODER_=null,t._PARAM_TEXTURE_POS_=2,t._PARAM_VB_POS_=5,t}(),function(){function t(){}s(t,"laya.display.cmd.RestoreCmd");var e=t.prototype;return e.recover=function(){Ji.recover("RestoreCmd",this)},e.run=function(t){t.restore()},r(0,e,"cmdID",function(){return"Restore"}),t.create=function(){var e=Ji.getItemByClass("RestoreCmd",t);return e},t.ID="Restore",t}()),Ge=(function(){function t(){this._graphicsCmdEncoder=null,this._paramData=new ParamData(16,!0)}s(t,"laya.layagl.cmdNative.ClipRectCmdNative");var e=t.prototype;return e.recover=function(){Ji.recover("ClipRectCmd",this)},r(0,e,"cmdID",function(){return"ClipRect"}),r(0,e,"width",function(){return 0},function(){}),r(0,e,"x",function(){return 0},function(){}),r(0,e,"y",function(){return 0},function(){}),r(0,e,"height",function(){return 0},function(){}),t.create=function(e,i,n,s){var r=Ji.getItemByClass("ClipRectCmd",t);r._graphicsCmdEncoder=this._commandEncoder;var a=r._graphicsCmdEncoder,o=r._paramData._float32Data;o[0]=e,o[1]=i,o[2]=n,o[3]=s;var h=r._paramData.getPtrID();return we.syncBufferToRenderThread(r._paramData),a.setClipValueEx(he.GLOBALVALUE_CLIP_MAT_DIR,he.GLOBALVALUE_CLIP_MAT_POS,he.GLOBALVALUE_MATRIX32,h),we.syncBufferToRenderThread(a),r},t.ID="ClipRect",t}(),function(){function t(){this.char="",this.tex=null,this.deleted=!1,this.uv=[0,0,1,1],this.pos=0,this.width=0,this.height=0,this.bmpWidth=0,this.bmpHeight=0,this.touchTick=0,this.isSpace=!1}s(t,"laya.webgl.resource.CharRenderInfo");var e=t.prototype;return e.touch=function(){var t=wi.loopCount;this.tex._scoreTick!=t&&(this.tex._score=0,this.tex._scoreTick=t),this.touchTick!=t&&this.tex._score++,this.touchTick=t},t}()),ze=function(){function t(){this._one=null,this._cmds=null,this.autoDestroy=!1,this._render=this._renderEmpty,this._createData()}s(t,"laya.display.Graphics");var e=t.prototype;return e._createData=function(){},e._clearData=function(){},e._destroyData=function(){},e.destroy=function(){this.clear(!0),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0,this._sp._setRenderType(0),this._sp=null),this._destroyData()},e.clear=function(t){if(void 0===t&&(t=!0),t){var e=this._one;if(this._cmds){var i=0,n=this._cmds.length;for(i=0;n>i;i++)e=this._cmds[i],e.recover();this._cmds.length=0}else e&&e.recover()}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._clearData(),this._sp&&(this._sp._renderType&=-513,this._sp._setRenderType(this._sp._renderType)),this._repaint(),this._vectorgraphArray){for(i=0,n=this._vectorgraphArray.length;n>i;i++)yi.getInstance().deleteShape(this._vectorgraphArray[i]);this._vectorgraphArray.length=0}},e._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},e._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=zi.create(),this._graphicBounds._graphics=this)},e._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},e._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},e.getBounds=function(t){return void 0===t&&(t=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(t)},e.getBoundPoints=function(t){return void 0===t&&(t=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(t)},e.drawImage=function(t,e,i,n,s){if(void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),!t)return null;if(n||(n=t.sourceWidth),s||(s=t.sourceHeight),t.getIsReady()){var r=n/t.sourceWidth,a=s/t.sourceHeight;if(n=t.width*r,s=t.height*a,0>=n||0>=s)return null;e+=t.offsetX*r,i+=t.offsetY*a}this._sp&&(this._sp._renderType|=512,this._sp._setRenderType(this._sp._renderType));var o=li.create.call(this,t,e,i,n,s);return null==this._one?(this._one=o,this._render=this._renderOneImg):this._saveToCmd(null,o),this._repaint(),o},e.drawTexture=function(t,e,i,n,s,r,a,h,l){if(void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===a&&(a=1),!t||.01>a)return null;if(!t.getIsReady())return null;if(n||(n=t.sourceWidth),s||(s=t.sourceHeight),t.getIsReady()){var _=!Ni.isWebGL&&(Be.onFirefox||Be.onEdge||Be.onIE||Be.onSafari)?.5:0,u=n/t.sourceWidth,c=s/t.sourceHeight;if(n=t.width*u,s=t.height*c,0>=n||0>=s)return null;e+=t.offsetX*u,i+=t.offsetY*c,e-=_,i-=_,n+=2*_,s+=2*_}if(this._sp&&(this._sp._renderType|=512,this._sp._setRenderType(this._sp._renderType)),!Ni.isConchApp&&!Ni.isWebGL&&(l||h)){var d=new Is;d.size(n,s);var f=d.getContext("2d");if(f.drawTexture(t,0,0,n,s),t=new _n(d),h){var p=new xi,m=o.create(h).arrColor;p.data=(new gn).color(255*m[0],255*m[1],255*m[2]),p.apply({ctx:{ctx:f}})}}var g=Qe.create.call(this,t,e,i,n,s,r,a,h,l);return this._repaint(),this._saveToCmd(null,g)},e.drawTextures=function(t,e){return t?this._saveToCmd(Ni._context._drawTextures,Li.create.call(this,t,e)):null},e.drawTriangles=function(t,e,i,n,s,r,a,o,h,l){return void 0===o&&(o=1),this._saveToCmd(Ni._context.drawTriangles,Zi.create.call(this,t,e,i,n,s,r,a,o,h,l))},e.fillTexture=function(t,e,i,n,s,r,a){return void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r="repeat"),t&&t.getIsReady()?this._saveToCmd(Ni._context._fillTexture,Se.create.call(this,t,e,i,n,s,r,a||$i.EMPTY,{})):null},e._saveToCmd=function(t,e){return this._sp&&(this._sp._renderType|=512,this._sp._setRenderType(this._sp._renderType)),null==this._one?(this._one=e,this._render=this._renderOne):(this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(e)),this._repaint(),e},e.clipRect=function(t,e,i,n){return this._saveToCmd(Ni._context._clipRect,w.create.call(this,t,e,i,n))},e.fillText=function(t,e,i,n,s,r){return this._saveToCmd(Ni._context._fillText,ai.create.call(this,t,e,i,n||Cs.defaultFontStr(),s,r))},e.fillBorderText=function(t,e,i,n,s,r,a,o){return this._saveToCmd(Ni._context._fillBorderText,vi.create.call(this,t,e,i,n||Cs.defaultFontStr(),s,r,a,o))},e.fillWords=function(t,e,i,n,s){return this._saveToCmd(Ni._context._fillWords,k.create.call(this,t,e,i,n||Cs.defaultFontStr(),s))},e.fillBorderWords=function(t,e,i,n,s,r,a){return this._saveToCmd(Ni._context._fillBorderWords,Pi.create.call(this,t,e,i,n||Cs.defaultFontStr(),s,r,a))},e.strokeText=function(t,e,i,n,s,r,a){return this._saveToCmd(Ni._context._strokeText,nn.create.call(this,t,e,i,n||Cs.defaultFontStr(),s,r,a))},e.alpha=function(t){return this._saveToCmd(Ni._context._alpha,ti.create.call(this,t))},e.transform=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),this._saveToCmd(Ni._context._transform,F.create.call(this,t,e,i))},e.rotate=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),this._saveToCmd(Ni._context._rotate,Vi.create.call(this,t,e,i))},e.scale=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),this._saveToCmd(Ni._context._scale,Je.create.call(this,t,e,i,n))},e.translate=function(t,e){return this._saveToCmd(Ni._context._translate,ge.create.call(this,t,e))},e.save=function(){return this._saveToCmd(Ni._context._save,Ke.create.call(this))},e.restore=function(){return this._saveToCmd(Ni._context._restore,We.create.call(this))},e.replaceText=function(t){this._repaint();var e=this._cmds;if(e){for(var i=e.length-1;i>-1;i--)if(this._isTextCmd(e[i]))return e[i].text=t,!0}else if(this._one&&this._isTextCmd(this._one))return this._one.text=t,!0;return!1},e._isTextCmd=function(t){var e=t.cmdID;return"FillText"==e||"StrokeText"==e||"FillBorderText"==e},e.replaceTextColor=function(t){this._repaint();var e=this._cmds;if(e)for(var i=e.length-1;i>-1;i--)this._isTextCmd(e[i])&&this._setTextCmdColor(e[i],t);else this._one&&this._isTextCmd(this._one)&&this._setTextCmdColor(this._one,t)},e._setTextCmdColor=function(t,e){var i=t.cmdID;switch(i){case"FillText":case"StrokeText":t.color=e;break;case"FillBorderText":case"FillBorderWords":case"FillBorderText":t.fillColor=e}},e.loadImage=function(t,e,i,n,s,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0);var a=un.getRes(t);a?a.getIsReady()?this.drawImage(a,e,i,n,s):a.once("ready",this,this.drawImage,[a,e,i,n,s]):(a=new _n,a.load(t),un.cacheRes(t,a),a.once("ready",this,this.drawImage,[a,e,i,n,s])),null!=r&&(a.getIsReady()?r.call(this._sp):a.on("ready",this._sp,r))},e._renderEmpty=function(){},e._renderAll=function(t,e,i,n){for(var s,r=this._cmds,a=0,o=r.length;o>a;a++)(s=r[a]).run(e,i,n)},e._renderOne=function(t,e,i,n){this._one.run(e,i,n)},e._renderOneImg=function(t,e,i,n){this._one.run(e,i,n)},e.drawLine=function(t,e,i,n,s,r){void 0===r&&(r=1);var a=0;Ni.isWebGL&&(a=yi.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(a));var o=1>r||r%2===0?0:.5;return this._saveToCmd(Ni._context._drawLine,ue.create.call(this,t+o,e+o,i+o,n+o,s,r,a))},e.drawLines=function(t,e,i,n,s){void 0===s&&(s=1);
var r=0;if(!i||i.length<4)return null;Ni.isWebGL&&(r=yi.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(r));var a=1>s||s%2===0?0:.5;return this._saveToCmd(Ni._context._drawLines,ke.create.call(this,t+a,e+a,i,n,s,r))},e.drawCurves=function(t,e,i,n,s){return void 0===s&&(s=1),this._saveToCmd(Ni._context._drawCurves,$.create.call(this,t,e,i,n,s))},e.drawRect=function(t,e,i,n,s,r,a){void 0===a&&(a=1);var o=a>=1&&r?a/2:0,h=r?a:0;return this._saveToCmd(Ni._context.drawRect,re.create.call(this,t+o,e+o,i-h,n-h,s,r,a))},e.drawCircle=function(t,e,i,n,s,r){void 0===r&&(r=1);var a=r>=1&&s?r/2:0,o=0;return Ni.isWebGL&&(o=yi.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(o)),this._saveToCmd(Ni._context._drawCircle,di.create.call(this,t,e,i-a,n,s,r,o))},e.drawPie=function(t,e,i,n,s,r,a,o){void 0===o&&(o=1);var h=o>=1&&a?o/2:0,l=a?o:0,_=0;return Ni.isWebGL&&(_=yi.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(_)),this._saveToCmd(Ni._context._drawPie,Me.create.call(this,t+h,e+h,i-l,ee.toRadian(n),ee.toRadian(s),r,a,o,_))},e.drawPoly=function(t,e,i,n,s,r){void 0===r&&(r=1);var a=0;if(Ni.isWebGL){a=yi.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(a);var o=!1;o=i.length>6?!1:!0}var h=r>=1&&s?r%2===0?0:.5:0;return this._saveToCmd(Ni._context._drawPoly,B.create.call(this,t+h,e+h,i,n,s,r,o,a))},e.drawPath=function(t,e,i,n,s){return this._saveToCmd(Ni._context._drawPath,Ae.create.call(this,t,e,i,n,s))},r(0,e,"cmds",function(){return this._cmds},function(t){this._sp&&(this._sp._renderType|=512,this._sp._setRenderType(this._sp._renderType)),this._cmds=t,this._render=this._renderAll,this._repaint()}),t}(),Xe=function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._paramData=null,this.texture=null,this.x=0/0,this.y=0/0,this.width=0/0,this.height=0/0}s(t,"laya.display.cmd.DrawCanvasCmd");var e=t.prototype;return e.recover=function(){this._graphicsCmdEncoder=null,Ji.recover("DrawCanvasCmd",this)},r(0,e,"cmdID",function(){return"DrawCanvasCmd"}),t.create=function(){return null},t.ID="DrawCanvasCmd",t._DRAW_IMAGE_CMD_ENCODER_=null,t._PARAM_TEXTURE_POS_=2,t._PARAM_VB_POS_=5,t}(),He=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.width=i,this.height=n}s(t,"laya.maths.Rectangle");var e=t.prototype;return e.setTo=function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},e.reset=function(){return this.x=this.y=this.width=this.height=0,this},e.recover=function(){Ji.recover("Rectangle",this.reset())},e.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},e.contains=function(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.right&&e>=this.y&&e<this.bottom?!0:!1},e.intersects=function(t){return!(t.x>this.x+this.width||t.x+t.width<this.x||t.y>this.y+this.height||t.y+t.height<this.y)},e.intersection=function(e,i){return this.intersects(e)?(i||(i=new t),i.x=Math.max(this.x,e.x),i.y=Math.max(this.y,e.y),i.width=Math.min(this.right,e.right)-i.x,i.height=Math.min(this.bottom,e.bottom)-i.y,i):null},e.union=function(e,i){return i||(i=new t),this.clone(i),e.width<=0||e.height<=0?i:(i.addPoint(e.x,e.y),i.addPoint(e.right,e.bottom),this)},e.clone=function(e){return e||(e=new t),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},e.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},e.equals=function(t){return t&&t.x===this.x&&t.y===this.y&&t.width===this.width&&t.height===this.height?!0:!1},e.addPoint=function(t,e){return this.x>t&&(this.width+=this.x-t,this.x=t),this.y>e&&(this.height+=this.y-e,this.y=e),this.width<t-this.x&&(this.width=t-this.x),this.height<e-this.y&&(this.height=e-this.y),this},e._getBoundPoints=function(){var e=t._temB;return e.length=0,0==this.width||0==this.height?e:(e.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),e)},e.isEmpty=function(){return this.width<=0||this.height<=0?!0:!1},r(0,e,"right",function(){return this.x+this.width}),r(0,e,"bottom",function(){return this.y+this.height}),t.create=function(){return Ji.getItemByClass("Rectangle",t)},t._getBoundPointS=function(e,i,n,s){var r=t._temA;return r.length=0,0==n||0==s?r:(r.push(e,i,e+n,i,e,i+s,e+n,i+s),r)},t._getWrapRec=function(e,i){if(!e||e.length<1)return i?i.setTo(0,0,0,0):t.TEMP.setTo(0,0,0,0);i=i?i:laya.maths.Rectangle.create();var n,s,r,a,o,h=e.length,l=$i.TEMP;for(s=a=99999,r=o=-s,n=0;h>n;n+=2)l.x=e[n],l.y=e[n+1],s=s<l.x?s:l.x,a=a<l.y?a:l.y,r=r>l.x?r:l.x,o=o>l.y?o:l.y;return i.setTo(s,a,r-s,o-a)},t.EMPTY=new t,t.TEMP=new t,t._temB=[],t._temA=[],t}(),Ye=function(){function t(){this._idata=[]}s(t,"laya.layagl.CommandEncoder");var e=t.prototype;return e.getArrayData=function(){return this._idata},e.getPtrID=function(){return 0},e.beginEncoding=function(){},e.endEncoding=function(){},e.clearEncoding=function(){this._idata.length=0},e.getCount=function(){return this._idata.length},e.add_ShaderValue=function(t){this._idata.push(t)},e.addShaderUniform=function(t){this.add_ShaderValue(t)},t}(),je=(function(){function t(){this._graphicsCmdEncoder=null,this._index=0,this._text=null,this._x=0/0,this._y=0/0,this._font=null,this._color=null,this._strokeColor=null,this._strokeWidth=0,this._textAlign=null,this._draw_texture_cmd_encoder_=we.instance.createCommandEncoder(64,32,!0)}s(t,"laya.layagl.cmdNative.FillBorderTextCmdNative");var e=t.prototype;return e.createFillBorderText=function(e,i,n,s,r,a,h,l,_){var u=o.create(a),c=(u.numColor,{});c._curMat=new fi,c._italicDeg=0,c._drawTextureUseColor=4294967295,c.fillStyle=a,c._fillColor=4294967295,c.setFillColor=function(t){c._fillColor=t},c.getFillColor=function(){return c._fillColor},c.mixRGBandAlpha=function(t){return t},c._drawTextureM=function(t,i,n,s,r,a,o,h){e.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),e.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),e.useVDO(he.VDO_MESHQUADTEXTURE),e.uniformEx(he.GLOBALVALUE_VIEWS,0),e.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),e.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),e.uniformTexture(3,33984,t.bitmap._glTexture);var l=new Float32Array([i,n,h[0],h[1],0,0,i+s,n,h[2],h[3],0,0,i+s,n+r,h[4],h[5],0,0,i,n+r,h[6],h[7],0,0]),_=new Int32Array(l.buffer);_[4]=_[10]=_[16]=_[22]=4294967295,_[5]=_[11]=_[17]=_[23]=4294967295,e.setRectMesh(1,l,l.length),e.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),e.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(e)},t.cbook.filltext_native(c,i,null,n,s,r,a,h,l,_)},e.recover=function(){this._graphicsCmdEncoder=null,Ji.recover("FillBorderTextCmd",this)},r(0,e,"text",function(){return this._text},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._text=t,this.createFillBorderText(e,this._text,this._x,this._y,this._font,this._color,this._strokeColor,this._strokeWidth,this._textAlign),we.syncBufferToRenderThread(e)}),r(0,e,"cmdID",function(){return"FillBorderText"}),r(0,e,"font",function(){return this._font},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._font=t,this.createFillBorderText(e,this._text,this._x,this._y,this._font,this._color,this._strokeColor,this._strokeWidth,this._textAlign),we.syncBufferToRenderThread(e)}),r(0,e,"color",function(){return this._color},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._color=t,this.createFillBorderText(e,this._text,this._x,this._y,this._font,this._color,this._strokeColor,this._strokeWidth,this._textAlign),we.syncBufferToRenderThread(e)}),r(0,e,"textAlign",function(){return this._textAlign},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._textAlign=t,this.createFillBorderText(e,this._text,this._x,this._y,this._font,this._color,this._strokeColor,this._strokeWidth,this._textAlign),we.syncBufferToRenderThread(e)}),r(0,e,"x",function(){return this._x},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._x=t,this.createFillBorderText(e,this._text,this._x,this._y,this._font,this._color,this._strokeColor,this._strokeWidth,this._textAlign),we.syncBufferToRenderThread(e)}),r(0,e,"y",function(){return this._y},function(t){var e=this._draw_texture_cmd_encoder_;e.clearEncoding(),this._y=t,this.createFillBorderText(e,this._text,this._x,this._y,this._font,this._color,this._strokeColor,this._strokeWidth,this._textAlign),we.syncBufferToRenderThread(e)}),t.create=function(e,i,n,s,r,a,o,h){t.cbook||new Error("Error:charbook not create!");var l=Ji.getItemByClass("FillBorderTextCmd",t),_=l._graphicsCmdEncoder=this._commandEncoder;return l._text=e,l._x=i,l._y=n,l._font=s,l._color=r,l._strokeColor=a,l._strokeWidth=o,l._textAlign=h,l._draw_texture_cmd_encoder_.clearEncoding(),l.createFillBorderText(l._draw_texture_cmd_encoder_,e,i,n,s,r,a,o,h),we.syncBufferToRenderThread(l._draw_texture_cmd_encoder_),_.useCommandEncoder(l._draw_texture_cmd_encoder_.getPtrID(),-1,-1),we.syncBufferToRenderThread(_),l},t.ID="FillBorderText",n(t,["cbook",function(){return this.cbook=xe.charbookInst}]),t}(),function(){function t(){}return s(t,"laya.layagl.LayaGLRunner"),t.uploadShaderUniforms=function(t,e,i,n){for(var s=i._data,r=e.getArrayData(),a=0,o=0,h=r.length;h>o;o++){var l=r[o];if(n||-1!==l.textureID){var _=s[l.dataOffset];null!=_&&(a+=l.fun.call(l.caller,l,_))}}return a},t.uploadCustomUniform=function(t,e,i,n){var s=0,r=e[i];return r&&null!=n&&(s+=r.fun.call(r.caller,r,n)),s},t.uploadShaderUniformsForNative=function(t,e,i){var n=0;i._runtimeCopyValues.length>=0&&(n=1);var s=i._data;return t.uploadShaderUniforms(e,s,n)},t}()),Ze=function(){function t(){this.blendShader=0,this.submitType=0,this.other=0,this.clear()}s(t,"laya.webgl.submit.SubmitKey");var e=t.prototype;return e.clear=function(){this.submitType=-1,this.blendShader=this.other=0},e.copyFrom=function(t){this.other=t.other,this.blendShader=t.blendShader,this.submitType=t.submitType},e.copyFrom2=function(t,e,i){this.blendShader=t.blendShader,this.other=i,this.submitType=e},e.equal3_2=function(t,e,i){return this.submitType===e&&this.other===i&&this.blendShader===t.blendShader},e.equal4_2=function(t,e,i){return this.submitType===e&&this.other===i&&this.blendShader===t.blendShader},e.equal_3=function(t){return this.submitType===t.submitType&&this.blendShader===t.blendShader},e.equal=function(t){return this.other===t.other&&this.submitType===t.submitType&&this.blendShader===t.blendShader},t}(),qe=(function(){function t(){this._graphicsCmdEncoder=null,this._paramData=new ParamData(12,!0)}s(t,"laya.layagl.cmdNative.RotateCmdNative");var e=t.prototype;return e.recover=function(){Ji.recover("RotateCmd",this)},r(0,e,"cmdID",function(){return"Rotate"}),r(0,e,"angle",function(){return this._paramData._float32Data[0]},function(t){this._paramData._float32Data[0]=t,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"pivotX",function(){return this._paramData._float32Data[1]},function(t){this._paramData._float32Data[1]=t,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"pivotY",function(){return this._paramData._float32Data[2]},function(t){this._paramData._float32Data[2]=t,we.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,n){var s=Ji.getItemByClass("RotateCmd",t),r=s._graphicsCmdEncoder=this._commandEncoder,a=s._paramData._float32Data;a[0]=e,a[1]=i,a[2]=n;var o=s._paramData.getPtrID();return we.syncBufferToRenderThread(s._paramData),r.setGlobalValueEx(he.GLOBALVALUE_MATRIX32,13,o,0),we.syncBufferToRenderThread(r),s},t.ID="Rotate",t}(),function(){function t(){this._graphicsCmdEncoder=null,this._paramData=new ParamData(16,!0)}s(t,"laya.layagl.cmdNative.ScaleCmdNative");var e=t.prototype;return e.recover=function(){Ji.recover("ScaleCmd",this)},r(0,e,"cmdID",function(){return"Scale"}),r(0,e,"scaleX",function(){return this._paramData._float32Data[0]},function(t){this._paramData._float32Data[0]=t,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"scaleY",function(){return this._paramData._float32Data[1]},function(t){this._paramData._float32Data[1]=t,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"pivotX",function(){return this._paramData._float32Data[2]},function(t){this._paramData._float32Data[2]=t,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"pivotY",function(){return this._paramData._float32Data[3]},function(t){this._paramData._float32Data[3]=t,we.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,n,s){var r=Ji.getItemByClass("ScaleCmd",t),a=r._graphicsCmdEncoder=this._commandEncoder,o=r._paramData._float32Data;o[0]=e,o[1]=i,o[2]=n,o[3]=s;var h=r._paramData.getPtrID();return we.syncBufferToRenderThread(r._paramData),a.setGlobalValueEx(he.GLOBALVALUE_MATRIX32,12,h,0),we.syncBufferToRenderThread(a),r},t.ID="Scale",t}(),function(){function t(){this._nativeVertexArrayObject=null,this._bindedIndexBuffer=null,this._nativeVertexArrayObject=we.instance.createVertexArray()}s(t,"laya.webgl.BufferStateBase");var e=t.prototype;return e.bind=function(){t._curBindedBufferState!==this&&(we.instance.bindVertexArray(this._nativeVertexArrayObject),t._curBindedBufferState=this)},e.unBind=function(){if(t._curBindedBufferState!==this)throw"BufferState: must call bind() function first.";we.instance.bindVertexArray(null),t._curBindedBufferState=null},e.bindForNative=function(){we.instance.bindVertexArray(this._nativeVertexArrayObject),t._curBindedBufferState=this},e.unBindForNative=function(){we.instance.bindVertexArray(null),t._curBindedBufferState=null},e.destroy=function(){we.instance.deleteVertexArray(this._nativeVertexArrayObject)},t._curBindedBufferState=null,t}()),Ke=(function(){function t(){this._graphicsCmdEncoder=null,this._paramData=new ParamData(8,!0)}s(t,"laya.layagl.cmdNative.TranslateCmdNative");var e=t.prototype;return e.recover=function(){Ji.recover("TranslateCmd",this)},r(0,e,"ty",function(){return this._paramData._float32Data[1]},function(t){this._paramData._float32Data[1]=t,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"cmdID",function(){return"Translate"}),r(0,e,"tx",function(){return this._paramData._float32Data[0]},function(t){this._paramData._float32Data[0]=t,we.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i){var n=Ji.getItemByClass("TranslateCmd",t),s=n._graphicsCmdEncoder=this._commandEncoder,r=n._paramData._float32Data;r[0]=e,r[1]=i;var a=n._paramData.getPtrID();return we.syncBufferToRenderThread(n._paramData),s.setGlobalValueEx(he.GLOBALVALUE_MATRIX32,9,a,0),we.syncBufferToRenderThread(s),n},t.ID="Translate",t}(),function(){function t(){}s(t,"laya.display.cmd.SaveCmd");var e=t.prototype;return e.recover=function(){Ji.recover("SaveCmd",this)},e.run=function(t){t.save()},r(0,e,"cmdID",function(){return"Save"}),t.create=function(){var e=Ji.getItemByClass("SaveCmd",t);return e},t.ID="Save",t}()),$e=function(){function t(){this.rec=new He,this.reset()}s(t,"laya.html.dom.HTMLHitRect");var e=t.prototype;return e.reset=function(){return this.rec.reset(),this.href=null,this},e.recover=function(){Ji.recover("HTMLHitRect",this.reset())},t.create=function(){return Ji.getItemByClass("HTMLHitRect",t)},t}(),Je=function(){function t(){}s(t,"laya.display.cmd.ScaleCmd");var e=t.prototype;return e.recover=function(){Ji.recover("ScaleCmd",this)},e.run=function(t,e,i){t._scale(this.scaleX,this.scaleY,this.pivotX+e,this.pivotY+i)},r(0,e,"cmdID",function(){return"Scale"}),t.create=function(e,i,n,s){var r=Ji.getItemByClass("ScaleCmd",t);return r.scaleX=e,r.scaleY=i,r.pivotX=n,r.pivotY=s,r},t.ID="Scale",t}(),Qe=function(){function t(){}s(t,"laya.display.cmd.DrawTextureCmd");var e=t.prototype;return e.recover=function(){this.texture._removeReference(),this.texture=null,this.matrix=null,Ji.recover("DrawTextureCmd",this)},e.run=function(t,e,i){t.drawTextureWithTransform(this.texture,this.x,this.y,this.width,this.height,this.matrix,e,i,this.alpha,this.blendMode)},r(0,e,"cmdID",function(){return"DrawTexture"}),t.create=function(e,i,n,s,r,a,o,h,l){var _=Ji.getItemByClass("DrawTextureCmd",t);return _.texture=e,e._addReference(),_.x=i,_.y=n,_.width=s,_.height=r,_.matrix=a,_.alpha=o,_.color=h,_.blendMode=l,_},t.ID="DrawTexture",t}(),ti=(function(){function t(){}return s(t,"laya.webgl.VertexArrayObject"),t}()(function(){function e(e){t.console&&t.console.error&&t.console.error(e)}function i(e){t.console&&t.console.log&&t.console.log(e)}function n(t,i){r[t]=!0,void 0!==i&&e(i)}function s(t){var e=t.getError;t.getError=function(){var i;do i=e.apply(t),i!=t.NO_ERROR&&(r[i]=!0);while(i!=t.NO_ERROR);for(var i in r)if(r[i])return delete r[i],parseInt(i);return t.NO_ERROR}}var r={},a=function h(t){var e=t.gl;this.ext=t,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(t.maxVertexAttribs);for(var i=0;i<this.attribs.length;i++){var n=new h.VertexAttrib(e);this.attribs[i]=n}this.maxAttrib=0};a.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=t.FLOAT,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()},a.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var o=function(t){var e=this;this.gl=t,s(t);var n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t==e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject==e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){var i=e.currentVertexArrayObject;i.maxAttrib=Math.max(i.maxAttrib,t);var s=i.attribs[t];return s.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){var i=e.currentVertexArrayObject;i.maxAttrib=Math.max(i.maxAttrib,t);var s=i.attribs[t];return s.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(i,s){switch(i){case t.ARRAY_BUFFER:e.currentArrayBuffer=s;break;case t.ELEMENT_ARRAY_BUFFER:e.currentVertexArrayObject.elementArrayBuffer=s}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(i,s){var r=e.currentVertexArrayObject,a=r.attribs[i];switch(s){case t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return a.buffer;case t.VERTEX_ATTRIB_ARRAY_ENABLED:return a.enabled;case t.VERTEX_ATTRIB_ARRAY_SIZE:return a.size;case t.VERTEX_ATTRIB_ARRAY_STRIDE:return a.stride;case t.VERTEX_ATTRIB_ARRAY_TYPE:return a.type;case t.VERTEX_ATTRIB_ARRAY_NORMALIZED:return a.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,i,s,r,a,o){var h=e.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,t);var l=h.attribs[t];return l.buffer=e.currentArrayBuffer,l.size=i,l.type=s,l.normalized=r,l.stride=a,l.offset=o,l.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener&&t.canvas.addEventListener("webglcontextrestored",function(){i("OESVertexArrayObject emulation library context restored"),e.reset_()},!0),this.reset_()};o.prototype.VERTEX_ARRAY_BINDING_OES=34229,o.prototype.reset_=function(){var t=void 0!==this.vertexArrayObjects;if(t)for(var e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;var i=this.gl;this.maxVertexAttribs=i.getParameter(i.MAX_VERTEX_ATTRIBS),this.defaultVertexArrayObject=new a(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},o.prototype.createVertexArrayOES=function(){var t=new a(this);return this.vertexArrayObjects.push(t),t},o.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject==t&&this.bindVertexArrayOES(null)},o.prototype.isVertexArrayOES=function(t){return t&&t instanceof a&&t.hasBeenBound&&t.ext==this?!0:!1},o.prototype.bindVertexArrayOES=function(t){var e=this.gl;if(t&&!t.isAlive)return n(e.INVALID_OPERATION,"bindVertexArrayOES: attempt to bind deleted arrayObject"),void 0;var i=this.original,s=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;var r=this.currentVertexArrayObject;if(s!=r){s&&r.elementArrayBuffer==s.elementArrayBuffer||i.bindBuffer.call(e,e.ELEMENT_ARRAY_BUFFER,r.elementArrayBuffer);for(var a=this.currentArrayBuffer,o=Math.max(s?s.maxAttrib:0,r.maxAttrib),h=0;o>=h;h++){var l=r.attribs[h],_=s?s.attribs[h]:null;if(s&&l.enabled==_.enabled||(l.enabled?i.enableVertexAttribArray.call(e,h):i.disableVertexAttribArray.call(e,h)),l.enabled){var u=!1;s&&l.buffer==_.buffer||(a!=l.buffer&&(i.bindBuffer.call(e,e.ARRAY_BUFFER,l.buffer),a=l.buffer),u=!0),(u||l.cached!=_.cached)&&i.vertexAttribPointer.call(e,h,l.size,l.type,l.normalized,l.stride,l.offset)}}this.currentArrayBuffer!=a&&i.bindBuffer.call(e,e.ARRAY_BUFFER,this.currentArrayBuffer)}},t._setupVertexArrayObject=function(t){var e=t.getSupportedExtensions;t.getSupportedExtensions=function(){var t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};var i=t.getExtension;t.getExtension=function(t){var e=i.call(this,t);return e?e:"OES_vertex_array_object"!==t?null:(this.__OESVertexArrayObject||(console.log("Setup OES_vertex_array_object polyfill"),this.__OESVertexArrayObject=new o(this)),this.__OESVertexArrayObject)}},t._forceSetupVertexArrayObject=function(t){var e=t.getSupportedExtensions;t.getSupportedExtensions=function(){var t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};var i=t.getExtension;t.getExtension=function(t){if("OES_vertex_array_object"===t)return this.__OESVertexArrayObject||(console.log("Setup OES_vertex_array_object polyfill"),this.__OESVertexArrayObject=new o(this)),this.__OESVertexArrayObject;var e=i.call(this,t);return e?e:null}}}()),function(){function t(){}s(t,"laya.display.cmd.AlphaCmd");var e=t.prototype;return e.recover=function(){Ji.recover("AlphaCmd",this)},e.run=function(t){t.alpha(this.alpha)},r(0,e,"cmdID",function(){return"Alpha"}),t.create=function(e){var i=Ji.getItemByClass("AlphaCmd",t);return i.alpha=e,i},t.ID="Alpha",t}()),ei=(function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this.vbBuffer=null,this._template=null,this._floatCountPerVertex=29,this._firstNewElement=0,this._firstFreeElement=0,this._firstActiveElement=0,this._firstRetiredElement=0,this._maxParticleNum=0}s(t,"laya.layagl.cmdNative.DrawParticleCmdNative");var e=t.prototype;return e.updateParticle=function(){if(this._template.texture){this._template.updateParticleForNative();var e=this._template.sv,i=this._paramData._int32Data,n=this._paramData._float32Data;n[t._PARAM_CURRENTTIME_POS_]=e.u_CurrentTime,n[t._PARAM_DURATION_POS_]=e.u_Duration,n[t._PARAM_ENDVEL_POS_]=e.u_EndVelocity,n[t._PARAM_GRAVITY_POS_]=e.u_Gravity[0],n[t._PARAM_GRAVITY_POS_+1]=e.u_Gravity[1],n[t._PARAM_GRAVITY_POS_+2]=e.u_Gravity[2],e.size[0]=pi.width,e.size[1]=pi.height,n[t._PARAM_SIZE_POS_]=e.size[0],n[t._PARAM_SIZE_POS_+1]=e.size[1],n[t._PARAM_MAT_POS_]=1,n[t._PARAM_MAT_POS_+1]=0,n[t._PARAM_MAT_POS_+2]=0,n[t._PARAM_MAT_POS_+3]=0,n[t._PARAM_MAT_POS_+4]=0,n[t._PARAM_MAT_POS_+5]=1,n[t._PARAM_MAT_POS_+6]=0,n[t._PARAM_MAT_POS_+7]=0,n[t._PARAM_MAT_POS_+8]=0,n[t._PARAM_MAT_POS_+9]=0,n[t._PARAM_MAT_POS_+10]=1,n[t._PARAM_MAT_POS_+11]=0,n[t._PARAM_MAT_POS_+12]=0,n[t._PARAM_MAT_POS_+13]=0,n[t._PARAM_MAT_POS_+14]=0,n[t._PARAM_MAT_POS_+15]=1,i[t._PARAM_TEXTURE_LOC_POS_]=33984,i[t._PARAM_TEXTURE_POS_]=this._template.texture.bitmap._glTexture.id,this.vbBuffer=this._template.getConchMesh(),this._firstNewElement=this._template.getFirstNewElement(),this._firstFreeElement=this._template.getFirstFreeElement(),this._firstActiveElement=this._template.getFirstActiveElement(),this._firstRetiredElement=this._template.getFirstRetiredElement();var s=0,r=0,a=0,o=0,h=0,l=0;this._firstActiveElement!=this._firstFreeElement&&(this._firstActiveElement<this._firstFreeElement?(i[t._PARAM_REGDATA_POS_]=1,h=this._firstFreeElement-this._firstActiveElement,s=(this._firstFreeElement-this._firstActiveElement)*this._floatCountPerVertex*4*4,a=this._firstActiveElement*this._floatCountPerVertex*4*4):(i[t._PARAM_REGDATA_POS_]=0,h=this._maxParticleNum-this._firstActiveElement,s=(this._maxParticleNum-this._firstActiveElement)*this._floatCountPerVertex*4*4,a=this._firstActiveElement*this._floatCountPerVertex*4*4,this._firstFreeElement>0?(l=this._firstFreeElement,r=this._firstFreeElement*this._floatCountPerVertex*4*4,o=0):i[t._PARAM_REGDATA_POS_]=1)),i[t._PARAM_VB1_POS_]=this.vbBuffer.getPtrID(),i[t._PARAM_RECT1_NUM_POS_]=h,i[t._PARAM_VB1_SIZE_POS_]=s,i[t._PARAM_VB1_OFFSET_POS_]=a,we.syncBufferToRenderThread(this.vbBuffer),r>0&&(i[t._PARAM_VB2_POS_]=this.vbBuffer.getPtrID(),i[t._PARAM_RECT2_NUM_POS_]=l,i[t._PARAM_VB2_SIZE_POS_]=r,i[t._PARAM_VB2_OFFSET_POS_]=o),we.syncBufferToRenderThread(this._paramData),this._template.addDrawCounter()}},e.recover=function(){this._template=null,Ji.recover("DrawParticleCmd",this)},r(0,e,"cmdID",function(){return"DrawParticleCmd"}),t.create=function(e){var i=Ji.getItemByClass("DrawParticleCmd",t);i._graphicsCmdEncoder=this._commandEncoder,t._DRAW_PARTICLE_CMD_ENCODER_||(t._DRAW_PARTICLE_CMD_ENCODER_=we.instance.createCommandEncoder(284,32,!0),t._DRAW_PARTICLE_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_PARTICLE_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWPARTICLE),t._DRAW_PARTICLE_CMD_ENCODER_.useVDO(he.VDO_MESHPARTICLE),t._DRAW_PARTICLE_CMD_ENCODER_.uniformByParamData(0,4*t._PARAM_CURRENTTIME_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.uniformByParamData(1,4*t._PARAM_DURATION_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.uniformByParamData(2,4*t._PARAM_ENDVEL_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.uniformByParamData(3,4*t._PARAM_GRAVITY_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.uniformByParamData(4,4*t._PARAM_SIZE_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.uniformByParamData(5,4*t._PARAM_MAT_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.uniformTextureByParamData(4*t._PARAM_TEXTURE_UNIFORMLOC_POS_,4*t._PARAM_TEXTURE_LOC_POS_,4*t._PARAM_TEXTURE_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.setRectMeshExByParamData(4*t._PARAM_RECT1_NUM_POS_,4*t._PARAM_VB1_POS_,4*t._PARAM_VB1_SIZE_POS_,4*t._PARAM_VB1_OFFSET_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,1,7),t._DRAW_PARTICLE_CMD_ENCODER_.loadDataToRegByParamData(0,4*t._PARAM_REGDATA_POS_,4),t._DRAW_PARTICLE_CMD_ENCODER_.ifGreater0(0,2),t._DRAW_PARTICLE_CMD_ENCODER_.setRectMeshExByParamData(4*t._PARAM_RECT2_NUM_POS_,4*t._PARAM_VB2_POS_,4*t._PARAM_VB2_SIZE_POS_,4*t._PARAM_VB2_OFFSET_POS_),t._DRAW_PARTICLE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,1,7),we.syncBufferToRenderThread(t._DRAW_PARTICLE_CMD_ENCODER_)),i._paramData||(i._paramData=new ParamData(144,!0)),i._template=e,i._maxParticleNum=e.settings.maxPartices;var n=i._paramData._int32Data,s=(e._sv,i._paramData._float32Data),r=0;for(s[t._PARAM_CURRENTTIME_POS_]=-1,s[t._PARAM_DURATION_POS_]=-1,s[t._PARAM_ENDVEL_POS_]=-1,s[t._PARAM_GRAVITY_POS_]=-1,s[t._PARAM_GRAVITY_POS_+1]=-1,s[t._PARAM_GRAVITY_POS_+2]=-1,s[t._PARAM_SIZE_POS_]=-1,s[t._PARAM_SIZE_POS_+1]=-1,r=0;16>r;r++)s[t._PARAM_MAT_POS_+r]=-1;return n[t._PARAM_TEXTURE_LOC_POS_]=-1,n[t._PARAM_TEXTURE_POS_]=-1,n[t._PARAM_TEXTURE_UNIFORMLOC_POS_]=6,n[t._PARAM_REGDATA_POS_]=0,n[t._PARAM_VB1_POS_]=-1,n[t._PARAM_VB2_POS_]=-1,n[t._PARAM_VB1_SIZE_POS_]=-1,n[t._PARAM_VB2_SIZE_POS_]=-1,n[t._PARAM_RECT1_NUM_POS_]=-1,n[t._PARAM_RECT2_NUM_POS_]=-1,we.syncBufferToRenderThread(i._paramData),i._graphicsCmdEncoder.useCommandEncoder(t._DRAW_PARTICLE_CMD_ENCODER_.getPtrID(),i._paramData.getPtrID(),-1),we.syncBufferToRenderThread(i._graphicsCmdEncoder),i},t.ID="DrawParticleCmd",t._DRAW_PARTICLE_CMD_ENCODER_=null,t._PARAM_VB1_POS_=0,t._PARAM_VB2_POS_=1,t._PARAM_VB1_SIZE_POS_=2,t._PARAM_VB2_SIZE_POS_=3,t._PARAM_CURRENTTIME_POS_=4,t._PARAM_DURATION_POS_=5,t._PARAM_ENDVEL_POS_=6,t._PARAM_GRAVITY_POS_=7,t._PARAM_SIZE_POS_=10,t._PARAM_MAT_POS_=12,t._PARAM_TEXTURE_LOC_POS_=28,t._PARAM_TEXTURE_POS_=29,t._PARAM_REGDATA_POS_=30,t._PARAM_TEXTURE_UNIFORMLOC_POS_=31,t._PARAM_RECT1_NUM_POS_=32,t._PARAM_RECT2_NUM_POS_=33,t._PARAM_VB1_OFFSET_POS_=34,t._PARAM_VB2_OFFSET_POS_=35,t}(),function(){function t(){this.json=null}s(t,"laya.components.Prefab");var e=t.prototype;return e.create=function(){return this.json?pe.createByData(null,this.json):null},t}()),ii=function(){function t(){}return s(t,"laya.webgl.shapes.BasePoly"),t.createLine2=function(e,i,n,s,r,a){if(e.length<4)return null;var o=t.tempData.length>e.length+2?t.tempData:new Array(e.length+2);o[0]=e[0],o[1]=e[1];var h=2,l=0,_=e.length;for(l=2;_>l;l+=2)Math.abs(e[l]-e[l-2])+Math.abs(e[l+1]-e[l-1])>.01&&(o[h++]=e[l],o[h++]=e[l+1]);a&&Math.abs(e[0]-o[h-2])+Math.abs(e[1]-o[h-1])>.01&&(o[h++]=e[0],o[h++]=e[1]);var u=r;_=h/2;var c,d,f,p,m,g,v,y,E,S,A,C,D,x,R,T,b,P,L,I,M,w=n/2;f=o[0],p=o[1],m=o[2],g=o[3],E=-(p-g),S=f-m,M=Math.sqrt(E*E+S*S),E=E/M*w,S=S/M*w;for(u.push(f-E,p-S,f+E,p+S),l=1;_-1>l;l++)f=o[2*(l-1)],p=o[2*(l-1)+1],m=o[2*l],g=o[2*l+1],v=o[2*(l+1)],y=o[2*(l+1)+1],E=-(p-g),S=f-m,M=Math.sqrt(E*E+S*S),E=E/M*w,S=S/M*w,A=-(g-y),C=m-v,M=Math.sqrt(A*A+C*C),A=A/M*w,C=C/M*w,D=-S+p-(-S+g),x=-E+m-(-E+f),R=(-E+f)*(-S+g)-(-E+m)*(-S+p),T=-C+y-(-C+g),b=-A+m-(-A+v),P=(-A+v)*(-C+g)-(-A+m)*(-C+y),L=D*b-T*x,Math.abs(L)<.1?(L+=10.1,u.push(m-E,g-S,m+E,g+S)):(c=(x*P-b*R)/L,d=(T*R-D*P)/L,I=(c-m)*(c-m)+(d-g)+(d-g),u.push(c,d,m-(c-m),g-(d-g)));for(f=o[h-4],p=o[h-3],m=o[h-2],g=o[h-1],E=-(p-g),S=f-m,M=Math.sqrt(E*E+S*S),E=E/M*w,S=S/M*w,u.push(m-E,g-S,m+E,g+S),l=1;_>l;l++)i.push(s+2*(l-1),s+2*(l-1)+1,s+2*l+1,s+2*l+1,s+2*l,s+2*(l-1));return u},t.createLineTriangle=function(t,e,i,n){var s=t.slice(),r=s.length,a=s[0],o=s[1],h=s[2],l=s[2],_=0,u=0,c=0,d=0,f=r/2;if(!(1>=f)&&2!=f){for(var p=new Array(4*f),m=0,g=0,v=0;f-1>v;v++)a=s[g++],o=s[g++],h=s[g++],l=s[g++],c=h-a,d=l-o,0!=c&&0!=d&&(_=Math.sqrt(c*c+d*d),_>.001&&(u=4*m,p[u]=a,p[u+1]=o,p[u+2]=c/_,p[u+3]=d/_,m++));for(n?(a=s[r-2],o=s[r-1],h=s[0],l=s[1],c=h-a,d=l-o,0!=c&&0!=d&&(_=Math.sqrt(c*c+d*d),_>.001&&(u=4*m,p[u]=a,p[u+1]=o,p[u+2]=c/_,p[u+3]=d/_,m++))):(u=4*m,p[u]=a,p[u+1]=o,p[u+2]=c/_,p[u+3]=d/_,m++),g=0,v=0;f>v;v++){a=s[g],o=s[g+1],h=s[g+2],l=s[g+3];{s[g+4],s[g+5]}}}},n(t,["tempData",function(){return this.tempData=new Array(256)}]),t}(),ni=function(){function t(){this._saveuse=0}s(t,"laya.webgl.canvas.save.SaveMark");var e=t.prototype;return i.imps(e,{"laya.webgl.canvas.save.ISaveData":!0}),e.isSaveMark=function(){return!0},e.restore=function(e){e._saveMark=this._preSaveMark,t.POOL[t.POOL._length++]=this},t.Create=function(e){var i=t.POOL,n=i._length>0?i[--i._length]:new t;return n._saveuse=0,n._preSaveMark=e._saveMark,e._saveMark=n,n},t.POOL=h._createArray(),t}(),si=function(){function t(){this.fun=null,this._this=null,this.args=null,this._ref=1,this._key=new Ze}s(t,"laya.webgl.submit.SubmitCMD");var e=t.prototype;return i.imps(e,{"laya.webgl.submit.ISubmit":!0}),e.renderSubmit=function(){return this.fun.apply(this._this,this.args),1},e.getRenderType=function(){return 0},e.reUse=function(t,e){return this._ref++,e},e.releaseRender=function(){if(--this._ref<1){var e=t.POOL;e[e._length++]=this}},e.clone=function(){return null},t.create=function(e,i,n){var s=t.POOL._length?t.POOL[--t.POOL._length]:new t;return s.fun=i,s.args=e,s._this=n,s._ref=1,s._key.clear(),s},t.POOL=(t.POOL=[],t.POOL._length=0,t.POOL),t}(),ri=function(){function t(){this.gid=0,this.repeat=1,this._count=0}s(t,"laya.utils.Tween");var e=t.prototype;return e.to=function(t,e,i,n,s,r,a){return void 0===r&&(r=0),void 0===a&&(a=!1),this._create(t,e,i,n,s,r,a,!0,!1,!0)
},e.from=function(t,e,i,n,s,r,a){return void 0===r&&(r=0),void 0===a&&(a=!1),this._create(t,e,i,n,s,r,a,!1,!1,!0)},e._create=function(e,n,s,r,a,o,h,l,_,u){if(!e)throw new Error("Tween:target is null");this._target=e,this._duration=s,this._ease=r||n.ease||t.easeNone,this._complete=a||n.complete,this._delay=o,this._props=[],this._usedTimer=0,this._startTimer=Be.now(),this._usedPool=_,this._delayParam=null,this.update=n.update;var c=e.$_GID||(e.$_GID=ee.getGID());return t.tweenMap[c]?(h&&t.clearTween(e),t.tweenMap[c].push(this)):t.tweenMap[c]=[this],u?0>=o?this.firstStart(e,n,l):(this._delayParam=[e,n,l],i.timer.once(o,this,this.firstStart,this._delayParam)):this._initProps(e,n,l),this},e.firstStart=function(t,e,i){return this._delayParam=null,t.destroyed?(this.clear(),void 0):(this._initProps(t,e,i),this._beginLoop(),void 0)},e._initProps=function(t,e,i){for(var n in e)if("number"==typeof t[n]){var s=i?t[n]:e[n],r=i?e[n]:t[n];this._props.push([n,s,r-s]),i||(t[n]=s)}},e._beginLoop=function(){i.timer.frameLoop(1,this,this._doEase)},e._doEase=function(){this._updateEase(Be.now())},e._updateEase=function(e){var i=this._target;if(i){if(i.destroyed)return t.clearTween(i);var n=this._usedTimer=e-this._startTimer-this._delay;if(!(0>n)){if(n>=this._duration)return this.complete();for(var s=n>0?this._ease(n,0,1,this._duration):0,r=this._props,a=0,o=r.length;o>a;a++){var h=r[a];i[h[0]]=h[1]+s*h[2]}this.update&&this.update.run()}}},e.complete=function(){if(this._target){i.timer.runTimer(this,this.firstStart);for(var t=this._target,e=this._props,n=this._complete,s=0,r=e.length;r>s;s++){var a=e[s];t[a[0]]=a[1]+a[2]}this.update&&this.update.run(),this._count++,this._count>=this.repeat?(this.clear(),n&&n.run()):this.restart()}},e.pause=function(){i.timer.clear(this,this._beginLoop),i.timer.clear(this,this._doEase),i.timer.clear(this,this.firstStart);var t=Be.now(),e=0/0;e=t-this._startTimer-this._delay,0>e&&(this._usedTimer=e)},e.setStartTime=function(t){this._startTimer=t},e.clear=function(){this._target&&(this._remove(),this._clear())},e._clear=function(){this.pause(),i.timer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,Ji.recover("tween",this))},e.recover=function(){this._usedPool=!0,this._clear()},e._remove=function(){var e=t.tweenMap[this._target.$_GID];if(e)for(var i=0,n=e.length;n>i;i++)if(e[i]===this){e.splice(i,1);break}},e.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=Be.now(),this._delayParam)return i.timer.once(this._delay,this,this.firstStart,this._delayParam),void 0;for(var t=this._props,e=0,n=t.length;n>e;e++){var s=t[e];this._target[s[0]]=s[1]}i.timer.once(this._delay,this,this._beginLoop)},e.resume=function(){this._usedTimer>=this._duration||(this._startTimer=Be.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?i.timer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},r(0,e,"progress",null,function(t){var e=t*this._duration;this._startTimer=Be.now()-this._delay-e}),t.to=function(e,i,n,s,r,a,o,h){return void 0===a&&(a=0),void 0===o&&(o=!1),void 0===h&&(h=!0),Ji.getItemByClass("tween",t)._create(e,i,n,s,r,a,o,!0,h,!0)},t.from=function(e,i,n,s,r,a,o,h){return void 0===a&&(a=0),void 0===o&&(o=!1),void 0===h&&(h=!0),Ji.getItemByClass("tween",t)._create(e,i,n,s,r,a,o,!1,h,!0)},t.clearAll=function(e){if(e&&e.$_GID){var i=t.tweenMap[e.$_GID];if(i){for(var n=0,s=i.length;s>n;n++)i[n]._clear();i.length=0}}},t.clear=function(t){t.clear()},t.clearTween=function(e){t.clearAll(e)},t.easeNone=function(t,e,i,n){return i*t/n+e},t.tweenMap=[],t}(),ai=(function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._paramID=null,this._x=0/0,this._y=0/0,this._radius=0/0,this._fillColor=null,this._lineColor=null,this._lineWidth=0/0,this._vertNum=0,this._line_vertNum=0,this.ibBuffer=null,this.vbBuffer=null,this.line_ibBuffer=null,this.line_vbBuffer=null,this._ibSize=0,this._vbSize=0,this._line_ibSize=0,this._line_vbSize=0,this._cmdCurrentPos=0,this._points=[],this._linePoints=[],this._line_vbArray=[],this._line_ibArray=[]}s(t,"laya.layagl.cmdNative.DrawCircleCmdNative");var e=t.prototype;return e._arc=function(t,e,i,n,s){void 0===n&&(n=!1),void 0===s&&(s=!0);var r=[],a=0,o=2*Math.PI,h=0,l=0,_=0,u=0,c=0,d=0,f=0,p=0,m=0,g=0,v=0;if(l=o-a,n)if(Math.abs(l)>=2*Math.PI)l=2*-Math.PI;else for(;l>0;)l-=2*Math.PI;else if(Math.abs(l)>=2*Math.PI)l=2*Math.PI;else for(;0>l;)l+=2*Math.PI;g=101>i?Math.max(10,l*i/5):201>i?Math.max(10,l*i/20):Math.max(10,l*i/40),_=l/g/2,u=Math.abs(4/3*(1-Math.cos(_))/Math.sin(_)),n&&(u=-u),v=0;for(m=0;g>=m;m++)h=a+l*(m/g),c=Math.cos(h),d=Math.sin(h),f=t+c*i,p=e+d*i,r.push(f),r.push(p);return r},e.recover=function(){this._fillColor=null,this._lineColor=null,this._points.length=0,this._linePoints.length=0,this._line_vbArray.length=0,this._line_ibArray.length=0,Ji.recover("DrawCircleCmd",this)},r(0,e,"lineColor",function(){return this._lineColor},function(e){!this._lineColor&&this._lineWidth&&(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_CIRCLE_LINES_CMD_ENCODER_.getPtrID(),we.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._lineColor=e,this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0;for(var i=0;i<this._points.length;i++)this._linePoints.push(this._points[i]);this._linePoints.push(this._points[0]),this._linePoints.push(this._points[1]),ii.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length;var n=this._line_vertNum;(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(n-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;for(var s=this.line_ibBuffer._int16Data,r=0,a=0;a<3*(this._line_vertNum-2);a++)s[r++]=this._line_ibArray[a];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*n*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var h=o.create(e),l=h.numColor,_=this.line_vbBuffer._float32Data,u=this.line_vbBuffer._int32Data,c=0;for(i=0;i<this._line_vertNum;i++)_[c++]=this._line_vbArray[2*i]+this.x,_[c++]=this._line_vbArray[2*i+1]+this.y,u[c++]=l;var d=this._paramData._int32Data;d[t._PARAM_LINE_VB_POS_]=this.line_vbBuffer.getPtrID(),d[t._PARAM_LINE_IB_POS_]=this.line_ibBuffer.getPtrID(),d[t._PARAM_LINE_VB_SIZE_POS_]=this._line_vbSize,d[t._PARAM_LINE_IB_SIZE_POS_]=this._line_ibSize,we.syncBufferToRenderThread(this.line_vbBuffer),we.syncBufferToRenderThread(this.line_ibBuffer),we.syncBufferToRenderThread(this._paramData)}),r(0,e,"cmdID",function(){return"DrawCircle"}),r(0,e,"fillColor",function(){return this._fillColor},function(t){this._fillColor=t;for(var e=o.create(this._fillColor),i=e.numColor,n=this.vbBuffer._int32Data,s=0,r=0;r<this._vertNum;r++)s++,s++,n[s++]=i;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)e[i++]=this._points[2*n]+this._x,i++,i++;if(this._lineColor){var s=this.line_vbBuffer._float32Data;for(i=0,n=0;n<this._line_vertNum;n++)s[i++]=this._line_vbArray[2*n]+this._x,i++,i++;we.syncBufferToRenderThread(this.line_vbBuffer)}we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)i++,e[i++]=this._points[2*n+1]+this._y,i++;if(this._lineColor){var s=this.line_vbBuffer._float32Data;for(i=0,n=0;n<this._line_vertNum;n++)i++,s[i++]=this._line_vbArray[2*n+1]+this._y,i++;we.syncBufferToRenderThread(this.line_vbBuffer)}we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"radius",function(){return this._radius},function(e){this._points=this._arc(0,0,e),this._vertNum=this._points.length/2;var i=this._vertNum,n=0;this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0;var s=0,r=this._vertNum-2;(!this.ibBuffer||this.ibBuffer.getByteLength()<3*r*2)&&(this.ibBuffer=new ParamData(3*r*2,!0,!0)),this._ibSize=3*r*2;for(var a=this.ibBuffer._int16Data,h=0,l=0;r>l;l++)a[h++]=s,a[h++]=l+1+s,a[h++]=l+2+s;(!this.vbBuffer||this.vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.vbBuffer=new ParamData(3*i*4,!0)),this._vbSize=3*this._vertNum*4;for(var _=o.create(this._fillColor),u=_.numColor,c=this.vbBuffer._float32Data,d=this.vbBuffer._int32Data,f=0,p=0;p<this._vertNum;p++)c[f++]=this._points[2*p]+this._x,c[f++]=this._points[2*p+1]+this._y,d[f++]=u;if(this._lineColor){for(p=0;p<this._points.length;p++)this._linePoints.push(this._points[p]);this._linePoints.push(this._points[0]),this._linePoints.push(this._points[1]),ii.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length,n=this._line_vertNum,(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(n-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;var m=this.line_ibBuffer._int16Data;h=0;for(var g=0;g<3*(this._line_vertNum-2);g++)m[h++]=this._line_ibArray[g];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*n*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var v=o.create(this._lineColor),y=v.numColor,E=this.line_vbBuffer._float32Data,S=this.line_vbBuffer._int32Data;for(f=0,p=0;p<this._line_vertNum;p++)E[f++]=this._line_vbArray[2*p]+this._x,E[f++]=this._line_vbArray[2*p+1]+this._y,S[f++]=y}var A=this._paramData._int32Data;A[t._PARAM_VB_POS_]=this.vbBuffer.getPtrID(),A[t._PARAM_IB_POS_]=this.ibBuffer.getPtrID(),A[t._PARAM_VB_SIZE_POS_]=this._vbSize,A[t._PARAM_IB_SIZE_POS_]=this._ibSize,we.syncBufferToRenderThread(this.vbBuffer),we.syncBufferToRenderThread(this.ibBuffer),this._lineColor&&(A[t._PARAM_LINE_VB_POS_]=this.line_vbBuffer.getPtrID(),A[t._PARAM_LINE_IB_POS_]=this.line_ibBuffer.getPtrID(),A[t._PARAM_LINE_VB_SIZE_POS_]=this._line_vbSize,A[t._PARAM_LINE_IB_SIZE_POS_]=this._line_ibSize,we.syncBufferToRenderThread(this.line_vbBuffer),we.syncBufferToRenderThread(this.line_ibBuffer)),we.syncBufferToRenderThread(this._paramData)}),r(0,e,"lineWidth",function(){return this._lineWidth},function(e){!this._lineWidth&&this._lineColor&&(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_CIRCLE_LINES_CMD_ENCODER_.getPtrID(),we.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._lineWidth=e,this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0;for(var i=0;i<this._points.length;i++)this._linePoints.push(this._points[i]);this._linePoints.push(this._points[0]),this._linePoints.push(this._points[1]),ii.createLine2(this._linePoints,this._line_ibArray,e,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length;var n=this._line_vertNum;(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(n-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;for(var s=this.line_ibBuffer._int16Data,r=0,a=0;a<3*(this._line_vertNum-2);a++)s[r++]=this._line_ibArray[a];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*n*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var h=o.create(this._lineColor),l=h.numColor,_=this.line_vbBuffer._float32Data,u=this.line_vbBuffer._int32Data,c=0;for(i=0;i<this._line_vertNum;i++)_[c++]=this._line_vbArray[2*i]+this.x,_[c++]=this._line_vbArray[2*i+1]+this.y,u[c++]=l;var d=this._paramData._int32Data;d[t._PARAM_LINE_VB_POS_]=this.line_vbBuffer.getPtrID(),d[t._PARAM_LINE_IB_POS_]=this.line_ibBuffer.getPtrID(),d[t._PARAM_LINE_VB_SIZE_POS_]=this._line_vbSize,d[t._PARAM_LINE_IB_SIZE_POS_]=this._line_ibSize,we.syncBufferToRenderThread(this.line_vbBuffer),we.syncBufferToRenderThread(this.line_ibBuffer),we.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,n,s,r,a){var h=Ji.getItemByClass("DrawCircleCmd",t);h._graphicsCmdEncoder=this._commandEncoder,t._DRAW_CIRCLE_LINES_CMD_ENCODER_||(t._DRAW_CIRCLE_LINES_CMD_ENCODER_=we.instance.createCommandEncoder(244,32,!0),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_LINE_VB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINE_VB_SIZE_POS_,4*t._PARAM_LINE_IB_POS_,4*t._PARAM_LINE_IB_OFFSET_POS_,4*t._PARAM_LINE_IB_SIZE_POS_,4*t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_CIRCLE_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_CIRCLE_LINES_CMD_ENCODER_)),t._DRAW_CIRCLE_CMD_ENCODER_||(t._DRAW_CIRCLE_CMD_ENCODER_=we.instance.createCommandEncoder(168,32,!0),t._DRAW_CIRCLE_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_CIRCLE_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_CIRCLE_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_CIRCLE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_CIRCLE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_CIRCLE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_CIRCLE_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_CIRCLE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_CIRCLE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_CIRCLE_CMD_ENCODER_)),h._paramData||(h._paramData=new ParamData(72,!0)),h._x=e,h._y=i,h._radius=n,h._fillColor=s,h._lineColor=r,h._lineWidth=a,h._points=h._arc(0,0,n),h._vertNum=h._points.length/2;var l=h._vertNum,_=0,u=h._vertNum-2;(!h.ibBuffer||h.ibBuffer.getByteLength()<3*u*2)&&(h.ibBuffer=new ParamData(3*u*2,!0,!0)),h._ibSize=3*u*2;for(var c=h.ibBuffer._int16Data,d=0,f=0;u>f;f++)c[d++]=_,c[d++]=f+1+_,c[d++]=f+2+_;var p=o.create(s),m=p.numColor;(!h.vbBuffer||h.vbBuffer.getByteLength()<3*h._vertNum*4)&&(h.vbBuffer=new ParamData(3*l*4,!0)),h._vbSize=3*h._vertNum*4;for(var g=h.vbBuffer._float32Data,v=h.vbBuffer._int32Data,y=0,E=0;E<h._vertNum;E++)g[y++]=h._points[2*E]+e,g[y++]=h._points[2*E+1]+i,v[y++]=m;var S=0;for(E=0;E<h._points.length;E++)h._linePoints.push(h._points[E]);if(h._linePoints.push(h._points[0]),h._linePoints.push(h._points[1]),r){ii.createLine2(h._linePoints,h._line_ibArray,a,0,h._line_vbArray,!1),h._line_vertNum=h._linePoints.length,S=h._line_vertNum,(!h.line_ibBuffer||h.line_ibBuffer.getByteLength()<3*(h._line_vertNum-2)*2)&&(h.line_ibBuffer=new ParamData(3*(S-2)*2,!0,!0)),h._line_ibSize=3*(h._line_vertNum-2)*2;var A=h.line_ibBuffer._int16Data;d=0;for(var C=0;C<3*(h._line_vertNum-2);C++)A[d++]=h._line_ibArray[C];(!h.line_vbBuffer||h.line_vbBuffer.getByteLength()<3*h._line_vertNum*4)&&(h.line_vbBuffer=new ParamData(3*S*4,!0)),h._line_vbSize=3*h._line_vertNum*4;var D=o.create(r),x=D.numColor,R=h.line_vbBuffer._float32Data,T=h.line_vbBuffer._int32Data;for(y=0,E=0;E<h._line_vertNum;E++)R[y++]=h._line_vbArray[2*E]+e,R[y++]=h._line_vbArray[2*E+1]+i,T[y++]=x}else{h._lineWidth=1;var b="#FFFFFF";for(ii.createLine2(h._linePoints,h._line_ibArray,h._lineWidth,0,h._line_vbArray,!1),h._line_vertNum=h._linePoints.length,S=h._line_vertNum,(!h.line_ibBuffer||h.line_ibBuffer.getByteLength()<3*(h._line_vertNum-2)*2)&&(h.line_ibBuffer=new ParamData(3*(S-2)*2,!0,!0)),h._line_ibSize=3*(h._line_vertNum-2)*2,A=h.line_ibBuffer._int16Data,d=0,C=0;C<3*(h._line_vertNum-2);C++)A[d++]=h._line_ibArray[C];for((!h.line_vbBuffer||h.line_vbBuffer.getByteLength()<3*h._line_vertNum*4)&&(h.line_vbBuffer=new ParamData(3*S*4,!0)),h._line_vbSize=3*h._line_vertNum*4,D=o.create(b),x=D.numColor,R=h.line_vbBuffer._float32Data,T=h.line_vbBuffer._int32Data,y=0,E=0;E<h._line_vertNum;E++)R[y++]=h._line_vbArray[2*E]+e,R[y++]=h._line_vbArray[2*E+1]+i,T[y++]=x}var P=h._paramData._float32Data,L=h._paramData._int32Data;return L[0]=1,L[1]=32,L[t._PARAM_VB_POS_]=h.vbBuffer.getPtrID(),L[t._PARAM_IB_POS_]=h.ibBuffer.getPtrID(),L[t._PARAM_VB_SIZE_POS_]=h._vbSize,L[t._PARAM_IB_SIZE_POS_]=h._ibSize,L[t._PARAM_VB_OFFSET_POS_]=0,L[t._PARAM_IB_OFFSET_POS_]=0,L[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0,we.syncBufferToRenderThread(h.vbBuffer),we.syncBufferToRenderThread(h.ibBuffer),L[t._PARAM_LINE_VB_POS_]=h.line_vbBuffer.getPtrID(),L[t._PARAM_LINE_IB_POS_]=h.line_ibBuffer.getPtrID(),P[t._PARAM_LINECOLOR_POS_]=r,P[t._PARAM_LINEWIDTH_POS_]=a,L[t._PARAM_LINE_VB_SIZE_POS_]=h._line_vbSize,L[t._PARAM_LINE_IB_SIZE_POS_]=h._line_ibSize,L[t._PARAM_LINE_VB_OFFSET_POS_]=0,L[t._PARAM_LINE_IB_OFFSET_POS_]=0,L[t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_]=0,we.syncBufferToRenderThread(h.line_vbBuffer),we.syncBufferToRenderThread(h.line_ibBuffer),we.syncBufferToRenderThread(h._paramData),h._cmdCurrentPos=r?h._graphicsCmdEncoder.useCommandEncoder(t._DRAW_CIRCLE_LINES_CMD_ENCODER_.getPtrID(),h._paramData.getPtrID(),-1):h._graphicsCmdEncoder.useCommandEncoder(t._DRAW_CIRCLE_CMD_ENCODER_.getPtrID(),h._paramData.getPtrID(),-1),we.syncBufferToRenderThread(h._graphicsCmdEncoder),h},t.ID="DrawCircle",t._DRAW_CIRCLE_CMD_ENCODER_=null,t._DRAW_CIRCLE_LINES_CMD_ENCODER_=null,t._PARAM_VB_POS_=2,t._PARAM_IB_POS_=3,t._PARAM_LINE_VB_POS_=4,t._PARAM_LINE_IB_POS_=5,t._PARAM_LINECOLOR_POS_=6,t._PARAM_LINEWIDTH_POS_=7,t._PARAM_VB_SIZE_POS_=8,t._PARAM_IB_SIZE_POS_=9,t._PARAM_LINE_VB_SIZE_POS_=10,t._PARAM_LINE_IB_SIZE_POS_=11,t._PARAM_VB_OFFSET_POS_=12,t._PARAM_IB_OFFSET_POS_=13,t._PARAM_LINE_VB_OFFSET_POS_=14,t._PARAM_LINE_IB_OFFSET_POS_=15,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=16,t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_=17,t}(),function(){function t(){this._textIsWorldText=!1,this._fontColor=4294967295,this._strokeColor=0,this._nTexAlign=0,this._fontObj=t._defFontObj}s(t,"laya.display.cmd.FillTextCmd");var e=t.prototype;return e.recover=function(){Ji.recover("FillTextCmd",this)},e.run=function(t,e,i){this._textIsWorldText&&t._fast_filltext?t._fast_filltext(this._text,this.x+e,this.y+i,this._fontObj,this._fontColor,0,0,this._nTexAlign,0):t.drawText(this._text,this.x+e,this.y+i,this._font,this._color,this._textAlign)},r(0,e,"text",function(){return this._text},function(t){this._text=t,this._textIsWorldText=t instanceof laya.utils.WordText,this._textIsWorldText&&this._text.cleanCache()}),r(0,e,"cmdID",function(){return"FillText"}),r(0,e,"color",function(){return this._color},function(t){this._color=t,this._fontColor=o.create(t).numColor,this._textIsWorldText&&this._text.cleanCache()}),r(0,e,"font",function(){return this._font},function(t){this._font=t,(Ni.isWebGL||Ni.isConchApp)&&(this._fontObj=de.Parse(t)),this._textIsWorldText&&this._text.cleanCache()}),r(0,e,"textAlign",function(){return this._textAlign},function(t){switch(this._textAlign=t,t){case"center":this._nTexAlign=N.ENUM_TEXTALIGN_CENTER;break;case"right":this._nTexAlign=N.ENUM_TEXTALIGN_RIGHT;break;default:this._nTexAlign=N.ENUM_TEXTALIGN_DEFAULT}this._textIsWorldText&&this._text.cleanCache()}),t.create=function(e,i,n,s,r,a){var o=Ji.getItemByClass("FillTextCmd",t);return o.text=e,o._textIsWorldText=e instanceof laya.utils.WordText,o.x=i,o.y=n,o.font=s,o.color=r,o.textAlign=a,o},t.ID="FillText",n(t,["_defFontObj",function(){return this._defFontObj=new de(null)}]),t}()),oi=function(){function t(){}return s(t,"laya.webgl.resource.WebGLRTMgr"),t.getRT=function(e,i){e=0|e,i=0|i,e>=1e4&&console.error("getRT error! w too big");var n,s=1e4*i+e,r=t.dict[s];return r&&r.length>0?(n=r.pop(),n._mgrKey=s,n):(n=new ir(e,i,1,-1),n._mgrKey=s,n)},t.releaseRT=function(e){if(!(e._mgrKey<=0)){var i=t.dict[e._mgrKey];!i&&(i=[],t.dict[e._mgrKey]=i),e._mgrKey=0,i.push(e)}},t.dict={},t}(),hi=function(){function t(t){this.scale=1,this.currFrame=0,this._delta=0,this._map=[],this._handlers=[],this._temp=[],this._count=0,this.currTimer=Be.now(),this._lastTimer=Be.now(),void 0===t&&(t=!0),t&&i.systemTimer&&i.systemTimer.frameLoop(1,this,this._update)}var e;s(t,"laya.utils.Timer");var n=t.prototype;return n._update=function(){if(this.scale<=0)return this._lastTimer=Be.now(),void 0;var t=this.currFrame=this.currFrame+this.scale,e=Be.now();this._delta=(e-this._lastTimer)*this.scale;var i=this.currTimer=this.currTimer+this._delta;this._lastTimer=e;var n=this._handlers;this._count=0;for(var s=0,r=n.length;r>s;s++){var a=n[s];if(null!==a.method){var o=a.userFrame?t:i;if(o>=a.exeTime)if(a.repeat)if(a.jumpFrame)for(;o>=a.exeTime;)a.exeTime+=a.delay,a.run(!1);else a.exeTime+=a.delay,a.run(!1),o>a.exeTime&&(a.exeTime+=Math.ceil((o-a.exeTime)/a.delay)*a.delay);else a.run(!0)}else this._count++}(this._count>30||t%200===0)&&this._clearHandlers()},n._clearHandlers=function(){for(var t=this._handlers,e=0,i=t.length;i>e;e++){var n=t[e];null!==n.method?this._temp.push(n):this._recoverHandler(n)}this._handlers=this._temp,t.length=0,this._temp=t},n._recoverHandler=function(e){this._map[e.key]==e&&(this._map[e.key]=null),e.clear(),t._pool.push(e)},n._create=function(i,n,s,r,a,o,h){if(!s)return a.apply(r,o),null;if(h){var l=this._getHandler(r,a);if(l)return l.repeat=n,l.userFrame=i,l.delay=s,l.caller=r,l.method=a,l.args=o,l.exeTime=s+(i?this.currFrame:this.currTimer+Be.now()-this._lastTimer),l}return l=t._pool.length>0?t._pool.pop():new e,l.repeat=n,l.userFrame=i,l.delay=s,l.caller=r,l.method=a,l.args=o,l.exeTime=s+(i?this.currFrame:this.currTimer+Be.now()-this._lastTimer),this._indexHandler(l),this._handlers.push(l),l},n._indexHandler=function(e){var i=e.caller,n=e.method,s=i?i.$_GID||(i.$_GID=ee.getGID()):0,r=n.$_TID||(n.$_TID=1e5*t._mid++);e.key=s+r,this._map[e.key]=e},n.once=function(t,e,i,n,s){void 0===s&&(s=!0),this._create(!1,!1,t,e,i,n,s)},n.loop=function(t,e,i,n,s,r){void 0===s&&(s=!0),void 0===r&&(r=!1);var a=this._create(!1,!0,t,e,i,n,s);a&&(a.jumpFrame=r)},n.frameOnce=function(t,e,i,n,s){void 0===s&&(s=!0),this._create(!0,!1,t,e,i,n,s)},n.frameLoop=function(t,e,i,n,s){void 0===s&&(s=!0),this._create(!0,!0,t,e,i,n,s)},n.toString=function(){return" handlers:"+this._handlers.length+" pool:"+t._pool.length},n.clear=function(t,e){var i=this._getHandler(t,e);i&&(this._map[i.key]=null,i.key=0,i.clear())},n.clearAll=function(t){if(t)for(var e=0,i=this._handlers.length;i>e;e++){var n=this._handlers[e];n.caller===t&&(this._map[n.key]=null,n.key=0,n.clear())}},n._getHandler=function(e,i){var n=e?e.$_GID||(e.$_GID=ee.getGID()):0,s=i.$_TID||(i.$_TID=1e5*t._mid++);return this._map[n+s]},n.callLater=function(t,e,i){Ai.I.callLater(t,e,i)},n.runCallLater=function(t,e){Ai.I.runCallLater(t,e)},n.runTimer=function(t,e){var i=this._getHandler(t,e);i&&null!=i.method&&(this._map[i.key]=null,i.run(!0))},n.pause=function(){this.scale=0},n.resume=function(){this.scale=1},r(0,n,"delta",function(){return this._delta}),t._pool=[],t._mid=1,t.__init$=function(){e=function(){function t(){this.key=0,this.repeat=!1,this.delay=0,this.userFrame=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}s(t,"");var e=t.prototype;return e.clear=function(){this.caller=null,this.method=null,this.args=null},e.run=function(t){var e=this.caller;if(e&&e.destroyed)return this.clear();var i=this.method,n=this.args;t&&this.clear(),null!=i&&(n?i.apply(e,n):i.call(e))},t}()},t}(),li=function(){function t(){}s(t,"laya.display.cmd.DrawImageCmd");var e=t.prototype;return e.recover=function(){this.texture._removeReference(),this.texture=null,Ji.recover("DrawImageCmd",this)},e.run=function(t,e,i){t.drawTexture(this.texture,this.x+e,this.y+i,this.width,this.height)},r(0,e,"cmdID",function(){return"DrawImage"}),t.create=function(e,i,n,s,r){var a=Ji.getItemByClass("DrawImageCmd",t);return a.texture=e,e._addReference(),a.x=i,a.y=n,a.width=s,a.height=r,a},t.ID="DrawImage",t}(),_i=function(){function t(){this.reset()}s(t,"laya.display.css.CacheStyle");var e=t.prototype;return e.needBitmapCache=function(){return this.cacheForFilters||!!this.mask},e.needEnableCanvasRender=function(){return"none"!=this.userSetCache||this.cacheForFilters||!!this.mask},e.releaseContext=function(){this.canvas&&this.canvas.size&&(Ji.recover("CacheCanvas",this.canvas),this.canvas.size(0,0)),this.canvas=null},e.createContext=function(){if(!this.canvas){this.canvas=Ji.getItem("CacheCanvas")||new Is(!Ni.isWebGL);var t=this.canvas.context;t||(t=this.canvas.getContext("2d"))}},e.releaseFilterCache=function(){var t=this.filterCache;t&&(t.destroy(),t.recycle(),this.filterCache=null)},e.recover=function(){this!==t.EMPTY&&Ji.recover("SpriteCache",this.reset())},e.reset=function(){return this.releaseContext(),this.releaseFilterCache(),this.cacheAs="none",this.enableCanvasRender=!1,this.userSetCache="none",this.cacheForFilters=!1,this.staticCache=!1,this.reCache=!0,this.mask=null,this.maskParent=null,this.filterCache=null,this.filters=null,this.hasGlowFilter=!1,this.cacheRect&&this.cacheRect.recover(),this.cacheRect=null,this},e._calculateCacheRect=function(e,n,s,r){var a=!1;(Ni.isWebGL||Ni.isConchApp)&&(a=!0);var o=e._cacheStyle;o.cacheRect||(o.cacheRect=He.create());var h;a&&"bitmap"!==n?o.cacheRect.setTo(-e._style.pivotX,-e._style.pivotY,1,1):(h=e.getSelfBounds(),Ni.isConchApp?(h.width=h.x+h.width+32,h.height=h.x+h.height+32):(h.width=h.width+32,h.height=h.height+32),h.x=h.x-e.pivotX,h.y=h.y-e.pivotY,h.x=h.x-16,h.y=h.y-16,h.x=Math.floor(h.x+s)-s,h.y=Math.floor(h.y+r)-r,h.width=Math.floor(h.width),h.height=Math.floor(h.height),o.cacheRect.copyFrom(h)),h=o.cacheRect;var l=a?1:Be.pixelRatio*i.stage.clientScaleX,_=a?1:Be.pixelRatio*i.stage.clientScaleY;if(!a){var u,c=1,d=1;for(u=e;u&&u!=i.stage;)c*=u.scaleX,d*=u.scaleY,u=u.parent;c>1&&(l*=c),d>1&&(_*=d)}if(e._style.scrollRect){var f=e._style.scrollRect;h.x-=f.x,h.y-=f.y}return t._scaleInfo.setTo(l,_),t._scaleInfo},t.create=function(){return Ji.getItemByClass("SpriteCache",t)},t.EMPTY=new t,t.CANVAS_EXTEND_EDGE=16,n(t,["_scaleInfo",function(){return this._scaleInfo=new $i}]),t}(),ui=function(){function t(){this._clipInfoID=-1,this._globalClipMatrix=new fi,this._clipRect=new He}s(t,"laya.webgl.canvas.save.SaveClipRect");var e=t.prototype;return i.imps(e,{"laya.webgl.canvas.save.ISaveData":!0}),e.isSaveMark=function(){return!1},e.restore=function(e){this._globalClipMatrix.copyTo(e._globalClipMatrix),this._clipRect.clone(e._clipRect),e._clipInfoID=this._clipInfoID,t.POOL[t.POOL._length++]=this},t.save=function(e){if(131072!=(131072&e._saveMark._saveuse)){e._saveMark._saveuse|=131072;var i=t.POOL,n=i._length>0?i[--i._length]:new t;e._globalClipMatrix.copyTo(n._globalClipMatrix),e._clipRect.clone(n._clipRect),n._clipInfoID=e._clipInfoID;var s=e._save;s[s._length++]=n}},t.POOL=h._createArray(),t}(),ci=function(){function t(){this._strsToID={},this._idToStrs=[],this._length=0}s(t,"laya.utils.StringKey");var e=t.prototype;return e.add=function(t){var e=this._strsToID[t];return null!=e?e:(this._idToStrs[this._length]=t,this._strsToID[t]=this._length++)},e.getID=function(t){var e=this._strsToID[t];return null==e?-1:e},e.getName=function(t){var e=this._idToStrs[t];return null==e?void 0:e},t}(),di=function(){function t(){}s(t,"laya.display.cmd.DrawCircleCmd");var e=t.prototype;return e.recover=function(){this.fillColor=null,this.lineColor=null,Ji.recover("DrawCircleCmd",this)},e.run=function(t,e,i){t._drawCircle(this.x+e,this.y+i,this.radius,this.fillColor,this.lineColor,this.lineWidth,this.vid)},r(0,e,"cmdID",function(){return"DrawCircle"}),t.create=function(e,i,n,s,r,a,o){var h=Ji.getItemByClass("DrawCircleCmd",t);return h.x=e,h.y=i,h.radius=n,h.fillColor=s,h.lineColor=r,h.lineWidth=a,h.vid=o,h},t.ID="DrawCircle",t}(),fi=function(){function t(e,i,n,s,r,a,o){return this._bTransform=!1,void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=1),void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o=0),null!=t._createFun?t._createFun(e,i,n,s,r,a,o):(this.a=e,this.b=i,this.c=n,this.d=s,this.tx=r,this.ty=a,this._checkTransform(),void 0)}s(t,"laya.maths.Matrix");var e=t.prototype;return e.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this._bTransform=!1,this},e._checkTransform=function(){return this._bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},e.setTranslate=function(t,e){return this.tx=t,this.ty=e,this},e.translate=function(t,e){return this.tx+=t,this.ty+=e,this},e.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this._bTransform=!0,this},e.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,s=this.c,r=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=s*e-this.d*i,this.d=s*i+this.d*e,this.tx=r*e-this.ty*i,this.ty=r*i+this.ty*e,this._bTransform=!0,this},e.skew=function(t,e){var i=Math.tan(t),n=Math.tan(e),s=this.a,r=this.b;return this.a+=n*this.c,this.b+=n*this.d,this.c+=i*s,this.d+=i*r,this},e.invertTransformPoint=function(t){var e=this.a,i=this.b,n=this.c,s=this.d,r=this.tx,a=e*s-i*n,o=s/a,h=-i/a,l=-n/a,_=e/a,u=(n*this.ty-s*r)/a,c=-(e*this.ty-i*r)/a;return t.setTo(o*t.x+l*t.y+u,h*t.x+_*t.y+c)},e.transformPoint=function(t){return t.setTo(this.a*t.x+this.c*t.y+this.tx,this.b*t.x+this.d*t.y+this.ty)},e.transformPointN=function(t){return t.setTo(this.a*t.x+this.c*t.y,this.b*t.x+this.d*t.y)},e.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},e.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},e.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,s=this.tx,r=t*n-e*i;return this.a=n/r,this.b=-e/r,this.c=-i/r,this.d=t/r,this.tx=(i*this.ty-n*s)/r,this.ty=-(t*this.ty-e*s)/r,this},e.setTo=function(t,e,i,n,s,r){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=s,this.ty=r,this},e.concat=function(t){var e=this.a,i=this.c,n=this.tx;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d,this.tx=n*t.a+this.ty*t.c+t.tx,this.ty=n*t.b+this.ty*t.d+t.ty,this},e.scaleEx=function(t,e){var i=this.a,n=this.b,s=this.c,r=this.d;0!==n||0!==s?(this.a=t*i,this.b=t*n,this.c=e*s,this.d=e*r):(this.a=t*i,this.b=0*r,this.c=0*i,this.d=e*r),this._bTransform=!0},e.rotateEx=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,s=this.b,r=this.c,a=this.d;0!==s||0!==r?(this.a=e*n+i*r,this.b=e*s+i*a,this.c=-i*n+e*r,this.d=-i*s+e*a):(this.a=e*n,this.b=i*a,this.c=-i*n,this.d=e*a),this._bTransform=!0},e.clone=function(){var e=t.create();return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e._bTransform=this._bTransform,e},e.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t._bTransform=this._bTransform,t},e.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},e.destroy=function(){this.recover()},e.recover=function(){Ji.recover("Matrix",this.identity())},t.mul=function(t,e,i){var n=t.a,s=t.b,r=t.c,a=t.d,o=t.tx,h=t.ty,l=e.a,_=e.b,u=e.c,c=e.d,d=e.tx,f=e.ty;return 0!==_||0!==u?(i.a=n*l+s*u,i.b=n*_+s*c,i.c=r*l+a*u,i.d=r*_+a*c,i.tx=l*o+u*h+d,i.ty=_*o+c*h+f):(i.a=n*l,i.b=s*c,i.c=r*l,i.d=a*c,i.tx=l*o+d,i.ty=c*h+f),i
},t.mul16=function(t,e,i){var n=t.a,s=t.b,r=t.c,a=t.d,o=t.tx,h=t.ty,l=e.a,_=e.b,u=e.c,c=e.d,d=e.tx,f=e.ty;return 0!==_||0!==u?(i[0]=n*l+s*u,i[1]=n*_+s*c,i[4]=r*l+a*u,i[5]=r*_+a*c,i[12]=l*o+u*h+d,i[13]=_*o+c*h+f):(i[0]=n*l,i[1]=s*c,i[4]=r*l,i[5]=a*c,i[12]=l*o+d,i[13]=c*h+f),i},t.create=function(){return Ji.getItemByClass("Matrix",t)},t.EMPTY=new t,t.TEMP=new t,t._createFun=null,t}(),pi=function(){function t(){}return s(t,"laya.webgl.utils.RenderState2D"),t.mat2MatArray=function(e,i){var n=e,s=i;return s[0]=n.a,s[1]=n.b,s[2]=t.EMPTYMAT4_ARRAY[2],s[3]=t.EMPTYMAT4_ARRAY[3],s[4]=n.c,s[5]=n.d,s[6]=t.EMPTYMAT4_ARRAY[6],s[7]=t.EMPTYMAT4_ARRAY[7],s[8]=t.EMPTYMAT4_ARRAY[8],s[9]=t.EMPTYMAT4_ARRAY[9],s[10]=t.EMPTYMAT4_ARRAY[10],s[11]=t.EMPTYMAT4_ARRAY[11],s[12]=n.tx,s[13]=n.ty,s[14]=t.EMPTYMAT4_ARRAY[14],s[15]=t.EMPTYMAT4_ARRAY[15],i},t.restoreTempArray=function(){t.TEMPMAT4_ARRAY[0]=1,t.TEMPMAT4_ARRAY[1]=0,t.TEMPMAT4_ARRAY[4]=0,t.TEMPMAT4_ARRAY[5]=1,t.TEMPMAT4_ARRAY[12]=0,t.TEMPMAT4_ARRAY[13]=0},t.clear=function(){t.worldScissorTest=!1,t.worldAlpha=1},t._MAXSIZE=99999999,t.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t.worldMatrix4=t.TEMPMAT4_ARRAY,t.worldAlpha=1,t.worldScissorTest=!1,t.worldShaderDefines=null,t.worldFilters=null,t.width=0,t.height=0,n(t,["worldMatrix",function(){return this.worldMatrix=new fi}]),t}(),mi=(function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._paramID=null,this._x=0/0,this._y=0/0,this._radius=0/0,this._startAngle=0/0,this._endAngle=0/0,this._fillColor=null,this._lineColor=null,this._lineWidth=0/0,this._vertNum=0,this._line_vertNum=0,this.ibBuffer=null,this.vbBuffer=null,this.line_ibBuffer=null,this.line_vbBuffer=null,this._ibSize=0,this._vbSize=0,this._line_ibSize=0,this._line_vbSize=0,this._cmdCurrentPos=0,this._points=[],this._linePoints=[],this._line_vbArray=[],this._line_ibArray=[]}s(t,"laya.layagl.cmdNative.DrawPieCmdNative");var e=t.prototype;return e._arc=function(t,e,i,n,s,r,a){void 0===r&&(r=!1),void 0===a&&(a=!0);var o=[];o.push(0),o.push(0);var h=0,l=0,_=0,u=0,c=0,d=0,f=0,p=0,m=0,g=0,v=0;if(l=s-n,r)if(Math.abs(l)>=2*Math.PI)l=2*-Math.PI;else for(;l>0;)l-=2*Math.PI;else if(Math.abs(l)>=2*Math.PI)l=2*Math.PI;else for(;0>l;)l+=2*Math.PI;g=101>i?Math.max(10,l*i/5):201>i?Math.max(10,l*i/20):Math.max(10,l*i/40),_=l/g/2,u=Math.abs(4/3*(1-Math.cos(_))/Math.sin(_)),r&&(u=-u),v=0;var y=0,E=0;for(m=0;g>=m;m++)h=n+l*(m/g),c=Math.cos(h),d=Math.sin(h),f=t+c*i,p=e+d*i,(f!=y||p!=E)&&(o.push(f),o.push(p)),y=f,E=p;return c=Math.cos(s),d=Math.sin(s),f=t+c*i,p=e+d*i,(f!=y||p!=E)&&(o.push(f),o.push(p)),o},e._setData=function(t,e,i,n,s,r){this._vertNum=n.length/2;var a=this._vertNum,h=0,l=this._vertNum-2;(!this.ibBuffer||this.ibBuffer.getByteLength()<3*l*2)&&(this.ibBuffer=new ParamData(3*l*2,!0,!0)),this._ibSize=3*l*2;for(var _=this.ibBuffer._int16Data,u=0,c=0;l>c;c++)_[u++]=h,_[u++]=c+1+h,_[u++]=c+2+h;(!this.vbBuffer||this.vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.vbBuffer=new ParamData(3*a*4,!0)),this._vbSize=3*this._vertNum*4;for(var d=o.create(i),f=d.numColor,p=this.vbBuffer._float32Data,m=this.vbBuffer._int32Data,g=0,v=0;v<this._vertNum;v++)p[g++]=n[2*v]+t,p[g++]=n[2*v+1]+e,m[g++]=f;var y=0;for(this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0,v=0;v<n.length;v++)this._linePoints.push(n[v]);if(this._linePoints.push(n[0]),this._linePoints.push(n[1]),s){ii.createLine2(this._linePoints,this._line_ibArray,r,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length,y=this._line_vertNum,(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(y-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;var E=this.line_ibBuffer._int16Data;u=0;for(var S=0;S<3*(this._line_vertNum-2);S++)E[u++]=this._line_ibArray[S];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*y*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var A=o.create(s),C=A.numColor,D=this.line_vbBuffer._float32Data,x=this.line_vbBuffer._int32Data;for(g=0,v=0;v<this._line_vertNum;v++)D[g++]=this._line_vbArray[2*v]+this._x,D[g++]=this._line_vbArray[2*v+1]+this._y,x[g++]=C}else{this._lineWidth=1;var R="#FFFFFF";for(ii.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length,y=this._line_vertNum,(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(y-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2,E=this.line_ibBuffer._int16Data,u=0,S=0;S<3*(this._line_vertNum-2);S++)E[u++]=this._line_ibArray[S];for((!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*y*4,!0)),this._line_vbSize=3*this._line_vertNum*4,A=o.create(R),C=A.numColor,D=this.line_vbBuffer._float32Data,x=this.line_vbBuffer._int32Data,g=0,v=0;v<this._line_vertNum;v++)D[g++]=this._line_vbArray[2*v]+this._x,D[g++]=this._line_vbArray[2*v+1]+this._y,x[g++]=C}},e._saveToParamData=function(){var e=(this._paramData._float32Data,this._paramData._int32Data);e[0]=1,e[1]=32,e[t._PARAM_VB_POS_]=this.vbBuffer.getPtrID(),e[t._PARAM_IB_POS_]=this.ibBuffer.getPtrID(),e[t._PARAM_VB_SIZE_POS_]=this._vbSize,e[t._PARAM_IB_SIZE_POS_]=this._ibSize,e[t._PARAM_VB_OFFSET_POS_]=0,e[t._PARAM_IB_OFFSET_POS_]=0,e[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0,we.syncBufferToRenderThread(this.vbBuffer),we.syncBufferToRenderThread(this.ibBuffer),e[t._PARAM_LINE_VB_POS_]=this.line_vbBuffer.getPtrID(),e[t._PARAM_LINE_IB_POS_]=this.line_ibBuffer.getPtrID(),e[t._PARAM_LINE_VB_SIZE_POS_]=this._line_vbSize,e[t._PARAM_LINE_IB_SIZE_POS_]=this._line_ibSize,e[t._PARAM_LINE_VB_OFFSET_POS_]=0,e[t._PARAM_LINE_IB_OFFSET_POS_]=0,e[t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_]=0,we.syncBufferToRenderThread(this.line_vbBuffer),we.syncBufferToRenderThread(this.line_ibBuffer)},e.recover=function(){this._fillColor=null,this._lineColor=null,this._points.length=0,this._linePoints.length=0,this._line_vbArray.length=0,this._line_ibArray.length=0,Ji.recover("DrawPieCmd",this)},r(0,e,"lineColor",function(){return this._lineColor},function(e){!this._lineColor&&this._lineWidth&&(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_PIE_LINES_CMD_ENCODER_.getPtrID(),we.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._lineColor=e,this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0;for(var i=0;i<this._points.length;i++)this._linePoints.push(this._points[i]);this._linePoints.push(this._points[0]),this._linePoints.push(this._points[1]),ii.createLine2(this._linePoints,this._line_ibArray,this._lineWidth,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length;var n=this._line_vertNum;(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(n-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;for(var s=this.line_ibBuffer._int16Data,r=0,a=0;a<3*(this._line_vertNum-2);a++)s[r++]=this._line_ibArray[a];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*n*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var h=o.create(e),l=h.numColor,_=this.line_vbBuffer._float32Data,u=this.line_vbBuffer._int32Data,c=0;for(i=0;i<this._line_vertNum;i++)_[c++]=this._line_vbArray[2*i]+this._x,_[c++]=this._line_vbArray[2*i+1]+this._y,u[c++]=l;we.syncBufferToRenderThread(this.line_ibBuffer),we.syncBufferToRenderThread(this.line_vbBuffer)}),r(0,e,"startAngle",function(){return 180*this._startAngle/Math.PI},function(t){this._startAngle=t*Math.PI/180,this._points=this._arc(0,0,this._radius,t*Math.PI/180,this._endAngle),this._setData(this._x,this._y,this._fillColor,this._points,this._lineColor,this._lineWidth),this._saveToParamData(),we.syncBufferToRenderThread(this._paramData)}),r(0,e,"cmdID",function(){return"DrawPie"}),r(0,e,"fillColor",function(){return this._fillColor},function(t){this._fillColor=t;for(var e=o.create(this._fillColor),i=e.numColor,n=this.vbBuffer._int32Data,s=0,r=0;r<this._vertNum;r++)s++,s++,n[s++]=i;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)e[i++]=this._points[2*n]+this._x,i++,i++;if(this._lineColor){var s=this.line_vbBuffer._float32Data;for(i=0,n=0;n<this._line_vertNum;n++)s[i++]=this._line_vbArray[2*n]+this._x,i++,i++;we.syncBufferToRenderThread(this.line_vbBuffer)}we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)i++,e[i++]=this._points[2*n+1]+this._y,i++;if(this._lineColor){var s=this.line_vbBuffer._float32Data;for(i=0,n=0;n<this._line_vertNum;n++)i++,s[i++]=this._line_vbArray[2*n+1]+this._y,i++;we.syncBufferToRenderThread(this.line_vbBuffer)}we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"radius",function(){return this._radius},function(t){this._points=this._arc(0,0,t,this._startAngle,this._endAngle),this._setData(this._x,this._y,this._fillColor,this._points,this._lineColor,this._lineWidth),this._saveToParamData(),we.syncBufferToRenderThread(this._paramData)}),r(0,e,"endAngle",function(){return 180*this._endAngle/Math.PI},function(t){this._endAngle=t*Math.PI/180,this._points=this._arc(0,0,this._radius,this._startAngle,t*Math.PI/180),this._setData(this._x,this._y,this._fillColor,this._points,this._lineColor,this._lineWidth),this._saveToParamData(),we.syncBufferToRenderThread(this._paramData)}),r(0,e,"lineWidth",function(){return this._lineWidth},function(e){this.lineColor&&(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_PIE_LINES_CMD_ENCODER_.getPtrID(),we.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._lineWidth=e,this._linePoints.length=0,this._line_ibArray.length=0,this._line_vbArray.length=0;for(var i=0;i<this._points.length;i++)this._linePoints.push(this._points[i]);this._linePoints.push(this._points[0]),this._linePoints.push(this._points[1]),ii.createLine2(this._linePoints,this._line_ibArray,e,0,this._line_vbArray,!1),this._line_vertNum=this._linePoints.length;var n=this._line_vertNum;(!this.line_ibBuffer||this.line_ibBuffer.getByteLength()<3*(this._line_vertNum-2)*2)&&(this.line_ibBuffer=new ParamData(3*(n-2)*2,!0,!0)),this._line_ibSize=3*(this._line_vertNum-2)*2;for(var s=this.line_ibBuffer._int16Data,r=0,a=0;a<3*(this._line_vertNum-2);a++)s[r++]=this._line_ibArray[a];(!this.line_vbBuffer||this.line_vbBuffer.getByteLength()<3*this._line_vertNum*4)&&(this.line_vbBuffer=new ParamData(3*n*4,!0)),this._line_vbSize=3*this._line_vertNum*4;var h=o.create(this.lineColor),l=h.numColor,_=this.line_vbBuffer._float32Data,u=this.line_vbBuffer._int32Data,c=0;for(i=0;i<this._line_vertNum;i++)_[c++]=this._line_vbArray[2*i]+this._x,_[c++]=this._line_vbArray[2*i+1]+this._y,u[c++]=l;we.syncBufferToRenderThread(this.line_ibBuffer),we.syncBufferToRenderThread(this.line_vbBuffer)}),t.create=function(e,i,n,s,r,a,o,h){var l=Ji.getItemByClass("DrawPieCmd",t);return l._graphicsCmdEncoder=this._commandEncoder,t._DRAW_PIE_LINES_CMD_ENCODER_||(t._DRAW_PIE_LINES_CMD_ENCODER_=we.instance.createCommandEncoder(244,32,!0),t._DRAW_PIE_LINES_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_PIE_LINES_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_PIE_LINES_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_PIE_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_PIE_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_PIE_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_PIE_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_PIE_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_PIE_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_PIE_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_LINE_VB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINE_VB_SIZE_POS_,4*t._PARAM_LINE_IB_POS_,4*t._PARAM_LINE_IB_OFFSET_POS_,4*t._PARAM_LINE_IB_SIZE_POS_,4*t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_PIE_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_PIE_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_PIE_LINES_CMD_ENCODER_)),t._DRAW_PIE_CMD_ENCODER_||(t._DRAW_PIE_CMD_ENCODER_=we.instance.createCommandEncoder(168,32,!0),t._DRAW_PIE_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_PIE_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_PIE_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_PIE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_PIE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_PIE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_PIE_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_PIE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_PIE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_PIE_CMD_ENCODER_)),l._paramData||(l._paramData=new ParamData(64,!0)),l._x=e,l._y=i,l._radius=n,l._startAngle=s,l._endAngle=r,l._fillColor=a,l._lineColor=o,l._lineWidth=h,l._points=l._arc(0,0,n,s,r),l._setData(e,i,a,l._points,o,h),l._saveToParamData(),we.syncBufferToRenderThread(l._paramData),l._cmdCurrentPos=o?l._graphicsCmdEncoder.useCommandEncoder(t._DRAW_PIE_LINES_CMD_ENCODER_.getPtrID(),l._paramData.getPtrID(),-1):l._graphicsCmdEncoder.useCommandEncoder(t._DRAW_PIE_CMD_ENCODER_.getPtrID(),l._paramData.getPtrID(),-1),we.syncBufferToRenderThread(l._graphicsCmdEncoder),l},t.ID="DrawPie",t._DRAW_PIE_CMD_ENCODER_=null,t._DRAW_PIE_LINES_CMD_ENCODER_=null,t._PARAM_VB_POS_=2,t._PARAM_IB_POS_=3,t._PARAM_LINE_VB_POS_=4,t._PARAM_LINE_IB_POS_=5,t._PARAM_VB_SIZE_POS_=6,t._PARAM_IB_SIZE_POS_=7,t._PARAM_LINE_VB_SIZE_POS_=8,t._PARAM_LINE_IB_SIZE_POS_=9,t._PARAM_VB_OFFSET_POS_=10,t._PARAM_IB_OFFSET_POS_=11,t._PARAM_LINE_VB_OFFSET_POS_=12,t._PARAM_LINE_IB_OFFSET_POS_=13,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=14,t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_=15,t}(),function(){function t(e,i){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this.ref=1,this._cacheID=0,this.clipMatDir=[99999999,0,0,99999999],this.clipMatPos=[0,0],this.defines=new Tn,this.mainID=e,this.subID=i,this.textureHost=null,this.texture=null,this.color=null,this.colorAdd=null,this.u_mmat2=null,this._cacheID=e|i,this._inClassCache=t._cache[this._cacheID],e>0&&!this._inClassCache&&(this._inClassCache=t._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}s(t,"laya.webgl.shader.d2.value.Value2D");var e=t.prototype;return e.setValue=function(){},e._ShaderWithCompile=function(){var t=Ls.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,er.create,this._attribLocation);return t},e.upload=function(){var t=pi;pi.worldMatrix4===pi.TEMPMAT4_ARRAY||this.defines.addInt(128),this.mmat=t.worldMatrix4;var e=Ls.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();e._shaderValueWidth!==t.width||e._shaderValueHeight!==t.height?(this.size[0]=t.width,this.size[1]=t.height,e._shaderValueWidth=t.width,e._shaderValueHeight=t.height,e.upload(this,null)):e.upload(this,e._params2dQuick2||e._make2dQuick2())},e.setFilters=function(t){if(this.filters=t,t)for(var e,i=t.length,n=0;i>n;n++)e=t[n],e&&(this.defines.add(e.type),e.action.setValue(this))},e.clear=function(){this.defines._value=this.subID+(Oi.shaderHighPrecision?1024:0)},e.release=function(){--this.ref<1&&(this._inClassCache&&(this._inClassCache[this._inClassCache._length++]=this),this.clear(),this.filters=null,this.ref=1)},t._initone=function(e,i){t._typeClass[e]=i,t._cache[e]=[],t._cache[e]._length=0},t.__init__=function(){t._initone(4,Nn),t._initone(512,On),t._initone(1,Bn),t._initone(9,Bn)},t.create=function(e,i){var n=t._cache[e|i];return n._length?n[--n._length]:new t._typeClass[e|i](i)},t._cache=[],t._typeClass=[],t.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t}()),gi=function(){function t(){}return s(t,"laya.webgl.shapes.Earcut"),t.earcut=function(e,i,n){n=n||2;var s=i&&i.length,r=s?i[0]*n:e.length,a=t.linkedList(e,0,r,n,!0),o=[];if(!a)return o;var h,l,_,u,c,d,f;if(s&&(a=t.eliminateHoles(e,i,a,n)),e.length>80*n){h=_=e[0],l=u=e[1];for(var p=n;r>p;p+=n)c=e[p],d=e[p+1],h>c&&(h=c),l>d&&(l=d),c>_&&(_=c),d>u&&(u=d);f=Math.max(_-h,u-l),f=0!==f?1/f:0}return t.earcutLinked(a,o,n,h,l,f),o},t.linkedList=function(e,i,n,s,r){var a,o;if(r===t.signedArea(e,i,n,s)>0)for(a=i;n>a;a+=s)o=t.insertNode(a,e[a],e[a+1],o);else for(a=n-s;a>=i;a-=s)o=t.insertNode(a,e[a],e[a+1],o);return o&&t.equals(o,o.next)&&(t.removeNode(o),o=o.next),o},t.filterPoints=function(e,i){if(!e)return e;i||(i=e);var n,s=e;do if(n=!1,s.steiner||!t.equals(s,s.next)&&0!==t.area(s.prev,s,s.next))s=s.next;else{if(t.removeNode(s),s=i=s.prev,s===s.next)break;n=!0}while(n||s!==i);return i},t.earcutLinked=function(e,i,n,s,r,a,o){if(e){!o&&a&&t.indexCurve(e,s,r,a);for(var h,l,_=e;e.prev!==e.next;)if(h=e.prev,l=e.next,a?t.isEarHashed(e,s,r,a):t.isEar(e))i.push(h.i/n),i.push(e.i/n),i.push(l.i/n),t.removeNode(e),e=l.next,_=l.next;else if(e=l,e===_){o?1===o?(e=t.cureLocalIntersections(e,i,n),t.earcutLinked(e,i,n,s,r,a,2)):2===o&&t.splitEarcut(e,i,n,s,r,a):t.earcutLinked(t.filterPoints(e,null),i,n,s,r,a,1);break}}},t.isEar=function(e){var i=e.prev,n=e,s=e.next;if(t.area(i,n,s)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(t.pointInTriangle(i.x,i.y,n.x,n.y,s.x,s.y,r.x,r.y)&&t.area(r.prev,r,r.next)>=0)return!1;r=r.next}return!0},t.isEarHashed=function(e,i,n,s){var r=e.prev,a=e,o=e.next;if(t.area(r,a,o)>=0)return!1;for(var h=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,l=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,_=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,u=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,c=t.zOrder(h,l,i,n,s),d=t.zOrder(_,u,i,n,s),f=e.nextZ;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&t.pointInTriangle(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&t.area(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=e.prevZ;f&&f.z>=c;){if(f!==e.prev&&f!==e.next&&t.pointInTriangle(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&t.area(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0},t.cureLocalIntersections=function(e,i,n){var s=e;do{var r=s.prev,a=s.next.next;!t.equals(r,a)&&t.intersects(r,s,s.next,a)&&t.locallyInside(r,a)&&t.locallyInside(a,r)&&(i.push(r.i/n),i.push(s.i/n),i.push(a.i/n),t.removeNode(s),t.removeNode(s.next),s=e=a),s=s.next}while(s!==e);return s},t.splitEarcut=function(e,i,n,s,r,a){var o=e;do{for(var h=o.next.next;h!==o.prev;){if(o.i!==h.i&&t.isValidDiagonal(o,h)){var l=t.splitPolygon(o,h);return o=t.filterPoints(o,o.next),l=t.filterPoints(l,l.next),t.earcutLinked(o,i,n,s,r,a),t.earcutLinked(l,i,n,s,r,a),void 0}h=h.next}o=o.next}while(o!==e)},t.eliminateHoles=function(e,i,n,s){var r,a,o,h,l,_=[];for(r=0,a=i.length;a>r;r++)o=i[r]*s,h=a-1>r?i[r+1]*s:e.length,l=t.linkedList(e,o,h,s,!1),l===l.next&&(l.steiner=!0),_.push(t.getLeftmost(l));for(_.sort(t.compareX),r=0;r<_.length;r++)t.eliminateHole(_[r],n),n=t.filterPoints(n,n.next);return n},t.compareX=function(t,e){return t.x-e.x},t.eliminateHole=function(e,i){if(i=t.findHoleBridge(e,i)){var n=t.splitPolygon(i,e);t.filterPoints(n,n.next)}},t.findHoleBridge=function(e,i){var n,s=i,r=e.x,a=e.y,o=-1/0;do{if(a<=s.y&&a>=s.next.y&&s.next.y!==s.y){var h=s.x+(a-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(r>=h&&h>o){if(o=h,h===r){if(a===s.y)return s;if(a===s.next.y)return s.next}n=s.x<s.next.x?s:s.next}}s=s.next}while(s!==i);if(!n)return null;if(r===o)return n.prev;var l,_=n,u=n.x,c=n.y,d=1/0;for(s=n.next;s!==_;)r>=s.x&&s.x>=u&&r!==s.x&&t.pointInTriangle(c>a?r:o,a,u,c,c>a?o:r,a,s.x,s.y)&&(l=Math.abs(a-s.y)/(r-s.x),(d>l||l===d&&s.x>n.x)&&t.locallyInside(s,e)&&(n=s,d=l)),s=s.next;return n},t.indexCurve=function(e,i,n,s){var r=e;do null===r.z&&(r.z=t.zOrder(r.x,r.y,i,n,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,t.sortLinked(r)},t.sortLinked=function(t){var e,i,n,s,r,a,o,h,l=1;do{for(i=t,t=null,r=null,a=0;i;){for(a++,n=i,o=0,e=0;l>e&&(o++,n=n.nextZ,n);e++);for(h=l;o>0||h>0&&n;)0!==o&&(0===h||!n||i.z<=n.z)?(s=i,i=i.nextZ,o--):(s=n,n=n.nextZ,h--),r?r.nextZ=s:t=s,s.prevZ=r,r=s;i=n}r.nextZ=null,l*=2}while(a>1);return t},t.zOrder=function(t,e,i,n,s){return t=32767*(t-i)*s,e=32767*(e-n)*s,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1},t.getLeftmost=function(t){var e=t,i=t;do e.x<i.x&&(i=e),e=e.next;while(e!==t);return i},t.pointInTriangle=function(t,e,i,n,s,r,a,o){return(s-a)*(e-o)-(t-a)*(r-o)>=0&&(t-a)*(n-o)-(i-a)*(e-o)>=0&&(i-a)*(r-o)-(s-a)*(n-o)>=0},t.isValidDiagonal=function(e,i){return e.next.i!==i.i&&e.prev.i!==i.i&&!t.intersectsPolygon(e,i)&&t.locallyInside(e,i)&&t.locallyInside(i,e)&&t.middleInside(e,i)},t.area=function(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)},t.equals=function(t,e){return t.x===e.x&&t.y===e.y},t.intersects=function(e,i,n,s){return t.equals(e,i)&&t.equals(n,s)||t.equals(e,s)&&t.equals(n,i)?!0:t.area(e,i,n)>0!=t.area(e,i,s)>0&&t.area(n,s,e)>0!=t.area(n,s,i)>0},t.intersectsPolygon=function(e,i){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==i.i&&n.next.i!==i.i&&t.intersects(n,n.next,e,i))return!0;n=n.next}while(n!==e);return!1},t.locallyInside=function(e,i){return t.area(e.prev,e,e.next)<0?t.area(e,i,e.next)>=0&&t.area(e,e.prev,i)>=0:t.area(e,i,e.prev)<0||t.area(e,e.next,i)<0},t.middleInside=function(t,e){var i=t,n=!1,s=(t.x+e.x)/2,r=(t.y+e.y)/2;do i.y>r!=i.next.y>r&&i.next.y!==i.y&&s<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==t);return n},t.splitPolygon=function(t,e){var i=new ae(t.i,t.x,t.y),n=new ae(e.i,e.x,e.y),s=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=s,s.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n},t.insertNode=function(t,e,i,n){var s=new ae(t,e,i);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s},t.removeNode=function(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)},t.signedArea=function(t,e,i,n){for(var s=0,r=e,a=i-n;i>r;r+=n)s+=(t[a]-t[r])*(t[r+1]+t[a+1]),a=r;return s},t}(),vi=function(){function t(){}s(t,"laya.display.cmd.FillBorderTextCmd");var e=t.prototype;return e.recover=function(){Ji.recover("FillBorderTextCmd",this)},e.run=function(t,e,i){t.fillBorderText(this.text,this.x+e,this.y+i,this.font,this.fillColor,this.borderColor,this.lineWidth,this.textAlign)},r(0,e,"cmdID",function(){return"FillBorderText"}),t.create=function(e,i,n,s,r,a,o,h){var l=Ji.getItemByClass("FillBorderTextCmd",t);return l.text=e,l.x=i,l.y=n,l.font=s,l.fillColor=r,l.borderColor=a,l.lineWidth=o,l.textAlign=h,l},t.ID="FillBorderText",t}(),yi=function(){function t(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],Ni.isWebGL&&Qi.regCacheByFunction(ee.bind(this.startDispose,this),ee.bind(this.getCacheList,this))}s(t,"laya.utils.VectorGraphManager");var e=t.prototype;return e.getId=function(){return this._id++},e.addShape=function(t,e){this.shapeDic[t]=e,this.useDic[t]||(this.useDic[t]=!0)},e.addLine=function(t,e){this.shapeLineDic[t]=e,this.shapeLineDic[t]||(this.shapeLineDic[t]=!0)},e.getShape=function(t){this._checkKey&&null!=this.useDic[t]&&(this.useDic[t]=!0)},e.deleteShape=function(t){this.shapeDic[t]&&(this.shapeDic[t]=null,delete this.shapeDic[t]),this.shapeLineDic[t]&&(this.shapeLineDic[t]=null,delete this.shapeLineDic[t]),null!=this.useDic[t]&&delete this.useDic[t]},e.getCacheList=function(){var t,e=[];for(t in this.shapeDic)e.push(this.shapeDic[t]);for(t in this.shapeLineDic)e.push(this.shapeLineDic[t]);return e},e.startDispose=function(){var t;for(t in this.useDic)this.useDic[t]=!1;this._checkKey=!0},e.endDispose=function(){if(this._checkKey){var t;for(t in this.useDic)this.useDic[t]||this.deleteShape(t);this._checkKey=!1}},t.getInstance=function(){return t.instance=t.instance||new t},t.instance=null,t}(),Ei=(function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._texture=null,this._x=0/0,this._y=0/0,this._vertices=null,this._uvs=null,this._indices=null,this._matrix=null,this._alpha=0/0,this._color=null,this._blendMode=null,this.vbBuffer=null,this._vbSize=0/0,this.ibBuffer=null,this._ibSize=0/0,this._verticesNum=0/0,this._ibNum=0/0,this._blend_src=0,this._blend_dest=0}s(t,"laya.layagl.cmdNative.DrawTrianglesCmdNative");var e=t.prototype;return e.recover=function(){this._texture=null,this._vertices=null,this._uvs=null,this._indices=null,this._matrix=null,Ji.recover("DrawTrianglesCmd",this)},e._setBlendMode=function(t){switch(t){case"normal":this._blend_src=1,this._blend_dest=771;break;case"add":this._blend_src=1,this._blend_dest=772;break;case"multiply":this._blend_src=774,this._blend_dest=771;break;case"screen":this._blend_src=1,this._blend_dest=1;break;case"light":this._blend_src=1,this._blend_dest=1;break;case"overlay":this._blend_src=1,this._blend_dest=769;break;case"destination-out":this._blend_src=0,this._blend_dest=0;break;case"mask":this._blend_src=0,this._blend_dest=770;break;default:alert("_setBlendMode Unknown type")}},e._mixRGBandAlpha=function(t,e){var i=(4278190080&t)>>>24;return 0!=i?i*=e:i=255*e,16777215&t|i<<24},r(0,e,"vertices",function(){return this._vertices},function(t){this._vertices=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._verticesNum;n++)e[i++]=this._x+t[2*n],e[i++]=this._y+t[2*n+1],i++,i++,i++,i++;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"cmdID",function(){return"DrawTriangles"}),r(0,e,"matrix",function(){return this._matrix},function(e){this._matrix=e;var i=this._paramData._float32Data;i[t._PARAM_MATRIX_POS_]=e.a,i[t._PARAM_MATRIX_POS_+1]=e.b,i[t._PARAM_MATRIX_POS_+2]=e.c,i[t._PARAM_MATRIX_POS_+3]=e.d,i[t._PARAM_MATRIX_POS_+4]=e.tx,i[t._PARAM_MATRIX_POS_+5]=e.ty,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"texture",function(){return this._texture},function(e){if(e&&e.url){this._texture=e;var i=this._paramData._int32Data;i[t._PARAM_TEXTURE_POS_]=this._texture.bitmap._glTexture.id,we.syncBufferToRenderThread(this._paramData)}}),r(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._verticesNum;n++)i++,e[i++]=t+this.vertices[2*n+1],i++,i++,i++,i++;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._verticesNum;n++)e[i++]=t+this.vertices[2*n],i++,i++,i++,i++,i++;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"alpha",function(){return this._alpha},function(t){this._alpha=t}),r(0,e,"uvs",function(){return this._uvs},function(t){this._uvs=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._verticesNum;n++)i++,i++,e[i++]=t[2*n],e[i++]=t[2*n+1],i++,i++;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"indices",function(){return this._indices},function(t){this._indices=t;for(var e=this.ibBuffer._int16Data,i=0,n=0;n<this._ibNum;n++)e[i++]=t[n];we.syncBufferToRenderThread(this.ibBuffer)}),r(0,e,"color",function(){return this._color},function(t){this._color=t}),r(0,e,"blendMode",function(){return this._blendMode},function(t){this._blendMode=t}),t.create=function(e,i,n,s,r,a,h,l,_,u){var c=Ji.getItemByClass("DrawTrianglesCmd",t);c._graphicsCmdEncoder=this._commandEncoder,t._DRAW_TRIANGLES_CMD_ENCODER_||(t._DRAW_TRIANGLES_CMD_ENCODER_=we.instance.createCommandEncoder(152,32,!0),t._DRAW_TRIANGLES_CMD_ENCODER_.save(),t._DRAW_TRIANGLES_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_TRIANGLES_CMD_ENCODER_.blendFuncByParamData(4*t._PARAM_BLEND_SRC_POS_,4*t._PARAM_BLEND_DEST_POS_),t._DRAW_TRIANGLES_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),t._DRAW_TRIANGLES_CMD_ENCODER_.useVDO(he.VDO_MESHQUADTEXTURE),t._DRAW_TRIANGLES_CMD_ENCODER_.setGlobalValueByParamData(he.GLOBALVALUE_MATRIX32,7,4*t._PARAM_MATRIX_POS_),t._DRAW_TRIANGLES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_TRIANGLES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_TRIANGLES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_TRIANGLES_CMD_ENCODER_.uniformTextureByParamData(4*t._PARAM_UNIFORMLOCATION_POS_,4*t._PARAM_TEXLOCATION_POS_,4*t._PARAM_TEXTURE_POS_),t._DRAW_TRIANGLES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_TRIANGLES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_TRIANGLES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_TRIANGLES_CMD_ENCODER_.restore(),we.syncBufferToRenderThread(t._DRAW_TRIANGLES_CMD_ENCODER_)),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_||(t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_=we.instance.createCommandEncoder(152,32,!0),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.save(),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.blendFuncByParamData(4*t._PARAM_BLEND_SRC_POS_,4*t._PARAM_BLEND_DEST_POS_),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.addShaderMacro(he.SHADER_MACRO_COLOR_FILTER),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.setGlobalValueByParamData(he.GLOBALVALUE_COLORFILTER_COLOR,8,4*t._PARAM_FILTER_COLOR_POS_),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.setGlobalValueByParamData(he.GLOBALVALUE_COLORFILTER_ALPHA,8,4*t._PARAM_FILTER_ALPHA_POS_),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.useVDO(he.VDO_MESHQUADTEXTURE),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.setGlobalValueByParamData(he.GLOBALVALUE_MATRIX32,7,4*t._PARAM_MATRIX_POS_),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.uniformTextureByParamData(4*t._PARAM_UNIFORMLOCATION_POS_,4*t._PARAM_TEXLOCATION_POS_,4*t._PARAM_TEXTURE_POS_),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.restore(),we.syncBufferToRenderThread(t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_)),c._paramData||(c._paramData=new ParamData(152,!0)),c._texture=e,c._x=i,c._y=n,c._vertices=s,c._uvs=r,c._indices=a,c._matrix=h?h:new fi,c._alpha=l,c._color=_,c._blendMode=u;var d=new gn,f=o.create(_);d.color(f.arrColor[0],f.arrColor[1],f.arrColor[2],f.arrColor[3]),c._verticesNum=c._vertices.length/2;var p=c._verticesNum;(!c.vbBuffer||c.vbBuffer.getByteLength()<24*p*3)&&(c.vbBuffer=new ParamData(24*p*3,!0)),c._vbSize=24*p*3;var m=c.vbBuffer._float32Data,g=c.vbBuffer._int32Data,v=4294967295;l&&(v=c._mixRGBandAlpha(v,l));for(var y=0,E=0;E<c._verticesNum;E++)m[y++]=i/c._matrix.a+s[2*E],m[y++]=n/c._matrix.d+s[2*E+1],m[y++]=r[2*E],m[y++]=r[2*E+1],g[y++]=v,g[y++]=4294967295;
c._ibNum=a.length;var S=c._ibNum;(!c.ibBuffer||c.ibBuffer.getByteLength()<2*S)&&(c.ibBuffer=new ParamData(2*S,!0,!0)),c._ibSize=2*S;for(var A=c.ibBuffer._int16Data,C=0,D=0;D<c._ibNum;D++)A[C++]=a[D];var x=c._paramData._float32Data,R=c._paramData._int32Data;if(R[t._PARAM_UNIFORMLOCATION_POS_]=3,R[t._PARAM_TEXLOCATION_POS_]=33984,R[t._PARAM_TEXTURE_POS_]=e.bitmap._glTexture.id,R[t._PARAM_VB_POS_]=c.vbBuffer.getPtrID(),R[t._PARAM_VB_SIZE_POS_]=c._vbSize,R[t._PARAM_IB_POS_]=c.ibBuffer.getPtrID(),R[t._PARAM_IB_SIZE_POS_]=c._ibSize,R[t._PARAM_VB_OFFSET_POS_]=0,R[t._PARAM_IB_OFFSET_POS_]=0,R[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0,x[t._PARAM_MATRIX_POS_]=c._matrix.a,x[t._PARAM_MATRIX_POS_+1]=c._matrix.b,x[t._PARAM_MATRIX_POS_+2]=c._matrix.c,x[t._PARAM_MATRIX_POS_+3]=c._matrix.d,x[t._PARAM_MATRIX_POS_+4]=c._matrix.tx,x[t._PARAM_MATRIX_POS_+5]=c._matrix.ty,u?(c._setBlendMode(u),R[t._PARAM_BLEND_SRC_POS_]=c._blend_src,R[t._PARAM_BLEND_DEST_POS_]=c._blend_dest):(R[t._PARAM_BLEND_SRC_POS_]=-1,R[t._PARAM_BLEND_DEST_POS_]=-1),_){y=t._PARAM_FILTER_COLOR_POS_;var T=d._mat;x[y++]=T[0],x[y++]=T[1],x[y++]=T[2],x[y++]=T[3],x[y++]=T[4],x[y++]=T[5],x[y++]=T[6],x[y++]=T[7],x[y++]=T[8],x[y++]=T[9],x[y++]=T[10],x[y++]=T[11],x[y++]=T[12],x[y++]=T[13],x[y++]=T[14],x[y++]=T[15],y=t._PARAM_FILTER_ALPHA_POS_;var b=d._alpha;x[y++]=255*b[0],x[y++]=255*b[1],x[y++]=255*b[2],x[y++]=255*b[3]}return we.syncBufferToRenderThread(c.vbBuffer),we.syncBufferToRenderThread(c.ibBuffer),we.syncBufferToRenderThread(c._paramData),_?c._graphicsCmdEncoder.useCommandEncoder(t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_.getPtrID(),c._paramData.getPtrID(),-1):c._graphicsCmdEncoder.useCommandEncoder(t._DRAW_TRIANGLES_CMD_ENCODER_.getPtrID(),c._paramData.getPtrID(),-1),we.syncBufferToRenderThread(c._graphicsCmdEncoder),c},t.ID="DrawTriangles",t._DRAW_TRIANGLES_CMD_ENCODER_=null,t._DRAW_TRIANGLES_COLORFILTER_CMD_ENCODER_=null,t._PARAM_UNIFORMLOCATION_POS_=0,t._PARAM_TEXLOCATION_POS_=1,t._PARAM_TEXTURE_POS_=2,t._PARAM_VB_POS_=3,t._PARAM_VB_SIZE_POS_=4,t._PARAM_IB_POS_=5,t._PARAM_IB_SIZE_POS_=6,t._PARAM_VB_OFFSET_POS_=7,t._PARAM_IB_OFFSET_POS_=8,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=9,t._PARAM_BLEND_SRC_POS_=10,t._PARAM_BLEND_DEST_POS_=11,t._PARAM_MATRIX_POS_=12,t._PARAM_FILTER_COLOR_POS_=18,t._PARAM_FILTER_ALPHA_POS_=34,t}(),function(){function t(){this._lastOriX=0,this._lastOriY=0,this.paths=[],this._curPath=null}var e;s(t,"laya.webgl.canvas.Path");var i=t.prototype;return i.beginPath=function(t){this.paths.length=1,this._curPath=this.paths[0]=new e,this._curPath.convex=t},i.closePath=function(){this._curPath.loop=!0},i.newPath=function(){this._curPath=new e,this.paths.push(this._curPath)},i.addPoint=function(t,e){this._curPath.path.push(t,e)},i.push=function(t,i){this._curPath?this._curPath.path.length>0&&(this._curPath=new e,this.paths.push(this._curPath)):(this._curPath=new e,this.paths.push(this._curPath));var n=this._curPath;n.path=t.slice(),n.convex=i},i.reset=function(){this.paths.length=0},t.__init$=function(){e=function(){function t(){this.path=[],this.loop=!1,this.convex=!1}return s(t,""),t}()},t}()),Si=function(){function t(){this._customCmds=null,this._targets=null,this._width=0,this._height=0,this._cmdEncoder=null}s(t,"laya.layagl.LayaGLRenderingContext");var e=t.prototype;return e.drawTexture=function(t,e,i,n,s){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),this.drawImage(t,e,i,n,s)},e.drawImage=function(t,e,i,n,s){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),this._customCmds.push(li.create.call(this,t,e,i,n,s))},e.fillText=function(t,e,i,n,s,r){this._customCmds.push(ai.create.call(this,t,e,i,n||Cs.defaultFontStr(),s,r))},e.save=function(){this._customCmds.push(Ke.create.call(this))},e.restore=function(){this._customCmds.push(We.create.call(this))},e.translate=function(t,e){this._customCmds.push(ge.create.call(this,t,e))},e.rotate=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),this._customCmds.push(Vi.create.call(this,t,e,i))},e.scale=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this._customCmds.push(Je.create.call(this,t,e,i,n))},e.transform=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),this._customCmds.push(F.create.call(this,t,e,i))},e.beginRT=function(){ir.pushRT(),this._targets.start(),this.clear()},e.clear=function(){},e.endRT=function(){ir.popRT()},e.drawCanvas=function(t,e,i){var n=t.context._targets;this._customCmds.push(Xe.create.call(this,n,e,i,n.width,n.height))},e.drawTarget=function(t,e,i,n,s,r){var a=new ArrayBuffer(96),o=new Int32Array(a),h=new Float32Array(a),l=0!=s?s:e.width,_=0!=r?r:e.height,u=ir.flipyuv,c=0;h[c++]=i,h[c++]=n,h[c++]=u[0],h[c++]=u[1],o[c++]=4294967295,o[c++]=4294967295,h[c++]=i+l,h[c++]=n,h[c++]=u[2],h[c++]=u[3],o[c++]=4294967295,o[c++]=4294967295,h[c++]=i+l,h[c++]=n+_,h[c++]=u[4],h[c++]=u[5],o[c++]=4294967295,o[c++]=4294967295,h[c++]=i,h[c++]=n+_,h[c++]=u[6],h[c++]=u[7],o[c++]=4294967295,o[c++]=4294967295,t.useProgramEx(he.PROGRAMEX_DRAWTEXTURE),t.useVDO(he.VDO_MESHQUADTEXTURE),t.uniformEx(he.GLOBALVALUE_VIEWS,0),t.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t.uniformTexture(0,33984,e._getSource()),t.setRectMesh(1,a),t.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15)},e.getImageData=function(t,e,i,n,s){var r=this._targets.sourceWidth,a=this._targets.sourceHeight;if(!(0>t||0>e||0>i||0>n||i>r||n>a)){this._cmdEncoder||(this._cmdEncoder=we.instance.createCommandEncoder(128,64,!1));var o=we.instance;this._cmdEncoder.beginEncoding(),this._cmdEncoder.clearEncoding(),ir.pushRT(),this._targets.start(),o.readPixelsAsync(t,e,i,n,6408,5121,function(t){s(t)}),this.endRT(),this._cmdEncoder.endEncoding(),o.useCommandEncoder(this._cmdEncoder.getPtrID(),-1,0)}},e.toBase64=function(t,e,i){var n=this._targets.sourceWidth,s=this._targets.sourceHeight;this.getImageData(0,0,n,s,function(r){var a=conchToBase64(t,e,r,n,s);i(a)})},r(0,e,"asBitmap",function(){return!this._targets},function(t){if(t){if(this._targets||(this._targets=new ir(this._width,this._height,1,-1)),!this._width||!this._height)throw Error("asBitmap no size!")}else this._targets=null}),t}(),Ai=function(){function t(){this._pool=[],this._map=[],this._laters=[]}var e;s(t,"laya.utils.CallLater");var i=t.prototype;return i._update=function(){var t=this._laters,e=t.length;if(e>0){for(var i=0,n=e-1;n>=i;i++){var s=t[i];this._map[s.key]=null,null!==s.method&&(s.run(),s.clear()),this._pool.push(s),i===n&&(n=t.length-1)}t.length=0}},i._getHandler=function(t,e){var i=t?t.$_GID||(t.$_GID=ee.getGID()):0,n=e.$_TID||(e.$_TID=1e5*hi._mid++);return this._map[i+n]},i.callLater=function(t,i,n){if(null==this._getHandler(t,i)){if(this._pool.length)var s=this._pool.pop();else s=new e;s.caller=t,s.method=i,s.args=n;var r=t?t.$_GID:0,a=i.$_TID;s.key=r+a,this._map[s.key]=s,this._laters.push(s)}},i.runCallLater=function(t,e){var i=this._getHandler(t,e);i&&null!=i.method&&(this._map[i.key]=null,i.run(),i.clear())},t.I=new t,t.__init$=function(){e=function(){function t(){this.key=0,this.caller=null,this.method=null,this.args=null}s(t,"");var e=t.prototype;return e.clear=function(){this.caller=null,this.method=null,this.args=null},e.run=function(){var t=this.caller;if(t&&t.destroyed)return this.clear();var e=this.method,i=this.args;null!=e&&(i?e.apply(t,i):e.call(t))},t}()},t}(),Ci=function(){function t(){}return s(t,"laya.events.KeyBoardManager"),t.__init__=function(){t._addEvent("keydown"),t._addEvent("keypress"),t._addEvent("keyup")},t._addEvent=function(t){Be.document.addEventListener(t,function(e){laya.events.KeyBoardManager._dispatch(e,t)},!0)},t._dispatch=function(e,n){if(t.enabled){t._event._stoped=!1,t._event.nativeEvent=e,t._event.keyCode=e.keyCode||e.which||e.charCode,"keydown"===n?t._pressKeys[t._event.keyCode]=!0:"keyup"===n&&(t._pressKeys[t._event.keyCode]=null);for(var s=i.stage.focus&&null!=i.stage.focus.event&&i.stage.focus.displayedInStage?i.stage.focus:i.stage,r=s;r;)r.event(n,t._event.setTo(n,r,s)),r=r.parent}},t.hasKeyDown=function(e){return t._pressKeys[e]},t._pressKeys={},t.enabled=!0,n(t,["_event",function(){return this._event=new se}]),t}(),Di=function(){function t(){this.ib=null,this.vb=null;Oi.mainContext;this.ib=tr.create(35048),this.vb=Qs.create(8)}s(t,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var e=t.prototype;return e.addSkinMesh=function(t){t.getData2(this.vb,this.ib,this.vb._byteLength/32)},e.reset=function(){this.vb.clear(),this.ib.clear()},t.getInstance=function(){return t.instance=t.instance||new t},t.instance=null,t}(),xi=function(){function t(){this.data=null}s(t,"laya.filters.ColorFilterAction");var e=t.prototype;return e.apply=function(t){var e=t.canvas,i=e.context;if(0==e.width||0==e.height)return e;for(var n,s=i.getImageData(0,0,e.width,e.height),r=s.data,a=0,o=r.length;o>a;a+=4)n=this.getColor(r[a],r[a+1],r[a+2],r[a+3]),0!=r[a+3]&&(r[a]=n[0],r[a+1]=n[1],r[a+2]=n[2],r[a+3]=n[3]);return i.putImageData(s,0,0),t},e.getColor=function(t,e,i,n){var s=[];if(this.data._mat&&this.data._alpha){var r=this.data._mat,a=this.data._alpha;s[0]=r[0]*t+r[1]*e+r[2]*i+r[3]*n+a[0],s[1]=r[4]*t+r[5]*e+r[6]*i+r[7]*n+a[1],s[2]=r[8]*t+r[9]*e+r[10]*i+r[11]*n+a[2],s[3]=r[12]*t+r[13]*e+r[14]*i+r[15]*n+a[3]}return s},t}(),Ri=function(){function t(){this._hit=null,this._unHit=null}s(t,"laya.utils.HitArea");var e=t.prototype;return e.contains=function(e,i){return t._isHitGraphic(e,i,this.hit)?!t._isHitGraphic(e,i,this.unHit):!1},r(0,e,"hit",function(){return this._hit||(this._hit=new ze),this._hit},function(t){this._hit=t}),r(0,e,"unHit",function(){return this._unHit||(this._unHit=new ze),this._unHit},function(t){this._unHit=t}),t._isHitGraphic=function(e,i,n){if(!n)return!1;var s=n.cmds;if(!s&&n._one&&(s=t._cmds,s.length=1,s[0]=n._one),!s)return!1;var r=0,a=0;a=s.length;var o;for(r=0;a>r;r++)if(o=s[r]){switch(o.cmdID){case"Translate":e-=o.tx,i-=o.ty}if(t._isHitCmd(e,i,o))return!0}return!1},t._isHitCmd=function(e,i,n){if(!n)return!1;var s=!1;switch(n.cmdID){case"DrawRect":t._rect.setTo(n.x,n.y,n.width,n.height),s=t._rect.contains(e,i);break;case"DrawCircle":var r=0/0;e-=n.x,i-=n.y,r=e*e+i*i,s=r<n.radius*n.radius;break;case"DrawPoly":e-=n.x,i-=n.y,s=t._ptInPolygon(e,i,n.points)}return s},t._ptInPolygon=function(e,i,n){var s=t._ptPoint;s.setTo(e,i);var r=0,a=0/0,o=0/0,h=0/0,l=0/0,_=0;_=n.length;for(var u=0;_>u;u+=2)if(a=n[u],o=n[u+1],h=n[(u+2)%_],l=n[(u+3)%_],o!=l&&!(s.y<Math.min(o,l)||s.y>=Math.max(o,l))){var c=(s.y-o)*(h-a)/(l-o)+a;c>s.x&&r++}return r%2==1},t._cmds=[],n(t,["_rect",function(){return this._rect=new He},"_ptPoint",function(){return this._ptPoint=new $i}]),t}(),Ti=function(){function t(){}return s(t,"Config"),t.animationInterval=50,t.isAntialias=!1,t.isAlpha=!1,t.premultipliedAlpha=!0,t.isStencil=!0,t.preserveDrawingBuffer=!1,t.webGL2D_MeshAllocMaxMem=!0,t.is2DPixelArtGame=!1,t.useWebGL2=!1,t}(),bi=function(){function t(){this._commStr="",this._commandEncoder=null,this._id=0,this._commandEncoder=we.instance.createCommandEncoder(64,16,!1)}s(t,"laya.layagl.LayaGLTemplate");var e=t.prototype;return e.addComd=function(t,e){this._commStr+=t+"("+e+");",this._commandEncoder[t].apply(this._commandEncoder,e)},t.createByRenderType=function(e){var i=t.GLS[e]=new t;Ni.isConchApp&&we.instance.setGLTemplate(e,i._commandEncoder.getPtrID());for(var n=1;8192>=n;){var s=e&n;if(s&&t.__FUN_PARAM__[n])for(var r=t.__FUN_PARAM__[n],a=0,o=r.length;o>a;a++){var h=r[a];i.addComd(h.func,h.args)}n<<=1}return i._id=e,console.log("template="+i._commStr),i},t.createByRenderTypeEnd=function(e){var i=t.GLSE[e]=new t;Ni.isConchApp&&we.instance.setEndGLTemplate(e,i._commandEncoder.getPtrID());for(var n=8192;n>1;){var s=e&n;if(s&&t.__FUN_PARAM_END_[n])for(var r=t.__FUN_PARAM_END_[n],a=0,o=r.length;o>a;a++){var h=r[a];i.addComd(h.func,h.args)}n>>=1}return i._id=e,console.log("templateEnd="+i._commStr),i},t.__init__=function(){t.__FUN_PARAM__[1]=[{func:"setGlobalValueByParamData",args:[he.GLOBALVALUE_DRAWTEXTURE_COLOR,15,88]}],t.__FUN_PARAM__[2]=[{func:"calcLocalMatrix32",args:[60,64,24,28,32,36,40,44,48,52,56]},{func:"setGlobalValueByParamData",args:[he.GLOBALVALUE_MATRIX32,7,64]}],t.__FUN_PARAM__[4]=[{func:"setGlobalValueByParamData",args:[he.GLOBALVALUE_BLENDFUNC_SRC,8,284]},{func:"setGlobalValueByParamData",args:[he.GLOBALVALUE_BLENDFUNC_DEST,8,288]}],t.__FUN_PARAM__[256]=[{func:"useCommandEncoderByParamData",args:[96,100,1]}],t.__FUN_PARAM__[512]=[{func:"callbackJSByParamData",args:[216,272]},{func:"useCommandEncoderByParamData",args:[92,-1,1]}],t.__FUN_PARAM__[1024]=[{func:"callbackJSByParamData",args:[216,248]},{func:"useCommandEncoderByParamData",args:[104,-1,3]}],t.__FUN_PARAM__[2048]=[{func:"callbackJSByParamData",args:[216,220]},{func:"useCommandEncoderByParamData",args:[108,-1,1]}],t.__FUN_PARAM__[64]=[{func:"setClipByParamData",args:[he.GLOBALVALUE_CLIP_MAT_DIR,he.GLOBALVALUE_CLIP_MAT_POS,he.GLOBALVALUE_MATRIX32,112]},{func:"setGlobalValueByParamData",args:[he.GLOBALVALUE_MATRIX32,9,128]}],t.__FUN_PARAM__[16]=[{func:"callbackJSByParamData",args:[216,260]},{func:"useCommandEncoderByParamData",args:[256,-1,0]}],t.__FUN_PARAM__[32]=[{func:"callbackJSByParamData",args:[216,276]},{func:"useCommandEncoderByParamData",args:[280,-1,0]}],t.__FUN_PARAM__[8]=[{func:"callbackJSByParamData",args:[216,224]},{func:"loadDataToRegByParamData",args:[0,252,4]},{func:"ifGreater0",args:[0,2147483647]},{func:"useCommandEncoderByParamData",args:[232,-1,0]}],t.__FUN_PARAM__[128]=[{func:"useCommandEncoderByParamData",args:[292,296,1]},{func:"useCommandEncoderByParamData",args:[300,304,1]}]},t.__init_END_=function(){t.__FUN_PARAM_END_[16]=[{func:"loadDataToRegByParamData",args:[0,252,4]},{func:"ifGreater0",args:[0,2]},{func:"callbackJSByParamData",args:[216,268]},{func:"useCommandEncoderByParamData",args:[264,-1,1]}],t.__FUN_PARAM_END_[8]=[{func:"callbackJSByParamData",args:[216,228]},{func:"useCommandEncoderByParamData",args:[236,-1,0]},{func:"useCommandEncoderByParamData",args:[240,244,1]}]},t.GLS=[],t.GLSE=[],t.__FUN_PARAM__=[],t.__FUN_PARAM_END_=[],t}(),Pi=function(){function t(){}s(t,"laya.display.cmd.FillBorderWordsCmd");var e=t.prototype;return e.recover=function(){this.words=null,Ji.recover("FillBorderWordsCmd",this)},e.run=function(t,e,i){t.fillBorderWords(this.words,this.x+e,this.y+i,this.font,this.fillColor,this.borderColor,this.lineWidth)},r(0,e,"cmdID",function(){return"FillBorderWords"}),t.create=function(e,i,n,s,r,a,o){var h=Ji.getItemByClass("FillBorderWordsCmd",t);return h.words=e,h.x=i,h.y=n,h.font=s,h.fillColor=r,h.borderColor=a,h.lineWidth=o,h},t.ID="FillBorderWords",t}(),Li=function(){function t(){}s(t,"laya.display.cmd.DrawTexturesCmd");var e=t.prototype;return e.recover=function(){this.texture._removeReference(),this.texture=null,this.pos=null,Ji.recover("DrawTexturesCmd",this)},e.run=function(t,e,i){t.drawTextures(this.texture,this.pos,e,i)},r(0,e,"cmdID",function(){return"DrawTextures"}),t.create=function(e,i){var n=Ji.getItemByClass("DrawTexturesCmd",t);return n.texture=e,e._addReference(),n.pos=i,n},t.ID="DrawTextures",t}(),Ii=(function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._graphicsCmdEncoder_fill=null,this._paramData_fill=null,this._x=0/0,this._y=0/0,this._paths=null,this._brush=null,this._pen=null,this._vertNum=0,this._startOriX=0,this._startOriY=0,this._lastOriX=0,this._lastOriY=0,this.SEGNUM=32,this.lines_ibBuffer=null,this.lines_vbBuffer=null,this._lines_ibSize=0,this._lines_vbSize=0,this.fill_ibBuffer=null,this.fill_vbBuffer=null,this._fill_ibSize=0,this._fill_vbSize=0,this._cmdCurrentPos=0,this._points=[],this._lines_ibArray=[],this._lines_vbArray=[],this._fill_ibArray=[],this._fill_vbArray=[]}s(t,"laya.layagl.cmdNative.DrawPathCmdNative");var e=t.prototype;return e._arcTo=function(t){var e=t[1],i=t[2],n=t[3],s=t[4],r=t[5],a=0,o=0,h=0,l=this._lastOriX-e,_=this._lastOriY-i,u=Math.sqrt(l*l+_*_);if(!(1e-6>=u)){var c=l/u,d=_/u,f=n-e,p=s-i,m=f*f+p*p,g=Math.sqrt(m);if(!(1e-6>=g)){var v=f/g,y=p/g,E=c+v,S=d+y,A=Math.sqrt(E*E+S*S);if(!(1e-6>=A)){var C=E/A,D=S/A,x=Math.acos(C*c+D*d),R=Math.PI/2-x;u=r/Math.tan(R);var T=u*c+e,b=u*d+i,P=Math.sqrt(u*u+r*r),L=e+C*P,I=i+D*P,M=c*y-d*v,w=0,O=0,B=0;if(M>=0){w=2*R;var N=w/this.SEGNUM;O=Math.sin(N),B=Math.cos(N)}else w=2*-R,N=w/this.SEGNUM,O=Math.sin(N),B=Math.cos(N);var k=this._lastOriX,F=this._lastOriY,V=T-L,U=b-I;for(a=0;a<this.SEGNUM;a++){var W=V*B+U*O,G=-V*O+U*B;o=W+L,h=G+I,(Math.abs(k-o)>.1||Math.abs(F-h)>.1)&&(this._points.push(o),this._points.push(h)),V=W,U=G}}}}},e.recover=function(){this._paths=null,this._brush=null,this._pen=null,this._points.length=0,this._lines_ibArray.length=0,this._lines_vbArray.length=0,this._fill_ibArray.length=0,this._fill_vbArray.length=0,Ji.recover("DrawPathCmd",this)},r(0,e,"cmdID",function(){return"DrawPath"}),r(0,e,"paths",function(){return this._paths},function(t){this._paths=t}),r(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.lines_vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)e[i++]=this._lines_vbArray[2*n]+t,i++,i++;we.syncBufferToRenderThread(this.lines_vbBuffer)}),r(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.lines_vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)i++,e[i++]=this._lines_vbArray[2*n+1]+t,i++;we.syncBufferToRenderThread(this.lines_vbBuffer)}),r(0,e,"brush",function(){return this._brush},function(e){this._brush||(this._graphicsCmdEncoder._idata[this._cmdCurrentPos+1]=t._DRAW_LINES_FILL_CMD_ENCODER_.getPtrID(),we.syncBufferToRenderThread(this._graphicsCmdEncoder)),this._brush=e;var i=this._vertNum,n=gi.earcut(this._points,null,2);if(n.length>0){(!this.fill_ibBuffer||this.fill_ibBuffer.getByteLength()<2*n.length)&&(this.fill_ibBuffer=new ParamData(2*n.length,!0,!0)),this._fill_ibSize=2*n.length;for(var s=this.fill_ibBuffer._int16Data,r=0,a=0;a<n.length;a++)s[r++]=n[a]}var h=o.create(e.fillStyle),l=h.numColor;(!this.fill_vbBuffer||this.fill_vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.fill_vbBuffer=new ParamData(3*i*4,!0)),this._fill_vbSize=3*this._vertNum*4;for(var _=this.fill_vbBuffer._float32Data,u=this.fill_vbBuffer._int32Data,c=0,d=0;d<this._vertNum;d++)_[c++]=this._points[2*d]+this.x,_[c++]=this._points[2*d+1]+this.y,u[c++]=l;var f=this._paramData._int32Data;f[t._PARAM_FILL_VB_POS_]=this.fill_vbBuffer.getPtrID(),f[t._PARAM_FILL_IB_POS_]=this.fill_ibBuffer.getPtrID(),f[t._PARAM_FILL_VB_SIZE_POS_]=this._fill_vbSize,f[t._PARAM_FILL_IB_SIZE_POS_]=this._fill_ibSize,we.syncBufferToRenderThread(this.fill_vbBuffer),we.syncBufferToRenderThread(this.fill_ibBuffer),we.syncBufferToRenderThread(this._paramData)}),r(0,e,"pen",function(){return this._pen},function(e){this._pen=e,this._lines_ibArray.length=0,this._lines_vbArray.length=0,ii.createLine2(this._points,this._lines_ibArray,e.lineWidth,0,this._lines_vbArray,!1);var i=o.create(e.strokeStyle),n=i.numColor,s=this._vertNum;(!this.lines_vbBuffer||this.lines_vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.lines_vbBuffer=new ParamData(3*s*4,!0)),this._lines_vbSize=3*this._vertNum*4;for(var r=this.lines_vbBuffer._float32Data,a=this.lines_vbBuffer._int32Data,h=0,l=0;l<this._vertNum;l++)r[h++]=this._lines_vbArray[2*l]+this.x,r[h++]=this._lines_vbArray[2*l+1]+this.y,a[h++]=n;(!this.lines_ibBuffer||this.lines_ibBuffer.getByteLength()<3*(this._vertNum-2)*2)&&(this.lines_ibBuffer=new ParamData(3*(s-2)*2,!0,!0)),this._lines_ibSize=3*(this._vertNum-2)*2;for(var _=this.lines_ibBuffer._int16Data,u=0;u<3*(this._vertNum-2);u++)_[u]=this._lines_ibArray[u];a=this._paramData._int32Data,a[t._PARAM_LINES_VB_POS_]=this.lines_vbBuffer.getPtrID(),a[t._PARAM_LINES_IB_POS_]=this.lines_ibBuffer.getPtrID(),a[t._PARAM_LINES_VB_SIZE_POS_]=this._lines_vbSize,a[t._PARAM_LINES_IB_SIZE_POS_]=this._lines_ibSize,we.syncBufferToRenderThread(this.lines_vbBuffer),we.syncBufferToRenderThread(this.lines_ibBuffer),we.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,n,s,r){var a=Ji.getItemByClass("DrawPathCmd",t);a._graphicsCmdEncoder=this._commandEncoder,t._DRAW_LINES_CMD_ENCODER_||(t._DRAW_LINES_CMD_ENCODER_=we.instance.createCommandEncoder(188,32,!0),t._DRAW_LINES_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_LINES_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_LINES_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_LINES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_LINES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_LINES_VB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINES_VB_SIZE_POS_,4*t._PARAM_LINES_IB_POS_,4*t._PARAM_LINE_IB_OFFSET_POS_,4*t._PARAM_LINES_IB_SIZE_POS_,4*t._PARAM_FILL_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_LINES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_LINES_CMD_ENCODER_)),t._DRAW_FILL_CMD_ENCODER_||(t._DRAW_FILL_CMD_ENCODER_=we.instance.createCommandEncoder(168,32,!0),t._DRAW_FILL_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_FILL_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_FILL_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_FILL_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_FILL_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_FILL_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_FILL_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_FILL_VB_POS_,4*t._PARAM_FILL_VB_OFFSET_POS_,4*t._PARAM_FILL_VB_SIZE_POS_,4*t._PARAM_FILL_IB_POS_,4*t._PARAM_FILL_IB_OFFSET_POS_,4*t._PARAM_FILL_IB_SIZE_POS_,4*t._PARAM_FILL_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_FILL_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_FILL_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_FILL_CMD_ENCODER_)),t._DRAW_LINES_FILL_CMD_ENCODER_||(t._DRAW_LINES_FILL_CMD_ENCODER_=we.instance.createCommandEncoder(244,32,!0),t._DRAW_LINES_FILL_CMD_ENCODER_.blendFuncByGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,he.GLOBALVALUE_BLENDFUNC_DEST),t._DRAW_LINES_FILL_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_LINES_FILL_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_LINES_FILL_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_LINES_FILL_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_LINES_FILL_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_LINES_FILL_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_FILL_VB_POS_,4*t._PARAM_FILL_VB_OFFSET_POS_,4*t._PARAM_FILL_VB_SIZE_POS_,4*t._PARAM_FILL_IB_POS_,4*t._PARAM_FILL_IB_OFFSET_POS_,4*t._PARAM_FILL_IB_SIZE_POS_,4*t._PARAM_FILL_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_LINES_FILL_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_LINES_FILL_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),t._DRAW_LINES_FILL_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_LINES_VB_POS_,4*t._PARAM_LINE_VB_OFFSET_POS_,4*t._PARAM_LINES_VB_SIZE_POS_,4*t._PARAM_LINES_IB_POS_,4*t._PARAM_LINE_IB_OFFSET_POS_,4*t._PARAM_LINES_IB_SIZE_POS_,4*t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_LINES_FILL_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_LINES_FILL_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_LINES_FILL_CMD_ENCODER_)),a._paramData||(a._paramData=new ParamData(60,!0)),a._x=e,a._y=i,a._paths=n,a._brush=s,a._pen=r;for(var h=0,l=n.length;l>h;h++){var _=n[h];switch(0==h&&(a._startOriX=_[1],a._startOriY=_[2]),_[0]){case"moveTo":a._lastOriX=_[1],a._lastOriY=_[2],a._points.push(_[1]),a._points.push(_[2]);break;case"lineTo":a._lastOriX=_[1],a._lastOriY=_[2],a._points.push(_[1]),a._points.push(_[2]);break;case"arcTo":a._arcTo(_);break;case"closePath":a._points.push(a._startOriX),a._points.push(a._startOriY)}}if(a._vertNum=a._points.length,r){ii.createLine2(a._points,a._lines_ibArray,r.lineWidth,0,a._lines_vbArray,!1);var u=o.create(r.strokeStyle),c=u.numColor,d=a._vertNum;(!a.lines_vbBuffer||a.lines_vbBuffer.getByteLength()<3*a._vertNum*4)&&(a.lines_vbBuffer=new ParamData(3*d*4,!0)),a._lines_vbSize=3*a._vertNum*4;var f=a.lines_vbBuffer._float32Data,p=a.lines_vbBuffer._int32Data,m=0;for(h=0;h<a._vertNum;h++)f[m++]=a._lines_vbArray[2*h]+e,f[m++]=a._lines_vbArray[2*h+1]+i,p[m++]=c;(!a.lines_ibBuffer||a.lines_ibBuffer.getByteLength()<3*(a._vertNum-2)*2)&&(a.lines_ibBuffer=new ParamData(3*(d-2)*2,!0,!0)),a._lines_ibSize=3*(a._vertNum-2)*2;for(var g=a.lines_ibBuffer._int16Data,v=0;v<3*(a._vertNum-2);v++)g[v]=a._lines_ibArray[v]}if(s){d=a._vertNum;var y=gi.earcut(a._points,null,2);if(y.length>0){(!a.fill_ibBuffer||a.fill_ibBuffer.getByteLength()<2*y.length)&&(a.fill_ibBuffer=new ParamData(2*y.length,!0,!0)),a._fill_ibSize=2*y.length,g=a.fill_ibBuffer._int16Data;var E=0;for(v=0;v<y.length;v++)g[E++]=y[v]}u=o.create(s.fillStyle),c=u.numColor,(!a.fill_vbBuffer||a.fill_vbBuffer.getByteLength()<3*a._vertNum*4)&&(a.fill_vbBuffer=new ParamData(3*d*4,!0)),a._fill_vbSize=3*a._vertNum*4,f=a.fill_vbBuffer._float32Data;var S=a.fill_vbBuffer._int32Data;for(S=a.fill_vbBuffer._int32Data,m=0,h=0;h<a._vertNum;h++)f[m++]=a._points[2*h]+e,f[m++]=a._points[2*h+1]+i,S[m++]=c}a._paramData._float32Data;return p=a._paramData._int32Data,p[0]=1,r&&(p[t._PARAM_LINES_VB_POS_]=a.lines_vbBuffer.getPtrID(),p[t._PARAM_LINES_IB_POS_]=a.lines_ibBuffer.getPtrID(),p[t._PARAM_LINES_VB_SIZE_POS_]=a._lines_vbSize,p[t._PARAM_LINES_IB_SIZE_POS_]=a._lines_ibSize,p[t._PARAM_LINE_VB_OFFSET_POS_]=0,p[t._PARAM_LINE_IB_OFFSET_POS_]=0,p[t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_]=0,we.syncBufferToRenderThread(a.lines_vbBuffer),we.syncBufferToRenderThread(a.lines_ibBuffer)),s&&(p[t._PARAM_FILL_VB_POS_]=a.fill_vbBuffer.getPtrID(),p[t._PARAM_FILL_IB_POS_]=a.fill_ibBuffer.getPtrID(),p[t._PARAM_FILL_VB_SIZE_POS_]=a._fill_vbSize,p[t._PARAM_FILL_IB_SIZE_POS_]=a._fill_ibSize,p[t._PARAM_FILL_VB_OFFSET_POS_]=0,p[t._PARAM_FILL_IB_OFFSET_POS_]=0,p[t._PARAM_FILL_INDEX_ELEMENT_OFFSET_POS_]=0,we.syncBufferToRenderThread(a.fill_vbBuffer),we.syncBufferToRenderThread(a.fill_ibBuffer)),we.syncBufferToRenderThread(a._paramData),s&&r?a._cmdCurrentPos=a._graphicsCmdEncoder.useCommandEncoder(t._DRAW_LINES_FILL_CMD_ENCODER_.getPtrID(),a._paramData.getPtrID(),-1):s&&!r?a._cmdCurrentPos=a._graphicsCmdEncoder.useCommandEncoder(t._DRAW_FILL_CMD_ENCODER_.getPtrID(),a._paramData.getPtrID(),-1):!s&&r&&(a._cmdCurrentPos=a._graphicsCmdEncoder.useCommandEncoder(t._DRAW_LINES_CMD_ENCODER_.getPtrID(),a._paramData.getPtrID(),-1)),we.syncBufferToRenderThread(a._graphicsCmdEncoder),a},t.ID="DrawPath",t._DRAW_LINES_CMD_ENCODER_=null,t._DRAW_LINES_FILL_CMD_ENCODER_=null,t._DRAW_FILL_CMD_ENCODER_=null,t._PARAM_LINES_VB_POS_=1,t._PARAM_LINES_IB_POS_=2,t._PARAM_LINES_VB_SIZE_POS_=3,t._PARAM_LINES_IB_SIZE_POS_=4,t._PARAM_FILL_VB_POS_=5,t._PARAM_FILL_IB_POS_=6,t._PARAM_FILL_VB_SIZE_POS_=7,t._PARAM_FILL_IB_SIZE_POS_=8,t._PARAM_FILL_VB_OFFSET_POS_=9,t._PARAM_FILL_IB_OFFSET_POS_=10,t._PARAM_LINE_VB_OFFSET_POS_=11,t._PARAM_LINE_IB_OFFSET_POS_=12,t._PARAM_FILL_INDEX_ELEMENT_OFFSET_POS_=13,t._PARAM_LINE_INDEX_ELEMENT_OFFSET_POS_=14,t}(),function(){function t(){}return s(t,"laya.net.AtlasInfoManager"),t.enable=function(e,n){i.loader.load(e,_.create(null,t._onInfoLoaded,[n]),_.create(null,t._progressData),"json")},t._progressData=function(t){console.log("sss:"+t)},t._onInfoLoaded=function(e,i){var n,s,r,a=0,o=0;for(n in i)for(r=i[n],s=r[0],r=r[1],o=r.length,a=0;o>a;a++)t._fileLoadDic[s+r[a]]=n;e&&e.run()},t.getFileLoadPath=function(e){return t._fileLoadDic[e]||e},t._fileLoadDic={},t}()),Mi=function(){function t(e){this._url=null,this._path=null,this._url=t.formatURL(e),this._path=t.getPath(e)}s(t,"laya.net.URL");var e=t.prototype;return r(0,e,"path",function(){return this._path}),r(0,e,"url",function(){return this._url}),t.formatURL=function(e){if(!e)return"null path";if(e.indexOf(":")>0)return e;if(null!=t.customFormat&&(e=t.customFormat(e)),e.indexOf(":")>0)return e;var i=e.charAt(0);if("."===i)return t._formatRelativePath(t.basePath+e);if("~"===i)return t.rootPath+e.substring(1);if("d"===i){if(0===e.indexOf("data:image"))return e}else if("/"===i)return e;return t.basePath+e},t._formatRelativePath=function(t){for(var e=t.split("/"),i=0,n=e.length;n>i;i++)".."==e[i]&&(e.splice(i-1,2),i-=2);return e.join("/")},t.getPath=function(t){var e=t.lastIndexOf("/");return e>0?t.substr(0,e+1):""},t.getFileName=function(t){var e=t.lastIndexOf("/");return e>0?t.substr(e+1):t},t.getAdptedFilePath=function(e){if(!t.exportSceneToJson||!e)return e;var i=0,n=0;n=t._adpteTypeList.length;var s;for(i=0;n>i;i++)s=t._adpteTypeList[i],e=e.replace(s[0],s[1]);return e},t.version={},t.exportSceneToJson=!1,t.basePath="",t.rootPath="",t.customFormat=function(e){var i=t.version[e];return!Ni.isConchApp&&i&&(e+="?v="+i),e},n(t,["_adpteTypeList",function(){return this._adpteTypeList=[[".scene3d",".json"],[".scene",".json"],[".taa",".json"],[".prefab",".json"]]}]),t}(),wi=(function(){function t(){this._graphicsCmdEncoder=null}s(t,"laya.layagl.cmdNative.SaveCmdNative");var e=t.prototype;return e.recover=function(){Ji.recover("SaveCmd",this)},r(0,e,"cmdID",function(){return"Save"}),t.create=function(){var e=Ji.getItemByClass("SaveCmd",t),i=e._graphicsCmdEncoder=this._commandEncoder;return i.save(),we.syncBufferToRenderThread(i),e},t.ID="Save",t}(),function(){function t(){}return s(t,"laya.utils.Stat"),r(1,t,"onclick",null,function(e){t._sp&&t._sp.on("click",t._sp,e),t._canvas&&(t._canvas.source.onclick=e,t._canvas.source.style.pointerEvents="")}),t.show=function(e,i){void 0===e&&(e=0),void 0===i&&(i=0),Be.onMiniGame||Be.onLimixiu||(t._useCanvas=!0),t._show=!0,t._fpsData.length=60,t._view[0]=Ni.isConchApp?{title:"FPS",value:"_fpsStr",color:"yellow",units:"int"}:{title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},t._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},t._view[2]={title:"DrawCall",value:"drawCall",color:"white",units:"int"},t._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},Ni.isWebGL&&(t._view[4]={title:"Shader",value:"shaderCall",color:"white",units:"int"},Ni.is3DMode?(t._view[0].title="FPS(3D)",t._view[5]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"},t._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},t._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"}):(t._view[0].title="FPS(WebGL)",t._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"})),t._useCanvas?t.createUIPre(e,i):t.createUI(e,i),t.enable()},t.createUIPre=function(e,n){var s=Be.pixelRatio;t._width=130*s,t._vx=75*s,t._height=s*(12*t._view.length+3*s)+4,t._fontSize=12*s;for(var r=0;r<t._view.length;r++)t._view[r].x=4,t._view[r].y=r*t._fontSize+2*s;Ni.isConchApp?(t._sp=new kn,t._titleSp=new kn,t._bgSp=new kn,t._bgSp.graphics.drawRect(e,n,t._width,t._height,"#969696"),t._bgSp.alpha=.8,t._sp.zOrder=1e5,t._titleSp.zOrder=1e5,t._bgSp.zOrder=1e5,t._bgSp.addChild(t._sp),t._bgSp.addChild(t._titleSp),i.stage.addChild(t._bgSp)):(t._canvas||(t._canvas=new Is(!0),t._canvas.size(t._width,t._height),t._ctx=t._canvas.getContext("2d"),t._ctx.textBaseline="top",t._ctx.font=t._fontSize+"px Arial",t._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+e+"px;top:"+n+"px;width:"+t._width/s+"px;height:"+t._height/s+"px;"),Be.container.appendChild(t._canvas.source)),t._first=!0,t.loop(),t._first=!1},t.createUI=function(e,i){var n=t._sp,s=Be.pixelRatio;n||(n=new kn,t._leftText=new Cs,t._leftText.pos(5,5),t._leftText.color="#ffffff",n.addChild(t._leftText),t._txt=new Cs,t._txt.pos(80*s,5),t._txt.color="#ffffff",n.addChild(t._txt),t._sp=n),n.pos(e,i);for(var r="",a=0;a<t._view.length;a++){var o=t._view[a];r+=o.title+"\n"}t._leftText.text=r;var h=138*s,l=s*(12*t._view.length+3*s)+4;t._txt.fontSize=t._fontSize*s,t._leftText.fontSize=t._fontSize*s,n.size(h,l),n.graphics.clear(),n.graphics.alpha(.5),n.graphics.drawRect(0,0,h,l,"#999999"),n.graphics.alpha(2),t.loop()
},t.enable=function(){i.systemTimer.frameLoop(1,t,t.loop)},t.hide=function(){t._show=!1,i.systemTimer.clear(t,t.loop),t._canvas&&Be.removeElement(t._canvas.source)},t.clear=function(){t.trianglesFaces=t.drawCall=t.shaderCall=t.spriteCount=t.spriteRenderUseCacheCount=t.treeNodeCollision=t.treeSpriteCollision=t.canvasNormal=t.canvasBitmap=t.canvasReCache=0},t.loop=function(){t._count++;var e=Be.now();if(!(e-t._timer<1e3)){var i=t._count;if(t.FPS=Math.round(1e3*i/(e-t._timer)),t._show){t.trianglesFaces=Math.round(t.trianglesFaces/i),t._useCanvas?(t.drawCall=Math.round(t.drawCall/i),t.shaderCall=Math.round(t.shaderCall/i),t.spriteCount=Math.round(t.spriteCount/i)-1):(t.drawCall=Math.round(t.drawCall/i)-1,t.shaderCall=Math.round(t.shaderCall/i),t.spriteCount=Math.round(t.spriteCount/i)-4),t.spriteRenderUseCacheCount=Math.round(t.spriteRenderUseCacheCount/i),t.canvasNormal=Math.round(t.canvasNormal/i),t.canvasBitmap=Math.round(t.canvasBitmap/i),t.canvasReCache=Math.ceil(t.canvasReCache/i),t.treeNodeCollision=Math.round(t.treeNodeCollision/i),t.treeSpriteCollision=Math.round(t.treeSpriteCollision/i);var n=t.FPS>0?Math.floor(1e3/t.FPS).toString():" ";t._fpsStr=t.FPS+(t.renderSlow?" slow":"")+" "+n,t._spriteStr=t.spriteCount+(t.spriteRenderUseCacheCount?"/"+t.spriteRenderUseCacheCount:""),t._canvasStr=t.canvasReCache+"/"+t.canvasNormal+"/"+t.canvasBitmap,t.currentMemorySize=Xi.systemResourceManager.memorySize,t._useCanvas?t.renderInfoPre():t.renderInfo(),t.clear()}t._count=0,t._timer=e}},t.renderInfoPre=function(){var e,i,n=0;if(Ni.isConchApp)for(t._sp.graphics.clear(),n=0;n<t._view.length;n++)e=t._view[n],t._first&&t._titleSp.graphics.fillText(e.title,e.x,e.y,t._fontSize+"px Arial","#ffffff","left"),i=t[e.value],"M"==e.units&&(i=Math.floor(i/1048576*100)/100+" M"),t._sp.graphics.fillText(i+"",e.x+t._vx,e.y,t._fontSize+"px Arial",e.color,"left");else if(t._canvas){var s=t._ctx;for(s.clearRect(t._first?0:t._vx,0,t._width,t._height),n=0;n<t._view.length;n++)e=t._view[n],t._first&&(s.fillStyle="white",s.fillText(e.title,e.x,e.y)),s.fillStyle=e.color,i=t[e.value],"M"==e.units&&(i=Math.floor(i/1048576*100)/100+" M"),s.fillText(i+"",e.x+t._vx,e.y)}},t.renderInfo=function(){for(var e="",i=0;i<t._view.length;i++){var n=t._view[i],s=t[n.value];"M"==n.units&&(s=Math.floor(s/1048576*100)/100+" M"),"K"==n.units&&(s=Math.floor(s/1024*100)/100+" K"),e+=s+"\n"}t._txt.text=e},t.FPS=0,t.loopCount=0,t.shaderCall=0,t.drawCall=0,t.trianglesFaces=0,t.spriteCount=0,t.spriteRenderUseCacheCount=0,t.treeNodeCollision=0,t.treeSpriteCollision=0,t.canvasNormal=0,t.canvasBitmap=0,t.canvasReCache=0,t.renderSlow=!1,t.currentMemorySize=0,t._fpsStr=null,t._canvasStr=null,t._spriteStr=null,t._fpsData=[],t._timer=0,t._count=0,t._view=[],t._fontSize=12,t._txt=null,t._leftText=null,t._sp=null,t._titleSp=null,t._bgSp=null,t._show=!1,t._useCanvas=!1,t._canvas=null,t._ctx=null,t._first=!1,t._vx=0/0,t._width=0,t._height=100,t}()),Oi=function(){function e(){}return s(e,"laya.webgl.WebGL"),e._uint8ArraySlice=function(){for(var t=this,e=t.length,i=new Uint8Array(t.length),n=0;e>n;n++)i[n]=t[n];return i},e._float32ArraySlice=function(){for(var t=this,e=t.length,i=new Float32Array(t.length),n=0;e>n;n++)i[n]=t[n];return i},e._uint16ArraySlice=function(){var t,e=arguments,i=this,n=0,s=0;if(0===e.length)for(n=i.length,t=new Uint16Array(n),s=0;n>s;s++)t[s]=i[s];else if(2===e.length){var r=e[0],a=e[1];if(a>r)for(n=a-r,t=new Uint16Array(n),s=r;a>s;s++)t[s-r]=i[s];else t=new Uint16Array(0)}return t},e._nativeRender_enable=function(){e.isNativeRender_enable||(e.isNativeRender_enable=!0,Ms.create=function(t,e){return new nr(t,e,1,!1,!1)},ye.__init_native(),pi.width=Be.window.innerWidth,pi.height=Be.window.innerHeight,qi.measureText=function(e,i){return t.conchTextCanvas.font=i,t.conchTextCanvas.measureText(e)},qi.enableNative=function(){je.uploadShaderUniforms=je.uploadShaderUniformsForNative;var e=Ts;e.prototype.repaint=e.prototype.repaintForNative,e.prototype.render=e.prototype.renderToNative;var i=qe;if(i.prototype.bind=qe.prototype.bindForNative,i.prototype.unBind=qe.prototype.unBindForNative,Ni.isConchApp){Ye=t.GLCommandEncoder,we=t.LayaGLContext;var n=t.CanvasRenderingContext.prototype,s=Si.prototype;Si=t.CanvasRenderingContext,n.drawImage=s.drawImage,n.drawTexture=s.drawTexture,n.fillText=s.fillText,n.save=s.save,n.restore=s.restore,n.translate=s.translate,n.scale=s.scale,n.rotate=s.rotate,n.transform=s.transform,n.beginRT=s.beginRT,n.endRT=s.endRT,n.drawCanvas=s.drawCanvas,n.drawTarget=s.drawTarget,n._$get_asBitmap=s._$get_asBitmap,n._$set_asBitmap=s._$set_asBitmap,n.toBase64=s.toBase64,n.getImageData=s.getImageData,r(0,n,"asBitmap",n._$get_asBitmap,n._$set_asBitmap),W.rewriteProperties()}fs.init(),he.__init__()},qi.clear=function(t){var e=o.create(t).arrColor,i=we.instance;e&&i.clearColor(e[0],e[1],e[2],e[3]),i.clear(17664)},qi.drawToCanvas=function(t,e,i,n,s,r){var a=new Is(!0);a.size(i,n);var o=a.getContext("2d");o.asBitmap=!0;var h=we.instance.createCommandEncoder(128,64,!1);h.beginEncoding(),h.clearEncoding();var l=we.instance,_=l.getCurrentContext();l.setCurrentContext(o),o.beginRT(),l.save();var u=fs._tempFloatArrayMatrix;return u[0]=1,u[1]=0,u[2]=0,u[3]=1,u[4]=s,u[5]=r,l.setGlobalValue(he.GLOBALVALUE_MATRIX32,8,u),t.writeBlockToNative(),l.restore(),l.setCurrentContext(_),l.commitContextToGPU(o),o.endRT(),h.endEncoding(),l.useCommandEncoder(h.getPtrID(),-1,0),a},Is.prototype.getTexture=function(){return this._texture||(this._texture=this.context._targets,this._texture.uv=ir.flipyuv,this._texture.bitmap=this._texture),this._texture})},e._webglRender_enable=function(){Ni.isWebGL||(Ni.isWebGL=!0,qi.initRender=function(t,i,n){function s(t){var e,i=["webgl2","webgl","experimental-webgl","webkit-3d","moz-webgl"];Ti.useWebGL2||i.shift();for(var n=0;n<i.length;n++){try{e=t.getContext(i[n],{stencil:Ti.isStencil,alpha:Ti.isAlpha,antialias:Ti.isAntialias,premultipliedAlpha:Ti.premultipliedAlpha,preserveDrawingBuffer:Ti.preserveDrawingBuffer})}catch(s){}if(e)return"webgl2"===i[n]&&(laya.webgl.WebGL._isWebGL2=!0),new we,e}return null}var r=we.instance=laya.webgl.WebGL.mainContext=s(Ni._mainCanvas.source);if(!r)return!1;t.size(i,n),ye.__init__(r),pn.__init__(),K.__init__();var a=new pn;Ni._context=a,t._setContext(a),laya.webgl.WebGL.shaderHighPrecision=!1;try{var o=r.getShaderPrecisionFormat(35632,36338);e.shaderHighPrecision=o.precision?!0:!1}catch(h){}return we.instance=r,be.__init__(),Tn.__init__(),mi.__init__(),Bi.__init__(),Ps.__int__(r),fe._init_(r),!0},Ms.create=function(t,e){return new nr(t,e,1,!1,!1)},qi.createRenderSprite=function(t,e){return new xn(t,e)},qi.changeWebGLSize=function(t,e){laya.webgl.WebGL.onStageResize(t,e)},qi.clear=function(t){pn.set2DRenderConfig(),pi.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var e=Ni.context,n=0==e._submits._length||Ti.preserveDrawingBuffer?o.create(t).arrColor:i.stage._wgColor;n&&e.clearBG(n[0],n[1],n[2],n[3]),pi.clear()},qi.drawToCanvas=function(t,e,i,n,s,r){s-=t.x,r-=t.y,s|=0,r|=0,i|=0,n|=0;var a=new pn;a.size(i,n),a.asBitmap=!0,a._targets.start(),z.renders[e]._fun(t,a,s,r),a.flush(),a._targets.end(),a._targets.restore();var o=a._targets.getData(0,0,i,n);a.destroy();for(var h=new ImageData(i,n),l=4*i,_=(new Uint8Array(l),h.data),u=n-1,c=u*l,d=0;u>=0;u--)_.set(o.subarray(d,d+l),c),c-=l,d+=l;var f=new Is(!0);f.size(i,n);var p=f.getContext("2d");return p.putImageData(h,0,0),f},qi.getTexturePixels=function(t,e,i,n,s){var r=0,a=0,o=0,h=t.bitmap,l=h.width,_=h.height;if(e+n>l&&(n-=e+n-l),i+s>_&&(s-=i+s-_),0>=n||0>=s)return null;var u=4*n,c=null;try{c=h.getPixels()}catch(d){}if(c){if(0==e&&0==i&&n==l&&s==_)return c;var f=new Uint8Array(n*s*4);for(u=4*l,r=4*e,a=(i+s-1)*u+4*e,o=s-1;o>=0;o--)f.set(C.slice(a,a+4*n),r),r+=u,a-=u;return f}var p=new pn;p.size(n,s),p.asBitmap=!0;var m=null;if(0!=e||0!=i||n!=l||s!=_){m=t.uv.concat();var g=m[0],v=m[1],y=m[2]-g,E=m[7]-v,S=y/l,A=E/_;m=[g+e*S,v+i*A,g+(e+n)*S,v+i*A,g+(e+n)*S,v+(i+s)*A,g+e*S,v+(i+s)*A]}p._drawTextureM(t,0,0,n,s,null,1,m),p._targets.start(),p.flush(),p._targets.end(),p._targets.restore();var C=p._targets.getData(0,0,n,s);for(p.destroy(),f=new Uint8Array(n*s*4),r=0,a=(s-1)*u,o=s-1;o>=0;o--)f.set(C.slice(a,a+u),r),r+=u,a-=u;return f},Q._filter=function(t,e,i,n){var s=e,r=this._next;if(r){var a=t.filters,o=a.length;if(1==o&&32==a[0].type)return e.save(),e.setColorFilter(a[0]),r._fun.call(r,t,e,i,n),e.restore(),void 0;var h,l=mi.create(1,0),_=$i.TEMP,u=s._curMat,c=fi.create();u.copyTo(c);var d=0,f=0,p=!1,m=t._cacheStyle.filterCache||null;if(m&&0==t.getRepaint()){if(p=t._cacheStyle.hasGlowFilter||!1,p&&(d=50,f=25),h=t.getBounds(),h.width<=0||h.height<=0)return;h.width+=d,h.height+=d,_.x=h.x*c.a+h.y*c.c,_.y=h.y*c.d+h.x*c.b,h.x=_.x,h.y=_.y,_.x=h.width*c.a+h.height*c.c,_.y=h.height*c.d+h.width*c.b,h.width=_.x,h.height=_.y}else{p=t._isHaveGlowFilter(),p&&(d=50,f=25),h=new He,h.copyFrom(t.getSelfBounds()),h.x+=t.x,h.y+=t.y,h.x-=t.pivotX+4,h.y-=t.pivotY+4;var g=h.x,v=h.y;if(h.width+=d+8,h.height+=d+8,_.x=h.x*c.a+h.y*c.c,_.y=h.y*c.d+h.x*c.b,h.x=_.x,h.y=_.y,_.x=h.width*c.a+h.height*c.c,_.y=h.height*c.d+h.width*c.b,h.width=_.x,h.height=_.y,h.width<=0||h.height<=0)return;m&&oi.releaseRT(m);var y=oi.getRT(h.width,h.height),E=oi.getRT(h.width,h.height);t._getCacheStyle().filterCache=m,s.pushRT(),s.useRT(y);var S=t.x-g+f,A=t.y-v+f;r._fun.call(r,t,e,S,A),s.useRT(E);for(var C=0;o>C;C++){0!=C&&(s.useRT(y),s.drawTarget(E,0,0,h.width,h.height,fi.TEMP.identity(),l,null,fe.TOINT.overlay),s.useRT(E));var D=a[C];switch(D.type){case 16:D._glRender&&D._glRender.render(y,e,h.width,h.height,D);break;case 8:D._glRender&&D._glRender.render(y,e,h.width,h.height,D);break;case 32:s.setColorFilter(D),s.drawTarget(y,0,0,h.width,h.height,fi.EMPTY.identity(),mi.create(1,0)),s.setColorFilter(null)}}s.popRT()}i=i-f-t.x,n=n-f-t.y,_.setTo(i,n),c.transformPoint(_),i=_.x+h.x,n=_.y+h.y,s._drawRenderTexture(E,i,n,h.width,h.height,fi.TEMP.identity(),1,ir.defuv),c.destroy()}},Is.prototype.getTexture=function(){if(!this._texture){var t=new nr;t.loadImageSource(this.source),this._texture=new _n(t)}return this._texture},Float32Array.prototype.slice||(Float32Array.prototype.slice=e._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=e._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=e._uint8ArraySlice))},e.enable=function(){return Be.__init__(),Be._supportWebGL?(Ni.isConchApp?e._nativeRender_enable():e._webglRender_enable(),!0):!1},e.onStageResize=function(t,i){null!=e.mainContext&&(e.mainContext.viewport(0,0,t,i),pi.width=t,pi.height=i)},e.mainContext=null,e.shaderHighPrecision=!1,e._isWebGL2=!1,e.isNativeRender_enable=!1,e}(),Bi=function(){function t(){this.ALPHA=1,this.shaderType=0,this.defines=new Tn,this.fillStyle=ki.DEFAULT,this.strokeStyle=ki.DEFAULT}s(t,"laya.webgl.shader.d2.Shader2D");var e=t.prototype;return e.destroy=function(){this.defines=null,this.filters=null},t.__init__=function(){var t,e;t="/*\n	texture和fillrect使用的。\n*/\nattribute vec4 posuv;\nattribute vec4 attribColor;\nattribute vec4 attribFlags;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;		// 这个是全局的，不用再应用矩阵了。\nvarying vec2 cliped;\nuniform vec2 size;\n\n#ifdef WORLDMAT\n	uniform mat4 mmat;\n#endif\n\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\n\nvoid main() {\n\n	vec4 pos = vec4(posuv.xy,0.,1.);\n#ifdef WORLDMAT\n	pos=mmat*pos;\n#endif\n	gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\n  \n	v_texcoordAlpha.xy = posuv.zw;\n	//v_texcoordAlpha.z = attribColor.a/255.0;\n	v_color = attribColor/255.0;\n	v_color.xyz*=v_color.w;//反正后面也要预乘\n	\n	v_useTex = attribFlags.r/255.0;\n	float clipw = length(clipMatDir.xy);\n	float cliph = length(clipMatDir.zw);\n	vec2 clippos = pos.xy - clipMatPos.xy;	//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n	if(clipw>20000. && cliph>20000.)\n		cliped = vec2(0.5,0.5);\n	else {\n		//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\n		cliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n	}\n\n}",e="/*\n	texture和fillrect使用的。\n*/\n\nprecision mediump float;\n//precision highp float;\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\nuniform sampler2D texture;\nvarying vec2 cliped;\n\n#ifdef BLUR_FILTER\nuniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}\n#endif\n\n#ifdef COLOR_FILTER\nuniform vec4 colorAlpha;\nuniform mat4 colorMat;\n#endif\n\n#ifdef GLOW_FILTER\nuniform vec4 u_color;\nuniform vec4 u_blurInfo1;\nuniform vec4 u_blurInfo2;\n#endif\n\n#ifdef COLOR_ADD\nuniform vec4 colorAdd;\n#endif\n\n//FILLTEXTURE\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\n\nvoid main() {\n	if(cliped.x<0.) discard;\n	if(cliped.x>1.) discard;\n	if(cliped.y<0.) discard;\n	if(cliped.y>1.) discard;\n	\n#ifdef FILLTEXTURE	\n   vec4 color= texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\n#else\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\n#endif\n\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\n   color.a*=v_color.w;\n   //color.rgb*=v_color.w;\n   color.rgb*=v_color.rgb;\n   gl_FragColor=color;\n   \n   #ifdef COLOR_ADD\n	gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\n	gl_FragColor.xyz *= colorAdd.a;\n   #endif\n   \n   #ifdef BLUR_FILTER\n	gl_FragColor =   blur();\n	gl_FragColor.w*=v_color.w;   \n   #endif\n   \n   #ifdef COLOR_FILTER\n	mat4 alphaMat =colorMat;\n\n	alphaMat[0][3] *= gl_FragColor.a;\n	alphaMat[1][3] *= gl_FragColor.a;\n	alphaMat[2][3] *= gl_FragColor.a;\n\n	gl_FragColor = gl_FragColor * alphaMat;\n	gl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n   #endif\n   \n   #ifdef GLOW_FILTER\n	const float c_IterationTime = 10.0;\n	float floatIterationTotalTime = c_IterationTime * c_IterationTime;\n	vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n	vec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\n	vec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\n	float maxNum = u_blurInfo1.x * u_blurInfo1.y;\n	vec2 vec2Off = vec2(0.0,0.0);\n	float floatOff = c_IterationTime/2.0;\n	for(float i = 0.0;i<=c_IterationTime; ++i){\n		for(float j = 0.0;j<=c_IterationTime; ++j){\n			vec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n			vec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\n		}\n	}\n	gl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\n	gl_FragColor.rgb *= gl_FragColor.a;   \n   #endif\n   \n}",Ls.preCompile2D(0,1,t,e,null),t="attribute vec4 position;\nattribute vec4 attribColor;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\n#ifdef WORLDMAT\n	uniform mat4 mmat;\n#endif\nuniform mat4 u_mmat2;\n//uniform vec2 u_pos;\nuniform vec2 size;\nvarying vec4 color;\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\n//vec4 clip=vec4(100.,30.,300.,600.);\nvarying vec2 cliped;\nvoid main(){\n	\n#ifdef WORLDMAT\n	vec4 pos=mmat*vec4(position.xy,0.,1.);\n	gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n#else\n	gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n#endif	\n	float clipw = length(clipMatDir.xy);\n	float cliph = length(clipMatDir.zw);\n	vec2 clippos = position.xy - clipMatPos.xy;	//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n	if(clipw>20000. && cliph>20000.)\n		cliped = vec2(0.5,0.5);\n	else {\n		//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\n		cliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n	}\n  //pos2d.x = dot(clippos,dirx);\n  color=attribColor/255.;\n}",e="precision mediump float;\n//precision mediump float;\nvarying vec4 color;\n//uniform float alpha;\nvarying vec2 cliped;\nvoid main(){\n	//vec4 a=vec4(color.r, color.g, color.b, 1);\n	//a.a*=alpha;\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\n	gl_FragColor.rgb*=color.a;\n	if(cliped.x<0.) discard;\n	if(cliped.x>1.) discard;\n	if(cliped.y<0.) discard;\n	if(cliped.y>1.) discard;\n}",Ls.preCompile2D(0,4,t,e,null),t="/*\n	texture和fillrect使用的。\n*/\nattribute vec4 posuv;\nattribute vec4 attribColor;\nattribute vec4 attribFlags;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;		// 这个是全局的，不用再应用矩阵了。\nvarying vec2 cliped;\nuniform vec2 size;\n\n#ifdef WORLDMAT\n	uniform mat4 mmat;\n#endif\n\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\n\nvoid main() {\n\n	vec4 pos = vec4(posuv.xy,0.,1.);\n#ifdef WORLDMAT\n	pos=mmat*pos;\n#endif\n	gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\n  \n	v_texcoordAlpha.xy = posuv.zw;\n	//v_texcoordAlpha.z = attribColor.a/255.0;\n	v_color = attribColor/255.0;\n	v_color.xyz*=v_color.w;//反正后面也要预乘\n	\n	v_useTex = attribFlags.r/255.0;\n	float clipw = length(clipMatDir.xy);\n	float cliph = length(clipMatDir.zw);\n	vec2 clippos = pos.xy - clipMatPos.xy;	//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n	if(clipw>20000. && cliph>20000.)\n		cliped = vec2(0.5,0.5);\n	else {\n		//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\n		cliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n	}\n\n}",e='#ifdef FSHIGHPRECISION\n	precision highp float;\n#else\n	precision mediump float;\n#endif\n\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n\n#import?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n\n#import?COLOR_FILTER "parts/ColorFilter.glsl" with ColorFilter_ps_uniform;\n\n#import?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n\n#import?COLOR_ADD "parts/ColorAdd.glsl" with ColorAdd_ps_uniform;\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n   color.a*=alpha;\n   gl_FragColor=color;\n   \n   #import?COLOR_ADD "parts/ColorAdd.glsl" with ColorAdd_ps_logic;\n   \n   #import?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   \n   #import?COLOR_FILTER "parts/ColorFilter.glsl" with ColorFilter_ps_logic;\n   \n   #import?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',Ls.preCompile2D(0,256,t,e,null),t="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",e="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\nuniform float alpha;\nvoid main() {\n	vec4 t_color = texture2D(texture, v_texcoord);\n	gl_FragColor = t_color.rgba * v_color;\n	gl_FragColor *= alpha;\n}",Ls.preCompile2D(0,512,t,e,null)},t}(),Ni=(function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._fromX=0/0,this._fromY=0/0,this._toX=0/0,this._toY=0/0,this._lineColor=null,this._lineWidth=0/0,this._vid=0}s(t,"laya.layagl.cmdNative.DrawLineCmdNative");var e=t.prototype;return e.recover=function(){Ji.recover("DrawLineCmd",this)},r(0,e,"lineColor",function(){return this._lineColor},function(e){this._lineColor=e;var i=o.create(this.lineColor),n=i.numColor,s=this._paramData._int32Data,r=t._PARAM_VB_POS_;r++,r++,s[r++]=n,r++,r++,s[r++]=n,r++,r++,s[r++]=n,r++,r++,s[r++]=n,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"cmdID",function(){return"DrawLine"}),r(0,e,"toY",function(){return this._toY},function(e){this._toY=e;var i=[this._fromX,this._fromY,this._toX,this._toY],n=[],s=[];ii.createLine2(i,s,this._lineWidth,0,n,!1);var r=this._paramData._float32Data,a=(this._paramData._int32Data,this._paramData._int16Data),o=t._PARAM_VB_POS_;r[o++]=n[0],r[o++]=n[1],o++,r[o++]=n[2],r[o++]=n[3],o++,r[o++]=n[4],r[o++]=n[5],o++,r[o++]=n[6],r[o++]=n[7],o++;var h=2*t._PARAM_IB_POS_;a[h++]=s[0],a[h++]=s[1],a[h++]=s[2],a[h++]=s[3],a[h++]=s[4],a[h++]=s[5],we.syncBufferToRenderThread(this._paramData)}),r(0,e,"fromX",function(){return this._fromX},function(e){this._fromX=e;var i=[this._fromX,this._fromY,this._toX,this._toY],n=[],s=[];ii.createLine2(i,s,this._lineWidth,0,n,!1);var r=this._paramData._float32Data,a=(this._paramData._int32Data,this._paramData._int16Data),o=t._PARAM_VB_POS_;r[o++]=n[0],r[o++]=n[1],o++,r[o++]=n[2],r[o++]=n[3],o++,r[o++]=n[4],r[o++]=n[5],o++,r[o++]=n[6],r[o++]=n[7],o++;var h=2*t._PARAM_IB_POS_;a[h++]=s[0],a[h++]=s[1],a[h++]=s[2],a[h++]=s[3],a[h++]=s[4],a[h++]=s[5],we.syncBufferToRenderThread(this._paramData)}),r(0,e,"vid",function(){return this._vid},function(t){this._vid=t}),r(0,e,"toX",function(){return this._toX},function(e){this._toX=e;var i=[this._fromX,this._fromY,this._toX,this._toY],n=[],s=[];ii.createLine2(i,s,this._lineWidth,0,n,!1);var r=this._paramData._float32Data,a=(this._paramData._int32Data,this._paramData._int16Data),o=t._PARAM_VB_POS_;r[o++]=n[0],r[o++]=n[1],o++,r[o++]=n[2],r[o++]=n[3],o++,r[o++]=n[4],r[o++]=n[5],o++,r[o++]=n[6],r[o++]=n[7],o++;var h=2*t._PARAM_IB_POS_;a[h++]=s[0],a[h++]=s[1],a[h++]=s[2],a[h++]=s[3],a[h++]=s[4],a[h++]=s[5],we.syncBufferToRenderThread(this._paramData)}),r(0,e,"fromY",function(){return this._fromY},function(e){this._fromY=e;var i=[this._fromX,this._fromY,this._toX,this._toY],n=[],s=[];ii.createLine2(i,s,this._lineWidth,0,n,!1);var r=this._paramData._float32Data,a=(this._paramData._int32Data,this._paramData._int16Data),o=t._PARAM_VB_POS_;r[o++]=n[0],r[o++]=n[1],o++,r[o++]=n[2],r[o++]=n[3],o++,r[o++]=n[4],r[o++]=n[5],o++,r[o++]=n[6],r[o++]=n[7],o++;var h=2*t._PARAM_IB_POS_;a[h++]=s[0],a[h++]=s[1],a[h++]=s[2],a[h++]=s[3],a[h++]=s[4],a[h++]=s[5],we.syncBufferToRenderThread(this._paramData)}),r(0,e,"lineWidth",function(){return this._lineWidth},function(e){this._lineWidth=e;var i=[this._fromX,this._fromY,this._toX,this._toY],n=[],s=[];ii.createLine2(i,s,this.lineWidth,0,n,!1);var r=this._paramData._float32Data,a=(this._paramData._int32Data,this._paramData._int16Data),o=t._PARAM_VB_POS_;r[o++]=n[0],r[o++]=n[1],o++,r[o++]=n[2],r[o++]=n[3],o++,r[o++]=n[4],r[o++]=n[5],o++,r[o++]=n[6],r[o++]=n[7],o++;var h=2*t._PARAM_IB_POS_;a[h++]=s[0],a[h++]=s[1],a[h++]=s[2],a[h++]=s[3],a[h++]=s[4],a[h++]=s[5],we.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,n,s,r,a,h){var l=Ji.getItemByClass("DrawLineCmd",t);l._graphicsCmdEncoder=this._commandEncoder,t._DRAW_LINE_CMD_ENCODER_||(t._DRAW_LINE_CMD_ENCODER_=we.instance.createCommandEncoder(152,32,!0),t._DRAW_LINE_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_LINE_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_LINE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_LINE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_LINE_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_LINE_CMD_ENCODER_.setMeshByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,8,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_LINE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_LINE_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_LINE_CMD_ENCODER_)),l._paramData||(l._paramData=new ParamData(96,!0)),l._fromX=e,l._fromY=i,l._toX=n,l._toY=s,l._lineColor=r,l._lineWidth=a,l._vid=h;var _=o.create(r),u=_.numColor,c=[e,i,n,s],d=[],f=[];ii.createLine2(c,f,a,0,d,!1);var p=l._paramData._float32Data,m=l._paramData._int32Data,g=l._paramData._int16Data;m[0]=1,m[1]=48,m[2]=12,m[t._PARAM_VB_OFFSET_POS_]=0,m[t._PARAM_IB_OFFSET_POS_]=0,m[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0;var v=t._PARAM_VB_POS_;p[v++]=d[0],p[v++]=d[1],m[v++]=u,p[v++]=d[2],p[v++]=d[3],m[v++]=u,p[v++]=d[4],p[v++]=d[5],m[v++]=u,p[v++]=d[6],p[v++]=d[7],m[v++]=u;var y=2*t._PARAM_IB_POS_;return g[y++]=f[0],g[y++]=f[1],g[y++]=f[2],g[y++]=f[3],g[y++]=f[4],g[y++]=f[5],p[t._PARAM_LINECOLOR_POS_]=r?r:4278190335,p[t._PARAM_LINEWIDTH_POS_]=a,p[t._PARAM_VID_POS_]=h,we.syncBufferToRenderThread(l._paramData),l._graphicsCmdEncoder.useCommandEncoder(t._DRAW_LINE_CMD_ENCODER_.getPtrID(),l._paramData.getPtrID(),-1),we.syncBufferToRenderThread(l._graphicsCmdEncoder),l},t.ID="DrawLine",t._DRAW_LINE_CMD_ENCODER_=null,t._PARAM_VB_POS_=3,t._PARAM_IB_POS_=15,t._PARAM_LINECOLOR_POS_=18,t._PARAM_LINEWIDTH_POS_=19,t._PARAM_VID_POS_=20,t._PARAM_VB_OFFSET_POS_=21,t._PARAM_IB_OFFSET_POS_=22,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=23,t}(),function(){function e(t,n){function s(){i.stage._loop(),Be.window.requestAnimationFrame(s)}this._timeId=0,e._mainCanvas.source.id="layaCanvas",e._mainCanvas.source.width=t,e._mainCanvas.source.height=n,laya.renders.Render.isConchApp?Be.document.body.appendChild(e._mainCanvas.source):Be.container.appendChild(e._mainCanvas.source),qi.initRender(e._mainCanvas,t,n),Be.window.requestAnimationFrame(s),i.stage.on("visibilitychange",this,this._onVisibilitychange)}s(e,"laya.renders.Render");var a=e.prototype;return a._onVisibilitychange=function(){i.stage.isVisibility?0!=this._timeId&&Be.window.clearInterval(this._timeId):this._timeId=Be.window.setInterval(this._enterFrame,1e3)},a._enterFrame=function(){i.stage._loop()},r(1,e,"context",function(){return e._context}),r(1,e,"canvas",function(){return e._mainCanvas.source}),e._context=null,e._mainCanvas=null,e.isWebGL=!1,e.is3DMode=!1,n(e,["isConchApp",function(){return this.isConchApp=null!=t.conch}]),e}()),ki=function(){function t(t){this._color=null,this.setValue(t)}s(t,"laya.webgl.canvas.DrawStyle");var e=t.prototype;return e.setValue=function(t){this._color=t?t instanceof laya.utils.ColorUtils?t:o.create(t):o.create("#000000")},e.reset=function(){this._color=o.create("#000000")},e.toInt=function(){return this._color.numColor},e.equal=function(t){return"string"==typeof t?this._color.strColor===t:t instanceof laya.utils.ColorUtils?this._color.numColor===t.numColor:!1},e.toColorStr=function(){return this._color.strColor},t.create=function(e){if(e){var i=e instanceof laya.utils.ColorUtils?e:o.create(e);return i._drawStyle||(i._drawStyle=new t(e))}return t.DEFAULT},n(t,["DEFAULT",function(){return this.DEFAULT=new t("#000000")}]),t}(),Fi=function(){function t(t,e,i,n,s,r,a){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=0),void 0===r&&(r=0),this._nums=a=a?a:new Float32Array(6),a[0]=t,a[1]=e,a[2]=i,a[3]=n,a[4]=s,a[5]=r,this._checkTransform()}s(t,"laya.layagl.MatrixConch");var e=t.prototype;return e.identity=function(){var t=this._nums;return t[0]=t[3]=1,t[1]=t[4]=t[5]=t[2]=0,this._bTransform=!1,this},e._checkTransform=function(){var t=this._nums;return this._bTransform=1!==t[0]||0!==t[1]||0!==t[2]||1!==t[3]},e.setTranslate=function(t,e){return this._nums[4]=t,this._nums[5]=e,this},e.translate=function(t,e){return this._nums[4]+=t,this._nums[5]+=e,this},e.scale=function(t,e){var i=this._nums;return i[0]*=t,i[3]*=e,i[2]*=t,i[1]*=e,i[4]*=t,i[5]*=e,this._bTransform=!0,this},e.rotate=function(t){var e=this._nums,i=Math.cos(t),n=Math.sin(t),s=e[0],r=e[2],a=e[4];return e[0]=s*i-e[1]*n,e[1]=s*n+e[1]*i,e[2]=r*i-e[3]*n,e[3]=r*n+e[3]*i,e[4]=a*i-e[5]*n,e[5]=a*n+e[5]*i,this._bTransform=!0,this},e.skew=function(t,e){var i=this._nums,n=Math.tan(t),s=Math.tan(e),r=i[0],a=i[1];return i[0]+=s*i[2],i[1]+=s*i[3],i[2]+=n*r,i[3]+=n*a,this},e.invertTransformPoint=function(t){var e=this._nums,i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=i*r-n*s,h=r/o,l=-n/o,_=-s/o,u=i/o,c=(s*e[5]-r*a)/o,d=-(i*e[5]-n*a)/o;return t.setTo(h*t.x+_*t.y+c,l*t.x+u*t.y+d)},e.transformPoint=function(t){var e=this._nums;return t.setTo(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},e.transformPointN=function(t){var e=this._nums;return t.setTo(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y)},e.getScaleX=function(){var t=this._nums;return 0===t[1]?this.a:Math.sqrt(t[0]*t[0]+t[1]*t[1])},e.getScaleY=function(){var t=this._nums;return 0===t[2]?t[3]:Math.sqrt(t[2]*t[2]+t[3]*t[3])},e.invert=function(){var t=this._nums,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=e*s-i*n;return t[0]=s/a,t[1]=-i/a,t[2]=-n/a,t[3]=e/a,t[4]=(n*this.ty-s*r)/a,t[5]=-(e*this.ty-i*r)/a,this},e.setTo=function(t,e,i,n,s,r){var a=this._nums;return a[0]=t,a[1]=e,a[2]=i,a[3]=n,a[4]=s,a[5]=r,this},e.concat=function(t){var e=this._nums,i=t._nums,n=e[0],s=e[2],r=e[4];return e[0]=n*i[0]+e[1]*i[2],e[1]=n*i[1]+e[1]*i[3],e[2]=s*i[0]+e[3]*i[2],e[3]=s*i[1]+e[3]*i[3],e[4]=r*i[0]+e[5]*i[2]+i[4],e[5]=r*i[1]+e[5]*i[3]+i[5],this},e.scaleEx=function(t,e){var i=this._nums,n=i[0],s=i[1],r=i[2],a=i[3];0!==s||0!==r?(i[0]=t*n,i[1]=t*s,i[2]=e*r,i[3]=e*a):(i[0]=t*n,i[1]=0*a,i[2]=0*n,i[3]=e*a),this._bTransform=!0},e.rotateEx=function(t){var e=this._nums,i=Math.cos(t),n=Math.sin(t),s=e[0],r=e[1],a=e[2],o=e[3];0!==r||0!==a?(e[0]=i*s+n*a,e[1]=i*r+n*o,e[2]=-n*s+i*a,e[3]=-n*r+i*o):(e[0]=i*s,e[1]=n*o,e[2]=-n*s,e[3]=i*o),this._bTransform=!0},e.clone=function(){var e=this._nums,i=t.create(),n=i._nums;return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],i._bTransform=this._bTransform,i},e.copyTo=function(t){var e=this._nums,i=t._nums;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],t._bTransform=this._bTransform,t},e.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},e.destroy=function(){this.recover()},e.recover=function(){t._pool.push(this)},r(0,e,"a",function(){return this._nums[0]},function(t){this._nums[0]=t}),r(0,e,"b",function(){return this._nums[1]},function(t){this._nums[1]=t}),r(0,e,"c",function(){return this._nums[2]},function(t){this._nums[2]=t}),r(0,e,"d",function(){return this._nums[3]},function(t){this._nums[3]=t}),r(0,e,"tx",function(){return this._nums[4]},function(t){this._nums[4]=t}),r(0,e,"ty",function(){return this._nums[5]},function(t){this._nums[5]=t}),t.mul=function(t,e,i){var n=t._nums,s=e._nums,r=i._nums,a=n[0],o=n[1],h=n[2],l=n[3],_=n[4],u=n[5],c=s[0],d=s[1],f=s[2],p=s[3],m=s[4],g=s[5];return 0!==d||0!==f?(r[0]=a*c+o*f,r[1]=a*d+o*p,r[2]=h*c+l*f,r[3]=h*d+l*p,r[4]=c*_+f*u+m,r[5]=d*_+p*u+g):(r[0]=a*c,r[1]=o*p,r[2]=h*c,r[3]=l*p,r[4]=c*_+m,r[5]=p*u+g),i},t.mul16=function(t,e,i){var n=t._nums,s=e._nums,r=n[0],a=n[1],o=n[2],h=n[3],l=n[4],_=n[5],u=s[0],c=s[1],d=s[2],f=s[3],p=s[4],m=s[5];return 0!==c||0!==d?(i[0]=r*u+a*d,i[1]=r*c+a*f,i[4]=o*u+h*d,i[5]=o*c+h*f,i[12]=u*l+d*_+p,i[13]=c*l+f*_+m):(i[0]=r*u,i[1]=a*f,i[4]=o*u,i[5]=h*f,i[12]=u*l+p,i[13]=f*_+m),i},t.create=function(e){var i;return t._pool.length?(i=t._pool.pop(),e&&(i._nums=e),i.identity(),i):new t(1,0,0,1,0,0,e)},t.A=0,t.B=1,t.C=2,t.D=3,t.TX=4,t.TY=5,t.EMPTY=new t,t.TEMP=new t,t._pool=[],t}(),Vi=function(){function t(){}s(t,"laya.display.cmd.RotateCmd");var e=t.prototype;return e.recover=function(){Ji.recover("RotateCmd",this)},e.run=function(t,e,i){t._rotate(this.angle,this.pivotX+e,this.pivotY+i)},r(0,e,"cmdID",function(){return"Rotate"
}),t.create=function(e,i,n){var s=Ji.getItemByClass("RotateCmd",t);return s.angle=e,s.pivotX=i,s.pivotY=n,s},t.ID="Rotate",t}(),Ui=function(){function t(){}return s(t,"UIConfig"),t.touchScrollEnable=!0,t.mouseWheelEnable=!0,t.showButtons=!0,t.popupBgColor="#000000",t.popupBgAlpha=.5,t.closeDialogOnSide=!0,t}(),Wi=function(){function t(){this._controlPoints=[new $i,new $i,new $i],this._calFun=this.getPoint2}s(t,"laya.maths.Bezier");var e=t.prototype;return e._switchPoint=function(t,e){var i=this._controlPoints.shift();i.setTo(t,e),this._controlPoints.push(i)},e.getPoint2=function(t,e){var i=this._controlPoints[0],n=this._controlPoints[1],s=this._controlPoints[2],r=Math.pow(1-t,2)*i.x+2*t*(1-t)*n.x+Math.pow(t,2)*s.x,a=Math.pow(1-t,2)*i.y+2*t*(1-t)*n.y+Math.pow(t,2)*s.y;e.push(r,a)},e.getPoint3=function(t,e){var i=this._controlPoints[0],n=this._controlPoints[1],s=this._controlPoints[2],r=this._controlPoints[3],a=Math.pow(1-t,3)*i.x+3*n.x*t*(1-t)*(1-t)+3*s.x*t*t*(1-t)+r.x*Math.pow(t,3),o=Math.pow(1-t,3)*i.y+3*n.y*t*(1-t)*(1-t)+3*s.y*t*t*(1-t)+r.y*Math.pow(t,3);e.push(a,o)},e.insertPoints=function(t,e){var i=0/0;t=t>0?t:5;var n=0/0;for(n=1/t,i=0;1>=i;i+=n)this._calFun(i,e)},e.getBezierPoints=function(t,e,i){void 0===e&&(e=5),void 0===i&&(i=2);var n=0,s=0;if(s=t.length,2*(i+1)>s)return[];var r=[];switch(i){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=i;)this._controlPoints.push($i.create());for(n=0;2*i>n;n+=2)this._switchPoint(t[n],t[n+1]);for(n=2*i;s>n;n+=2)this._switchPoint(t[n],t[n+1]),n/2%i==0&&this.insertPoints(e,r);return r},n(t,["I",function(){return this.I=new t}]),t}(),Gi=function(){function t(){}return s(t,"laya.media.SoundManager"),r(1,t,"useAudioMusic",function(){return t._useAudioMusic},function(e){t._useAudioMusic=e,t._musicClass=e?mn:null}),r(1,t,"autoStopMusic",function(){return t._autoStopMusic},function(e){i.stage.off("blur",null,t._stageOnBlur),i.stage.off("focus",null,t._stageOnFocus),i.stage.off("visibilitychange",null,t._visibilityChange),t._autoStopMusic=e,e&&(i.stage.on("blur",null,t._stageOnBlur),i.stage.on("focus",null,t._stageOnFocus),i.stage.on("visibilitychange",null,t._visibilityChange))}),r(1,t,"muted",function(){return t._muted},function(e){e!=t._muted&&(e&&t.stopAllSound(),t.musicMuted=e,t._muted=e)}),r(1,t,"musicMuted",function(){return t._musicMuted},function(e){e!=t._musicMuted&&(e?(t._bgMusic?t._musicChannel&&!t._musicChannel.isStopped?Ni.isConchApp?t._musicChannel._audio&&(t._musicChannel._audio.muted=!0):t._musicChannel.pause():t._musicChannel=null:t._musicChannel=null,t._musicMuted=e):(t._musicMuted=e,t._bgMusic&&t._musicChannel&&(Ni.isConchApp?t._musicChannel._audio&&(t._musicChannel._audio.muted=!1):t._musicChannel.resume())))}),r(1,t,"soundMuted",function(){return t._soundMuted},function(e){t._soundMuted=e}),t.__init__=function(){var e=Be.window,i=e.AudioContext||e.webkitAudioContext||e.mozAudioContext?!0:!1;return i&&dn.initWebAudio(),t._soundClass=i?dn:mn,mn._initMusicAudio(),t._musicClass=mn,i},t.addChannel=function(e){t._channels.indexOf(e)>=0||t._channels.push(e)},t.removeChannel=function(e){var i=0;for(i=t._channels.length-1;i>=0;i--)t._channels[i]==e&&t._channels.splice(i,1)},t.disposeSoundLater=function(e){t._lastSoundUsedTimeDic[e]=Be.now(),t._isCheckingDispose||(t._isCheckingDispose=!0,i.timer.loop(5e3,null,t._checkDisposeSound))},t._checkDisposeSound=function(){var e,n=Be.now(),s=!1;for(e in t._lastSoundUsedTimeDic)n-t._lastSoundUsedTimeDic[e]>3e4?(delete t._lastSoundUsedTimeDic[e],t.disposeSoundIfNotUsed(e)):s=!0;s||(t._isCheckingDispose=!1,i.timer.clear(null,t._checkDisposeSound))},t.disposeSoundIfNotUsed=function(e){var i=0;for(i=t._channels.length-1;i>=0;i--)if(t._channels[i].url==e)return;t.destroySound(e)},t._visibilityChange=function(){i.stage.isVisibility?t._stageOnFocus():t._stageOnBlur()},t._stageOnBlur=function(){t._isActive=!1,t._musicChannel&&(t._musicChannel.isStopped||(t._blurPaused=!0,t._musicChannel.pause())),t.stopAllSound(),i.stage.once("mousedown",null,t._stageOnFocus)},t._recoverWebAudio=function(){dn.ctx&&"running"!=dn.ctx.state&&dn.ctx.resume&&dn.ctx.resume()},t._stageOnFocus=function(){t._isActive=!0,t._recoverWebAudio(),i.stage.off("mousedown",null,t._stageOnFocus),t._blurPaused&&t._musicChannel&&t._musicChannel.isStopped&&(t._blurPaused=!1,t._musicChannel.resume())},t.playSound=function(e,n,s,r,a){if(void 0===n&&(n=1),void 0===a&&(a=0),!t._isActive||!e)return null;if(t._muted)return null;if(t._recoverWebAudio(),e=Mi.formatURL(e),e==t._bgMusic){if(t._musicMuted)return null}else{if(Ni.isConchApp){var o=ee.getFileExtension(e);if("wav"!=o&&"ogg"!=o)return alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document."),null}if(t._soundMuted)return null}var h;Be.onMiniGame||(h=i.loader.getRes(e)),r||(r=t._soundClass),h||(h=new r,h.load(e),Be.onMiniGame||un.cacheRes(e,h));var l;return(l=h.play(a,n))?(l.url=e,l.volume=e==t._bgMusic?t.musicVolume:t.soundVolume,l.completeHandler=s,l):null},t.destroySound=function(t){var e=i.loader.getRes(t);e&&(un.clearRes(t),e.dispose())},t.playMusic=function(e,i,n,s){return void 0===i&&(i=0),void 0===s&&(s=0),e=Mi.formatURL(e),t._bgMusic=e,t._musicChannel&&t._musicChannel.stop(),t._musicChannel=t.playSound(e,i,n,t._musicClass,s)},t.stopSound=function(e){e=Mi.formatURL(e);var i,n=0;for(n=t._channels.length-1;n>=0;n--)i=t._channels[n],i.url==e&&i.stop()},t.stopAll=function(){t._bgMusic=null;var e,i=0;for(i=t._channels.length-1;i>=0;i--)e=t._channels[i],e.stop()},t.stopAllSound=function(){var e,i=0;for(i=t._channels.length-1;i>=0;i--)e=t._channels[i],e.url!=t._bgMusic&&e.stop()},t.stopMusic=function(){t._musicChannel&&t._musicChannel.stop(),t._bgMusic=null},t.setSoundVolume=function(e,i){if(i)i=Mi.formatURL(i),t._setVolume(i,e);else{t.soundVolume=e;var n,s=0;for(s=t._channels.length-1;s>=0;s--)n=t._channels[s],n.url!=t._bgMusic&&(n.volume=e)}},t.setMusicVolume=function(e){t.musicVolume=e,t._setVolume(t._bgMusic,e)},t._setVolume=function(e,i){e=Mi.formatURL(e);var n,s=0;for(s=t._channels.length-1;s>=0;s--)n=t._channels[s],n.url==e&&(n.volume=i)},t.musicVolume=1,t.soundVolume=1,t.playbackRate=1,t._useAudioMusic=!0,t._muted=!1,t._soundMuted=!1,t._musicMuted=!1,t._bgMusic=null,t._musicChannel=null,t._channels=[],t._autoStopMusic=!1,t._blurPaused=!1,t._isActive=!0,t._soundClass=null,t._musicClass=null,t._lastSoundUsedTimeDic={},t._isCheckingDispose=!1,t.autoReleaseSound=!0,t}(),zi=function(){function t(){this._cacheBoundsType=!1}s(t,"laya.display.GraphicsBounds");var e=t.prototype;return e.destroy=function(){this._graphics=null,this._cacheBoundsType=!1,this._temp&&(this._temp.length=0),this._rstBoundPoints&&(this._rstBoundPoints.length=0),this._bounds&&this._bounds.recover(),this._bounds=null,Ji.recover("GraphicsBounds",this)},e.reset=function(){this._temp&&(this._temp.length=0)},e.getBounds=function(t){return void 0===t&&(t=!1),(!this._bounds||!this._temp||this._temp.length<1||t!=this._cacheBoundsType)&&(this._bounds=He._getWrapRec(this.getBoundPoints(t),this._bounds)),this._cacheBoundsType=t,this._bounds},e.getBoundPoints=function(t){return void 0===t&&(t=!1),(!this._temp||this._temp.length<1||t!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(t)),this._cacheBoundsType=t,this._rstBoundPoints=ee.copyArray(this._rstBoundPoints,this._temp)},e._getCmdPoints=function(e){void 0===e&&(e=!1);var i,n=(Ni._context,this._graphics.cmds);if(i=this._temp||(this._temp=[]),i.length=0,n||null==this._graphics._one||(t._tempCmds.length=0,t._tempCmds.push(this._graphics._one),n=t._tempCmds),!n)return i;var s=t._tempMatrixArrays;s.length=0;var r=t._initMatrix;r.identity();for(var a,o,h=t._tempMatrix,l=0,_=n.length;_>l;l++)switch(a=n[l],a.cmdID){case"Alpha":s.push(r),r=r.clone();break;case"Restore":r=s.pop();break;case"Scale":h.identity(),h.translate(-a.pivotX,-a.pivotY),h.scale(a.scaleX,a.scaleY),h.translate(a.pivotX,a.pivotY),this._switchMatrix(r,h);break;case"Rotate":h.identity(),h.translate(-a.pivotX,-a.pivotY),h.rotate(a.angle),h.translate(a.pivotX,a.pivotY),this._switchMatrix(r,h);break;case"Translate":h.identity(),h.translate(a.tx,a.ty),this._switchMatrix(r,h);break;case"Transform":h.identity(),h.translate(-a.pivotX,-a.pivotY),h.concat(a.matrix),h.translate(a.pivotX,a.pivotY),this._switchMatrix(r,h);break;case"DrawImage":case"FillTexture":t._addPointArrToRst(i,He._getBoundPointS(a.x,a.y,a.width,a.height),r);break;case"DrawTexture":r.copyTo(h),a.matrix&&h.concat(a.matrix),t._addPointArrToRst(i,He._getBoundPointS(a.x,a.y,a.width,a.height),h);break;case"DrawImage":if(o=a.texture,e)a.width&&a.height?t._addPointArrToRst(i,He._getBoundPointS(a.x,a.y,a.width,a.height),r):t._addPointArrToRst(i,He._getBoundPointS(a.x,a.y,o.width,o.height),r);else{var u=(a.width||o.sourceWidth)/o.width,c=(a.height||o.sourceHeight)/o.height,d=u*o.sourceWidth,f=c*o.sourceHeight,p=o.offsetX>0?o.offsetX:0,m=o.offsetY>0?o.offsetY:0;p*=u,m*=c,t._addPointArrToRst(i,He._getBoundPointS(a.x-p,a.y-m,d,f),r)}break;case"FillTexture":a.width&&a.height?t._addPointArrToRst(i,He._getBoundPointS(a.x,a.y,a.width,a.height),r):(o=a.texture,t._addPointArrToRst(i,He._getBoundPointS(a.x,a.y,o.width,o.height),r));break;case"DrawTexture":var g;a.matrix?(r.copyTo(h),h.concat(a.matrix),g=h):g=r,e?a.width&&a.height?t._addPointArrToRst(i,He._getBoundPointS(a.x,a.y,a.width,a.height),g):(o=a.texture,t._addPointArrToRst(i,He._getBoundPointS(a.x,a.y,o.width,o.height),g)):(o=a.texture,u=(a.width||o.sourceWidth)/o.width,c=(a.height||o.sourceHeight)/o.height,d=u*o.sourceWidth,f=c*o.sourceHeight,p=o.offsetX>0?o.offsetX:0,m=o.offsetY>0?o.offsetY:0,p*=u,m*=c,t._addPointArrToRst(i,He._getBoundPointS(a.x-p,a.y-m,d,f),g));break;case"DrawRect":t._addPointArrToRst(i,He._getBoundPointS(a.x,a.y,a.width,a.height),r);break;case"DrawCircle":t._addPointArrToRst(i,He._getBoundPointS(a.x-a.radius,a.y-a.radius,a.radius+a.radius,a.radius+a.radius),r);break;case"DrawLine":t._tempPoints.length=0;var v=0/0;v=.5*a.lineWidth,a.fromX==a.toX?t._tempPoints.push(a.fromX+v,a.fromY,a.toX+v,a.toY,a.fromX-v,a.fromY,a.toX-v,a.toY):a.fromY==a.toY?t._tempPoints.push(a.fromX,a.fromY+v,a.toX,a.toY+v,a.fromX,a.fromY-v,a.toX,a.toY-v):t._tempPoints.push(a.fromX,a.fromY,a.toX,a.toY),t._addPointArrToRst(i,t._tempPoints,r);break;case"DrawCurves":t._addPointArrToRst(i,Wi.I.getBezierPoints(a.points),r,a.x,a.y);break;case"DrawLines":case"DrawPoly":t._addPointArrToRst(i,a.points,r,a.x,a.y);break;case"DrawPath":t._addPointArrToRst(i,this._getPathPoints(a.paths),r,a.x,a.y);break;case"DrawPie":t._addPointArrToRst(i,this._getPiePoints(a.x,a.y,a.radius,a.startAngle,a.endAngle),r)}return i.length>200?i=ee.copyArray(i,He._getWrapRec(i)._getBoundPoints()):i.length>8&&(i=q.scanPList(i)),i},e._switchMatrix=function(t,e){e.concat(t),e.copyTo(t)},e._getPiePoints=function(e,i,n,s,r){var a=t._tempPoints;t._tempPoints.length=0,a.push(e,i);var o=Math.PI/10,h=0/0;for(h=s;r>h;h+=o)a.push(e+n*Math.cos(h),i+n*Math.sin(h));return r!=h&&a.push(e+n*Math.cos(r),i+n*Math.sin(r)),a},e._getPathPoints=function(e){var i=0,n=0,s=t._tempPoints;s.length=0,n=e.length;var r;for(i=0;n>i;i++)r=e[i],r.length>1&&(s.push(r[1],r[2]),r.length>3&&s.push(r[3],r[4]));return s},t.create=function(){return Ji.getItemByClass("GraphicsBounds",t)},t._addPointArrToRst=function(e,i,n,s,r){void 0===s&&(s=0),void 0===r&&(r=0);var a=0,o=0;for(o=i.length,a=0;o>a;a+=2)t._addPointToRst(e,i[a]+s,i[a+1]+r,n)},t._addPointToRst=function(t,e,i,n){var s=$i.TEMP;s.setTo(e?e:0,i?i:0),n.transformPoint(s),t.push(s.x,s.y)},t._tempPoints=[],t._tempMatrixArrays=[],t._tempCmds=[],n(t,["_tempMatrix",function(){return this._tempMatrix=new fi},"_initMatrix",function(){return this._initMatrix=new fi}]),t}(),Xi=function(){function t(e){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._id=++t._uniqueIDCounter,this._name=e?e:"Content Manager",t._isResourceManagersSorted=!1,this._memorySize=0,t._resourceManagers.push(this),this._resources=[]}s(t,"laya.resource.ResourceManager");var e=t.prototype;return i.imps(e,{"laya.resource.IDispose":!0}),e.getResourceByIndex=function(t){return this._resources[t]},e.getResourcesLength=function(){return this._resources.length},e.addResource=function(t){t.resourceManager&&t.resourceManager.removeResource(t);var e=this._resources.indexOf(t);return-1===e?(t._resourceManager=this,this._resources.push(t),this.addSize(t.gpuMemory),!0):!1},e.removeResource=function(t){var e=this._resources.indexOf(t);return-1!==e?(this._resources.splice(e,1),t._resourceManager=null,this._memorySize-=t.gpuMemory,!0):!1},e.unload=function(){for(var t=this._resources.slice(0,this._resources.length),e=0;e<t.length;e++){var i=t[e];i.destroy()}t.length=0},e.dispose=function(){if(this===t._systemResourceManager)throw new Error("systemResourceManager不能被释放！");t._resourceManagers.splice(t._resourceManagers.indexOf(this),1),t._isResourceManagersSorted=!1;for(var e=this._resources.slice(0,this._resources.length),i=0;i<e.length;i++){var n=e[i];n.resourceManager.removeResource(n),n.destroy()}e.length=0},e.addSize=function(t){t&&(this._memorySize+=t)},r(0,e,"id",function(){return this._id}),r(0,e,"name",function(){return this._name},function(e){!e&&""===e||this._name===e||(this._name=e,t._isResourceManagersSorted=!1)}),r(0,e,"memorySize",function(){return this._memorySize}),r(1,t,"systemResourceManager",function(){return t._systemResourceManager}),t.__init__=function(){t.currentResourceManager=t.systemResourceManager},t.getLoadedResourceManagerByIndex=function(e){return t._resourceManagers[e]},t.getLoadedResourceManagersCount=function(){return t._resourceManagers.length},t.recreateContentManagers=function(t){void 0===t&&(t=!1)},t.releaseContentManagers=function(e){void 0===e&&(e=!1);for(var i=t.currentResourceManager,n=0;n<t._resourceManagers.length;n++){t.currentResourceManager=t._resourceManagers[n];for(var s=0;s<t.currentResourceManager._resources.length;s++){var r=t.currentResourceManager._resources[s];!r.released&&r.releaseResource(e)}}t.currentResourceManager=i},t._uniqueIDCounter=0,t._isResourceManagersSorted=!1,t._resourceManagers=[],n(t,["_systemResourceManager",function(){return this._systemResourceManager=new t("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=t._systemResourceManager}]),t}(),Hi=function(){function t(){this.padding=t._PADDING,this.reset()}s(t,"laya.html.utils.HTMLStyle");var e=t.prototype;return e._getExtendStyle=function(){return this._extendStyle===H.EMPTY&&(this._extendStyle=H.create()),this._extendStyle},e.reset=function(){return this.ower=null,this._type=0,this.wordWrap=!0,this.fontSize=Cs.defaultFontSize,this.family=Cs.defaultFont,this.color="#000000",this.valign="top",this.padding=t._PADDING,this.bold=!1,this.italic=!1,this.align="left",this.textDecoration=null,this.bgColor=null,this.borderColor=null,this._extendStyle&&this._extendStyle.recover(),this._extendStyle=H.EMPTY,this},e.recover=function(){Ji.recover("HTMLStyle",this.reset())},e.inherit=function(e){var i,n=0,s=0;i=t._inheritProps,s=i.length;var r;for(n=0;s>n;n++)r=i[n],this[r]=e[r]},e._widthAuto=function(){return 0!==(262144&this._type)},e.widthed=function(){return 0!=(8&this._type)},e._calculation=function(){return!1},e.heighted=function(){return 0!=(8192&this._type)},e.size=function(t,e){var i=this.ower,n=!1;-1!==t&&t!=i.width&&(this._type|=8,i.width=t,n=!0),-1!==e&&e!=i.height&&(this._type|=8192,i.height=e,n=!0),n&&i._layoutLater()},e.getLineElement=function(){return 0!=(65536&this._type)},e.setLineElement=function(t){t?this._type|=65536:this._type&=-65537},e._enableLayout=function(){return 0===(2&this._type)&&0===(4&this._type)},e.cssText=function(e){this.attrs(t.parseOneCSS(e,";"))},e.attrs=function(t){if(t)for(var e=0,i=t.length;i>e;e++){var n=t[e];this[n[0]]=n[1]}},r(0,e,"font",function(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(Be.onIPhone?Cs.fontFamilyMap[this.family]||this.family:this.family)},function(t){for(var e=t.split(" "),i=0,n=e.length;n>i;i++){var s=e[i];switch(s){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}s.indexOf("px")>0&&(this.fontSize=parseInt(s),this.family=e[i+1],i++)}}),r(0,e,"href",function(){return this._extendStyle.href},function(t){t!==this._extendStyle.href&&(this._getExtendStyle().href=t)}),r(0,e,"lineHeight",function(){return this._extendStyle.lineHeight},function(t){this._extendStyle.lineHeight!==t&&(this._getExtendStyle().lineHeight=t)}),r(0,e,"strokeColor",function(){return this._extendStyle.strokeColor},function(t){this._extendStyle.strokeColor!==t&&(this._getExtendStyle().strokeColor=t)}),r(0,e,"stroke",function(){return this._extendStyle.stroke},function(t){this._extendStyle.stroke!==t&&(this._getExtendStyle().stroke=t)}),r(0,e,"leading",function(){return this._extendStyle.leading},function(t){this._extendStyle.leading!==t&&(this._getExtendStyle().leading=t)}),r(0,e,"align",function(){var e=48&this._type;return t.align_Value[e]},function(e){e in t.alignVDic&&(this._type&=-49,this._type|=t.alignVDic[e])}),r(0,e,"valign",function(){var e=192&this._type;return t.vAlign_Value[e]},function(e){e in t.alignVDic&&(this._type&=-193,this._type|=t.alignVDic[e])}),r(0,e,"block",function(){return 0!=(1&this._type)},function(t){t?this._type|=1:this._type&=-2}),r(0,e,"wordWrap",function(){return 0===(131072&this._type)},function(t){t?this._type&=-131073:this._type|=131072}),r(0,e,"bold",function(){return 0!=(1024&this._type)},function(t){t?this._type|=1024:this._type&=-1025}),r(0,e,"italic",function(){return 0!=(2048&this._type)},function(t){t?this._type|=2048:this._type&=-2049}),r(0,e,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(t){"nowrap"===t&&(this._type|=131072),"none"===t&&(this._type&=-131073)}),r(0,e,"width",null,function(t){if(this._type|=8,"string"==typeof t){var e=t.indexOf("auto");if(e>=0&&(this._type|=262144,t=t.substr(0,e)),this._calculation("width",t))return;t=parseInt(t)}this.size(t,-1)}),r(0,e,"height",null,function(t){if(this._type|=8192,"string"==typeof t){if(this._calculation("height",t))return;t=parseInt(t)}this.size(-1,t)}),r(0,e,"letterSpacing",function(){return this._extendStyle.letterSpacing},function(t){"string"==typeof t&&(t=parseInt(t+"")),t!=this._extendStyle.letterSpacing&&(this._getExtendStyle().letterSpacing=t)}),r(0,e,"position",function(){return 4&this._type?"absolute":""},function(t){"absolute"===t?this._type|=4:this._type&=-5}),r(0,e,"absolute",function(){return 0!==(4&this._type)}),r(0,e,"paddingLeft",function(){return this.padding[3]}),r(0,e,"paddingTop",function(){return this.padding[0]}),t.create=function(){return Ji.getItemByClass("HTMLStyle",t)},t.parseOneCSS=function(e,i){for(var n,s=[],r=e.split(i),a=0,o=r.length;o>a;a++){var h=r[a],l=h.indexOf(":"),_=h.substr(0,l).replace(/^\s+|\s+$/g,"");if(0!==_.length){var u=h.substr(l+1).replace(/^\s+|\s+$/g,""),c=[_,u];switch(_){case"italic":case"bold":c[1]="true"==u;break;case"font-weight":"bold"==u&&(c[1]=!0,c[0]="bold");break;case"line-height":c[0]="lineHeight",c[1]=parseInt(u);break;case"font-size":c[0]="fontSize",c[1]=parseInt(u);break;case"stroke":c[0]="stroke",c[1]=parseInt(u);break;case"padding":n=u.split(" "),n.length>1||(n[1]=n[2]=n[3]=n[0]),c[1]=[parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),parseInt(n[3])];break;default:(c[0]=t._CSSTOVALUE[_])||(c[0]=_)}s.push(c)}}return s},t.parseCSS=function(e){for(var i;null!=(i=t._parseCSSRegExp.exec(e));)t.styleSheets[i[1]]=t.parseOneCSS(i[2],";")},t._CSSTOVALUE={"letter-spacing":"letterSpacing","white-space":"whiteSpace","line-height":"lineHeight","font-family":"family","vertical-align":"valign","text-decoration":"textDecoration","background-color":"bgColor","border-color":"borderColor"},t._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),t.ALIGN_LEFT="left",t.ALIGN_CENTER="center",t.ALIGN_RIGHT="right",t.VALIGN_TOP="top",t.VALIGN_MIDDLE="middle",t.VALIGN_BOTTOM="bottom",t.styleSheets={},t.ADDLAYOUTED=512,t._PADDING=[0,0,0,0],t._HEIGHT_SET=8192,t._LINE_ELEMENT=65536,t._NOWARP=131072,t._WIDTHAUTO=262144,t._BOLD=1024,t._ITALIC=2048,t._CSS_BLOCK=1,t._DISPLAY_NONE=2,t._ABSOLUTE=4,t._WIDTH_SET=8,t._ALIGN=48,t._VALIGN=192,n(t,["_inheritProps",function(){return this._inheritProps=["italic","align","valign","leading","stroke","strokeColor","bold","fontSize","lineHeight","wordWrap","color"]},"alignVDic",function(){return this.alignVDic={left:0,center:16,right:32,top:0,middle:64,bottom:128}},"align_Value",function(){return this.align_Value={0:"left",16:"center",32:"right"}},"vAlign_Value",function(){return this.vAlign_Value={0:"top",64:"middle",128:"bottom"}}]),t}(),Yi=function(){function t(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}s(t,"laya.utils.Dragging");var e=t.prototype;return e.start=function(t,e,n,s,r,a,o,h){void 0===h&&(h=.92),this.clearTimer(),this.target=t,this.area=e,this.hasInertia=n,this.elasticDistance=e?s:0,this.elasticBackTime=r,this.data=a,this._disableMouseEvent=o,this.ratio=h,this._parent=t.parent,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,i.stage.on("mouseup",this,this.onStageMouseUp),i.stage.on("mouseout",this,this.onStageMouseUp),i.systemTimer.frameLoop(1,this,this.loop)},e.clearTimer=function(){i.systemTimer.clear(this,this.loop),i.systemTimer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},e.stop=function(){this._dragging&&(_e.instance.disableMouseEvent=!1,i.stage.off("mouseup",this,this.onStageMouseUp),i.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},e.loop=function(){var t=this._parent.getMousePoint(),e=t.x,n=t.y,s=e-this._lastX,r=n-this._lastY;if(this._clickOnly){if(!(Math.abs(s*i.stage._canvasTransform.getScaleX())>1||Math.abs(r*i.stage._canvasTransform.getScaleY())>1))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),_e.instance.disableMouseEvent=this._disableMouseEvent}else this._offsets.push(s,r);(0!==s||0!==r)&&(this._lastX=e,this._lastY=n,this.target.x+=s*this._elasticRateX,this.target.y+=r*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},e.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target._x<this.area.x)var t=this.area.x-this.target._x;else t=this.target._x>this.area.x+this.area.width?this.target._x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-t/this.elasticDistance),this.target._y<this.area.y)var e=this.area.y-this.target.y;else e=this.target._y>this.area.y+this.area.height?this.target._y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-e/this.elasticDistance)}},e.backToArea=function(){this.target.x=Math.min(Math.max(this.target._x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target._y,this.area.y),this.area.y+this.area.height)},e.onStageMouseUp=function(){if(_e.instance.disableMouseEvent=!1,i.stage.off("mouseup",this,this.onStageMouseUp),i.stage.off("mouseout",this,this.onStageMouseUp),i.systemTimer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var t=this._offsets.length,e=Math.min(t,6),n=this._offsets.length-e,s=t-1;s>n;s--)this._offsetY+=this._offsets[s--],this._offsetX+=this._offsets[s];this._offsetX=this._offsetX/e*2,this._offsetY=this._offsetY/e*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=this._offsetX>0?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=this._offsetY>0?this.maxOffset:-this.maxOffset),i.systemTimer.frameLoop(1,this,this.tweenMove)}else this.elasticDistance>0?this.checkElastic():this.clear()},e.checkElastic=function(){var t=0/0,e=0/0;if(this.target.x<this.area.x?t=this.area.x:this.target._x>this.area.x+this.area.width&&(t=this.area.x+this.area.width),this.target.y<this.area.y?e=this.area.y:this.target._y>this.area.y+this.area.height&&(e=this.area.y+this.area.height),isNaN(t)&&isNaN(e))this.clear();else{var i={};isNaN(t)||(i.x=t),isNaN(e)||(i.y=e),this._tween=ri.to(this.target,i,this.elasticBackTime,Ve.sineOut,_.create(this,this.clear),0,!1,!1)}},e.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(i.systemTimer.clear(this,this.tweenMove),this.elasticDistance>0?this.checkElastic():this.clear())},e.clear=function(){if(this.target){this.clearTimer();var t=this.target;this.target=null,this._parent=null,t.event("dragend",this.data)}},t}(),ji=(function(){function t(){this._graphicsCmdEncoder=null,this._matrix=null,this._paramData=new ParamData(32,!0)}s(t,"laya.layagl.cmdNative.TransformCmdNative");var e=t.prototype;return e.recover=function(){this._matrix=null,Ji.recover("TransformCmd",this)},r(0,e,"cmdID",function(){return"Transform"}),r(0,e,"matrix",function(){return this._matrix},function(t){this._matrix=t;var e=this._paramData._float32Data;e[0]=this._matrix.a,e[1]=this._matrix.b,e[2]=this._matrix.c,e[3]=this._matrix.d,e[4]=this._matrix.tx,e[5]=this._matrix.ty,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"pivotX",function(){return this._paramData._float32Data[6]},function(t){this._paramData._float32Data[6]=t,we.syncBufferToRenderThread(this._paramData)}),r(0,e,"pivotY",function(){return this._paramData._float32Data[7]},function(t){this._paramData._float32Data[7]=t,we.syncBufferToRenderThread(this._paramData)}),t.create=function(e,i,n){var s=Ji.getItemByClass("TransformCmd",t),r=s._graphicsCmdEncoder=this._commandEncoder,a=s._paramData._float32Data;a[0]=e.a,a[1]=e.b,a[2]=e.c,a[3]=e.d,a[4]=e.tx,a[5]=e.ty,a[6]=i,a[7]=n,s._matrix=e;var o=s._paramData.getPtrID();return we.syncBufferToRenderThread(s._paramData),r.setGlobalValueEx(he.GLOBALVALUE_MATRIX32,14,o,0),we.syncBufferToRenderThread(r),s},t.ID="Transform",t}(),function(){function t(){this._mat=new fi}s(t,"laya.webgl.canvas.save.SaveTranslate");var e=t.prototype;return i.imps(e,{"laya.webgl.canvas.save.ISaveData":!0}),e.isSaveMark=function(){return!1},e.restore=function(e){this._mat.copyTo(e._curMat),t.POOL[t.POOL._length++]=this},t.save=function(e){var i=t.POOL,n=i._length>0?i[--i._length]:new t;e._curMat.copyTo(n._mat);var s=e._save;s[s._length++]=n},t.POOL=h._createArray(),t}()),Zi=function(){function t(){}s(t,"laya.display.cmd.DrawTrianglesCmd");var e=t.prototype;return e.recover=function(){this.texture=null,this.vertices=null,this.uvs=null,this.indices=null,this.matrix=null,Ji.recover("DrawTrianglesCmd",this)},e.run=function(t,e,i){t.drawTriangles(this.texture,this.x+e,this.y+i,this.vertices,this.uvs,this.indices,this.matrix,this.alpha,this.color,this.blendMode)},r(0,e,"cmdID",function(){return"DrawTriangles"}),t.create=function(e,i,n,s,r,a,h,l,_,u){var c=Ji.getItemByClass("DrawTrianglesCmd",t);if(c.texture=e,c.x=i,c.y=n,c.vertices=s,c.uvs=r,c.indices=a,c.matrix=h,c.alpha=l,_){c.color=new gn;var d=o.create(_).arrColor;c.color.color(255*d[0],255*d[1],255*d[2],255*d[3])}return c.blendMode=u,c},t.ID="DrawTriangles",t}(),qi=function(){function t(){}return s(t,"laya.utils.RunDriver"),t.getIncludeStr=function(){return null},t.createShaderCondition=function(t){var e="(function() {return "+t+";})";return i._runScript(e)},t.fontMap=[],t.measureText=function(e,i){var n=t.hanzi.test(e);if(n&&t.fontMap[i])return t.fontMap[i];var s=Be.context;s.font=i;var r=s.measureText(e);return n&&(t.fontMap[i]=r),r},t.drawToCanvas=function(t,e,i,n,s,r){i|=0,n|=0,s|=0,r|=0;var a=new Is,o=a.getContext("2d");return a.size(i,n),z.renders[e]._fun(t,o,s,r),a},t.initRender=function(t,e,i){return Ni._context=t.getContext("2d"),t.size(e,i),!0},t.createParticleTemplate2D=null,t.changeWebGLSize=function(){},t.createRenderSprite=function(t,e){return new z(t,e)},t.clear=function(){Ni.isConchApp||Ni._context.clear()},t.getTexturePixels=function(){return null},t.skinAniSprite=function(){return null},t.cancelLoadByUrl=function(){},t.enableNative=null,n(t,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),t}(),Ki=function(){function t(t){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=t}s(t,"laya.webgl.utils.ShaderNode");var e=t.prototype;return e.setParent=function(t){t.childs.push(this),this.z=t.z+1,this.parent=t},e.setCondition=function(t,e){t&&(this.conditionType=e,t=t.replace(/(\s*$)/g,""),this.condition=function(){return this[t]},this.condition.__condition=t)},e.toscript=function(e,i){return this._toscript(e,i,++t.__id)},e._toscript=function(t,e,i){if(this.childs.length<1&&!this.text)return e;e.length;if(this.condition){var n=!!this.condition.call(t);if(2===this.conditionType&&(n=!n),!n)return e}if(this.text&&e.push(this.text),this.childs.length>0&&this.childs.forEach(function(n){n._toscript(t,e,i)}),this.includefiles.length>0&&this.useFuns.length>0)for(var s,r=0,a=this.includefiles.length;a>r;r++)this.includefiles[r].curUseID!=i&&(s=this.includefiles[r].file.getFunsScript(this.useFuns),s.length>0&&(this.includefiles[r].curUseID=i,e[0]=s+e[0]));return e},t.__id=1,t}(),$i=(function(){function t(){this._paramData=new ParamData(4,!0)}s(t,"laya.layagl.cmdNative.AlphaCmdNative");var e=t.prototype;return e.recover=function(){Ji.recover("AlphaCmd",this)},e.run=function(t){t.alpha(this._alpha)},r(0,e,"cmdID",function(){return"Alpha"}),r(0,e,"alpha",function(){return this._alpha},function(t){t=t>1?1:t,t=0>t?0:t,this._alpha=t;var e=16777215;e=255*t<<24|e,this._paramData._int32Data[0]=e,we.syncBufferToRenderThread(this._paramData)}),t.create=function(e){var i=Ji.getItemByClass("AlphaCmd",t),n=i._graphicsCmdEncoder=this._commandEncoder;return i.alpha=e,n.setGlobalValueEx(he.GLOBALVALUE_DRAWTEXTURE_COLOR,15,i._paramData.getPtrID(),0),we.syncBufferToRenderThread(n),i},t.ID="Alpha",t}(),function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}s(t,"laya.maths.Point");var e=t.prototype;return e.setTo=function(t,e){return this.x=t,this.y=e,this},e.reset=function(){return this.x=this.y=0,this},e.recover=function(){Ji.recover("Point",this.reset())},e.distance=function(t,e){return Math.sqrt((this.x-t)*(this.x-t)+(this.y-e)*(this.y-e))},e.toString=function(){return this.x+","+this.y},e.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t>0){var e=1/t;this.x*=e,this.y*=e}},e.copy=function(t){return this.setTo(t.x,t.y)},t.create=function(){return Ji.getItemByClass("Point",t)},t.TEMP=new t,t.EMPTY=new t,t}()),Ji=function(){function t(){}return s(t,"laya.utils.Pool"),t.getPoolBySign=function(e){return t._poolDic[e]||(t._poolDic[e]=[])},t.clearBySign=function(e){t._poolDic[e]&&(t._poolDic[e].length=0)},t.recover=function(e,i){i.__InPool||(i.__InPool=!0,t.getPoolBySign(e).push(i))},t.recoverByClass=function(e){if(e){var i=e.__className||e.constructor._$gid;i&&t.recover(i,e)}},t._getClassSign=function(t){var e=t.__className||t._$gid;return e||(t._$gid=e=ee.getGID()+""),e},t.createByClass=function(e){return t.getItemByClass(t._getClassSign(e),e)},t.getItemByClass=function(e,i){if(!t._poolDic[e])return new i;var n=t.getPoolBySign(e);if(n.length){var s=n.pop();s.__InPool=!1}else s=new i;return s},t.getItemByCreateFun=function(e,i,n){var s=t.getPoolBySign(e),r=s.length?s.pop():i.call(n);return r.__InPool=!1,r},t.getItem=function(e){var i=t.getPoolBySign(e),n=i.length?i.pop():null;return n&&(n.__InPool=!1),n},t.POOLSIGN="__InPool",t._poolDic={},t
}(),Qi=function(){function t(){}return s(t,"laya.utils.CacheManger"),t.regCacheByFunction=function(e,i){t.unRegCacheByFunction(e,i);var n;n={tryDispose:e,getCacheList:i},t._cacheList.push(n)},t.unRegCacheByFunction=function(e,i){var n=0,s=0;for(s=t._cacheList.length,n=0;s>n;n++)if(t._cacheList[n].tryDispose==e&&t._cacheList[n].getCacheList==i)return t._cacheList.splice(n,1),void 0},t.forceDispose=function(){var e=0,i=t._cacheList.length;for(e=0;i>e;e++)t._cacheList[e].tryDispose(!0)},t.beginCheck=function(e){void 0===e&&(e=15e3),i.systemTimer.loop(e,null,t._checkLoop)},t.stopCheck=function(){i.systemTimer.clear(null,t._checkLoop)},t._checkLoop=function(){var e=t._cacheList;if(!(e.length<1)){var i=Be.now(),n=0,s=0;for(s=n=e.length;n>0&&(t._index++,t._index=t._index%s,e[t._index].tryDispose(!1),!(Be.now()-i>t.loopTimeLimit));)n--}},t.loopTimeLimit=2,t._cacheList=[],t._index=0,t}(),tn=function(){function t(){}return s(t,"laya.ui.Styles"),t.labelColor="#000000",t.buttonStateNum=3,t.scrollBarMinNum=15,t.scrollBarDelayTime=500,n(t,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),t}(),en=(function(){function t(){this._graphicsCmdEncoder=null,this._paramData=null,this._x=0,this._y=0,this._points=[],this._lineColor=null,this._lineWidth=0/0,this.lastOriX=0,this.lastOriY=0,this.tArray=[],this._vertNum=0,this.ibBuffer=null,this.vbBuffer=null,this._ibSize=0,this._vbSize=0,this._ibArray=[],this._vbArray=[]}s(t,"laya.layagl.cmdNative.DrawCurvesCmdNative");var e=t.prototype;return e._getPoints=function(t){var e=[];this._points.push(t[0]),this._points.push(t[1]);for(var i=2,n=t.length;n>i;)this._quadraticCurveTo(e,t[i++],t[i++],t[i++],t[i++]);return e},e._quadraticCurveTo=function(t,e,i,n,s){var r=Wi.I;0==this.tArray.length?(this.lastOriX=this._points[0],this.lastOriY=this._points[1]):(this.lastOriX=this.tArray[this.tArray.length-2],this.lastOriY=this.tArray[this.tArray.length-1]),this.tArray=r.getBezierPoints([this.lastOriX,this.lastOriY,e,i,n,s],30,2);for(var a=2,o=this.tArray.length;o>a;a++)t.push(this.tArray[a])},e.recover=function(){this._lineColor=null,this._points.length=0,this.tArray.length=0,this._ibArray.length=0,this._vbArray.length=0,Ji.recover("DrawCurvesCmd",this)},r(0,e,"lineColor",function(){return this._lineColor},function(t){this._lineColor=t;for(var e=o.create(this._lineColor),i=e.numColor,n=this.vbBuffer._int32Data,s=0,r=0;r<this._vertNum;r++)s++,s++,n[s++]=i;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"points",function(){return this._points},function(e){this._points.length=0,this.lastOriX=0,this.lastOriY=0,this._points=this._getPoints(e),this._ibArray.length=0,this._vbArray.length=0,ii.createLine2(this._points,this._ibArray,this.lineWidth,0,this._vbArray,!1);var i=o.create(this._lineColor),n=i.numColor;this._vertNum=this._points.length;var s=this._vertNum;(!this.vbBuffer||this.vbBuffer.getByteLength()<3*this._vertNum*4)&&(this.vbBuffer=new ParamData(3*s*4,!0)),this._vbSize=3*this._vertNum*4;for(var r=this.vbBuffer._float32Data,a=this.vbBuffer._int32Data,h=0,l=0;l<this._vertNum;l++)r[h++]=this._vbArray[2*l]+this.x,r[h++]=this._vbArray[2*l+1]+this.y,a[h++]=n;(!this.ibBuffer||this.ibBuffer.getByteLength()<3*(this._vertNum-2)*2)&&(this.ibBuffer=new ParamData(3*(s-2)*2,!0,!0)),this._ibSize=3*(this._vertNum-2)*2;for(var _=this.ibBuffer._int16Data,u=0;u<3*(this._vertNum-2);u++)_[u]=this._ibArray[u];a=this._paramData._int32Data,a[t._PARAM_VB_SIZE_POS_]=this._vbSize,a[t._PARAM_IB_SIZE_POS_]=this._ibSize,we.syncBufferToRenderThread(this.ibBuffer),we.syncBufferToRenderThread(this.vbBuffer),we.syncBufferToRenderThread(this._paramData)}),r(0,e,"cmdID",function(){return"DrawCurves"}),r(0,e,"x",function(){return this._x},function(t){this._x=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)e[i++]=this._vbArray[2*n]+this._x,i++,i++;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"y",function(){return this._y},function(t){this._y=t;for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)i++,e[i++]=this._vbArray[2*n+1]+this._y,i++;we.syncBufferToRenderThread(this.vbBuffer)}),r(0,e,"lineWidth",function(){return this._lineWidth},function(t){this._lineWidth=t,this._ibArray.length=0,this._vbArray.length=0,ii.createLine2(this._points,this._ibArray,this._lineWidth,0,this._vbArray,!1);for(var e=this.vbBuffer._float32Data,i=0,n=0;n<this._vertNum;n++)e[i++]=this._vbArray[2*n]+this.x,e[i++]=this._vbArray[2*n+1]+this.y,i++;we.syncBufferToRenderThread(this.vbBuffer)}),t.create=function(e,i,n,s,r){var a=Ji.getItemByClass("DrawCurvesCmd",t);a._graphicsCmdEncoder=this._commandEncoder,t._DRAW_CURVES_CMD_ENCODER_||(t._DRAW_CURVES_CMD_ENCODER_=we.instance.createCommandEncoder(152,32,!0),t._DRAW_CURVES_CMD_ENCODER_.useProgramEx(he.PROGRAMEX_DRAWVG),t._DRAW_CURVES_CMD_ENCODER_.useVDO(he.VDO_MESHVG),t._DRAW_CURVES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_VIEWS,0),t._DRAW_CURVES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_DIR,1),t._DRAW_CURVES_CMD_ENCODER_.uniformEx(he.GLOBALVALUE_CLIP_MAT_POS,2),t._DRAW_CURVES_CMD_ENCODER_.setMeshExByParamData(4*t._PARAM_VB_POS_,4*t._PARAM_VB_OFFSET_POS_,4*t._PARAM_VB_SIZE_POS_,4*t._PARAM_IB_POS_,4*t._PARAM_IB_OFFSET_POS_,4*t._PARAM_IB_SIZE_POS_,4*t._PARAM_INDEX_ELEMENT_OFFSET_POS_),t._DRAW_CURVES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_MATRIX32,0,7),t._DRAW_CURVES_CMD_ENCODER_.modifyMesh(he.GLOBALVALUE_DRAWTEXTURE_COLOR,1,15),we.syncBufferToRenderThread(t._DRAW_CURVES_CMD_ENCODER_)),a._paramData||(a._paramData=new ParamData(32,!0)),a._x=e,a._y=i,a._lineColor=s,a._lineWidth=r,a._points=a._getPoints(n),ii.createLine2(a._points,a._ibArray,r,0,a._vbArray,!1);var h=o.create(s),l=h.numColor;a._vertNum=a._points.length;var _=a._vertNum;(!a.vbBuffer||a.vbBuffer.getByteLength()<3*a._vertNum*4)&&(a.vbBuffer=new ParamData(3*_*4,!0)),a._vbSize=3*a._vertNum*4;for(var u=a.vbBuffer._float32Data,c=a.vbBuffer._int32Data,d=0,f=0;f<a._vertNum;f++)u[d++]=a._vbArray[2*f]+e,u[d++]=a._vbArray[2*f+1]+i,c[d++]=l;(!a.ibBuffer||a.ibBuffer.getByteLength()<3*(a._vertNum-2)*2)&&(a.ibBuffer=new ParamData(3*(_-2)*2,!0,!0)),a._ibSize=3*(a._vertNum-2)*2;for(var p=a.ibBuffer._int16Data,m=0;m<3*(a._vertNum-2);m++)p[m]=a._ibArray[m];a._paramData._float32Data;return c=a._paramData._int32Data,c[0]=1,c[t._PARAM_VB_POS_]=a.vbBuffer.getPtrID(),c[t._PARAM_IB_POS_]=a.ibBuffer.getPtrID(),c[t._PARAM_VB_SIZE_POS_]=a._vbSize,c[t._PARAM_IB_SIZE_POS_]=a._ibSize,c[t._PARAM_VB_OFFSET_POS_]=0,c[t._PARAM_IB_OFFSET_POS_]=0,c[t._PARAM_INDEX_ELEMENT_OFFSET_POS_]=0,we.syncBufferToRenderThread(a.vbBuffer),we.syncBufferToRenderThread(a.ibBuffer),we.syncBufferToRenderThread(a._paramData),a._graphicsCmdEncoder.useCommandEncoder(t._DRAW_CURVES_CMD_ENCODER_.getPtrID(),a._paramData.getPtrID(),-1),we.syncBufferToRenderThread(a._graphicsCmdEncoder),a},t.ID="DrawCurves",t._DRAW_CURVES_CMD_ENCODER_=null,t._PARAM_VB_POS_=1,t._PARAM_IB_POS_=2,t._PARAM_VB_SIZE_POS_=3,t._PARAM_IB_SIZE_POS_=4,t._PARAM_VB_OFFSET_POS_=5,t._PARAM_IB_OFFSET_POS_=6,t._PARAM_INDEX_ELEMENT_OFFSET_POS_=7,t}(),function(){function t(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}s(t,"laya.html.utils.LayoutLine");var e=t.prototype;return e.updatePos=function(t,e,i,n,s,r,a){var o,h=0;this.elements.length>0&&(o=this.elements[this.elements.length-1],h=o.x+o.width-this.elements[0].x),a=a||this.h;var l=0,_=0/0;"center"===s&&(l=(e-h)/2),"right"===s&&(l=e-h);for(var u=0,c=this.elements.length;c>u;u++){o=this.elements[u];var d=o._getCSSStyle();switch(0!==l&&(o.x+=l),d.valign){case"top":o.y=n;break;case"middle":var f=0;99999!=this.minTextHeight&&(f=this.minTextHeight);var p=(f+a)/2;p=Math.max(p,this.h),_=o instanceof laya.html.dom.HTMLImageElement?n+p-o.height:n+p-o.height,o.y=_;break;case"bottom":o.y=n+(a-o.height)}}},t}()),nn=function(){function t(){}s(t,"laya.display.cmd.StrokeTextCmd");var e=t.prototype;return e.recover=function(){Ji.recover("StrokeTextCmd",this)},e.run=function(t,e,i){t.strokeWord(this.text,this.x+e,this.y+i,this.font,this.color,this.lineWidth,this.textAlign)},r(0,e,"cmdID",function(){return"StrokeText"}),t.create=function(e,i,n,s,r,a,o){var h=Ji.getItemByClass("StrokeTextCmd",t);return h.text=e,h.x=i,h.y=n,h.font=s,h.color=r,h.lineWidth=a,h.textAlign=o,h},t.ID="StrokeText",t}(),sn=function(){function t(){this.reset()}s(t,"laya.utils.HTMLChar");var e=t.prototype;return e.setData=function(e,i,n,s){return this.char=e,this.charNum=e.charCodeAt(0),this.x=this.y=0,this.width=i,this.height=n,this.style=s,this.isWord=!t._isWordRegExp.test(e),this},e.reset=function(){return this.x=this.y=this.width=this.height=0,this.isWord=!1,this.char=null,this.charNum=0,this.style=null,this},e.recover=function(){Ji.recover("HTMLChar",this.reset())},e._isChar=function(){return!0},e._getCSSStyle=function(){return this.style},t.create=function(){return Ji.getItemByClass("HTMLChar",t)},t._isWordRegExp=new RegExp("[\\w.]",""),t}(),rn=function(t){function e(){this._bits=0,this._parent=null,this.name="",this.destroyed=!1,this._conchData=null,this._components=null,this._scene=null,e.__super.call(this),this._children=e.ARRAY_EMPTY,this.createGLBuffer()}s(e,"laya.display.Node",t);var n=e.prototype;return n.createGLBuffer=function(){},n._setBit=function(t,e){if(16===t){var i=this._getBit(t);i!=e&&this._updateDisplayedInstage()}e?this._bits|=t:this._bits&=~t},n._getBit=function(t){return 0!=(this._bits&t)},n._setUpNoticeChain=function(){this._getBit(16)&&this._setBitUp(16)},n._setBitUp=function(t){var e=this;for(e._setBit(t,!0),e=e._parent;e;){if(e._getBit(t))return;e._setBit(t,!0),e=e._parent}},n.on=function(t,e,i,n){return("display"===t||"undisplay"===t)&&(this._getBit(16)||this._setBitUp(16)),this._createListener(t,e,i,n,!1)},n.once=function(t,e,i,n){return("display"===t||"undisplay"===t)&&(this._getBit(16)||this._setBitUp(16)),this._createListener(t,e,i,n,!0)},n.destroy=function(t){void 0===t&&(t=!0),this.destroyed=!0,this._destroyAllComponent(),this._parent&&this._parent.removeChild(this),this._children&&(t?this.destroyChildren():this.removeChildren()),this.onDestroy(),this._children=null,this.offAll()},n.onDestroy=function(){},n.destroyChildren=function(){if(this._children)for(var t=0,e=this._children.length;e>t;t++)this._children[0].destroy(!0)},n.addChild=function(t){if(!t||this.destroyed||t===this)return t;if(t._zOrder&&this._setBit(32,!0),t._parent===this){var i=this.getChildIndex(t);i!==this._children.length-1&&(this._children.splice(i,1),this._children.push(t),this._childChanged())}else t._parent&&t._parent.removeChild(t),this._children===e.ARRAY_EMPTY&&(this._children=[]),this._children.push(t),t._setParent(this),this._childChanged();return t},n.addChildren=function(){for(var t=arguments,e=0,i=t.length;i>e;)this.addChild(t[e++])},n.addChildAt=function(t,i){if(!t||this.destroyed||t===this)return t;if(t._zOrder&&this._setBit(32,!0),i>=0&&i<=this._children.length){if(t._parent===this){var n=this.getChildIndex(t);this._children.splice(n,1),this._children.splice(i,0,t),this._childChanged()}else t._parent&&t._parent.removeChild(t),this._children===e.ARRAY_EMPTY&&(this._children=[]),this._children.splice(i,0,t),t._setParent(this);return t}throw new Error("appendChildAt:The index is out of bounds")},n.getChildIndex=function(t){return this._children.indexOf(t)},n.getChildByName=function(t){var e=this._children;if(e)for(var i=0,n=e.length;n>i;i++){var s=e[i];if(s.name===t)return s}return null},n.getChildAt=function(t){return this._children[t]||null},n.setChildIndex=function(t,e){var i=this._children;if(0>e||e>=i.length)throw new Error("setChildIndex:The index is out of bounds.");var n=this.getChildIndex(t);if(0>n)throw new Error("setChildIndex:node is must child of this object.");return i.splice(n,1),i.splice(e,0,t),this._childChanged(),t},n._childChanged=function(){},n.removeChild=function(t){if(!this._children)return t;var e=this._children.indexOf(t);return this.removeChildAt(e)},n.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},n.removeChildByName=function(t){var e=this.getChildByName(t);return e&&this.removeChild(e),e},n.removeChildAt=function(t){var e=this.getChildAt(t);return e&&(this._children.splice(t,1),e._setParent(null)),e},n.removeChildren=function(t,i){if(void 0===t&&(t=0),void 0===i&&(i=2147483647),this._children&&this._children.length>0){var n=this._children;if(0===t&&i>=n.length-1){var s=n;this._children=e.ARRAY_EMPTY}else s=n.splice(t,i-t);for(var r=0,a=s.length;a>r;r++)s[r]._setParent(null)}return this},n.replaceChild=function(t,e){var i=this._children.indexOf(e);return i>-1?(this._children.splice(i,1,t),e._setParent(null),t._setParent(this),t):null},n._setParent=function(t){this._parent!==t&&(t?(this._parent=t,this._onAdded(),this.event("added"),this._getBit(16)&&(this._setUpNoticeChain(),t.displayedInStage&&this._displayChild(this,!0)),t._childChanged(this)):(this._onRemoved(),this.event("removed"),this._parent._childChanged(),this._getBit(16)&&this._displayChild(this,!1),this._parent=t))},n._updateDisplayedInstage=function(){var t;t=this;for(var e=i.stage,n=!1;t;){if(t._getBit(16)){n=t._getBit(128);break}if(t===e||t._getBit(128)){n=!0;break}t=t._parent}this._setBit(128,n)},n._setDisplay=function(t){this._getBit(128)!==t&&(this._setBit(128,t),t?this.event("display"):this.event("undisplay"))},n._displayChild=function(t,e){var i=t._children;if(i)for(var n=0,s=i.length;s>n;n++){var r=i[n];r._getBit(16)&&(r._children.length>0?this._displayChild(r,e):r._setDisplay(e))}t._setDisplay(e)},n.contains=function(t){if(t===this)return!0;for(;t;){if(t._parent===this)return!0;t=t._parent}return!1},n.timerLoop=function(t,e,n,s,r,a){void 0===r&&(r=!0),void 0===a&&(a=!1);var o=this.scene?this.scene.timer:i.timer;o.loop(t,e,n,s,r,a)},n.timerOnce=function(t,e,n,s,r){void 0===r&&(r=!0);var a=this.scene?this.scene.timer:i.timer;a._create(!1,!1,t,e,n,s,r)},n.frameLoop=function(t,e,n,s,r){void 0===r&&(r=!0);var a=this.scene?this.scene.timer:i.timer;a._create(!0,!0,t,e,n,s,r)},n.frameOnce=function(t,e,n,s,r){void 0===r&&(r=!0);var a=this.scene?this.scene.timer:i.timer;a._create(!0,!1,t,e,n,s,r)},n.clearTimer=function(t,e){var n=this.scene?this.scene.timer:i.timer;n.clear(t,e)},n.callLater=function(t,e){var n=this.scene?this.scene.timer:i.timer;n.callLater(this,t,e)},n.runCallLater=function(t){var e=this.scene?this.scene.timer:i.timer;e.runCallLater(this,t)},n._onActive=function(){},n._onInActive=function(){},n._onActiveInScene=function(){},n._onInActiveInScene=function(){},n._parse=function(){},n._setBelongScene=function(t){if(!this._scene){if(this._scene=t,this._components)for(var e=0,i=this._components.length;i>e;e++)this._components[e]._setActiveInScene(!0);for(this._onActiveInScene(),e=0,i=this._children.length;i>e;e++)this._children[e]._setBelongScene(t)}},n._setUnBelongScene=function(){if(this._scene!==this){if(this._onInActiveInScene(),this._components)for(var t=0,e=this._components.length;e>t;t++)this._components[t]._setActiveInScene(!1);for(this._scene=null,t=0,e=this._children.length;e>t;t++)this._children[t]._setUnBelongScene()}},n._activeHierarchy=function(){if(this._setBit(2,!0),this._components)for(var t=0,e=this._components.length;e>t;t++)this._components[t]._setActive(!0);for(this._onActive(),t=0,e=this._children.length;e>t;t++){var i=this._children[t];!i._getBit(1)&&i._activeHierarchy()}this._getBit(4)||(this._setBit(4,!0),this.onAwake()),this.onEnable()},n.onAwake=function(){},n.onEnable=function(){},n._inActiveHierarchy=function(){if(this._onInActive(),this._components)for(var t=0,e=this._components.length;e>t;t++)this._components[t]._setActive(!1);for(this._setBit(2,!1),t=0,e=this._children.length;e>t;t++){var i=this._children[t];!i._getBit(1)&&i._inActiveHierarchy()}this.onDisable()},n.onDisable=function(){},n._onAdded=function(){var t=this._parent.scene;t&&this._setBelongScene(t),this._parent.activeInHierarchy&&this.active&&this._activeHierarchy()},n._onRemoved=function(){this._parent.activeInHierarchy&&this.active&&this._inActiveHierarchy(),this._parent.scene&&this._setUnBelongScene()},n._addComponentInstance=function(t){this._components=this._components||[],this._components.push(t),t.owner=this,t._onAdded(),this.activeInHierarchy&&t._setActive(!0),this._scene&&t._setActiveInScene(!0)},n._destroyComponent=function(t){if(this._components)for(var e=0,i=this._components.length;i>e;e++){var n=this._components[e];if(n===t){n._destroy(),this._components.splice(e,1);break}}},n._destroyAllComponent=function(){if(this._components){for(var t=0,e=this._components.length;e>t;t++){var i=this._components[t];i._destroy()}this._components.length=0}},n._cloneTo=function(t){var e=t;if(this._components)for(var i=0,n=this._components.length;n>i;i++){var s=e.addComponent(this._components[i].constructor);this._components[i]._cloneTo(s)}},n.addComponentIntance=function(t){if(t.owner)throw"Node:the component has belong to other node.";if(t.isSingleton&&this.getComponent(t.constructor))throw"Node:the component is singleton,can't add the second one.";return this._addComponentInstance(t),t},n.addComponent=function(t){var e=Ji.createByClass(t);if(e._destroyed=!1,e.isSingleton&&this.getComponent(t))throw"无法实例"+t+"组件，"+t+"组件已存在！";return this._addComponentInstance(e),e},n.getComponent=function(t){if(this._components)for(var e=0,n=this._components.length;n>e;e++){var s=this._components[e];if(i.__typeof(s,t))return s}return null},n.getComponents=function(t){var e;if(this._components)for(var n=0,s=this._components.length;s>n;n++){var r=this._components[n];i.__typeof(r,t)&&(e=e||[],e.push(r))}return e},r(0,n,"numChildren",function(){return this._children.length}),r(0,n,"parent",function(){return this._parent}),r(0,n,"activeInHierarchy",function(){return this._getBit(2)}),r(0,n,"active",function(){return!this._getBit(8)&&!this._getBit(1)},function(t){t=!!t,!this._getBit(1)!==t&&(this._setBit(1,!t),this._parent&&this._parent.activeInHierarchy&&(t?this._activeHierarchy():this._inActiveHierarchy()))}),r(0,n,"displayedInStage",function(){return this._getBit(16)?this._getBit(128):(this._setBitUp(16),this._getBit(128))}),r(0,n,"scene",function(){return this._scene}),r(0,n,"timer",function(){return this.scene?this.scene.timer:i.timer}),e.ARRAY_EMPTY=[],e}(l),an=function(t){function e(){e.__super.call(this)}s(e,"laya.components.Script",t);var n=e.prototype;return n._onAwake=function(){this.onAwake(),this.onStart!==laya.components.Script.prototype.onStart&&i.startTimer.callLater(this,this.onStart)},n._onEnable=function(){var t=laya.components.Script.prototype;this.onTriggerEnter!==t.onTriggerEnter&&this.owner.on("triggerenter",this,this.onTriggerEnter),this.onTriggerStay!==t.onTriggerStay&&this.owner.on("triggerstay",this,this.onTriggerStay),this.onTriggerExit!==t.onTriggerExit&&this.owner.on("triggerexit",this,this.onTriggerExit),this.onMouseDown!==t.onMouseDown&&this.owner.on("mousedown",this,this.onMouseDown),this.onMouseUp!==t.onMouseUp&&this.owner.on("mouseup",this,this.onMouseUp),this.onClick!==t.onClick&&this.owner.on("click",this,this.onClick),this.onStageMouseDown!==t.onStageMouseDown&&i.stage.on("mousedown",this,this.onStageMouseDown),this.onStageMouseUp!==t.onStageMouseUp&&i.stage.on("mouseup",this,this.onStageMouseUp),this.onStageClick!==t.onStageClick&&i.stage.on("click",this,this.onStageClick),this.onStageMouseMove!==t.onStageMouseMove&&i.stage.on("mousemove",this,this.onStageMouseMove),this.onDoubleClick!==t.onDoubleClick&&this.owner.on("doubleclick",this,this.onDoubleClick),this.onRightClick!==t.onRightClick&&this.owner.on("rightclick",this,this.onRightClick),this.onMouseMove!==t.onMouseMove&&this.owner.on("mousemove",this,this.onMouseMove),this.onMouseOver!==t.onMouseOver&&this.owner.on("mouseover",this,this.onMouseOver),this.onMouseOut!==t.onMouseOut&&this.owner.on("mouseout",this,this.onMouseOut),this.onKeyDown!==t.onKeyDown&&i.stage.on("keydown",this,this.onKeyDown),this.onKeyPress!==t.onKeyPress&&i.stage.on("keypress",this,this.onKeyPress),this.onKeyUp!==t.onKeyUp&&i.stage.on("keyup",this,this.onKeyUp),this.onUpdate!==t.onUpdate&&i.updateTimer.frameLoop(1,this,this.onUpdate),this.onLateUpdate!==t.onLateUpdate&&i.lateTimer.frameLoop(1,this,this.onLateUpdate),this.onPreRender!==t.onPreRender&&i.lateTimer.frameLoop(1,this,this.onPreRender),this.onEnable()},n._onDisable=function(){this.owner.offAllCaller(this),i.stage.offAllCaller(this),i.startTimer.clearAll(this),i.updateTimer.clearAll(this),i.lateTimer.clearAll(this),this.onDisable()},n._onDestroy=function(){this.onDestroy()},n.onAwake=function(){},n.onEnable=function(){},n.onStart=function(){},n.onTriggerEnter=function(){},n.onTriggerStay=function(){},n.onTriggerExit=function(){},n.onMouseDown=function(){},n.onMouseUp=function(){},n.onClick=function(){},n.onStageMouseDown=function(){},n.onStageMouseUp=function(){},n.onStageClick=function(){},n.onStageMouseMove=function(){},n.onDoubleClick=function(){},n.onRightClick=function(){},n.onMouseMove=function(){},n.onMouseOver=function(){},n.onMouseOut=function(){},n.onKeyDown=function(){},n.onKeyPress=function(){},n.onKeyUp=function(){},n.onUpdate=function(){},n.onLateUpdate=function(){},n.onPreRender=function(){},n.onPostRender=function(){},n.onDisable=function(){},n.onDestroy=function(){},r(0,n,"isSingleton",function(){return!1}),e}(u),on=function(t){function e(){e.__super.call(this)}var i;return s(e,"eventUtil.EventCenter",t),r(1,e,"instance",function(){return null==e._eventCenter&&(e._eventCenter=new e(new i)),e._eventCenter},laya.events.EventDispatcher._$SET_instance),e.LOGIN_SUCESS="LOGIN_SUCESS",e.SELECT_FOLDER="SELECT_FOLDER",e.UPDATE_FILE_LIST="UPDATE_FILE_LIST",e.SELECT_PIC_ORDER="SELECT_PIC_ORDER",e.SELECT_ORDER_ADDRESS="SELECT_ORDER_ADDRESS",e.SELECT_OUT_ADDRESS="SELECT_OUT_ADDRESS",e.SELECT_DELIVERY_TYPE="SELECT_DELIVERY_TYPE",e.ADD_PIC_FOR_ORDER="ADD_PIC_FOR_ORDER",e.DELETE_PIC_ORDER="DELETE_PIC_ORDER",e.SHOW_SELECT_TECH="SHOW_SELECT_TECH",e.UPDATE_ORDER_ITEM_TECH="UPDATE_ORDER_ITEM_TECH",e.ADJUST_PIC_ORDER_TECH="ADJUST_PIC_ORDER_TECH",e.UPDATE_LOADING_PROGRESS="UPDATE_LOADING_PROGRESS",e.UPDATE_MYADDRESS_LIST="UPDATE_MYADDRESS_LIST",e.CANCAEL_UPLOAD_ITEM="CANCAEL_UPLOAD_ITEM",e.RE_UPLOAD_FILE="RE_UPLOAD_FILE",e.ADD_TECH_ATTACH="ADD_TECH_ATTACH",e.BROWER_WINDOW_RESIZE="BROWER_WINDOW_RESIZE",e.BATCH_CHANGE_PRODUCT_NUM="BATCH_CHANGE_PRODUCT_NUM",e.PAUSE_SCROLL_VIEW="PAUSE_SCROLL_VIEW",e.CLOSE_PANEL_VIEW="CLOSE_PANEL_VIEW",e.SHOW_CHARGE_VIEW="SHOW_CHARGE_VIEW",e.PAY_ORDER_SUCESS="PAY_ORDER_SUCESS",e.CANCEL_PAY_ORDER="CANCEL_PAY_ORDER",e._eventCenter=null,e.__init$=function(){i=function(){function t(){}return s(t,""),t}()},e}(l),hn=function(t){function e(){e.__super.call(this),this._id=++e._uniqueIDCounter,this._destroyed=!1,this._referenceCount=0,e._idResourcesMap[this.id]=this,this._released=!0,this.lock=!1,this._gpuMemory=0,Xi.currentResourceManager&&Xi.currentResourceManager.addResource(this)}s(e,"laya.resource.Resource",t);var n=e.prototype;return i.imps(n,{"laya.resource.ICreateResource":!0,"laya.resource.IDestroy":!0}),n._setCPUMemory=function(t){t-this._cpuMemory;this._cpuMemory=t},n._setGPUMemory=function(t){var e=t-this._gpuMemory;this._gpuMemory=t,this.resourceManager&&this.resourceManager.addSize(e)},n._setUrl=function(t){if(this._url!==t){var i;this._url&&(i=e._urlResourcesMap[this._url],i.splice(i.indexOf(this),1),0===i.length&&delete e._urlResourcesMap[this._url]),t&&(i=e._urlResourcesMap[t],i||(e._urlResourcesMap[t]=i=[]),i.push(this)),this._url=t}},n._getGroup=function(){return this._group},n._setGroup=function(t){if(this._group!==t){var i;this._group&&(i=e._groupResourcesMap[this._group],i.splice(i.indexOf(this),1),0===i.length&&delete e._groupResourcesMap[this._group]),t&&(i=e._groupResourcesMap[t],i||(e._groupResourcesMap[t]=i=[]),i.push(this)),this._group=t}},n._addReference=function(t){void 0===t&&(t=1),this._referenceCount+=t},n._removeReference=function(t){void 0===t&&(t=1),this._referenceCount-=t},n._clearReference=function(){this._referenceCount=0},n._completeLoad=function(){this._released=!1},n._recoverResource=function(){},n._disposeResource=function(){},n._activeResource=function(){this._released=!1},n._onAsynLoaded=function(){throw new Error("Resource: must override this function!")},n.releaseResource=function(t){return void 0===t&&(t=!1),!t&&this.lock?!1:!this._released||t?(this._disposeResource(),this._released=!0,!0):!1},n.destroy=function(){if(!this._destroyed){null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete e._idResourcesMap[this.id];var t;if(this._url){t=e._urlResourcesMap[this._url],t&&(t.splice(t.indexOf(this),1),0===t.length&&delete e._urlResourcesMap[this.url]);var i=un.getRes(this._url);i==this&&delete un.loadedMap[this._url],qi.cancelLoadByUrl(this._url)}this._group&&(t=e._groupResourcesMap[this._group],t.splice(t.indexOf(this),1),0===t.length&&delete e._groupResourcesMap[this.url])}},r(0,n,"id",function(){return this._id}),r(0,n,"released",function(){return this._released}),r(0,n,"url",function(){return this._url}),r(0,n,"gpuMemory",function(){return this._gpuMemory}),r(0,n,"group",function(){return this._getGroup()},function(t){this._setGroup(t)}),r(0,n,"destroyed",function(){return this._destroyed}),r(0,n,"resourceManager",function(){return this._resourceManager}),r(0,n,"cpuMemory",function(){return this._cpuMemory}),r(0,n,"referenceCount",function(){return this._referenceCount}),e.getResourceByID=function(t){return e._idResourcesMap[t]},e.getResourceByURL=function(t,i){return void 0===i&&(i=0),e._urlResourcesMap[t][i]},e.destroyUnusedResources=function(t){var i;if(t){var n=e._groupResourcesMap[t];if(n)for(var s=n.slice(),r=0,a=s.length;a>r;r++)i=s[r],i.lock||0!==i._referenceCount||i.destroy()}else for(var o in e._idResourcesMap)i=e._idResourcesMap[o],i.lock||0!==i._referenceCount||i.destroy()},e._uniqueIDCounter=0,e._idResourcesMap={},e._urlResourcesMap={},e._groupResourcesMap={},e}(l),ln=function(t){function e(){this.url=null,this.loops=0,this.startTime=0/0,this.isStopped=!1,this.completeHandler=null,e.__super.call(this)}s(e,"laya.media.SoundChannel",t);var i=e.prototype;return i.play=function(){},i.stop=function(){},i.pause=function(){},i.resume=function(){},i.__runComplete=function(t){t&&t.run()},r(0,i,"volume",function(){return 1},function(){}),r(0,i,"position",function(){return 0}),r(0,i,"duration",function(){return 0}),e}(l),_n=function(t){function e(t,i,n,s){this.uvrect=[0,0,1,1],this._w=0,this._h=0,this._destroyed=!1,this._referenceCount=0,this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this.scaleRate=1,e.__super.call(this),void 0===n&&(n=0),void 0===s&&(s=0),this.setTo(t,i,n,s)}s(e,"laya.resource.Texture",t);var n=e.prototype;return n._addReference=function(){this._bitmap&&this._bitmap._addReference(),this._referenceCount++},n._removeReference=function(){this._bitmap&&this._bitmap._removeReference(),this._referenceCount--},n._getSource=function(){return this._destroyed||!this._bitmap?null:(this.recoverBitmap(),this._bitmap.destroyed?null:this.bitmap._getSource())},n._onLoaded=function(t,i){if(i)if(i==this);else if(i instanceof laya.resource.Texture){var n=i;e._create(i,0,0,n.width,n.height,0,0,n.sourceWidth,n.sourceHeight,this)}else this.bitmap=i,this.sourceWidth=this._w=i.width,this.sourceHeight=this._h=i.height;else;t&&t.run(),this.event("ready",this)},n.getIsReady=function(){return this._destroyed?!1:this._bitmap?!0:!1},n.setTo=function(t,i,n,s){if(void 0===n&&(n=0),void 0===s&&(s=0),this.bitmap=t,this.sourceWidth=n,this.sourceHeight=s,t){this._w=t.width,this._h=t.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h}this.uv=i||e.DEF_UV},n.load=function(t,e){this._destroyed||i.loader.load(t,_.create(this,this._onLoaded,[e]),null,"htmlimage",1,!1,null,!0)},n.getPixels=function(t,e,i,n){if(Ni.isWebGL)return qi.getTexturePixels(this,t,e,i,n);if(Ni.isConchApp)return this._nativeObj.getImageData(t,e,i,n);var s=this.width,r=this.height;if(t+i>s&&(i-=t+i-s),e+n>r&&(n-=e+n-r),0>=i||0>=n)return null;Be.canvas.size(i,n),Be.canvas.clear(),Be.context.drawImage(this.bitmap._source,t,e,i,n,0,0,i,n);var a=Be.context.getImageData(0,0,i,n);return a.data},n.recoverBitmap=function(){this._destroyed||this._bitmap&&!this._bitmap.destroyed||!this.url||this.load(this.url)},n.disposeBitmap=function(){!this._destroyed&&this._bitmap&&this._bitmap.destroy()},n.destroy=function(){this._destroyed||(this._destroyed=!0,this.bitmap&&(this.bitmap._removeReference(this._referenceCount),this.bitmap=null),this.url&&this===i.loader.getRes(this.url)&&i.loader.clearRes(this.url))},r(0,n,"height",function(){return this._h?this._h:this.bitmap?this.uv&&this.uv!==e.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height:0},function(t){this._h=t,this.sourceHeight||(this.sourceHeight=t)}),r(0,n,"uv",function(){return this._uv},function(t){this.uvrect[0]=Math.min(t[0],t[2],t[4],t[6]),this.uvrect[1]=Math.min(t[1],t[3],t[5],t[7]),this.uvrect[2]=Math.max(t[0],t[2],t[4],t[6])-this.uvrect[0],this.uvrect[3]=Math.max(t[1],t[3],t[5],t[7])-this.uvrect[1],this._uv=t}),r(0,n,"width",function(){return this._w?this._w:this.bitmap?this.uv&&this.uv!==e.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width:0},function(t){this._w=t,this.sourceWidth||(this.sourceWidth=t)}),r(0,n,"bitmap",function(){return this._bitmap},function(t){this._bitmap&&this._bitmap._removeReference(this._referenceCount),this._bitmap=t,t&&t._addReference(this._referenceCount)}),r(0,n,"destroyed",function(){return this._destroyed}),e.moveUV=function(t,e,i){for(var n=0;8>n;n+=2)i[n]+=t,i[n+1]+=e;return i},e.create=function(t,i,n,s,r,a,o,h,l){return void 0===a&&(a=0),void 0===o&&(o=0),void 0===h&&(h=0),void 0===l&&(l=0),e._create(t,i,n,s,r,a,o,h,l)},e._create=function(t,i,n,s,r,a,o,h,l,_){void 0===a&&(a=0),void 0===o&&(o=0),void 0===h&&(h=0),void 0===l&&(l=0);var u=t instanceof laya.resource.Texture,c=u?t.uv:e.DEF_UV,d=u?t.bitmap:t;d.width&&i+s>d.width&&(s=d.width-i),d.height&&n+r>d.height&&(r=d.height-n);var f;_?(f=_,f.setTo(d,null,h||s,l||r)):f=new e(d,null,h||s,l||r),f.width=s,f.height=r,f.offsetX=a,f.offsetY=o;var p=1/d.width,m=1/d.height;i*=p,n*=m,s*=p,r*=m;var g=f.uv[0],v=f.uv[1],y=f.uv[4],E=f.uv[5],S=y-g,A=E-v,C=e.moveUV(c[0],c[1],[i,n,i+s,n,i+s,n+r,i,n+r]);f.uv=[g+C[0]*S,v+C[1]*A,y-(1-C[2])*S,v+C[3]*A,y-(1-C[4])*S,E-(1-C[5])*A,g+C[6]*S,E-(1-C[7])*A];var D=d.scaleRate;return D&&1!=D?(f.sourceWidth/=D,f.sourceHeight/=D,f.width/=D,f.height/=D,f.scaleRate=D):f.scaleRate=1,f},e.createFromTexture=function(t,i,n,s,r){var a=t.scaleRate;1!=a&&(i*=a,n*=a,s*=a,r*=a);var o=He.TEMP.setTo(i-t.offsetX,n-t.offsetY,s,r),h=o.intersection(e._rect1.setTo(0,0,t.width,t.height),e._rect2);if(!h)return null;var l=e.create(t,h.x,h.y,h.width,h.height,h.x-o.x,h.y-o.y,s,r);return l},e.DEF_UV=[0,0,1,0,1,1,0,1],e.NO_UV=[0,0,0,0,0,0,0,0],e.INV_UV=[0,1,1,1,1,0,0,0],e._rect1=new He,e._rect2=new He,e}(l),un=function(t){function e(){this._data=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._useWorkerLoader=!1,this._customParse=!1,this._constructParams=null,this._propertyParams=null,this._createCache=!1,e.__super.call(this)}s(e,"laya.net.Loader",t);var n=e.prototype;return n.load=function(t,i,n,s,r,a){if(void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===a&&(a=!1),!t)return this.onLoaded(null),void 0;if(e.setGroup(t,"666"),this._url=t,0===t.indexOf("data:image")?i="image":t=Mi.formatURL(t),this._type=i||(i=e.getTypeFromUrl(t)),this._cache=n,this._useWorkerLoader=a,this._data=null,a&&yn.enableWorkerLoader(),!r&&e.loadedMap[t])return this._data=e.loadedMap[t],this.event("progress",1),this.event("complete",this._data),void 0;
if(s&&e.setGroup(t,s),null!=e.parserMap[i])return this._customParse=!0,e.parserMap[i]instanceof laya.utils.Handler?e.parserMap[i].runWith(this):e.parserMap[i].call(null,this),void 0;if("image"===i||"htmlimage"===i||"nativeimage"===i)return this._loadImage(t);if("sound"===i)return this._loadSound(t);if("ttf"===i)return this._loadTTF(t);var o;switch(i){case"atlas":case"prefab":case"plf":o="json";break;case"font":o="xml";break;default:o=i}e.preLoadedMap[t]?this.onLoaded(e.preLoadedMap[t]):(this._http||(this._http=new fn,this._http.on("progress",this,this.onProgress),this._http.on("error",this,this.onError),this._http.on("complete",this,this.onLoaded)),this._http.send(t,null,"get",o))},n._loadTTF=function(t){t=Mi.formatURL(t);var e=new G;e.complete=_.create(this,this.onLoaded),e.load(t)},n._loadImage=function(t){function i(){var i=n;i&&(i.onload=null,i.onerror=null,delete e._imgCache[t])}t=Mi.formatURL(t);var n,s=this,r=function(){i(),s.event("error","Load image failed")};if("nativeimage"===this._type){var a=function(){i(),s.onLoaded(n)};n=new Be.window.Image,n.crossOrigin="",n.onload=a,n.onerror=r,n.src=t,e._imgCache[t]=n}else{var o=new Be.window.Image;a=function(){n=Ms.create(o.width,o.height),n.loadImageSource(o,!0),n._setUrl(t),i(),s.onLoaded(n)},o.crossOrigin="",o.onload=a,o.onerror=r,o.src=t,n=o,e._imgCache[t]=o}},n._loadSound=function(t){function e(){n(),r.onLoaded(s)}function i(){n(),s.dispose(),r.event("error","Load sound failed")}function n(){s.offAll()}var s=new Gi._soundClass,r=this;s.on("complete",this,e),s.on("error",this,i),s.load(t)},n.onProgress=function(t){"atlas"===this._type?this.event("progress",.3*t):this.event("progress",t)},n.onError=function(t){this.event("error",t)},n.onLoaded=function(t){var i=this._type;if("plf"==i)this.parsePLFData(t),this.complete(t);else if("image"===i){var n=new _n(t);n.url=this._url,this.complete(n)}else if("sound"===i||"htmlimage"===i||"nativeimage"===i)this.complete(t);else if("atlas"===i){if(!t.url&&!t._setContext){if(!this._data){if(this._data=t,t.meta&&t.meta.image)for(var s=t.meta.image.split(","),r=this._url.indexOf("/")>=0?"/":"\\",a=this._url.lastIndexOf(r),o=a>=0?this._url.substr(0,a+1):"",h=0,l=s.length;l>h;h++)s[h]=o+s[h];else s=[this._url.replace(".json",".png")];s.reverse(),t.toLoads=s,t.pics=[]}return this.event("progress",.3+1/s.length*.6),this._loadImage(s.pop())}if(this._data.pics.push(t),this._data.toLoads.length>0)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var _=this._data.frames,u=this._url.split("?")[0],c=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:u.substring(0,u.lastIndexOf("."))+"/",d=this._data.pics,f=Mi.formatURL(this._url),p=e.atlasMap[f]||(e.atlasMap[f]=[]);p.dir=c;var m=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale){m=parseFloat(this._data.meta.scale);for(var g in _){var v=_[g],y=d[v.frame.idx?v.frame.idx:0],E=Mi.formatURL(c+g);y.scaleRate=m;var S;S=_n._create(y,v.frame.x,v.frame.y,v.frame.w,v.frame.h,v.spriteSourceSize.x,v.spriteSourceSize.y,v.sourceSize.w,v.sourceSize.h,laya.net.Loader.getRes(E)),e.cacheRes(E,S),S.url=E,p.push(E)}}else for(g in _)v=_[g],y=d[v.frame.idx?v.frame.idx:0],E=Mi.formatURL(c+g),S=_n._create(y,v.frame.x,v.frame.y,v.frame.w,v.frame.h,v.spriteSourceSize.x,v.spriteSourceSize.y,v.sourceSize.w,v.sourceSize.h,laya.net.Loader.getRes(E)),e.cacheRes(E,S),S.url=E,p.push(E);delete this._data.pics,this.complete(this._data)}else if("font"===i){if(!t._source)return this._data=t,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var A=new ie;A.parseFont(this._data,new _n(t));var C=this._url.split(".fnt")[0].split("/"),D=C[C.length-1];Cs.registerBitmapFont(D,A),this._data=A,this.complete(this._data)}else if("prefab"===i){var x=new ei;x.json=t,this.complete(x)}else this.complete(t)},n.parsePLFData=function(t){var i,n,s;for(i in t)switch(s=t[i],i){case"json":case"text":for(n in s)e.preLoadedMap[Mi.formatURL(n)]=s[n];break;default:for(n in s)e.preLoadedMap[Mi.formatURL(n)]=s[n]}},n.complete=function(t){this._data=t,this._customParse?this.event("loaded",t instanceof Array?[t]:t):(e._loaders.push(this),e._isWorking||e.checkNext())},n.endLoad=function(t){t&&(this._data=t),this._cache&&e.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},r(0,n,"url",function(){return this._url}),r(0,n,"data",function(){return this._data}),r(0,n,"cache",function(){return this._cache}),r(0,n,"type",function(){return this._type}),e.getTypeFromUrl=function(t){var i=ee.getFileExtension(t);return i?e.typeMap[i]:(console.warn("Not recognize the resources suffix",t),"text")},e.checkNext=function(){e._isWorking=!0;for(var t=Be.now(),n=t;e._startIndex<e._loaders.length;)if(n=Be.now(),e._loaders[e._startIndex].endLoad(),e._startIndex++,Be.now()-t>e.maxTimeOut)return console.warn("loader callback cost a long time:"+(Be.now()-t)+" url="+e._loaders[e._startIndex-1].url),i.systemTimer.frameOnce(1,null,e.checkNext),void 0;e._loaders.length=0,e._startIndex=0,e._isWorking=!1},e.clearRes=function(t){t=Mi.formatURL(t);var i=e.getAtlas(t);if(i){for(var n=0,s=i.length;s>n;n++){var r=i[n],a=e.getRes(r);delete e.loadedMap[r],a&&a.destroy()}i.length=0,delete e.atlasMap[t],delete e.loadedMap[t]}else{var o=e.loadedMap[t];o&&(delete e.loadedMap[t],o instanceof laya.resource.Texture&&o.bitmap&&o.destroy())}},e.clearTextureRes=function(t){t=Mi.formatURL(t);var e=laya.net.Loader.getAtlas(t),i=e&&e.length>0?laya.net.Loader.getRes(e[0]):laya.net.Loader.getRes(t);i instanceof laya.resource.Texture&&i.disposeBitmap()},e.getRes=function(t){return e.loadedMap[Mi.formatURL(t)]},e.getAtlas=function(t){return e.atlasMap[Mi.formatURL(t)]},e.cacheRes=function(t,i){t=Mi.formatURL(t),null!=e.loadedMap[t]?console.warn("Resources already exist,is repeated loading:",t):e.loadedMap[t]=i},e.setGroup=function(t,i){e.groupMap[i]||(e.groupMap[i]=[]),e.groupMap[i].push(t)},e.clearResByGroup=function(t){if(e.groupMap[t]){var i=e.groupMap[t],n=0,s=i.length;for(n=0;s>n;n++)e.clearRes(i[n]);i.length=0}},e.TEXT="text",e.JSON="json",e.PREFAB="prefab",e.XML="xml",e.BUFFER="arraybuffer",e.IMAGE="image",e.SOUND="sound",e.ATLAS="atlas",e.FONT="font",e.TTF="ttf",e.PLF="plf",e.HIERARCHY="HIERARCHY",e.MESH="MESH",e.MATERIAL="MATERIAL",e.TEXTURE2D="TEXTURE2D",e.TEXTURECUBE="TEXTURECUBE",e.ANIMATIONCLIP="ANIMATIONCLIP",e.AVATAR="AVATAR",e.TERRAINHEIGHTDATA="TERRAINHEIGHTDATA",e.TERRAINRES="TERRAIN",e.typeMap={ttf:"ttf",png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",prefab:"prefab",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",plf:"plf",scene:"json",ani:"json",sk:"arraybuffer"},e.parserMap={},e.maxTimeOut=100,e.groupMap={},e.loadedMap={},e.atlasMap={},e.preLoadedMap={},e._imgCache={},e._loaders=[],e._isWorking=!1,e._startIndex=0,e}(l),cn=function(t){function e(){this.retryNum=4,this.retryDelay=1e3,this.maxLoader=5,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},this._statInfo={count:1,loaded:1},e.__super.call(this);for(var t=0;t<this._maxPriority;t++)this._resInfos[t]=[]}var r;s(e,"laya.net.LoaderManager",t);var a=e.prototype;return a.getProgress=function(){return this._statInfo.loaded/this._statInfo.count},a.resetProgress=function(){this._statInfo.count=this._statInfo.loaded=1},a.create=function(t,e,i,n,s,r,a,o){void 0===a&&(a=1),void 0===o&&(o=!0),this._create(t,!0,e,i,n,s,r,a,o)},a._create=function(t,e,i,n,s,r,a,o,h){function l(t){f++,t.progress=1,f===d&&i&&i.run()}function u(t,e){t.progress=e;for(var i=0,n=0;d>n;n++){var s=c[n];i+=s.progress}var r=i/d;p.runWith(r)}if(void 0===o&&(o=1),void 0===h&&(h=!0),t instanceof Array){var c=t,d=c.length,f=0;if(n)var p=_.create(n.caller,n.method,n.args,!1);for(var m=0;d>m;m++){var g=c[m];"string"==typeof g&&(g=c[m]={url:g}),g.progress=0}for(m=0;d>m;m++){g=c[m];var v=n?_.create(null,u,[g],!1):null,y=n||i?_.create(null,l,[g]):null;this._createOne(g.url,e,y,v,g.type||s,g.constructParams||r,g.propertyParams||a,g.priority||o,h)}}else this._createOne(t,e,i,n,s,r,a,o,h)},a._createOne=function(t,n,s,r,a,o,h,l,u){function c(e){!n&&e instanceof laya.resource.Resource&&e._addReference(),s&&s.runWith(e),i.loader.event(t)}void 0===l&&(l=1),void 0===u&&(u=!0);var d=this.getRes(t);if(d)!n&&d instanceof laya.resource.Resource&&d._addReference(),r&&r.runWith(1),s&&s.runWith(d);else{var f=ee.getFileExtension(t);if(a||(a=e.createMap[f]?e.createMap[f][0]:null),!a)return this.load(t,s,r,a,l,u),void 0;var p=un.parserMap;if(!p[a])return this.load(t,s,r,a,l,u),void 0;this._createLoad(t,_.create(null,c),r,a,o,h,l,u,!0)}},a.load=function(t,n,s,a,o,h,l,_,u){var c=this;if(void 0===o&&(o=1),void 0===h&&(h=!0),void 0===_&&(_=!0),void 0===u&&(u=!1),t instanceof Array)return this._loadAssets(t,n,s,a,o,h,l);var d=un.getRes(t);if(_||null==d){var f;f=t,t=Ii.getFileLoadPath(t),t!=f&&"nativeimage"!==a?a="atlas":f=null;var p=e._resMap[t];p?(n&&(f?n&&p._createListener("complete",this,this._resInfoLoaded,[f,n],!1,!1):n&&p._createListener("complete",n.caller,n.method,n.args,!1,!1)),s&&p._createListener("progress",s.caller,s.method,s.args,!1,!1)):(p=this._infoPool.length?this._infoPool.pop():new r,p.url=t,p.type=a,p.cache=h,p.group=l,p.ignoreCache=_,p.useWorkerLoader=u,p.originalUrl=f,n&&p.on("complete",n.caller,n.method,n.args),s&&p.on("progress",s.caller,s.method,s.args),e._resMap[t]=p,o=o<this._maxPriority?o:this._maxPriority-1,this._resInfos[o].push(p),this._statInfo.count++,this.event("progress",this.getProgress()),this._next())}else i.systemTimer.frameOnce(1,null,function(){s&&s.runWith(1),n&&n.runWith(d),c._loaderCount||c.event("complete")});return this},a._resInfoLoaded=function(t,e){e.runWith(un.getRes(t))},a._createLoad=function(t,n,s,a,o,h,l,_,u){var c=this;if(void 0===l&&(l=1),void 0===_&&(_=!0),void 0===u&&(u=!1),t instanceof Array)return this._loadAssets(t,n,s,a,l,_);var d=un.getRes(t);if(null!=d)i.systemTimer.frameOnce(1,null,function(){s&&s.runWith(1),n&&n.runWith(d),c._loaderCount||c.event("complete")});else{var f=e._resMap[t];f?(n&&f._createListener("complete",n.caller,n.method,n.args,!1,!1),s&&f._createListener("progress",s.caller,s.method,s.args,!1,!1)):(f=this._infoPool.length?this._infoPool.pop():new r,f.url=t,f.type=a,f.cache=!1,f.ignoreCache=u,f.originalUrl=null,f.createCache=_,f.createConstructParams=o,f.createPropertyParams=h,n&&f.on("complete",n.caller,n.method,n.args),s&&f.on("progress",s.caller,s.method,s.args),e._resMap[t]=f,l=l<this._maxPriority?l:this._maxPriority-1,this._resInfos[l].push(f),this._statInfo.count++,this.event("progress",this.getProgress()),this._next())}return this},a._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var t=0;t<this._maxPriority;t++)for(var e=this._resInfos[t];e.length>0;){var i=e.shift();if(i)return this._doLoad(i)}this._loaderCount||this.event("complete")}},a._doLoad=function(t){function e(e){i.offAll(),i._data=null,i._customParse=!1,n._loaders.push(i),n._endLoad(t,e instanceof Array?[e]:e),n._loaderCount--,n._next()}this._loaderCount++;var i=this._loaders.length?this._loaders.pop():new un;i.on("complete",null,e),i.on("progress",null,function(e){t.event("progress",e)}),i.on("error",null,function(){e(null)});var n=this;i._constructParams=t.createConstructParams,i._propertyParams=t.createPropertyParams,i._createCache=t.createCache,i.load(t.url,t.type,t.cache,t.group,t.ignoreCache,t.useWorkerLoader)},a._endLoad=function(t,n){var s=t.url;if(null==n){var r=this._failRes[s]||0;if(r<this.retryNum)return console.warn("[warn]Retry to load:",s),this._failRes[s]=r+1,i.systemTimer.once(this.retryDelay,this,this._addReTry,[t],!1),void 0;un.clearRes(s),console.warn("[error]Failed to load:",s),this.event("error",s)}this._failRes[s]&&(this._failRes[s]=0),delete e._resMap[s],t.originalUrl&&(n=un.getRes(t.originalUrl)),t.event("complete",n),t.offAll(),this._infoPool.push(t),this._statInfo.loaded++,this.event("progress",this.getProgress())},a._addReTry=function(t){this._resInfos[this._maxPriority-1].push(t),this._next()},a.clearRes=function(t){un.clearRes(t)},a.clearTextureRes=function(t){un.clearTextureRes(t)},a.getRes=function(t){return un.getRes(t)},a.cacheRes=function(t,e){un.cacheRes(t,e)},a.setGroup=function(t,e){un.setGroup(t,e)},a.clearResByGroup=function(t){un.clearResByGroup(t)},a.clearUnLoaded=function(){for(var t=0;t<this._maxPriority;t++){for(var i=this._resInfos[t],n=i.length-1;n>-1;n--){var s=i[n];s&&(s.offAll(),this._infoPool.push(s))}i.length=0}this._loaderCount=0,e._resMap={}},a.cancelLoadByUrls=function(t){if(t)for(var e=0,i=t.length;i>e;e++)this.cancelLoadByUrl(t[e])},a.cancelLoadByUrl=function(t){for(var i=0;i<this._maxPriority;i++)for(var n=this._resInfos[i],s=n.length-1;s>-1;s--){var r=n[s];r&&r.url===t&&(n[s]=null,r.offAll(),this._infoPool.push(r))}e._resMap[t]&&delete e._resMap[t]},a._loadAssets=function(t,e,i,n,s,r,a){function o(t,i){u++,t.progress=1,i||(f=!1),u===l&&e&&e.runWith(f)}function h(t,e){if(null!=i){t.progress=e;for(var n=0,s=0;s<d.length;s++){var r=d[s];n+=r.size*r.progress}var a=n/c;i.runWith(a)}}void 0===s&&(s=1),void 0===r&&(r=!0);for(var l=t.length,u=0,c=0,d=[],f=!0,p=0;l>p;p++){var m=t[p];"string"==typeof m&&(m={url:m,type:n,size:1,priority:s}),m.size||(m.size=1),m.progress=0,c+=m.size,d.push(m);var g=i?_.create(null,h,[m],!1):null,v=e||i?_.create(null,o,[m]):null;this.load(m.url,v,g,m.type,m.priority||1,r,m.group||a,!1,m.useWorkerLoader)}return this},a.decodeBitmaps=function(t){var e,i=0,n=t.length;for(e=Ni._context,i=0;n>i;i++){var s;if(s=un.getAtlas(t[i]))this._decodeTexture(s[0],e);else{var r;r=this.getRes(t[i]),r&&r instanceof laya.resource.Texture&&this._decodeTexture(r,e)}}},a._decodeTexture=function(t,e){var n=t.bitmap;if(t&&n){var s=n.source||n.image;if(s&&i.__typeof(s,Be.window.HTMLImageElement)){e.drawImage(s,0,0,1,1);{e.getImageData(0,0,1,1)}}}},e.cacheRes=function(t,e){un.cacheRes(t,e)},e._resMap={},n(e,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),e.__init$=function(){r=function(t){function e(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.useWorkerLoader=!1,this.originalUrl=null,this.createCache=!1,this.createConstructParams=null,this.createPropertyParams=null,e.__super.call(this)}return s(e,"",t),e}(l)},e}(l),dn=function(t){function e(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,e.__super.call(this)}s(e,"laya.media.webaudio.WebAudioSound",t);var i=e.prototype;return i.load=function(t){var i=this;if(t=Mi.formatURL(t),this.url=t,this.audioBuffer=e._dataCache[t],this.audioBuffer)return this._loaded(this.audioBuffer),void 0;if(e.e.on("loaded:"+t,this,this._loaded),e.e.on("err:"+t,this,this._err),!e.__loadingSound[t]){e.__loadingSound[t]=!0;var n=new Be.window.XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){return i._disposed?(i._removeLoadEvents(),void 0):(i.data=n.response,e.buffs.push({buffer:i.data,url:i.url}),e.decode(),void 0)},n.onerror=function(){i._err()},n.send()}},i._err=function(){this._removeLoadEvents(),e.__loadingSound[this.url]=!1,this.event("error")},i._loaded=function(t){this._removeLoadEvents(),this._disposed||(this.audioBuffer=t,e._dataCache[this.url]=this.audioBuffer,this.loaded=!0,this.event("complete"))},i._removeLoadEvents=function(){e.e.off("loaded:"+this.url,this,this._loaded),e.e.off("err:"+this.url,this,this._err)},i.__playAfterLoaded=function(){if(this.__toPlays){var t,e=0,i=0;t=this.__toPlays,i=t.length;var n;for(e=0;i>e;e++)n=t[e],n[2]&&!n[2].isStopped&&this.play(n[0],n[1],n[2]);this.__toPlays.length=0}},i.play=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),i=i?i:new gs,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([t,e,i]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),i.url=this.url,i.loops=e,i.audioBuffer=this.audioBuffer,i.startTime=t,i.play(),Gi.addChannel(i),i},i.dispose=function(){this._disposed=!0,delete e._dataCache[this.url],delete e.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},r(0,i,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),e.decode=function(){e.buffs.length<=0||e.isDecoding||(e.isDecoding=!0,e.tInfo=e.buffs.shift(),e.ctx.decodeAudioData(e.tInfo.buffer,e._done,e._fail))},e._done=function(t){e.e.event("loaded:"+e.tInfo.url,t),e.isDecoding=!1,e.decode()},e._fail=function(){e.e.event("err:"+e.tInfo.url,null),e.isDecoding=!1,e.decode()},e._playEmptySound=function(){if(null!=e.ctx){var t=e.ctx.createBufferSource();t.buffer=e._miniBuffer,t.connect(e.ctx.destination),t.start(0,0,0)}},e._unlock=function(){e._unlocked||(e._playEmptySound(),"running"==e.ctx.state&&(Be.document.removeEventListener("mousedown",e._unlock,!0),Be.document.removeEventListener("touchend",e._unlock,!0),Be.document.removeEventListener("touchstart",e._unlock,!0),e._unlocked=!0))},e.initWebAudio=function(){"running"!=e.ctx.state&&(e._unlock(),Be.document.addEventListener("mousedown",e._unlock,!0),Be.document.addEventListener("touchend",e._unlock,!0),Be.document.addEventListener("touchstart",e._unlock,!0))},e._dataCache={},e.buffs=[],e.isDecoding=!1,e._unlocked=!1,e.tInfo=null,e.__loadingSound={},n(e,["window",function(){return this.window=Be.window},"webAudioEnabled",function(){return this.webAudioEnabled=e.window.AudioContext||e.window.webkitAudioContext||e.window.mozAudioContext},"ctx",function(){return this.ctx=e.webAudioEnabled?new(e.window.AudioContext||e.window.webkitAudioContext||e.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=e.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new l}]),e}(l),fn=(function(t){function e(){e.__super.call(this)}s(e,"laya.media.Sound",t);var i=e.prototype;return i.load=function(){},i.play=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),null},i.dispose=function(){},r(0,i,"duration",function(){return 0}),e}(l),function(t){function e(){this._responseType=null,this._data=null,this._url=null,this.timeout=!1,e.__super.call(this),this._http=new Be.window.XMLHttpRequest}s(e,"laya.net.HttpRequest",t);var n=e.prototype;return n.send=function(t,e,n,s,r){var a=this;void 0===n&&(n="get"),void 0===s&&(s="text"),this._responseType=s,this._data=null,this._url=t;var o=this,h=this._http;if(i.timer.once(15e3,this,this.onTimeOut),t=Mi.getAdptedFilePath(t),h.open(n,t,!0),r)for(var l=0;l<r.length;l++)h.setRequestHeader(r[l++],r[l]);else Ni.isConchApp||(e&&"string"!=typeof e?h.setRequestHeader("Content-Type","application/json"):h.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));h.responseType="arraybuffer"!==s?"text":"arraybuffer",h.onerror=function(t){o._onError(t),i.timer.clear(o,a.onTimeOut)},h.onabort=function(t){o._onAbort(t),i.timer.clear(o,a.onTimeOut)},h.onprogress=function(t){o._onProgress(t)},h.onload=function(t){o._onLoad(t)},h.send(e)},n.onTimeOut=function(){this.timeout=!0,this.http.abort(),v.showAlert("请求超时，请重试")},n._onProgress=function(t){t&&t.lengthComputable&&this.event("progress",t.loaded/t.total)},n._onAbort=function(){this.error("Request was aborted by user")},n._onError=function(){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},n._onLoad=function(){var t=this._http,e=void 0!==t.status?t.status:200;if(200===e||204===e||0===e){if(i.timer.clear(this,this.onTimeOut),this.timeout)return;this.complete()}else this.error("["+t.status+"]"+t.statusText+":"+t.responseURL)},n.error=function(t){this.clear(),console.warn(this.url,t),this.event("error",t)},n.complete=function(){this.clear();var t=!0;try{this._data="json"===this._responseType?JSON.parse(this._http.responseText):"xml"===this._responseType?ee.parseXMLFromString(this._http.responseText):this._http.response||this._http.responseText}catch(e){t=!1,this.error(e.message)}t&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},n.clear=function(){var t=this._http;t.onerror=t.onabort=t.onprogress=t.onload=null},r(0,n,"url",function(){return this._url}),r(0,n,"http",function(){return this._http}),r(0,n,"data",function(){return this._data}),e}(l)),pn=function(t){function e(){if(this._drawTriUseAbsMatrix=!1,this._id=++e._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._renderCount=0,this._isConvexCmd=!0,this._submits=null,this._curSubmit=null,this.meshlist=[],this._clipInfoID=0,this._lastMatScaleX=1,this._lastMatScaleY=1,this._lastMat_a=1,this._lastMat_b=0,this._lastMat_c=0,this._lastMat_d=1,this._nBlendType=0,this._saveMark=null,this._drawTextureUseColor=!1,this._italicDeg=0,this._lastTex=null,this._fillColor=0,this._flushCnt=0,this.drawTexAlign=!1,this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,e.__super.call(this),this._width=99999999,this._height=99999999,this._submitKey=new Ze,this._transedPoints=new Array(8),this._temp4Points=new Array(8),this._clipRect=e.MAXCLIPRECT,this._globalClipMatrix=new fi(99999999,0,0,99999999,0,0),this._shader2D=new Bi,this.mOutPoint,e._contextcount++,!e.defTexture){var t=new nr(2,2);t.setPixels(new Uint8Array(16)),e.defTexture=new _n(t)}this._lastTex=e.defTexture,this.clear()}var a;s(e,"laya.webgl.canvas.WebGLContext2D",t);var l=e.prototype;return l.clearBG=function(t,e,i,n){var s=Oi.mainContext;s.clearColor(t,e,i,n),s.clear(16384)},l._getSubmits=function(){return this._submits},l._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var t=0,e=this._submits._length;e>t;t++)this._submits[t].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path=null,this._save=null;var i=0;for(t=0,i=this.meshlist.length;i>t;t++){var n=this.meshlist[t];n.destroy()}this.meshlist.length=0,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}},l.destroy=function(){--e._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._mesh.destroy()},l.clear=function(){this._submits||(this._other=a.DEFAULT,this._curMat=fi.create(),this._mesh=In.getAMesh(),this.meshlist.push(this._mesh),this._pathMesh=vn.getAMesh(),this.meshlist.push(this._pathMesh),this._triangleMesh=bn.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits=[],this._save=[ni.Create(this)],this._save.length=10,this._shader2D=new Bi),this._submitKey.clear(),this._mesh.clearVB(),this._renderCount++,this._drawCount=1,this._other=a.DEFAULT,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=e.MAXCLIPRECT,this._curSubmit=K.RENDERBASE,K.RENDERBASE._ref=16777215,K.RENDERBASE._numEle=0,this._shader2D.fillStyle=this._shader2D.strokeStyle=ki.DEFAULT;for(var t=0,i=this._submits._length;i>t;t++)this._submits[t].releaseRender();this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},l.size=function(t,e){(this._width!=t||this._height!=e)&&(this._width=t,this._height=e,this._targets&&(this._targets.destroy(),this._targets=new ir(t,e,1,-1)),Ni._context==this&&(Oi.mainContext.viewport(0,0,t,e),pi.width=t,pi.height=e)),0===t&&0===e&&this._releaseMem()},l.getMatScaleX=function(){return this._lastMat_a==this._curMat.a&&this._lastMat_b==this._curMat.b?this._lastMatScaleX:(this._lastMatScaleX=this._curMat.getScaleX(),this._lastMat_a=this._curMat.a,this._lastMat_b=this._curMat.b,this._lastMatScaleX)},l.getMatScaleY=function(){return this._lastMat_c==this._curMat.c&&this._lastMat_d==this._curMat.d?this._lastMatScaleY:(this._lastMatScaleY=this._curMat.getScaleY(),this._lastMat_c=this._curMat.c,this._lastMat_d=this._curMat.d,this._lastMatScaleY)},l.setFillColor=function(t){this._fillColor=t},l.getFillColor=function(){return this._fillColor},l.translate=function(t,e){(0!==t||0!==e)&&(ji.save(this),this._curMat._bTransform?(oe.save(this),this._curMat.tx+=t*this._curMat.a+e*this._curMat.c,this._curMat.ty+=t*this._curMat.b+e*this._curMat.d):(this._curMat.tx=t,this._curMat.ty=e))},l.save=function(){this._save[this._save._length++]=ni.Create(this)},l.restore=function(){var t=this._save._length,e=this._nBlendType;if(!(1>t)){for(var i=t-1;i>=0;i--){var n=this._save[i];if(n.restore(this),n.isSaveMark())return this._save._length=i,void 0}e!=this._nBlendType&&(this._curSubmit=K.RENDERBASE)}},l.fillText=function(t,e,i,n,s){this._fillText(t,null,e,i,n,s,null,0,null)},l._fillText=function(t,i,n,s,r,a,o,h,l,_){void 0===_&&(_=0),t?e._charBook.filltext(this,t,n,s,r,a,o,h,l,_):i&&e._charBook.fillWords(this,i,n,s,r,a,o,h)},l._fast_filltext=function(t,i,n,s,r,a,o,h,l){void 0===l&&(l=0),e._charBook._fast_filltext(this,t,null,i,n,s,r,a,o,h,l)},l.fillWords=function(t,e,i,n,s){this._fillText(null,t,e,i,n,s,null,-1,null,0)},l.fillBorderWords=function(t,e,i,n,s,r,a){this._fillBorderText(null,t,e,i,n,s,r,a,null)},l.drawText=function(t,e,i,n,s,r){this._fillText(t,null,e,i,n,o.create(s).strColor,null,-1,r)},l.strokeWord=function(t,e,i,n,s,r,a){this._fillText(t,null,e,i,n,null,o.create(s).strColor,r||1,a)},l.fillBorderText=function(t,e,i,n,s,r,a,h){this._fillBorderText(t,null,e,i,n,o.create(s).strColor,o.create(r).strColor,a,h)},l._fillBorderText=function(t,e,i,n,s,r,a,o,h){this._fillText(t,e,i,n,s,r,a,o||1,h)},l._fillRect=function(t,e,i,n,s){var r=this._curSubmit,a=r&&2===r._key.submitType&&r._key.blendShader===this._submitKey.blendShader;this._mesh.vertNum+4>65535&&(this._mesh=In.getAMesh(),this.meshlist.push(this._mesh),a=!1),a&&(a=a&&this.isSameClipInfo(r)),this.transformQuad(t,e,i,n,0,this._curMat,this._transedPoints),this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,_n.NO_UV,s,!1),a||(r=this._curSubmit=En.create(this,this._mesh,mi.create(1,0)),this._submits[this._submits._length++]=r,this.copyClipInfo(r,this._globalClipMatrix),r.shaderValue.textureHost=this._lastTex,r._key.copyFrom2(this._submitKey,2,this._lastTex&&this._lastTex.bitmap?this._lastTex.bitmap.id:-1),r._renderType=10016),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)},l.fillRect=function(t,e,i,n,s){var r=s?ki.create(s):this._shader2D.fillStyle,a=this.mixRGBandAlpha(r.toInt());this._fillRect(t,e,i,n,a)},l.fillTexture=function(t,e,n,s,r,a,o){if(!t._getSource())return this.sprite&&i.systemTimer.callLater(this,this._repaintSprite),void 0;var h=this._curSubmit,l=!1;this._mesh.vertNum+4>65535&&(this._mesh=In.getAMesh(),this.meshlist.push(this._mesh),l=!1);var _=(t.bitmap,!0),u=!0;switch(a){case"repeat":break;case"repeat-x":u=!1;break;case"repeat-y":_=!1;break;case"no-repeat":_=u=!1}var c=this._temp4Points,d=0,f=0,p=0,m=0,g=0,v=0;if(o.x<0?(p=e,d=-o.x%t.width/t.width):p=e+o.x,o.y<0?(m=n,f=-o.y%t.height/t.height):m=n+o.y,g=e+s,v=n+r,!_&&(g=Math.min(g,e+o.x+t.width)),!u&&(v=Math.min(v,n+o.y+t.height)),!(e>g||n>v||p>g||m>v)){var y=(g-e-o.x)/t.width,E=(v-n-o.y)/t.height;if(this.transformQuad(p,m,g-p,v-m,0,this._curMat,this._transedPoints),c[0]=d,c[1]=f,c[2]=y,c[3]=f,c[4]=y,c[5]=E,c[6]=d,c[7]=E,!this.clipedOff(this._transedPoints)){var S=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA);this._mesh.addQuad(this._transedPoints,c,S,!0);var A=mi.create(1,0);A.defines.add(256),A.u_TexRange=t.uvrect,h=this._curSubmit=En.create(this,this._mesh,A),this._submits[this._submits._length++]=h,this.copyClipInfo(h,this._globalClipMatrix),h.shaderValue.textureHost=t,h._renderType=10016,this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4}this.breakNextMerge()}},l.setColorFilter=function(t){h.save(this,8388608,this,!0),this._colorFiler=t,this._curSubmit=K.RENDERBASE},l.drawTexture=function(t,e,i,n,s){this._drawTextureM(t,e,i,n,s,null,1,null)},l.drawTextures=function(t,e,n,s){if(!t._getSource())return this.sprite&&i.systemTimer.callLater(this,this._repaintSprite),void 0;for(var r=e.length/2,a=0,o=0;r>o;o++)this._inner_drawTexture(t,t.bitmap.id,e[a++]+n,e[a++]+s,0,0,null,null,1)},l._drawTextureAddSubmit=function(t,e){var i=null;i=En.create(this,this._mesh,mi.create(1,0)),this._submits[this._submits._length++]=i,i.shaderValue.textureHost=e,i._key.copyFrom2(this._submitKey,2,t),i._renderType=10016,this._curSubmit=i},l._drawTextureM=function(t,e,n,s,r,a,o,h){return t._getSource()?this._inner_drawTexture(t,t.bitmap.id,e,n,s,r,a,h,o):(this.sprite&&i.systemTimer.callLater(this,this._repaintSprite),!1)},l._drawRenderTexture=function(t,e,i,n,s,r,a,o){return this._inner_drawTexture(t,-1,e,i,n,s,r,o,1)},l.submitDebugger=function(){this._submits[this._submits._length++]=si.create([],function(){},this)},l.copyClipInfo=function(t,e){var i=t.shaderValue.clipMatDir;i[0]=e.a,i[1]=e.b,i[2]=e.c,i[3]=e.d;var n=t.shaderValue.clipMatPos;n[0]=e.tx,n[1]=e.ty,t.clipInfoID=this._clipInfoID},l.isSameClipInfo=function(t){return t.clipInfoID===this._clipInfoID},l._useNewTex2DSubmit=function(t,e){this._mesh.vertNum+e>65535&&(this._mesh=In.getAMesh(),this.meshlist.push(this._mesh));var i=En.create(this,this._mesh,mi.create(1,0));this._submits[this._submits._length++]=this._curSubmit=i,i.shaderValue.textureHost=t,this.copyClipInfo(i,this._globalClipMatrix)},l._drawTexRect=function(t,e,i,n,s){this.transformQuad(t,e,i,n,this._italicDeg,this._curMat,this._transedPoints);var r=this._transedPoints;r[0]=r[0]+.5|0,r[1]=r[1]+.5|0,r[2]=r[2]+.5|0,r[3]=r[3]+.5|0,r[4]=r[4]+.5|0,r[5]=r[5]+.5|0,r[6]=r[6]+.5|0,r[7]=r[7]+.5|0,this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,s,this._fillColor,!0),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)},l._inner_drawTexture=function(t,i,n,s,r,a,o,h,l){var _=this._curSubmit._key;if(h=h||t._uv,4===_.submitType&&_.other===i){var u=e._drawTexToDrawTri_Vert;return u[0]=n,u[1]=s,u[2]=n+r,u[3]=s,u[4]=n+r,u[5]=s+a,u[6]=n,u[7]=s+a,this._drawTriUseAbsMatrix=!0,this.drawTriangles(t,0,0,u,h,e._drawTexToDrawTri_Index,o,l,null,"normal"),this._drawTriUseAbsMatrix=!1,!0}this._drawCount++;var c=i>=0&&2===_.submitType&&_.other===i;c&&(c=c&&this.isSameClipInfo(this._curSubmit)),this._lastTex=t;var d=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA*l);if(this._mesh.vertNum+4>65535&&(this._mesh=In.getAMesh(),this.meshlist.push(this._mesh),c=!1),this.transformQuad(n,s,r||t.width,a||t.height,this._italicDeg,o||this._curMat,this._transedPoints),this.drawTexAlign){var f=this._transedPoints;f[0]=f[0]+.5|0,f[1]=f[1]+.5|0,f[2]=f[2]+.5|0,f[3]=f[3]+.5|0,f[4]=f[4]+.5|0,f[5]=f[5]+.5|0,f[6]=f[6]+.5|0,f[7]=f[7]+.5|0,this.drawTexAlign=!1}if(!this.clipedOff(this._transedPoints)){if(this._mesh.addQuad(this._transedPoints,h,d,!0),!c){var p=En.create(this,this._mesh,mi.create(1,0));this._submits[this._submits._length++]=this._curSubmit=p,p.shaderValue.textureHost=t,p._key.other=i,this.copyClipInfo(p,this._globalClipMatrix)}return this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4,!0}return!1},l.transform4Points=function(t,e,i){var n=e.tx,s=e.ty;e._bTransform?(i[0]=t[0]*e.a+t[1]*e.c+n,i[1]=t[0]*e.b+t[1]*e.d+s,i[2]=t[2]*e.a+t[3]*e.c+n,i[3]=t[2]*e.b+t[3]*e.d+s,i[4]=t[4]*e.a+t[5]*e.c+n,i[5]=t[4]*e.b+t[5]*e.d+s,i[6]=t[6]*e.a+t[7]*e.c+n,i[7]=t[6]*e.b+t[7]*e.d+s):(i[0]=t[0]+n,i[1]=t[1]+s,i[2]=t[2]+n,i[3]=t[3]+s,i[4]=t[4]+n,i[5]=t[5]+s,i[6]=t[6]+n,i[7]=t[7]+s)},l.clipedOff=function(){return this._clipRect.width<=0||this._clipRect.height<=0?!0:!1},l.transformQuad=function(t,e,i,n,s,r,a){var o=0;0!=s&&(o=Math.tan(s*Math.PI/180)*n);var h=t+i,l=e+n;this._temp4Points[0]=t+o,this._temp4Points[1]=e,this._temp4Points[2]=h+o,this._temp4Points[3]=e,this._temp4Points[4]=h,this._temp4Points[5]=l,this._temp4Points[6]=t,this._temp4Points[7]=l,this.transform4Points(this._temp4Points,r,a)},l.pushRT=function(){this.addRenderObject(si.create(null,ir.pushRT,this))},l.popRT=function(){this.addRenderObject(si.create(null,ir.popRT,this)),this.breakNextMerge()},l.useRT=function(t){function e(t){if(!t)throw"error useRT";t.start(),t.clear(0,0,0,0)}this.addRenderObject(si.create([t],e,this)),this.breakNextMerge()
},l.RTRestore=function(t){function e(t){t.restore()}this.addRenderObject(si.create([t],e,this)),this.breakNextMerge()},l.breakNextMerge=function(){this._curSubmit=K.RENDERBASE},l._repaintSprite=function(){this.sprite&&this.sprite.repaint()},l.drawTextureWithTransform=function(t,i,n,s,r,a,o,h,l){if(!a)return this._drawTextureM(t,i+o,n+h,s,r,null,l,null),void 0;var _=this._curMat;e._tmpMatrix.a=a.a,e._tmpMatrix.b=a.b,e._tmpMatrix.c=a.c,e._tmpMatrix.d=a.d,e._tmpMatrix.tx=a.tx+o,e._tmpMatrix.ty=a.ty+h,e._tmpMatrix._bTransform=a._bTransform,a&&_._bTransform?(fi.mul(e._tmpMatrix,_,e._tmpMatrix),a=e._tmpMatrix,a._bTransform=!0):a=e._tmpMatrix,this._drawTextureM(t,i,n,s,r,a,l,null)},l._flushToTarget=function(t,e){pi.worldScissorTest=!1,Oi.mainContext.disable(3089);{var i=pi.worldAlpha,n=pi.worldMatrix4,s=pi.worldMatrix;pi.worldShaderDefines}pi.worldMatrix=fi.EMPTY,pi.restoreTempArray(),pi.worldMatrix4=pi.TEMPMAT4_ARRAY,pi.worldAlpha=1,ps.activeShader=null,e.start(),t._submits._length>0&&e.clear(0,0,0,0),t._curSubmit=K.RENDERBASE,t.flush(),t.clear(),e.restore(),t._curSubmit=K.RENDERBASE,ps.activeShader=null,pi.worldAlpha=i,pi.worldMatrix4=n,pi.worldMatrix=s},l.drawCanvas=function(t,e,i,n,s){var r,a=t.context;if(a._targets)a._submits._length>0&&(r=si.create([a,a._targets],this._flushToTarget,this),this._submits[this._submits._length++]=r),this._drawRenderTexture(a._targets,e,i,n,s,null,1,ir.flipyuv),this._curSubmit=K.RENDERBASE;else{t.touches&&t.touches.forEach(function(t){t.touch()}),r=Sn.create(t,this._shader2D.ALPHA,this._shader2D.filters),this._submits[this._submits._length++]=r,r._key.clear();var o=r._matrix;this._curMat.copyTo(o);var h=o.tx,l=o.ty;o.tx=o.ty=0,o.transformPoint($i.TEMP.setTo(e,i)),o.translate($i.TEMP.x+h,$i.TEMP.y+l),this._curSubmit=K.RENDERBASE}},l.drawTarget=function(t,e,i,n,s,r,a,o,h){void 0===h&&(h=-1),this._drawCount++;this.mixRGBandAlpha(this._drawTextureUseColor?this.fillStyle?this.fillStyle.toInt():0:4294967295);if(this._mesh.vertNum+4>65535&&(this._mesh=In.getAMesh(),this.meshlist.push(this._mesh)),this.transformQuad(e,i,n,s,0,r||this._curMat,this._transedPoints),!this.clipedOff(this._transedPoints)){this._mesh.addQuad(this._transedPoints,o||_n.DEF_UV,4294967295,!0);var l=this._curSubmit=ve.create(this,this._mesh,a,t);return l.blendType=-1==h?this._nBlendType:h,this.copyClipInfo(l,this._globalClipMatrix),l._numEle=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4,this._maxNumEle=Math.max(this._maxNumEle,l._numEle),this._submits[this._submits._length++]=l,this._curSubmit=K.RENDERBASE,!0}return this._curSubmit=K.RENDERBASE,!1},l.drawTriangles=function(t,n,s,r,a,o,h,l,_,u){if(!t._getSource())return this.sprite&&i.systemTimer.callLater(this,this._repaintSprite),void 0;this._drawCount++;var c=null,d=!1;_&&(c=this._colorFiler,this._colorFiler=_,this._curSubmit=K.RENDERBASE,d=c!=_);var f=fe.TOINT[u]||0,p=t.bitmap,m=this._curSubmit._key,g=4===m.submitType&&m.other===p.id&&m.blendShader==f,v=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA*l),y=r.length/2,E=o.length;if(this._triangleMesh.vertNum+y>65535&&(this._triangleMesh=bn.getAMesh(),this.meshlist.push(this._triangleMesh),g=!1),!g){var S=this._curSubmit=En.create(this,this._triangleMesh,mi.create(1,0));S.shaderValue.textureHost=t,S._renderType=10016,S._key.blendShader=f,S._blendFn=this._targets?fe.targetFns[f]:fe.fns[f],S._key.submitType=4,S._key.other=p.id,this.copyClipInfo(S,this._globalClipMatrix),this._submits[this._submits._length++]=S}h?(e._tmpMatrix.a=h.a,e._tmpMatrix.b=h.b,e._tmpMatrix.c=h.c,e._tmpMatrix.d=h.d,e._tmpMatrix.tx=h.tx+n,e._tmpMatrix.ty=h.ty+s):(e._tmpMatrix.a=1,e._tmpMatrix.b=0,e._tmpMatrix.c=0,e._tmpMatrix.d=1,e._tmpMatrix.tx=n,e._tmpMatrix.ty=s),this._drawTriUseAbsMatrix||fi.mul(e._tmpMatrix,this._curMat,e._tmpMatrix),this._triangleMesh.addData(r,a,o,e._tmpMatrix,v,this),this._curSubmit._numEle+=E,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),d&&(this._colorFiler=c,this._curSubmit=K.RENDERBASE)},l.transform=function(t,e,i,n,s,r){oe.save(this),fi.mul(fi.TEMP.setTo(t,e,i,n,s,r),this._curMat,this._curMat),this._curMat._checkTransform()},l._transformByMatrix=function(t,e,i){t.setTranslate(e,i),fi.mul(t,this._curMat,this._curMat),t.setTranslate(0,0),this._curMat._bTransform=!0},l.setTransformByMatrix=function(t){t.copyTo(this._curMat)},l.rotate=function(t){oe.save(this),this._curMat.rotateEx(t)},l.scale=function(t,e){oe.save(this),this._curMat.scaleEx(t,e)},l.clipRect=function(t,i,n,s){ui.save(this),this._clipRect==e.MAXCLIPRECT?this._clipRect=new He(t,i,n,s):(this._clipRect.width=n,this._clipRect.height=s,this._clipRect.x=t,this._clipRect.y=i),e._clipID_Gen++,e._clipID_Gen%=1e4,this._clipInfoID=e._clipID_Gen;var r=this._globalClipMatrix,a=r.tx,o=r.ty,h=a+r.a,l=o+r.d;if(this._clipRect.width>=99999999?(r.a=r.d=99999999,r.b=r.c=r.tx=r.ty=0):this._curMat._bTransform?(r.tx=this._clipRect.x*this._curMat.a+this._clipRect.y*this._curMat.c+this._curMat.tx,r.ty=this._clipRect.x*this._curMat.b+this._clipRect.y*this._curMat.d+this._curMat.ty,r.a=this._clipRect.width*this._curMat.a,r.b=this._clipRect.width*this._curMat.b,r.c=this._clipRect.height*this._curMat.c,r.d=this._clipRect.height*this._curMat.d):(r.tx=this._clipRect.x+this._curMat.tx,r.ty=this._clipRect.y+this._curMat.ty,r.a=this._clipRect.width,r.b=r.c=0,r.d=this._clipRect.height),r.a>0&&r.d>0){var _=r.tx+r.a,u=r.ty+r.d;a>=_||o>=u||r.tx>=h||r.ty>=l?(r.a=-.1,r.d=-.1):(r.tx<a&&(r.a-=a-r.tx,r.tx=a),_>h&&(r.a-=_-h),r.ty<o&&(r.d-=o-r.ty,r.ty=o),u>l&&(r.d-=u-l),r.a<=0&&(r.a=-.1),r.d<=0&&(r.d=-.1))}},l.drawMesh=function(t,e,i,n,s,r,a,o,h){void 0===h&&(h=0)},l.addRenderObject=function(t){this._submits[this._submits._length++]=t},l.submitElement=function(t,e){var i=(Ni._context===this,this._submits),n=i._length;0>e&&(e=i._length);for(var s=K.RENDERBASE;e>t;)this._renderNextSubmitIndex=t+1,i[t]!==K.RENDERBASE?(K.preRender=s,s=i[t],t+=s.renderSubmit()):t++;return n},l.flush=function(){var t=this.submitElement(0,this._submits._length);this._path&&this._path.reset(),Di.instance&&Di.getInstance().reset(),this._curSubmit=K.RENDERBASE;for(var e=0,i=this.meshlist.length;i>e;e++){var n=this.meshlist[e];n.canReuse?n.releaseMesh():n.destroy()}return this.meshlist.length=0,this._mesh=In.getAMesh(),this._pathMesh=vn.getAMesh(),this._triangleMesh=bn.getAMesh(),this.meshlist.push(this._mesh,this._pathMesh,this._triangleMesh),this._flushCnt++,this._flushCnt%600==0&&Ni._context==this&&xe.charbookInst&&xe.charbookInst.GC(),t},l.setPathId=function(t){if(this.mId=t,-1!=this.mId){this.mHaveKey=!1;var e=yi.getInstance();e.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,e.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},l.beginPath=function(t){void 0===t&&(t=!1);var e=this._getPath();e.beginPath(t)},l.closePath=function(){this._path.closePath()},l.addPath=function(t,e,i){this._getPath().push(t,i)},l.fill=function(){var t=this._curMat,e=this._getPath(),i=this._curSubmit,n=3===i._key.submitType&&i._key.blendShader===this._submitKey.blendShader;n&&(n=n&&this.isSameClipInfo(i)),n||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var s,r=this.mixRGBandAlpha(this.fillStyle.toInt()),a=0,o=0,h=e.paths.length;h>o;o++){var l=e.paths[o],_=l.path.length/2;if(!(3>_||3==_&&!l.convex)){var u=l.path.concat(),c=0,d=0,f=0,p=0/0,m=0/0;if(t._bTransform)for(c=0;_>c;c++)d=c<<1,f=d+1,p=u[d],m=u[f],u[d]=t.a*p+t.c*m+t.tx,u[f]=t.b*p+t.d*m+t.ty;else for(c=0;_>c;c++)d=c<<1,f=d+1,p=u[d],m=u[f],u[d]=p+t.tx,u[f]=m+t.ty;this._pathMesh.vertNum+_>65535&&(this._curSubmit._numEle+=a,a=0,this._pathMesh=vn.getAMesh(),this._curSubmit=this.addVGSubmit(this._pathMesh));var g=this._pathMesh.vertNum;if(l.convex){var v=_-2;s=new Array(3*v);for(var y=0,E=0;v>E;E++)s[y++]=g,s[y++]=E+1+g,s[y++]=E+2+g}else if(s=gi.earcut(u,null,2),g>0)for(var S=0;S<s.length;S++)s[S]+=g;this._pathMesh.addVertAndIBToMesh(this,u,r,s),a+=s.length}}this._curSubmit._numEle+=a},l.addVGSubmit=function(t){var e=K.createShape(this,t,0,mi.create(4,0));return e._key.blendShader=this._submitKey.blendShader,e._key.submitType=3,this._submits[this._submits._length++]=e,this.copyClipInfo(e,this._globalClipMatrix),e},l.stroke=function(){if(this.lineWidth>0){var t=this.mixRGBandAlpha(this.strokeStyle._color.numColor),e=this._getPath(),i=this._curSubmit,n=3===i._key.submitType&&i._key.blendShader===this._submitKey.blendShader;n&&(n=n&&this.isSameClipInfo(i)),n||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var s=0,r=0,a=e.paths.length;a>r;r++){var o=e.paths[r];if(!(o.path.length<=0)){var h=[],l=[],_=2*o.path.length;if(!(2>_)){this._pathMesh.vertNum+_>65535&&(this._curSubmit._numEle+=s,s=0,this._pathMesh=vn.getAMesh(),this.meshlist.push(this._pathMesh),this._curSubmit=this.addVGSubmit(this._pathMesh)),ii.createLine2(o.path,h,this.lineWidth,this._pathMesh.vertNum,l,o.loop);var u=l.length/2,c=this._curMat,d=0,f=0,p=0,m=0/0,g=0/0;if(c._bTransform)for(d=0;u>d;d++)f=d<<1,p=f+1,m=l[f],g=l[p],l[f]=c.a*m+c.c*g+c.tx,l[p]=c.b*m+c.d*g+c.ty;else for(d=0;u>d;d++)f=d<<1,p=f+1,m=l[f],g=l[p],l[f]=m+c.tx,l[p]=g+c.ty;this._pathMesh.addVertAndIBToMesh(this,l,t,h),s+=h.length}}}this._curSubmit._numEle+=s}},l.moveTo=function(t,e){var i=this._getPath();i.newPath(),i._lastOriX=t,i._lastOriY=e,i.addPoint(t,e)},l.lineTo=function(t,e){var i=this._getPath();Math.abs(t-i._lastOriX)<.001&&Math.abs(e-i._lastOriY)<.001||(i._lastOriX=t,i._lastOriY=e,i.addPoint(t,e))},l.arcTo=function(t,i,n,s,r){var a=0,o=0,h=0,l=this._path._lastOriX-t,_=this._path._lastOriY-i,u=Math.sqrt(l*l+_*_);if(!(1e-6>=u)){var c=l/u,d=_/u,f=n-t,p=s-i,m=f*f+p*p,g=Math.sqrt(m);if(!(1e-6>=g)){var v=f/g,y=p/g,E=c+v,S=d+y,A=Math.sqrt(E*E+S*S);if(!(1e-6>=A)){var C=E/A,D=S/A,x=Math.acos(C*c+D*d),R=Math.PI/2-x;u=r/Math.tan(R);var T=u*c+t,b=u*d+i,P=Math.sqrt(u*u+r*r),L=t+C*P,I=i+D*P,M=c*y-d*v,w=0,O=0,B=0;if(M>=0){w=2*R;var N=w/e.SEGNUM;O=Math.sin(N),B=Math.cos(N)}else w=2*-R,N=w/e.SEGNUM,O=Math.sin(N),B=Math.cos(N);var k=this._path._lastOriX,F=this._path._lastOriY,V=T,U=b;(Math.abs(V-this._path._lastOriX)>.1||Math.abs(U-this._path._lastOriY)>.1)&&(o=V,h=U,k=V,F=U,this._path.addPoint(o,h));var W=T-L,G=b-I;for(a=0;a<e.SEGNUM;a++){var z=W*B+G*O,X=-W*O+G*B;o=z+L,h=X+I,(Math.abs(k-o)>.1||Math.abs(F-h)>.1)&&(this._path.addPoint(o,h),k=o,F=h),W=z,G=X}}}}},l.arc=function(t,e,i,n,s,r,a){void 0===r&&(r=!1),void 0===a&&(a=!0);var o=0,h=0,l=0,_=0,u=0,c=0,d=0,f=0,p=0,m=0,g=0;if(h=s-n,r)if(Math.abs(h)>=2*Math.PI)h=2*-Math.PI;else for(;h>0;)h-=2*Math.PI;else if(Math.abs(h)>=2*Math.PI)h=2*Math.PI;else for(;0>h;)h+=2*Math.PI;var v=this.getMatScaleX(),y=this.getMatScaleY(),E=i*(v>y?v:y),S=2*Math.PI*E;m=0|Math.max(S/10,10),l=h/m/2,_=Math.abs(4/3*(1-Math.cos(l))/Math.sin(l)),r&&(_=-_),g=0;var A=this._getPath();for(p=0;m>=p;p++)o=n+h*(p/m),u=Math.cos(o),c=Math.sin(o),d=t+u*i,f=e+c*i,(d!=this._path._lastOriX||f!=this._path._lastOriY)&&A.addPoint(d,f);u=Math.cos(s),c=Math.sin(s),d=t+u*i,f=e+c*i,(d!=this._path._lastOriX||f!=this._path._lastOriY)&&A.addPoint(d,f)},l.quadraticCurveTo=function(t,e,i,n){for(var s=Wi.I,r=s.getBezierPoints([this._path._lastOriX,this._path._lastOriY,t,e,i,n],30,2),a=0,o=r.length/2;o>a;a++)this.lineTo(r[2*a],r[2*a+1]);this.lineTo(i,n)},l.rect=function(t,e,i,n){this._other=this._other.make(),this._other.path||(this._other.path=new Ei),this._other.path.rect(t,e,i,n)},l.mixRGBandAlpha=function(t){return this._mixRGBandAlpha(t,this._shader2D.ALPHA)},l._mixRGBandAlpha=function(t,e){var i=(4278190080&t)>>>24;return 0!=i?i*=e:i=255*e,16777215&t|i<<24},l.strokeRect=function(t,e,i,n,s){if(this.lineWidth>0){var r=this.mixRGBandAlpha(this.strokeStyle._color.numColor),a=this.lineWidth/2;this._fillRect(t-a,e-a,i+this.lineWidth,this.lineWidth,r),this._fillRect(t-a,e-a+n,i+this.lineWidth,this.lineWidth,r),this._fillRect(t-a,e+a,this.lineWidth,n-this.lineWidth,r),this._fillRect(t-a+i,e+a,this.lineWidth,n-this.lineWidth,r)}},l.clip=function(){},l.drawParticle=function(t,e,i){i.x=t,i.y=e,this._submits[this._submits._length++]=i},l._getPath=function(){return this._path||(this._path=new Ei)},r(0,l,"globalCompositeOperation",function(){return fe.NAMES[this._nBlendType]},function(t){var e=fe.TOINT[t];null==e||this._nBlendType===e||(h.save(this,65536,this,!0),this._curSubmit=K.RENDERBASE,this._nBlendType=e)}),r(0,l,"strokeStyle",function(){return this._shader2D.strokeStyle},function(t){this._shader2D.strokeStyle.equal(t)||(h.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=ki.create(t),this._submitKey.other=-this._shader2D.strokeStyle.toInt())}),r(0,l,"globalAlpha",function(){return this._shader2D.ALPHA},function(t){t=Math.floor(1e3*t)/1e3,t!=this._shader2D.ALPHA&&(h.save(this,1,this._shader2D,!1),this._shader2D.ALPHA=t)}),r(0,l,"asBitmap",null,function(t){if(t){if(this._targets||(this._targets=new ir(this._width,this._height,1,-1)),!this._width||!this._height)throw Error("asBitmap no size!")}else this._targets&&this._targets.destroy(),this._targets=null}),r(0,l,"fillStyle",function(){return this._shader2D.fillStyle},function(t){this._shader2D.fillStyle.equal(t)||(h.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=ki.create(t),this._submitKey.other=-this._shader2D.fillStyle.toInt())}),r(0,l,"textAlign",function(){return this._other.textAlign},function(t){this._other.textAlign===t||(this._other=this._other.make(),h.save(this,32768,this._other,!1),this._other.textAlign=t)}),r(0,l,"lineWidth",function(){return this._other.lineWidth},function(t){this._other.lineWidth===t||(this._other=this._other.make(),h.save(this,256,this._other,!1),this._other.lineWidth=t)}),r(0,l,"textBaseline",function(){return this._other.textBaseline},function(t){this._other.textBaseline===t||(this._other=this._other.make(),h.save(this,16384,this._other,!1),this._other.textBaseline=t)}),r(0,l,"font",null,function(){this._other=this._other.make(),h.save(this,8,this._other,!1)}),r(0,l,"canvas",function(){return this._canvas}),e.__init__=function(){a.DEFAULT=new a},e.set2DRenderConfig=function(){var t=we.instance;ye.setBlend(t,!0),ye.setBlendFunc(t,1,771),ye.setDepthTest(t,!1),ye.setCullFace(t,!1),ye.setDepthMask(t,!0),ye.setFrontFace(t,2305),t.viewport(0,0,pi.width,pi.height)},e._tempPoint=new $i,e._SUBMITVBSIZE=32e3,e._MAXSIZE=99999999,e._MAXVERTNUM=65535,e.MAXCLIPRECT=new He(0,0,99999999,99999999),e._COUNT=0,e._tmpMatrix=new fi,e.SEGNUM=32,e._contextcount=0,e._clipID_Gen=0,e.defTexture=null,n(e,["_drawStyleTemp",function(){return this._drawStyleTemp=new ki(null)},"_keyMap",function(){return this._keyMap=new ci},"_drawTexToDrawTri_Vert",function(){return this._drawTexToDrawTri_Vert=new Float32Array(8)},"_drawTexToDrawTri_Index",function(){return this._drawTexToDrawTri_Index=new Uint16Array([0,1,2,0,2,3])},"_charBook",function(){return this._charBook=new xe}]),e.__init$=function(){a=function(){function t(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null}s(t,"");var e=t.prototype;return e.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null},e.make=function(){return this===t.DEFAULT?new t:this},t.DEFAULT=null,t}()},e}(N),mn=(function(t){function e(){e.__super.call(this)}s(e,"laya.html.dom.HTMLStyleElement",t);var i=e.prototype;return i._creates=function(){},i.drawToGraphic=function(){},i.reset=function(){return this},r(0,i,"innerTEXT",t.prototype._$get_innerTEXT,function(t){Hi.parseCSS(t,null)}),e}(X),function(t){function e(){this.url=null,this.audio=null,this.loaded=!1,e.__super.call(this)}s(e,"laya.media.h5audio.AudioSound",t);var i=e.prototype;return i.dispose=function(){var t=e._audioCache[this.url];t&&(t.src="",delete e._audioCache[this.url])},i.load=function(t){function i(){s(),a.loaded=!0,a.event("complete")}function n(){r.load=null,s(),a.event("error")}function s(){r.removeEventListener("canplaythrough",i),r.removeEventListener("error",n)}t=Mi.formatURL(t),this.url=t;var r;if(t==Gi._bgMusic?(e._initMusicAudio(),r=e._musicAudio,r.src!=t&&(e._audioCache[r.src]=null,r=null)):r=e._audioCache[t],r&&r.readyState>=2)return this.event("complete"),void 0;r||(t==Gi._bgMusic?(e._initMusicAudio(),r=e._musicAudio):r=Be.createElement("audio"),e._audioCache[t]=r,r.src=t),r.addEventListener("canplaythrough",i),r.addEventListener("error",n);var a=this;this.audio=r,r.load?r.load():n()},i.play=function(t,i){if(void 0===t&&(t=0),void 0===i&&(i=0),!this.url)return null;var n;if(n=this.url==Gi._bgMusic?e._musicAudio:e._audioCache[this.url],!n)return null;var s;s=Ji.getItem("audio:"+this.url),Ni.isConchApp?s||(s=Be.createElement("audio"),s.src=this.url):this.url==Gi._bgMusic?(e._initMusicAudio(),s=e._musicAudio,s.src=this.url):s=s?s:n.cloneNode(!0);var r=new ys(s);return r.url=this.url,r.loops=i,r.startTime=t,r.play(),Gi.addChannel(r),r},r(0,i,"duration",function(){var t;return t=e._audioCache[this.url],t?t.duration:0}),e._initMusicAudio=function(){e._musicAudio||(e._musicAudio||(e._musicAudio=Be.createElement("audio")),Ni.isConchApp||Be.document.addEventListener("mousedown",e._makeMusicOK))},e._makeMusicOK=function(){Be.document.removeEventListener("mousedown",e._makeMusicOK),e._musicAudio.src?e._musicAudio.play():(e._musicAudio.src="",e._musicAudio.load())},e._audioCache={},e._musicAudio=null,e}(l)),gn=function(t){function e(t){e.__super.call(this),t||(t=this._copyMatrix(e.IDENTITY_MATRIX)),this._mat=new Float32Array(16),this._alpha=new Float32Array(4),this.setByMatrix(t),this._action=new xi,this._action.data=this}s(e,"laya.filters.ColorFilter",t);var a=e.prototype;return i.imps(a,{"laya.filters.IFilter":!0}),a.gray=function(){return this.setByMatrix(e.GRAY_MATRIX)},a.color=function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),this.setByMatrix([1,0,0,0,t,0,1,0,0,e,0,0,1,0,i,0,0,0,1,n])},a.setByMatrix=function(t){this._matrix!=t&&this._copyMatrix(t);for(var e=0,i=0,n=0;20>n;n++)n%5!=4?this._mat[e++]=t[n]:this._alpha[i++]=t[n];return this},a.adjustColor=function(t,e,i,n){return this.adjustHue(n),this.adjustContrast(e),this.adjustBrightness(t),this.adjustSaturation(i),this},a.adjustBrightness=function(t){return t=this._clampValue(t,100),0==t||isNaN(t)?this:this._multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])},a.adjustContrast=function(t){if(t=this._clampValue(t,100),0==t||isNaN(t))return this;var i=0/0;0>t?i=127+t/100*127:(i=t%1,i=0==i?e.DELTA_INDEX[t]:e.DELTA_INDEX[t<<0]*(1-i)+e.DELTA_INDEX[(t<<0)+1]*i,i=127*i+127);var n=i/127,s=.5*(127-i);return this._multiplyMatrix([n,0,0,0,s,0,n,0,0,s,0,0,n,0,s,0,0,0,1,0,0,0,0,0,1])},a.adjustSaturation=function(t){if(t=this._clampValue(t,100),0==t||isNaN(t))return this;var e=1+(t>0?3*t/100:t/100),i=1-e,n=.3086*i,s=.6094*i,r=.082*i;return this._multiplyMatrix([n+e,s,r,0,0,n,s+e,r,0,0,n,s,r+e,0,0,0,0,0,1,0,0,0,0,0,1])},a.adjustHue=function(t){if(t=this._clampValue(t,180)/180*Math.PI,0==t||isNaN(t))return this;var e=Math.cos(t),i=Math.sin(t),n=.213,s=.715,r=.072;return this._multiplyMatrix([n+e*(1-n)+i*-n,s+e*-s+i*-s,r+e*-r+i*(1-r),0,0,n+e*-n+.143*i,s+e*(1-s)+.14*i,r+e*-r+i*-.283,0,0,n+e*-n+i*-(1-n),s+e*-s+i*s,r+e*(1-r)+i*r,0,0,0,0,0,1,0,0,0,0,0,1])},a.reset=function(){return this.setByMatrix(this._copyMatrix(e.IDENTITY_MATRIX))},a._multiplyMatrix=function(t){var e=[];this._matrix=this._fixMatrix(this._matrix);for(var i=0;5>i;i++){for(var n=0;5>n;n++)e[n]=this._matrix[n+5*i];for(n=0;5>n;n++){for(var s=0,r=0;5>r;r++)s+=t[n+5*r]*e[r];this._matrix[n+5*i]=s}}return this.setByMatrix(this._matrix)},a._clampValue=function(t,e){return Math.min(e,Math.max(-e,t))},a._fixMatrix=function(t){return null==t?e.IDENTITY_MATRIX:(t.length<25?t=t.slice(0,t.length).concat(e.IDENTITY_MATRIX.slice(t.length,25)):t.length>25&&(t=t.slice(0,25)),t)},a._copyMatrix=function(t){var e=25;this._matrix||(this._matrix=[]);for(var i=0;e>i;i++)this._matrix[i]=t[i];return this._matrix},r(0,a,"type",function(){return 32}),e.LENGTH=25,n(e,["DELTA_INDEX",function(){return this.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10]},"GRAY_MATRIX",function(){return this.GRAY_MATRIX=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]},"IDENTITY_MATRIX",function(){return this.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}]),e}(Q),vn=function(t){function e(){e.__super.call(this,laya.webgl.utils.MeshVG.const_stride,4,4),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshVG._fixattriInfo)}s(e,"laya.webgl.utils.MeshVG",t);var i=e.prototype;return i.addVertAndIBToMesh=function(t,i,n,s){for(var r=this._vb.needSize(i.length/2*e.const_stride),a=r>>2,o=this._vb._floatArray32||this._vb.getFloat32Array(),h=this._vb._uint32Array,l=0,_=i.length/2,u=0;_>u;u++)o[a++]=i[l],o[a++]=i[l+1],l+=2,h[a++]=n;this._vb.setNeedUpload(),this._ib.append(new Uint16Array(s)),this._ib.setNeedUpload(),this.vertNum+=_,this.indexNum+=s.length},i.releaseMesh=function(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshVG._POOL.push(this)},i.destroy=function(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()},e.getAMesh=function(){return laya.webgl.utils.MeshVG._POOL.length?laya.webgl.utils.MeshVG._POOL.pop():new e},e.const_stride=12,e._POOL=[],n(e,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5121,4,8]}]),e}(Z),yn=function(t){function e(){this.worker=null,this._useWorkerLoader=!1,e.__super.call(this);var t=this;this.worker=new Be.window.Worker(e.workerPath),this.worker.onmessage=function(e){t.workerMessage(e.data)}}s(e,"laya.net.WorkerLoader",t);var i=e.prototype;return i.workerMessage=function(t){if(t)switch(t.type){case"Image":this.imageLoaded(t);break;case"Disable":e.enable=!1}},i.imageLoaded=function(t){if(!t.dataType||"imageBitmap"!=t.dataType)return this.event(t.url,null),void 0;var e=new Is(!0),i=e.source.getContext("2d");switch(t.dataType){case"imageBitmap":var n=t.imageBitmap;e.size(n.width,n.height),i.drawImage(n,0,0)}if(console.log("load:",t.url),Ni.isWebGL){e._setGPUMemory(0);var s=new laya.webgl.resource.Texture2D;s.loadImageSource(e),e=s}this.event(t.url,e)},i.loadImage=function(t){this.worker.postMessage(t)},i._loadImage=function(t){function i(){laya.net.WorkerLoader.I.off(t,n,s)}var n=this;if(!this._useWorkerLoader||!e._enable)return e._preLoadFun.call(n,t),void 0;t=Mi.formatURL(t);var s=function(s){i(),s?n.onLoaded(s):e._preLoadFun.call(n,t)};laya.net.WorkerLoader.I.on(t,n,s),laya.net.WorkerLoader.I.loadImage(t)},r(1,e,"enable",function(){return e._enable},function(t){e._enable!=t&&(e._enable=t,t&&null==e._preLoadFun&&(e._enable=e.__init__()))}),e.__init__=function(){return null!=e._preLoadFun?!1:Be.window.Worker?(e._preLoadFun=un.prototype._loadImage,un.prototype._loadImage=e.prototype._loadImage,e.I||(e.I=new e),!0):!1},e.workerSupported=function(){return Be.window.Worker?!0:!1},e.enableWorkerLoader=function(){e._tryEnabled||(e.enable=!0,e._tryEnabled=!0)},e.I=null,e.workerPath="libs/workerloader.js",e._preLoadFun=null,e._enable=!1,e._tryEnabled=!1,e}(l),En=(function(t){function e(){e.__super.call(this)}return s(e,"laya.ui.UIEvent",t),e.SHOW_TIP="showtip",e.HIDE_TIP="hidetip",e}(se),function(t){function e(t){void 0===t&&(t=1e4),e.__super.call(this,t)}s(e,"laya.webgl.submit.SubmitTexture",t);var i=e.prototype;return i.clone=function(t,i,n){var s=e._poolSize?e.POOL[--e._poolSize]:new e;return this._cloneInit(s,t,i,n),s},i.releaseRender=function(){--this._ref<1&&(e.POOL[e._poolSize++]=this,this.shaderValue.release(),this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))},i.renderSubmit=function(){if(0===this._numEle)return 1;var t=this.shaderValue.textureHost;if(t){var e=t?t._getSource():null;if(!e)return 1}var i=Oi.mainContext;this._mesh.useMesh(i);var n=K.preRender,s=K.preRender._key;return 0===this._key.blendShader&&this._key.submitType===s.submitType&&this._key.blendShader===s.blendShader&&ps.activeShader&&K.preRender.clipInfoID==this.clipInfoID&&n.shaderValue.defines._value===this.shaderValue.defines._value&&0==(this.shaderValue.defines._value&Tn.NOOPTMASK)?ps.activeShader.uploadTexture2D(e):(fe.activeBlendFunction!==this._blendFn&&(ye.setBlend(i,!0),this._blendFn(i),fe.activeBlendFunction=this._blendFn),this.shaderValue.texture=e,this.shaderValue.upload()),i.drawElements(4,this._numEle,5123,this._startIdx),wi.drawCall++,wi.trianglesFaces+=this._numEle/3,1},e.create=function(t,i,n){var s=e._poolSize?e.POOL[--e._poolSize]:new e(10016);s._mesh=i,s._key.clear(),s._key.submitType=2,s._ref=1,s._startIdx=i.indexNum*Ie.BYTES_PIDX,s._numEle=0;var r=t._nBlendType;if(s._key.blendShader=r,s._blendFn=t._targets?fe.targetFns[r]:fe.fns[r],s.shaderValue=n,t._colorFiler){var a=t._colorFiler;n.defines.add(a.type),n.colorMat=a._mat,n.colorAlpha=a._alpha}return s},e._poolSize=0,e.POOL=[],e}(K)),Sn=function(t){function e(){this._matrix=new fi,this._matrix4=Ie.defaultMatrix4.concat(),e.__super.call(this,1e4),this.shaderValue=new mi(0,0)}s(e,"laya.webgl.submit.SubmitCanvas",t);var i=e.prototype;return i.renderSubmit=function(){var t=pi.worldAlpha,e=pi.worldMatrix4,i=pi.worldMatrix,n=pi.worldFilters,s=pi.worldShaderDefines,r=this.shaderValue,a=this._matrix,o=this._matrix4,h=fi.TEMP;return fi.mul(a,i,h),o[0]=h.a,o[1]=h.b,o[4]=h.c,o[5]=h.d,o[12]=h.tx,o[13]=h.ty,pi.worldMatrix=h.clone(),pi.worldMatrix4=o,pi.worldAlpha=pi.worldAlpha*r.alpha,r.filters&&r.filters.length&&(pi.worldFilters=r.filters,pi.worldShaderDefines=r.defines),this.canv.flushsubmit(),pi.worldAlpha=t,pi.worldMatrix4=e,pi.worldMatrix.destroy(),pi.worldMatrix=i,pi.worldFilters=n,pi.worldShaderDefines=s,1},i.releaseRender=function(){if(--this._ref<1){var t=e.POOL;this._mesh=null,t[t._length++]=this}},i.clone=function(){return null},i.getRenderType=function(){return 10003},e.create=function(t,i,n){var s=e.POOL._length?e.POOL[--e.POOL._length]:new e;s.canv=t,s._ref=1,s._numEle=0;var r=s.shaderValue;return r.alpha=i,r.defines.setValue(0),n&&n.length&&r.setFilters(n),s},e.POOL=(e.POOL=[],e.POOL._length=0,e.POOL),e}(K),An=function(t){function e(){e.__super.call(this),this._top=0/0,this._bottom=0/0,this._left=0/0,this._right=0/0,this._centerX=0/0,this._centerY=0/0}s(e,"laya.ui.Widget",t);var i=e.prototype;return i.onReset=function(){this._top=this._bottom=this._left=this._right=this._centerX=this._centerY=0/0},i._onEnable=function(){this.owner.parent?this._onAdded():this.owner.once("added",this,this._onAdded)},i._onDisable=function(){this.owner.off("added",this,this._onAdded),this.owner.parent&&this.owner.parent.off("resize",this,this._onParentResize)},i._onAdded=function(){this.owner.parent&&this.owner.parent.on("resize",this,this._onParentResize),this.resetLayoutX(),this.resetLayoutY()},i._onParentResize=function(){(this.resetLayoutX()||this.resetLayoutY())&&this.owner.event("resize")},i.resetLayoutX=function(){var t=this.owner;if(!t)return!1;var e=t.parent;if(e)if(isNaN(this.centerX)){if(isNaN(this.left))isNaN(this.right)||(t.x=Math.round(e.width-t.displayWidth-this.right+t.pivotX*t.scaleX));else if(t.x=Math.round(this.left+t.pivotX*t.scaleX),!isNaN(this.right)){var i=(e._width-this.left-this.right)/(t.scaleX||.01);if(i!=t.width)return t.width=i,!0}}else t.x=Math.round(.5*(e.width-t.displayWidth)+this.centerX+t.pivotX*t.scaleX);return!1},i.resetLayoutY=function(){var t=this.owner;if(!t)return!1;var e=t.parent;if(e)if(isNaN(this.centerY)){if(isNaN(this.top))isNaN(this.bottom)||(t.y=Math.round(e.height-t.displayHeight-this.bottom+t.pivotY*t.scaleY));else if(t.y=Math.round(this.top+t.pivotY*t.scaleY),!isNaN(this.bottom)){var i=(e._height-this.top-this.bottom)/(t.scaleY||.01);if(i!=t.height)return t.height=i,!0}}else t.y=Math.round(.5*(e.height-t.displayHeight)+this.centerY+t.pivotY*t.scaleY);return!1},i.resetLayout=function(){this.owner&&(this.resetLayoutX(),this.resetLayoutY())},r(0,i,"centerX",function(){return this._centerX},function(t){this._centerX!=t&&(this._centerX=t,this.resetLayoutX())}),r(0,i,"top",function(){return this._top},function(t){this._top!=t&&(this._top=t,this.resetLayoutY())}),r(0,i,"bottom",function(){return this._bottom},function(t){this._bottom!=t&&(this._bottom=t,this.resetLayoutY())}),r(0,i,"left",function(){return this._left},function(t){this._left!=t&&(this._left=t,this.resetLayoutX())}),r(0,i,"right",function(){return this._right},function(t){this._right!=t&&(this._right=t,this.resetLayoutX())}),r(0,i,"centerY",function(){return this._centerY},function(t){this._centerY!=t&&(this._centerY=t,this.resetLayoutY())}),n(e,["EMPTY",function(){return this.EMPTY=new e}]),e}(u),Cn=function(t){function e(){this.totalCount=0,this._completeHandler=null,this._toLoadList=null,this._isLoading=!1,this._curUrl=null,e.__super.call(this),this._completeHandler=new _(this,this.onOneLoadComplete),this.reset()}s(e,"laya.net.SceneLoader",t);var a=e.prototype;return a.reset=function(){this._toLoadList=[],this._isLoading=!1,this.totalCount=0},a.load=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!0),t instanceof Array){var n=0,s=0;for(s=t.length,n=0;s>n;n++)this._addToLoadList(t[n],e)}else this._addToLoadList(t,e);i&&this._checkNext()},a._addToLoadList=function(t,e){void 0===e&&(e=!1),this._toLoadList.indexOf(t)>=0||un.getRes(t)||(e?this._toLoadList.push({url:t}):this._toLoadList.push(t),this.totalCount++)},a._checkNext=function(){if(!this._isLoading){if(0==this._toLoadList.length)return this.event("complete"),void 0;var t;t=this._toLoadList.pop(),"string"==typeof t?this.loadOne(t):this.loadOne(t.url,!0)}},a.loadOne=function(t,n){void 0===n&&(n=!1),this._curUrl=t;var s=ee.getFileExtension(this._curUrl);n?i.loader.create(t,this._completeHandler):e.LoadableExtensions[s]?i.loader.load(t,this._completeHandler,null,e.LoadableExtensions[s]):t!=Ii.getFileLoadPath(t)||e.No3dLoadTypes[s]||!cn.createMap[s]?i.loader.load(t,this._completeHandler):i.loader.create(t,this._completeHandler)},a.onOneLoadComplete=function(){this._isLoading=!1,un.getRes(this._curUrl)||console.log("Fail to load:",this._curUrl);var t=ee.getFileExtension(this._curUrl);if(e.LoadableExtensions[t]){var i;i=un.getRes(this._curUrl),i&&i instanceof laya.components.Prefab&&(i=i.json),i&&(i.loadList&&this.load(i.loadList,!1,!1),i.loadList3D&&this.load(i.loadList3D,!0,!1))}this.event("progress",this.getProgress()),this._checkNext()},a.getProgress=function(){return this.loadedCount/this.totalCount},r(0,a,"loadedCount",function(){return this.totalCount-this.leftCount}),r(0,a,"leftCount",function(){return this._isLoading?this._toLoadList.length+1:this._toLoadList.length}),n(e,["LoadableExtensions",function(){return this.LoadableExtensions={scene:"json",scene3d:"json",ani:"json",ui:"json",prefab:"prefab"}},"No3dLoadTypes",function(){return this.No3dLoadTypes={png:!0,jpg:!0,txt:!0}}]),e}(l),Dn=(function(t){function e(t){e.__super.call(this,laya.webgl.utils.MeshParticle2D.const_stride,4*t*e.const_stride,4),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshParticle2D._fixattriInfo),this.createQuadIB(t),this._quadNum=t}s(e,"laya.webgl.utils.MeshParticle2D",t);var i=e.prototype;return i.setMaxParticleNum=function(t){this._vb._resizeBuffer(4*t*e.const_stride,!1),this.createQuadIB(t)},i.releaseMesh=function(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshParticle2D._POOL.push(this)},i.destroy=function(){this._ib.destroy(),this._vb.destroy(),this._vb.deleteBuffer()},e.getAMesh=function(t){if(laya.webgl.utils.MeshParticle2D._POOL.length){var i=laya.webgl.utils.MeshParticle2D._POOL.pop();return i.setMaxParticleNum(t),i}return new e(t)},e.const_stride=116,e._POOL=[],n(e,["_fixattriInfo",function(){return this._fixattriInfo=[5126,4,0,5126,3,16,5126,3,28,5126,4,40,5126,4,56,5126,3,72,5126,2,84,5126,4,92,5126,1,108,5126,1,112]}]),e}(Z),function(t){function e(){this.italic=!1,e.__super.call(this)
}s(e,"laya.display.css.TextStyle",t);var i=e.prototype;return i.reset=function(){return t.prototype.reset.call(this),this.italic=!1,this.align="left",this.wordWrap=!1,this.leading=0,this.padding=[0,0,0,0],this.bgColor=null,this.borderColor=null,this.asPassword=!1,this.stroke=0,this.strokeColor="#000000",this.bold=!1,this.underline=!1,this.underlineColor=null,this.currBitmapFont=null,this},i.recover=function(){this!==e.EMPTY&&Ji.recover("TextStyle",this.reset())},i.render=function(t,e,i,n){(this.bgColor||this.borderColor)&&e.drawRect(i,n,t.width,t.height,this.bgColor,this.borderColor,1)},e.create=function(){return Ji.getItemByClass("TextStyle",e)},e.EMPTY=new e,e}(le)),xn=function(t){function e(t,i){e.__super.call(this,t,i)}s(e,"laya.webgl.utils.RenderSprite3D",t);var i=e.prototype;return i.onCreate=function(t){switch(t){case 4:return this._fun=this._blend,void 0}},i._mask=function(t,e,i,n){var s=this._next,r=t.mask,a=e;if(r){a.save();var o=a.globalCompositeOperation,h=new He;if(h.copyFrom(r.getBounds()),h.width=Math.round(h.width),h.height=Math.round(h.height),h.x=Math.round(h.x),h.y=Math.round(h.y),h.width>0&&h.height>0){var l=h.width,_=h.height,u=oi.getRT(l,_);a.breakNextMerge(),a.pushRT(),a.addRenderObject(si.create([a,u,l,_],laya.webgl.utils.RenderSprite3D.tmpTarget,this)),r.render(a,-h.x,-h.y),a.breakNextMerge(),a.popRT(),a.save(),a.clipRect(i+h.x-t.getStyle().pivotX,n+h.y-t.getStyle().pivotY,l,_),s._fun.call(s,t,a,i,n),a.restore(),o=a.globalCompositeOperation,a.addRenderObject(si.create(["mask"],laya.webgl.utils.RenderSprite3D.setBlendMode,this));var c=mi.create(1,0),d=_n.INV_UV;a.drawTarget(u,i+h.x-t.getStyle().pivotX,n+h.y-t.getStyle().pivotY,l,_,fi.TEMP.identity(),c,d,6),a.addRenderObject(si.create([u],laya.webgl.utils.RenderSprite3D.recycleTarget,this)),a.addRenderObject(si.create([o],laya.webgl.utils.RenderSprite3D.setBlendMode,this))}a.restore()}else s._fun.call(s,t,e,i,n)},i._blend=function(t,e,i,n){var s=t._style,r=this._next;s.blendMode?(e.save(),e.globalCompositeOperation=s.blendMode,r._fun.call(r,t,e,i,n),e.restore()):r._fun.call(r,t,e,i,n)},e.tmpTarget=function(t,e){e.start(),e.clear(0,0,0,0)},e.recycleTarget=function(t){oi.releaseRT(t)},e.setBlendMode=function(t){var e=Oi.mainContext;fe.targetFns[fe.TOINT[t]](e)},n(e,["tempUV",function(){return this.tempUV=new Array(8)}]),e}(z),Rn=function(i){function n(){this.lastScaleX=1,this.lastScaleY=1,this.needResetScale=!1,n.__super.call(this),n.canvas||(n.canvas=t.document.createElement("canvas"),n.canvas.width=512,n.canvas.height=512,n.canvas.style.left="-1000px",n.canvas.style.position="absolute",e.body.appendChild(n.canvas),n.ctx=n.canvas.getContext("2d"))}s(n,"laya.webgl.resource.CharRender_Canvas",i);var r=n.prototype;return r.getWidth=function(t){return n.ctx?(n.ctx._lastFont!=xe._curFont&&(n.ctx.font=xe._curFont,n.ctx._lastFont=xe._curFont),n.ctx.measureText(t).width):0},r.scale=function(t,e){(this.lastScaleX!=t||this.lastScaleY!=e)&&(this.needResetScale&&(n.ctx.restore(),this.lastScaleX=this.lastScaleY=1),n.ctx.save(),this.needResetScale=!0,xe.isWan1Wan||n.ctx.scale(t,e),this.lastScaleX=t,this.lastScaleY=e)},r.getCharBmp=function(t,e,i,s,r,a,o,h,l,_){if(xe.isWan1Wan)return this.getCharCanvas(t,e,i,s,r,a,o,h,l,_);n.ctx.font!=e&&(n.ctx.font=e,n.ctx._lastFont=e),a.width=n.ctx.measureText(t).width;var u=a.width*this.lastScaleX,c=a.height*this.lastScaleY;return u+=(o+l)*this.lastScaleX,c+=(h+_)*this.lastScaleY,u=Math.min(u,laya.webgl.resource.CharRender_Canvas.canvas.width),c=Math.min(c,laya.webgl.resource.CharRender_Canvas.canvas.height),n.ctx.clearRect(0,0,u+1,c+1),n.ctx.textBaseline="top",i>0&&(n.ctx.strokeStyle=r,n.ctx.lineWidth=i,n.ctx.strokeText(t,o,h)),n.ctx.fillStyle=s,n.ctx.fillText(t,o,h),xe.debug&&(n.ctx.strokeStyle="#ff0000",n.ctx.strokeRect(0,0,u,c),n.ctx.strokeStyle="#00ff00",n.ctx.strokeRect(o,h,a.width,a.height)),n.ctx.getImageData(0,0,0|u,0|c)},r.getCharCanvas=function(t,e,i,s,r,a,o,h,l,_){n.ctx.font!=e&&(n.ctx.font=e,n.ctx._lastFont=e),a.width=n.ctx.measureText(t).width;var u=a.width*this.lastScaleX,c=a.height*this.lastScaleY;return u+=(o+l)*this.lastScaleX,c+=(h+_)*this.lastScaleY,u=Math.min(u,xe.textureWidth),c=Math.min(c,xe.textureWidth),n.canvas.width=Math.min(u+1,xe.textureWidth),n.canvas.height=Math.min(c+1,xe.textureWidth),n.ctx.font=e,this.needResetScale=!1,n.ctx.clearRect(0,0,u+1,c+1),n.ctx.save(),n.ctx.translate(o,h),xe.scaleFontWithCtx&&n.ctx.scale(this.lastScaleX,this.lastScaleY),n.ctx.textAlign="left",n.ctx.textBaseline="top",i>0?(n.ctx.strokeStyle=r,n.ctx.fillStyle=s,n.ctx.lineWidth=i,n.ctx.strokeText(t,0,0),n.ctx.fillText(t,0,0)):(n.ctx.fillStyle=s,n.ctx.fillText(t,0,0)),xe.debug&&(n.ctx.strokeStyle="#ff0000",n.ctx.strokeRect(0,0,u,c),n.ctx.strokeStyle="#00ff00",n.ctx.strokeRect(0,0,a.width,a.height)),n.ctx.restore(),n.canvas},n.canvas=null,n.ctx=null,n}(U),Tn=function(t){function e(){e.__super.call(this,e.__name2int,e.__int2name,e.__int2nameMap)}return s(e,"laya.webgl.shader.d2.ShaderDefines2D",t),e.__init__=function(){e.reg("TEXTURE2D",1),e.reg("PRIMITIVE",4),e.reg("GLOW_FILTER",8),e.reg("BLUR_FILTER",16),e.reg("COLOR_FILTER",32),e.reg("COLOR_ADD",64),e.reg("WORLDMAT",128),e.reg("FILLTEXTURE",256),e.reg("FSHIGHPRECISION",1024)},e.reg=function(t,i){M._reg(t,i,e.__name2int,e.__int2name)},e.toText=function(t,e,i){return M._toText(t,e,i)},e.toInt=function(t){return M._toInt(t,e.__name2int)},e.TEXTURE2D=1,e.PRIMITIVE=4,e.FILTERGLOW=8,e.FILTERBLUR=16,e.FILTERCOLOR=32,e.COLORADD=64,e.WORLDMAT=128,e.FILLTEXTURE=256,e.SKINMESH=512,e.SHADERDEFINE_FSHIGHPRECISION=1024,e.NOOPTMASK=312,e.__name2int={},e.__int2name=[],e.__int2nameMap=[],e}(M),bn=function(t){function e(){e.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,4,4),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}s(e,"laya.webgl.utils.MeshTexture",t);var i=e.prototype;return i.addData=function(t,i,n,s,r){for(var a=t.length/2,o=this._vb.needSize(a*e.const_stride),h=o>>2,l=this._vb._floatArray32||this._vb.getFloat32Array(),_=this._vb._uint32Array,u=0,c=0;a>c;c++){var d=t[u],f=t[u+1],p=d*s.a+f*s.c+s.tx,m=d*s.b+f*s.d+s.ty;l[h++]=p,l[h++]=m,l[h++]=i[u],l[h++]=i[u+1],u+=2,_[h++]=r,_[h++]=255}this._vb.setNeedUpload();var g=this.vertNum;if(g>0){var v=n.length;v>e.tmpIdx.length&&(e.tmpIdx=new Uint16Array(v));for(var y=0;v>y;y++)e.tmpIdx[y]=n[y]+g;this._ib.appendU16Array(e.tmpIdx,n.length)}else this._ib.append(n);this._ib.setNeedUpload(),this.vertNum+=a,this.indexNum+=n.length},i.releaseMesh=function(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},i.destroy=function(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()},e.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new e},e.const_stride=24,e._POOL=[],n(e,["_fixattriInfo",function(){return this._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),e}(Z),Pn=function(e){function i(){this.lastFont="",i.__super.call(this)}s(i,"laya.webgl.resource.CharRender_Native",e);var n=i.prototype;return n.getWidth=function(e){return t.conchTextCanvas?(this.lastFont!=xe._curFont&&(t.conchTextCanvas.font=xe._curFont,this.lastFont=xe._curFont),t.conchTextCanvas.measureText(e).width):0},n.scale=function(){},n.getCharBmp=function(e,i,n,s,r,a,h,l,_,u){if(!t.conchTextCanvas)return null;this.lastFont!=i&&(t.conchTextCanvas.font=xe._curFont,this.lastFont=xe._curFont);var c=a.width=t.conchTextCanvas.measureText(e).width,d=a.height;c+=h+_,d+=l+u;var f=o.create(r),p=f.numColor,m=o.create(s),g=m.numColor,v=t.conchTextCanvas.getTextBitmapData(e,g,n>2?2:n,p);return v},i}(U),Ln=function(t){function e(){this.contextHeight=0/0,this.contextWidth=0/0,this._htmlBounds=null,this._boundsRec=null,this.repaintHandler=null,e.__super.call(this)}s(e,"laya.html.dom.HTMLDivParser",t);var n=e.prototype;return n.reset=function(){return t.prototype.reset.call(this),this._style.block=!0,this._style.setLineElement(!0),this._style.width=200,this._style.height=200,this.repaintHandler=null,this.contextHeight=0,this.contextWidth=0,this},n.appendHTML=function(t){De.parse(this,t,this.URI),this.layout()},n._addChildsToLayout=function(t){var e=this._getWords();if(null==e&&(!this._children||0==this._children.length))return!1;e&&e.forEach(function(e){t.push(e)});for(var i=!0,n=0,s=this._children.length;s>n;n++){var r=this._children[n];i?i=!1:t.push(null),r._addToLayout(t)}return!0},n._addToLayout=function(t){this.layout(),!this.style.absolute&&t.push(this)},n.getBounds=function(){return this._htmlBounds?(this._boundsRec||(this._boundsRec=He.create()),this._boundsRec.copyFrom(this._htmlBounds)):null},n.parentRepaint=function(e){void 0===e&&(e=!1),t.prototype.parentRepaint.call(this),this.repaintHandler&&this.repaintHandler.runWith(e)},n.layout=function(){this.style._type|=512;var t=me.layout(this);if(t){this._htmlBounds||(this._htmlBounds=He.create());var e=this._htmlBounds;e.x=e.y=0,e.width=this.contextWidth=t[0],e.height=this.contextHeight=t[1]}},r(0,n,"height",function(){return this._height?this._height:this.contextHeight},t.prototype._$set_height),r(0,n,"innerHTML",null,function(t){this.destroyChildren(),this.appendHTML(t)}),r(0,n,"width",function(){return this._width?this._width:this.contextWidth},function(t){var e=!1;e=0===t?t!=this._width:t!=this.width,i.superSet(X,this,"width",t),e&&this.layout()}),e}(X),In=function(t){function e(){e.__super.call(this,laya.webgl.utils.MeshQuadTexture.const_stride,4,4),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshQuadTexture._fixattriInfo),laya.webgl.utils.MeshQuadTexture._fixib?(this._ib=laya.webgl.utils.MeshQuadTexture._fixib,this._quadNum=e._maxIB):(this.createQuadIB(e._maxIB),laya.webgl.utils.MeshQuadTexture._fixib=this._ib)}s(e,"laya.webgl.utils.MeshQuadTexture",t);var i=e.prototype;return i.releaseMesh=function(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshQuadTexture._POOL.push(this)},i.destroy=function(){this._vb.destroy(),this._vb.deleteBuffer()},i.addQuad=function(t,e,i,n){var s=this._vb,r=s._byteLength>>2;s.setByteLength(r+laya.webgl.utils.MeshQuadTexture.const_stride<<2);var a=s._floatArray32||s.getFloat32Array(),o=s._uint32Array,h=r,l=n?255:0;a[h++]=t[0],a[h++]=t[1],a[h++]=e[0],a[h++]=e[1],o[h++]=i,o[h++]=l,a[h++]=t[2],a[h++]=t[3],a[h++]=e[2],a[h++]=e[3],o[h++]=i,o[h++]=l,a[h++]=t[4],a[h++]=t[5],a[h++]=e[4],a[h++]=e[5],o[h++]=i,o[h++]=l,a[h++]=t[6],a[h++]=t[7],a[h++]=e[6],a[h++]=e[7],o[h++]=i,o[h++]=l,s._upload=!0},e.getAMesh=function(){return laya.webgl.utils.MeshQuadTexture._POOL.length?laya.webgl.utils.MeshQuadTexture._POOL.pop():new e},e.const_stride=24,e._fixib=null,e._maxIB=16384,e._POOL=[],n(e,["_fixattriInfo",function(){return this._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}]),e}(Z),Mn=(function(t){function e(){e.__super.call(this)}s(e,"laya.html.dom.HTMLLinkElement",t);var i=e.prototype;return i._creates=function(){},i.drawToGraphic=function(){},i.reset=function(){return this._loader&&this._loader.off("complete",this,this._onload),this._loader=null,this},i._onload=function(t){switch(this._loader&&(this._loader=null),this.type){case"text/css":Hi.parseCSS(t,this.URI)}this.repaint(!0)},r(0,i,"href",t.prototype._$get_href,function(t){if(t){if(t=this.formatURL(t),this.URI=new Mi(t),this._loader&&this._loader.off("complete",this,this._onload),un.getRes(t))return"text/css"==this.type&&Hi.parseCSS(un.getRes(t),this.URI),void 0;this._loader=new un,this._loader.once("complete",this,this._onload),this._loader.load(t,"text")}}),e._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g"),e}(X),function(t){function e(){e.__super.call(this)}s(e,"laya.html.dom.HTMLImageElement",t);var i=e.prototype;return i.reset=function(){return t.prototype.reset.call(this),this._tex&&this._tex.off("loaded",this,this.onloaded),this._tex=null,this._url=null,this},i.onloaded=function(){{var t=this._style;t.widthed(this)?-1:this._tex.width,t.heighted(this)?-1:this._tex.height}t.widthed(this)||this._width==this._tex.width||(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),t.heighted(this)||this._height==this._tex.height||(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),this.repaint()},i._addToLayout=function(t){var e=this._style;!e.absolute&&t.push(this)},i.renderSelfToGraphic=function(t,e,i){this._tex&&t.drawImage(this._tex,e,i,this.width||this._tex.width,this.height||this._tex.height)},r(0,i,"src",null,function(t){if(t=this.formatURL(t),this._url!==t){this._url=t;var e=this._tex=un.getRes(t);e||(this._tex=e=new _n,e.load(t),un.cacheRes(t,e)),e.getIsReady()?this.onloaded():e.once("ready",this,this.onloaded)}}),e}(X),function(t){function e(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,e.__super.call(this)}s(e,"laya.ui.AutoBitmap",t);var n=e.prototype;return n.destroy=function(){t.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},n._setChanged=function(){this._isChanged||(this._isChanged=!0,i.timer.callLater(this,this.changeSource))},n.changeSource=function(){this._isChanged=!1;var t=this._source;if(t&&t.bitmap){var i=this.width,n=this.height,s=this._sizeGrid,r=t.sourceWidth,a=t.sourceHeight;if(!s||r===i&&a===n)this.clear(),this.drawTexture(t,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,i,n);else{this.clear();var o=s[0],h=s[1],l=s[2],_=s[3],u=s[4],c=!1;if(i==r&&(_=h=0),n==a&&(o=l=0),_+h>i){var d=i;c=!0,i=_+h,this.save(),this.clipRect(0,0,d,n)}_&&o&&this.drawImage(e.getTexture(t,0,0,_,o),0,0,_,o),h&&o&&this.drawImage(e.getTexture(t,r-h,0,h,o),i-h,0,h,o),_&&l&&this.drawImage(e.getTexture(t,0,a-l,_,l),0,n-l,_,l),h&&l&&this.drawImage(e.getTexture(t,r-h,a-l,h,l),i-h,n-l,h,l),o&&this.drawBitmap(u,e.getTexture(t,_,0,r-_-h,o),_,0,i-_-h,o),l&&this.drawBitmap(u,e.getTexture(t,_,a-l,r-_-h,l),_,n-l,i-_-h,l),_&&this.drawBitmap(u,e.getTexture(t,0,o,_,a-o-l),0,o,_,n-o-l),h&&this.drawBitmap(u,e.getTexture(t,r-h,o,h,a-o-l),i-h,o,h,n-o-l),this.drawBitmap(u,e.getTexture(t,_,o,r-_-h,a-o-l),_,o,i-_-h,n-o-l),c&&this.restore()}this._repaint()}},n.drawBitmap=function(t,e,i,n,s,r){void 0===s&&(s=0),void 0===r&&(r=0),.1>s||.1>r||(!t||e.width==s&&e.height==r?this.drawImage(e,i,n,s,r):this.fillTexture(e,i,n,s,r))},r(0,n,"sizeGrid",function(){return this._sizeGrid},function(t){this._sizeGrid=t,this._setChanged()}),r(0,n,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(t){this._width!=t&&(this._width=t,this._setChanged())}),r(0,n,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(t){this._height!=t&&(this._height=t,this._setChanged())}),r(0,n,"source",function(){return this._source},function(t){t?(this._source=t,this._setChanged()):(this._source=null,this.clear())}),e.getTexture=function(t,e,i,n,s){0>=n&&(n=1),0>=s&&(s=1),t.$_GID||(t.$_GID=ee.getGID());var r;return r&&r._getSource()||(r=_n.createFromTexture(t,e,i,n,s)),r},e}(ze)),wn=function(t){function e(){e.__super.call(this)}return s(e,"laya.webgl.BufferState2D",t),e}(qe),On=function(t){function e(){this.texcoord=null,this.position=null,this.offsetX=300,this.offsetY=0,e.__super.call(this,512,0);var t=8*Ie.BYTES_PE;this.position=[2,5126,!1,t,0],this.texcoord=[2,5126,!1,t,2*Ie.BYTES_PE],this.color=[4,5126,!1,t,4*Ie.BYTES_PE]}return s(e,"laya.webgl.shader.d2.skinAnishader.SkinSV",t),e}(mi),Bn=function(t){function e(t){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,void 0===t&&(t=0),e.__super.call(this,1,t),this._attribLocation=["posuv",0,"attribColor",1,"attribFlags",2]}s(e,"laya.webgl.shader.d2.value.TextureSV",t);var i=e.prototype;return i.clear=function(){this.texture=null,this.shader=null,this.defines._value=this.subID+(Oi.shaderHighPrecision?1024:0)},e}(mi),Nn=function(t){function e(){e.__super.call(this,4,0),this._attribLocation=["position",0,"attribColor",1]}return s(e,"laya.webgl.shader.d2.value.PrimitiveSV",t),e}(mi),kn=function(t){function e(){this._x=0,this._y=0,this._width=0,this._height=0,this._visible=!0,this._mouseState=0,this._zOrder=0,this._renderType=0,this._transform=null,this._tfChanged=!1,this._texture=null,this._boundStyle=null,this._graphics=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,e.__super.call(this),this._repaint=0,this._style=le.EMPTY,this._cacheStyle=_i.EMPTY}s(e,"laya.display.Sprite",t);var n=e.prototype;return n.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._style&&this._style.recover(),this._cacheStyle&&this._cacheStyle.recover(),this._boundStyle&&this._boundStyle.recover(),this._style=null,this._cacheStyle=null,this._boundStyle=null,this._transform=null,this._graphics&&this._graphics.autoDestroy&&this._graphics.destroy(),this._graphics=null,this.texture=null},n.updateZOrder=function(){ee.updateOrder(this._children)&&this.repaint()},n._getBoundsStyle=function(){return this._boundStyle||(this._boundStyle=Te.create()),this._boundStyle},n._setCustomRender=function(){},n._setCacheAs=function(){},n._checkCanvasEnable=function(){var t=this._cacheStyle.needEnableCanvasRender();this._getCacheStyle().enableCanvasRender=t,t?(this._cacheStyle.cacheAs=this._cacheStyle.needBitmapCache()?"bitmap":this._cacheStyle.userSetCache,this._cacheStyle.reCache=!0,this._renderType|=8):(this._cacheStyle.cacheAs="none",this._cacheStyle.releaseContext(),this._renderType&=-9),this._setCacheAs(this._cacheStyle.cacheAs),this._setRenderType(this._renderType)},n.reCache=function(){this._cacheStyle.reCache=!0,this._repaint|=2},n.getRepaint=function(){return this._repaint},n._setX=function(t){this._x=t},n._setY=function(t){this._y=t},n.setSelfBounds=function(t){this._getBoundsStyle().userBounds=t},n.getBounds=function(){return this._getBoundsStyle().bounds=He._getWrapRec(this._boundPointsToParent())},n.getSelfBounds=function(){return this._boundStyle&&this._boundStyle.userBounds?this._boundStyle.userBounds:this._graphics||0!==this._children.length||this._texture?this._getBoundsStyle().bounds=He._getWrapRec(this._getBoundPointsM(!1)):He.TEMP.setTo(0,0,0,0)},n._boundPointsToParent=function(t){void 0===t&&(t=!1);var e=0,i=0;this._style&&(e=this.pivotX,i=this.pivotY,t=t||0!==this._style.rotation,this._style.scrollRect&&(e+=this._style.scrollRect.x,i+=this._style.scrollRect.y));var n=this._getBoundPointsM(t);if(!n||n.length<1)return n;if(8!=n.length&&(n=t?q.scanPList(n):He._getWrapRec(n,He.TEMP)._getBoundPoints()),!this.transform)return ee.transPointList(n,this._x-e,this._y-i),n;var s=$i.TEMP,r=0,a=n.length;for(r=0;a>r;r+=2)s.x=n[r],s.y=n[r+1],this.toParentPoint(s),n[r]=s.x,n[r+1]=s.y;return n},n.getGraphicBounds=function(t){return void 0===t&&(t=!1),this._graphics?this._graphics.getBounds(t):He.TEMP.setTo(0,0,0,0)},n._getBoundPointsM=function(t){if(void 0===t&&(t=!1),this._boundStyle&&this._boundStyle.userBounds)return this._boundStyle.userBounds._getBoundPoints();if(this._boundStyle||this._getBoundsStyle(),this._boundStyle.temBM||(this._boundStyle.temBM=[]),this._style.scrollRect){var e=ee.clearArray(this._boundStyle.temBM),i=He.TEMP;return i.copyFrom(this._style.scrollRect),ee.concatArray(e,i._getBoundPoints()),e}var n;this._graphics?n=this._graphics.getBoundPoints():(n=ee.clearArray(this._boundStyle.temBM),this._texture&&(i=He.TEMP,i.setTo(0,0,this._texture.width,this._texture.height),ee.concatArray(n,i._getBoundPoints())));var s,r,a;a=this._children;for(var o=0,h=a.length;h>o;o++)s=a[o],s instanceof laya.display.Sprite&&s._visible===!0&&(r=s._boundPointsToParent(t),r&&(n=n?ee.concatArray(n,r):r));return n},n._getCacheStyle=function(){return this._cacheStyle===_i.EMPTY&&(this._cacheStyle=_i.create()),this._cacheStyle},n.getStyle=function(){return this._style===le.EMPTY&&(this._style=le.create()),this._style},n.setStyle=function(t){this._style=t},n._setScaleX=function(t){this._style.scaleX=t},n._setScaleY=function(t){this._style.scaleY=t},n._setRotation=function(t){this._style.rotation=t},n._setSkewX=function(t){this._style.skewX=t},n._setSkewY=function(t){this._style.skewY=t},n._createTransform=function(){return fi.create()},n._adjustTransform=function(){this._tfChanged=!1;var t=this._style,e=t.scaleX,i=t.scaleY,n=this._transform||(this._transform=this._createTransform());if(t.rotation||1!==e||1!==i||0!==t.skewX||0!==t.skewY){n._bTransform=!0;var s=.0174532922222222*(t.rotation-t.skewX),r=.0174532922222222*(t.rotation+t.skewY),a=Math.cos(r),o=Math.sin(r),h=Math.sin(s),l=Math.cos(s);n.a=e*a,n.b=e*o,n.c=-i*h,n.d=i*l,n.tx=n.ty=0}else n.identity(),this._renderType&=-3,this._setRenderType(this._renderType);return n},n._setTransform=function(){},n._setPivotX=function(t){var e=this.getStyle();e&&(e.pivotX=t)},n._getPivotX=function(){return this._style.pivotX},n._setPivotY=function(t){var e=this.getStyle();e&&(e.pivotY=t)},n._getPivotY=function(){return this._style.pivotY},n._setAlpha=function(t){if(this._style.alpha!==t){var e=this.getStyle();e.alpha=t,1!==t?this._renderType|=1:this._renderType&=-2,this._setRenderType(this._renderType),this.parentRepaint()}},n._getAlpha=function(){return this._style.alpha},n._setBlendMode=function(){},n._setGraphics=function(){},n._setGraphicsCallBack=function(){},n._setScrollRect=function(){},n.pos=function(t,e,i){if(void 0===i&&(i=!1),this._x!==t||this._y!==e){if(this.destroyed)return this;if(i){this._setX(t),this._setY(e),this.parentRepaint(2);var n=this._cacheStyle.maskParent;n&&n.repaint(2)}else this.x=t,this.y=e}return this},n.pivot=function(t,e){return this.pivotX=t,this.pivotY=e,this},n.size=function(t,e){return this.width=t,this.height=e,this},n.scale=function(t,e,i){void 0===i&&(i=!1);var n=this.getStyle();if(n.scaleX!=t||n.scaleY!=e){if(this.destroyed)return this;i?(this._setScaleX(t),this._setScaleY(e),this._setTranformChange()):(this.scaleX=t,this.scaleY=e)}return this},n.skew=function(t,e){return this.skewX=t,this.skewY=e,this},n.render=function(t,e,i){wi.spriteCount++,z.renders[this._renderType]._fun(this,t,e+this._x,i+this._y),this._repaint=0},n.drawToCanvas=function(t,e,i,n){return qi.drawToCanvas(this,this._renderType,t,e,i,n)},n.customRender=function(){this._repaint=3},n._applyFilters=function(){if(!Ni.isWebGL){var t;if(t=this._cacheStyle.filters,t&&!(t.length<1))for(var e=0,i=t.length;i>e;e++)t[e]._action&&t[e]._action.apply(this._cacheStyle)}},n._setColorFilter=function(){},n._isHaveGlowFilter=function(){var t=0,e=0;if(this.filters)for(t=0;t<this.filters.length;t++)if(8==this.filters[t].type)return!0;for(t=0,e=this._children.length;e>t;t++)if(this._children[t]._isHaveGlowFilter())return!0;return!1},n.localToGlobal=function(t,e,n){void 0===e&&(e=!1),e===!0&&(t=new $i(t.x,t.y));var s=this;for(n=n||i.stage;s&&s!=n;)t=s.toParentPoint(t),s=s.parent;return t},n.globalToLocal=function(t,e,n){void 0===e&&(e=!1),e&&(t=new $i(t.x,t.y));var s=this,r=[];for(n=n||i.stage;s&&s!=n;)r.push(s),s=s.parent;for(var a=r.length-1;a>=0;)s=r[a],t=s.fromParentPoint(t),a--;return t},n.toParentPoint=function(t){if(!t)return t;t.x-=this.pivotX,t.y-=this.pivotY,this.transform&&this._transform.transformPoint(t),t.x+=this._x,t.y+=this._y;var e=this._style.scrollRect;return e&&(t.x-=e.x,t.y-=e.y),t},n.fromParentPoint=function(t){if(!t)return t;t.x-=this._x,t.y-=this._y;var e=this._style.scrollRect;return e&&(t.x+=e.x,t.y+=e.y),this.transform&&this._transform.invertTransformPoint(t),t.x+=this.pivotX,t.y+=this.pivotY,t},n.on=function(e,i,n,s){return 1!==this._mouseState&&this.isMouseEvent(e)?(this.mouseEnabled=!0,this._setBit(64,!0),this._parent&&this._$2__onDisplay(),this._createListener(e,i,n,s,!1)):t.prototype.on.call(this,e,i,n,s)},n.once=function(e,i,n,s){return 1!==this._mouseState&&this.isMouseEvent(e)?(this.mouseEnabled=!0,this._setBit(64,!0),this._parent&&this._$2__onDisplay(),this._createListener(e,i,n,s,!0)):t.prototype.once.call(this,e,i,n,s)},n._$2__onDisplay=function(){if(1!==this._mouseState){var t=this;for(t=t.parent;t&&1!==t._mouseState&&!t._getBit(64);)t.mouseEnabled=!0,t._setBit(64,!0),t=t.parent}},n._setParent=function(e){t.prototype._setParent.call(this,e),e&&this._getBit(64)&&this._$2__onDisplay()},n.loadImage=function(t,e){function i(){n.repaint(3),e&&e.run()}var n=this;if(null==t)this.texture=null,i();else{var s=un.getRes(t);s||(s=new _n,s.load(t),un.cacheRes(t,s)),this.texture=s,s.getIsReady()?i():s.once("ready",null,i)}return this},n.repaint=function(t){void 0===t&&(t=2),this._repaint&t||(this._repaint|=t,this.parentRepaint(t)),this._cacheStyle&&this._cacheStyle.maskParent&&this._cacheStyle.maskParent.repaint(t)},n._needRepaint=function(){return 2&this._repaint&&this._cacheStyle.enableCanvasRender&&this._cacheStyle.reCache},n._childChanged=function(t){this._children.length?this._renderType|=8192:this._renderType&=-8193,this._setRenderType(this._renderType),t&&this._getBit(32)&&i.systemTimer.callLater(this,this.updateZOrder),this.repaint(3)},n.parentRepaint=function(t){void 0===t&&(t=2);var e=this._parent;!e||e._repaint&t||(e._repaint|=t,e.parentRepaint(t))},n._setMask=function(){},n.startDrag=function(t,e,i,n,s,r,a){void 0===e&&(e=!1),void 0===i&&(i=0),void 0===n&&(n=300),void 0===r&&(r=!1),void 0===a&&(a=.92),this._style.dragging||(this.getStyle().dragging=new Yi),this._style.dragging.start(this,t,e,i,n,s,r,a)},n.stopDrag=function(){this._style.dragging&&this._style.dragging.stop()},n._setDisplay=function(e){e||this._cacheStyle&&(this._cacheStyle.releaseContext(),this._cacheStyle.releaseFilterCache(),this._cacheStyle.hasGlowFilter&&(this._cacheStyle.hasGlowFilter=!1)),t.prototype._setDisplay.call(this,e)},n.hitTestPoint=function(t,e){var i=this.globalToLocal($i.TEMP.setTo(t,e));t=i.x,e=i.y;var n=this._style.hitArea?this._style.hitArea:this._width>0&&this._height>0?He.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds();return n.contains(t,e)},n.getMousePoint=function(){return this.globalToLocal($i.TEMP.setTo(i.stage.mouseX,i.stage.mouseY))},n._setTexture=function(){},n._setRenderType=function(){},n._setTranformChange=function(){this._tfChanged=!0,this._renderType|=2,this._setRenderType(this._renderType),this.parentRepaint(2)},n._setBgStyleColor=function(){},n._setBorderStyleColor=function(){},r(0,n,"customRenderEnable",null,function(t){t&&(this._renderType|=2048,this._setRenderType(this._renderType),this._setCustomRender())}),r(0,n,"cacheAs",function(){return this._cacheStyle.cacheAs},function(t){t!==this._cacheStyle.userSetCache&&(Ni.isConchApp&&"bitmap"!=t||this.mask&&"normal"===t||(this._setCacheAs(t),this._getCacheStyle().userSetCache=t,this._checkCanvasEnable(),this.repaint()))}),r(0,n,"globalScaleY",function(){for(var t=1,e=this;e&&e!==i.stage;)t*=e.scaleY,e=e.parent;return t}),r(0,n,"hitArea",function(){return this._style.hitArea},function(t){this.getStyle().hitArea=t}),r(0,n,"staticCache",function(){return this._cacheStyle.staticCache},function(t){this._getCacheStyle().staticCache=t,t||this.reCache()}),r(0,n,"displayWidth",function(){return this.width*this.scaleX}),r(0,n,"zOrder",function(){return this._zOrder},function(t){this._zOrder!=t&&(this._zOrder=t,this._parent&&(t&&this._parent._setBit(32,!0),i.systemTimer.callLater(this._parent,this.updateZOrder)))}),r(0,n,"rotation",function(){return this._style.rotation},function(t){var e=this.getStyle();e.rotation!==t&&(this._setRotation(t),this._setTranformChange())}),r(0,n,"width",function(){return this.autoSize?this.texture?this.texture.width:this._graphics||0!==this._children.length?this.getSelfBounds().width:0:this._width||(this.texture?this.texture.width:0)},function(t){this._width!==t&&(this._width=t,this.repaint())}),r(0,n,"x",function(){return this._x},function(t){if(!this.destroyed&&this._x!==t){this._setX(t),this.parentRepaint(2);var e=this._cacheStyle.maskParent;e&&e.repaint(2)}}),r(0,n,"texture",function(){return this._texture},function(t){"string"==typeof t?this.loadImage(t):this._texture!=t&&(this._texture&&this._texture._removeReference(),this._texture=t,t&&t._addReference(),this._setTexture(t),t?this._renderType|=256:this._renderType&=-257,this._setRenderType(this._renderType),this.repaint())}),r(0,n,"globalRotation",function(){for(var t=0,e=this;e&&e!==i.stage;)t+=e.rotation,e=e.parent;return t}),r(0,n,"y",function(){return this._y},function(t){if(!this.destroyed&&this._y!==t){this._setY(t),this.parentRepaint(2);var e=this._cacheStyle.maskParent;e&&e.repaint(2)}}),r(0,n,"displayHeight",function(){return this.height*this.scaleY}),r(0,n,"height",function(){return this.autoSize?this.texture?this.texture.height:this._graphics||0!==this._children.length?this.getSelfBounds().height:0:this._height||(this.texture?this.texture.height:0)},function(t){this._height!==t&&(this._height=t,this.repaint())}),r(0,n,"blendMode",function(){return this._style.blendMode},function(t){this._setBlendMode(t),this.getStyle().blendMode=t,t&&"source-over"!=t?this._renderType|=4:this._renderType&=-5,this._setRenderType(this._renderType),this.parentRepaint()}),r(0,n,"scaleX",function(){return this._style.scaleX},function(t){var e=this.getStyle();e.scaleX!==t&&(this._setScaleX(t),this._setTranformChange())}),r(0,n,"scaleY",function(){return this._style.scaleY},function(t){var e=this.getStyle();e.scaleY!==t&&(this._setScaleY(t),this._setTranformChange())}),r(0,n,"stage",function(){return i.stage}),r(0,n,"skewX",function(){return this._style.skewX},function(t){var e=this.getStyle();e.skewX!==t&&(this._setSkewX(t),this._setTranformChange())}),r(0,n,"scrollRect",function(){return this._style.scrollRect},function(t){this.getStyle().scrollRect=t,this._setScrollRect(t),this.repaint(),t?this._renderType|=64:this._renderType&=-65,this._setRenderType(this._renderType)}),r(0,n,"skewY",function(){return this._style.skewY},function(t){var e=this.getStyle();e.skewY!==t&&(this._setSkewY(t),this._setTranformChange())}),r(0,n,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(t){this._tfChanged=!1;var e=this._transform||(this._transform=this._createTransform());t.copyTo(e),this._setTransform(e),t&&(this._x=t.tx,this._y=t.ty,t.tx=t.ty=0),t?this._renderType|=2:this._renderType&=-3,this._setRenderType(this._renderType),this.parentRepaint()}),r(0,n,"pivotX",function(){return this._getPivotX()},function(t){this._setPivotX(t),this.repaint()}),r(0,n,"pivotY",function(){return this._getPivotY()},function(t){this._setPivotY(t),this.repaint()}),r(0,n,"alpha",function(){return this._getAlpha()},function(t){t=0>t?0:t>1?1:t,this._setAlpha(t)}),r(0,n,"visible",function(){return this._visible},function(t){this._visible!==t&&(this._visible=t,this.parentRepaint(3))}),r(0,n,"graphics",function(){return this._graphics||(this.graphics=new ze,this._graphics.autoDestroy=!0),this._graphics},function(t){this._graphics&&(this._graphics._sp=null),this._graphics=t,t?(this._setGraphics(t),this._renderType|=512,t._sp=this):this._renderType&=-513,this._setRenderType(this._renderType),this.repaint()}),r(0,n,"filters",function(){return this._cacheStyle.filters},function(t){t&&0===t.length&&(t=null),this._cacheStyle.filters!=t&&(this._getCacheStyle().filters=t?t.slice():null,(Ni.isWebGL||Ni.isConchApp)&&(t&&t.length?(this._setColorFilter(t[0]),this._renderType|=16):(this._setColorFilter(null),this._renderType&=-17),this._setRenderType(this._renderType)),t&&t.length>0?(this._getBit(16)||this._setBitUp(16),(Ni.isWebGL||Ni.isConchApp)&&1==t.length&&t[0]instanceof laya.filters.ColorFilter||(this._getCacheStyle().cacheForFilters=!0,this._checkCanvasEnable())):this._cacheStyle.cacheForFilters&&(this._cacheStyle.cacheForFilters=!1,this._checkCanvasEnable()),this._getCacheStyle().hasGlowFilter=this._isHaveGlowFilter(),this.repaint())}),r(0,n,"mask",function(){return this._cacheStyle.mask},function(t){t&&this.mask&&this.mask._cacheStyle.maskParent||(this._getCacheStyle().mask=t,this._setMask(t),this._checkCanvasEnable(),t?t._getCacheStyle().maskParent=this:this.mask&&(this.mask._getCacheStyle().maskParent=null),this._renderType|=32,this._setRenderType(this._renderType),this.parentRepaint(3))
}),r(0,n,"mouseEnabled",function(){return this._mouseState>1},function(t){this._mouseState=t?2:1}),r(0,n,"globalScaleX",function(){for(var t=1,e=this;e&&e!==i.stage;)t*=e.scaleX,e=e.parent;return t}),r(0,n,"mouseX",function(){return this.getMousePoint().x}),r(0,n,"mouseY",function(){return this.getMousePoint().y}),r(0,n,"viewport",function(){return this._style.viewport},function(t){if("string"==typeof t){var e;e=t.split(","),e.length>3&&(t=new He(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])))}this.getStyle().viewport=t}),e.fromImage=function(t){return(new e).loadImage(t)},e}(rn),Fn=function(e){function i(){this.hr=null,this.txtLogin=null,this.txtReg=null,this.versioninfo=null,i.__super.call(this),_e.multiTouchEnabled=!1}s(i,"script.MainPageControl",e);var n=i.prototype;return n.onStart=function(){this.txtLogin=this.owner.txt_login,this.txtLogin.on("click",this,this.onShowLogin),this.txtReg=this.owner.txt_reg,this.txtReg.on("click",this,this.onShowReg);var t=this.owner.btnUpload;t.on("click",this,this.onShowUpload);var e=this.owner.paintOrderBtn;e.on("click",this,this.onShowPaintOrder);var i=this.owner.btnUserCenter;i.on("click",this,this.onShowUserCenter);var n=this.owner.btnproduct;n.on("click",this,this.onProductView),this.versioninfo=this.owner.enterinfo,this.versioninfo.y=Be.clientHeight-this.versioninfo.height;var s=this.owner.linktobus;s.on("click",this,this.onOpenGongshang),on.instance.on("LOGIN_SUCESS",this,this.onSucessLogin),on.instance.on("BROWER_WINDOW_RESIZE",this,this.onResizeBrower),this.owner.panel_main.height=Be.clientHeight,f.instance.isLogin?(this.txtLogin.text=f.instance.userAccount,this.txtReg.text="[退出]"):this.loginAccount()},n.onOpenGongshang=function(){Be.window.open("http://www.gsxt.gov.cn/%7BF71C582A907AA9A77C0EF218C30915AFDDBCA77C96F73D4D09E3592B4A85097B87E62C5C18F2E9E75EE4EA5348B4AF45DB63374BC6AAC586EABEEBA8C48C8DD0A853A853A8F58D760E76817A817A8176817A024DB6A75CAB50ABF60D751CACB07FDF33E8223E00FC469D79017924DF021917AEB5D4C813F78F748F748F74-1561088596102%7D",null,null,!0)},n.loginAccount=function(){var t=y.getLocalVar("useraccount","0"),e=y.getLocalVar("userpwd","0");if("0"!=t&&"0"!=e&&""!=t&&""!=e){var i="phone="+t+"&pwd="+e+"&mode=0";R.instance.Request(R.httpUrl+"account/login?",this,this.onLoginBack,i,"post")}},n.onLoginBack=function(t){var e=JSON.parse(t);if(0==e.status){var i=y.getLocalVar("useraccount","");f.instance.userAccount=i,f.instance.isLogin=!0,this.txtLogin.text=i,this.txtReg.text="[退出]",R.instance.Request(R.httpUrl+"group/opt-group-express?",this,this.getMyAddressBack,"opt=list&page=1","post")}},n.getMyAddressBack=function(t){var e=JSON.parse(t);0==e.status&&(f.instance.initMyAddress(e.data),f.instance.defaultAddId=e["default"])},n.onResizeBrower=function(){console.log("height:"+Be.clientHeight+","+t.screen.availHeight+","+t.screen.availWidth),this.versioninfo.y=Be.clientHeight-this.versioninfo.height,this.owner.panel_main.height=Be.clientHeight},n.onShowUpload=function(){f.instance.isLogin?v.instance.openView("VIEW_PICMANAGER",!0):(v.showAlert("请先登录"),v.instance.openView("VIEW_lOGPANEL"))},n.onShowPaintOrder=function(){f.instance.isLogin?v.instance.openView("VIEW_PAINT_ORDER",!0):(v.showAlert("请先登录"),v.instance.openView("VIEW_lOGPANEL"))},n.onShowUserCenter=function(){return f.instance.isLogin?(v.instance.openView("VIEW_USERCENTER",!0),void 0):(v.showAlert("请先登录"),v.instance.openView("VIEW_lOGPANEL"),void 0)},n.onShowLogin=function(){f.instance.isLogin||v.instance.openView("VIEW_lOGPANEL")},n.onShowReg=function(){f.instance.isLogin?R.instance.Request(R.httpUrl+"account/logout?",this,this.onLoginOutBack,"","post"):v.instance.openView("VIEW_REGPANEL",!0)},n.onLoginOutBack=function(t){var e=JSON.parse(t);0==e.status&&(f.instance.isLogin=!1,this.txtLogin.text="[登录]",this.txtReg.text="[注册]",y.setLocalVar("useraccount",""),y.setLocalVar("userpwd",""))},n.onSucessLogin=function(t){this.txtLogin.text=t,this.txtReg.text="[退出]",R.instance.Request(R.httpUrl+"group/opt-group-express?",this,this.getMyAddressBack,"opt=list&page=1","post")},n.onEnable=function(){_e.multiTouchEnabled=!1;var t=this.owner.panel_main;t.vScrollBarSkin=""},n.onHttpRequestError=function(t){console.log(t)},n.onHttpRequestProgress=function(t){console.log(t)},n.onHttpRequestComplete=function(t){console.log(t)},n.onBrowerResize=function(){console.log("wid:"+Be.width);this.owner},n.onProductView=function(){return f.instance.isLogin?(v.instance.openView("VIEW_PRODUCT_VIEW",!0),void 0):(v.showAlert("请先登录"),v.instance.openView("VIEW_lOGPANEL"),void 0)},n.onTipClick=function(){},n.onDestroy=function(){on.instance.off("LOGIN_SUCESS",this,this.onSucessLogin),on.instance.off("BROWER_WINDOW_RESIZE",this,this.onResizeBrower)},i}(an),Vn=function(t){function e(){this.uiSkin=null,this.param=null,e.__super.call(this)}s(e,"script.product.BuyProductControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.btnclose.on("click",this,this.closePanel),this.uiSkin.proname.text=this.param.pname,this.uiSkin.productimg.skin="product/p"+(1+this.param.pid)+".jpg",this.uiSkin.pricetxt.text=this.param.price+"元";var t=this.param.allsize;this.uiSkin.size0.label=t[0],this.uiSkin.size1.label=t[1],this.uiSkin.btnbuy.on("click",this,this.onClickBuy),this.uiSkin.size0.selected=!0,this.uiSkin.size0.on("click",this,this.onClickSize,[this.uiSkin.size0]),this.uiSkin.size1.on("click",this,this.onClickSize,[this.uiSkin.size1]),this.uiSkin.numinput.restrict="0-9",this.uiSkin.numinput.maxChars=3,this.uiSkin.numinput.on("input",this,this.onNumChange)},i.onClickSize=function(t){this.uiSkin.size0.selected=t==this.uiSkin.size0,this.uiSkin.size1.selected=t==this.uiSkin.size1},i.onNumChange=function(){""==this.uiSkin.numinput.text&&(this.uiSkin.numinput.text="1");var t=parseInt(this.uiSkin.numinput.text);0>=t&&(this.uiSkin.numinput.text="1",t=1),this.uiSkin.pricetxt.text=(t*this.param.price).toString()+"元"},i.onClickBuy=function(){v.instance.openView("VIEW_POPUPDIALOG",!1,{msg:"购买成功"}),this.closePanel()},i.closePanel=function(){v.instance.closeView("VIEW_BUY_PRODUCT_VIEW")},e}(an),Un=function(t){function e(){this.uiSkin=null,this.viewArr=null,this.btntxtArr=null,this.curView=null,this.titleTxt=null,this.param=null,e.__super.call(this)}s(e,"script.usercenter.UserMainControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.panel_main.vScrollBarSkin="",this.viewArr=[cr,fr,null,Fs,null,hr],this.btntxtArr=[],this.titleTxt=["企业资料","收货地址","购物车","我的订单","委托订单","账户充值","我的订单"];for(var t=0;9>t;t++)this.uiSkin["btntxt"+t].on("click",this,this.onShowEditView,[t]),this.uiSkin["btntxt"+t].on("mouseover",this,this.onMouseOverHandler),this.uiSkin["btntxt"+t].on("mouseout",this,this.onMouseOutHandler),this.btntxtArr.push(this.uiSkin["btntxt"+t]);null!=this.param&&"number"==typeof this.param&&Math.floor(this.param)==this.param?this.onShowEditView(this.param):this.onShowEditView(0),this.uiSkin.panel_main.height=Be.clientHeight,on.instance.on("BROWER_WINDOW_RESIZE",this,this.onResizeBrower),on.instance.on("PAUSE_SCROLL_VIEW",this,this.onPauseScroll),on.instance.on("SHOW_CHARGE_VIEW",this,this.showCharge)},i.onResizeBrower=function(){this.uiSkin.panel_main.height=Be.clientHeight},i.onMouseOutHandler=function(){J.cursor="auto"},i.onMouseOverHandler=function(){J.cursor="hand"},i.onPauseScroll=function(t){this.uiSkin.panel_main.vScrollBar.target=t?this.uiSkin.panel_main:null},i.showCharge=function(){this.onShowEditView(5)},i.onShowEditView=function(t){if(8==t)return v.instance.openView("VIEW_CHANGEPWD"),void 0;if(7==t)return v.instance.openView("VIEW_PICMANAGER",!0),void 0;for(this.uiSkin.toptitle.text=this.titleTxt[t],this.uiSkin.bannertitile.text="/ "+this.titleTxt[t];this.uiSkin.sp_container.numChildren>0;)this.uiSkin.sp_container.getChildAt(0).destroy(!0),this.uiSkin.sp_container.removeChildAt(0);for(var e=0;e<this.btntxtArr.length;e++)this.btntxtArr[e].color="#262B2E",this.btntxtArr[e].alpha=.8;this.btntxtArr[t].color="#52B232",this.btntxtArr[t].alpha=1,this.viewArr[t]?(this.curView=new this.viewArr[t],this.curView.on("resize",this,this.onLoadComplete),this.uiSkin.sp_container.addChild(this.curView),this.uiSkin.sp_container.height=this.curView.height):this.uiSkin.sp_container.height=0,this.uiSkin.panel_main.refresh(),this.uiSkin.panel_main.scrollTo(0,0)},i.onLoadComplete=function(){this.curView&&(this.uiSkin.sp_container.height=this.curView.height,this.uiSkin.panel_main.refresh())},i.onBackToMain=function(){v.instance.openView("VIEW_FIRST_PAGE",!0)},i.onDestroy=function(){on.instance.off("BROWER_WINDOW_RESIZE",this,this.onResizeBrower),on.instance.off("PAUSE_SCROLL_VIEW",this,this.onPauseScroll),on.instance.off("SHOW_CHARGE_VIEW",this,this.showCharge)},e.MY_ORDER=3,e}(an),Wn=function(t){function e(){this.uiSkin=null,this.directTree=[],this.param=null,this.curFileList=null,e.__super.call(this)}s(e,"script.order.SelectPicControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.directTree=[],this.uiSkin.filetypeRadio.visible=!1,this.uiSkin.picList.itemRender=pa,this.uiSkin.picList.vScrollBarSkin="",this.uiSkin.picList.selectEnable=!1,this.uiSkin.picList.spaceY=0,this.uiSkin.picList.renderHandler=new _(this,this.updatePicInfoItem),this.uiSkin.flder0.visible=!1,this.uiSkin.flder1.visible=!1,this.uiSkin.flder2.visible=!1;for(var t=0;3>t;t++)this.uiSkin["flder"+t].on("click",this,this.onClickTopDirectLbl,[t]);this.uiSkin.btnroot.on("click",this,this.backToRootDir),this.uiSkin.btnprevfolder.on("click",this,this.onClickParentFolder),this.uiSkin.radiosel.on("click",this,this.onSelectAllPic),this.uiSkin.picList.array=[],R.instance.Request(R.httpUrl+"dir/list?",this,this.onGetTopDirListBack,"path=0|","post"),this.uiSkin.htmltext.style.fontSize=20,this.uiSkin.htmltext.innerHTML="<span color='#222222' size='20'>已选择</span><span color='#FF0000' size='20'>0</span><span color='#222222' size='20'>张图片</span>",this.uiSkin.btncancel.on("click",this,this.onCloseView),this.uiSkin.btnok.on("click",this,this.onConfirmSelect),this.uiSkin.searchInput.on("input",this,this.onSearchInput),on.instance.on("SELECT_FOLDER",this,this.onSelectChildFolder),on.instance.on("UPDATE_FILE_LIST",this,this.getFileList),on.instance.on("SELECT_PIC_ORDER",this,this.seletPicToOrder)},i.onConfirmSelect=function(){this.param instanceof model.orderModel.MaterialItemVo||on.instance.event("ADD_PIC_FOR_ORDER"),this.onCloseView()},i.onCloseView=function(){v.instance.closeView("VIEW_SELECT_PIC_TO_ORDER")},i.onSelectAllPic=function(){var t=D.instance.curFileList;if(null!=t&&!(this.param instanceof model.orderModel.MaterialItemVo)){for(var e=0;e<t.length;e++)if(1==t[e].picType)if(this.uiSkin.radiosel.selected){var i=D.instance.haselectPic.hasOwnProperty(t[e].fid);!i&&y.checkFileIsImg(t[e])&&(D.instance.haselectPic[t[e].fid]=t[e])}else{var i=D.instance.haselectPic.hasOwnProperty(t[e].fid);i&&delete D.instance.haselectPic[t[e].fid]}for(var e=0;e<this.uiSkin.picList.cells.length;e++)null!=this.uiSkin.picList.cells[e].picInfo&&y.checkFileIsImg(this.uiSkin.picList.cells[e].picInfo)&&(this.uiSkin.picList.cells[e].sel.visible=this.uiSkin.radiosel.selected,this.uiSkin.picList.cells[e].sel.selected=this.uiSkin.radiosel.selected);var n,s=0;for(var r in D.instance.haselectPic)n=D.instance.haselectPic[r],s++;this.uiSkin.htmltext.innerHTML="<span color='#222222' size='20'>已选择</span><span color='#FF0000' size='20'>"+s+"</span><span color='#222222' size='20'>张图片</span>"}},i.seletPicToOrder=function(t){if(this.param instanceof model.orderModel.MaterialItemVo)return this.param.attchFileId==t.fid?(this.param.attchMentFileId="",this.param.attchFileId=""):(this.param.attchMentFileId="http://original-image.oss-cn-hangzhou.aliyuncs.com/"+t.fid+"."+t.picClass,this.param.attchFileId=t.fid),void 0;var e=D.instance.haselectPic.hasOwnProperty(t.fid);e?delete D.instance.haselectPic[t.fid]:D.instance.haselectPic[t.fid]=t;var i,n=0;for(var s in D.instance.haselectPic)i=D.instance.haselectPic[s],n++;this.uiSkin.htmltext.innerHTML="<span color='#222222' size='20'>已选择</span><span color='#FF0000' size='20'>"+n+"</span><span color='#222222' size='20'>张图片</span>"},i.onGetTopDirListBack=function(t){var e=JSON.parse(t);0==e.status&&(D.instance.initTopDirectoryList(e),this.uiSkin.picList.array=D.instance.topDirectList,this.curFileList=this.uiSkin.picList.array)},i.getFileList=function(){R.instance.Request(R.httpUrl+"dir/list?",this,this.onGetDirFileListBack,"path="+D.instance.curSelectDir.dpath,"post")},i.onGetDirFileListBack=function(t){var e=JSON.parse(t);0==e.status&&(D.instance.initCurDirFiles(e),this.uiSkin.picList.array=D.instance.curFileList,this.curFileList=D.instance.curFileList)},i.onSearchInput=function(){if(null!=this.curFileList){for(var t=[],e=0;e<this.curFileList.length;e++)this.curFileList[e].directName.indexOf(this.uiSkin.searchInput.text)>=0&&t.push(this.curFileList[e]);this.uiSkin.picList.array=t}},i.onDestroy=function(){on.instance.event("CLOSE_PANEL_VIEW","VIEW_SELECT_PIC_TO_ORDER"),on.instance.off("SELECT_FOLDER",this,this.onSelectChildFolder),on.instance.off("UPDATE_FILE_LIST",this,this.getFileList),on.instance.off("SELECT_PIC_ORDER",this,this.seletPicToOrder)},i.onSlecteDirect=function(){},i.onSelectChildFolder=function(t){D.instance.curSelectDir=t,this.directTree.push(D.instance.curSelectDir),this.updateCurDirectLabel(),this.getFileList()},i.onClickTopDirectLbl=function(t){t!=this.directTree.length-1&&(D.instance.curSelectDir=this.directTree[t],this.directTree.splice(t+1,this.directTree.length-t-1),this.updateCurDirectLabel(),this.getFileList())},i.onClickParentFolder=function(){this.directTree.length>1?(D.instance.curSelectDir=this.directTree[this.directTree.length-2],this.directTree.splice(this.directTree.length-1,1),this.updateCurDirectLabel(),this.getFileList()):this.backToRootDir()},i.backToRootDir=function(){this.directTree.length<=0||(D.instance.curSelectDir=D.instance.rootDir,this.directTree=[],R.instance.Request(R.httpUrl+"dir/list?",this,this.onGetTopDirListBack,"path=0|","post"),this.updateCurDirectLabel())},i.updateCurDirectLabel=function(){this.uiSkin.flder0.visible=!1,this.uiSkin.flder1.visible=!1,this.uiSkin.flder2.visible=!1;for(var t=0;t<this.directTree.length;t++)3>t&&(this.uiSkin["flder"+t].text=this.directTree[t].directName+">",this.uiSkin["flder"+t].visible=!0)},i.updateDirectItem=function(t){t.setData(t.dataSource)},i.updatePicInfoItem=function(t){t.setData(t.dataSource)},e}(an),Gn=function(t){function e(){this.uiSKin=null,this.param=null,e.__super.call(this)}s(e,"script.login.LogPanelControl",t);var i=e.prototype;return i.onStart=function(){this.uiSKin=this.owner,this.owner.closebtn.on("click",this,this.onCloseScene),this.owner.bgimg.alpha=.95,this.uiSKin.input_account.maxChars=11,this.uiSKin.input_account.restrict="0-9",this.uiSKin.input_pwd.maxChars=20,this.uiSKin.input_pwd.type="password",this.uiSKin.txt_reg.underline=!0,this.uiSKin.txt_reg.underlineColor="#121212",this.uiSKin.txt_forget.underline=!0,this.uiSKin.txt_forget.underlineColor="#121212",this.uiSKin.txt_reg.on("click",this,this.onRegister),this.uiSKin.txt_forget.on("click",this,this.onResetpwd),this.uiSKin.btn_login.on("click",this,this.onLogin),this.uiSKin.input_account.on("keydown",this,this.onAccountKeyUp),this.uiSKin.input_pwd.on("keydown",this,this.onAccountKeyUp),this.uiSKin.input_account.focus=!0},i.onAccountKeyUp=function(t){9==t.keyCode&&(this.uiSKin.input_account.focus?this.uiSKin.input_pwd.focus=!0:this.uiSKin.input_pwd.focus&&(this.uiSKin.input_account.focus=!0)),13==t.keyCode&&this.onLogin()},i.onLogin=function(){if(11!=this.uiSKin.input_account.text.length)return v.showAlert("请填写正确的账号"),void 0;if(this.uiSKin.input_pwd.text.length<6)return v.showAlert("密码位数至少是6位"),void 0;var t="phone="+this.uiSKin.input_account.text+"&pwd="+this.uiSKin.input_pwd.text+"&mode=0";R.instance.Request(R.httpUrl+"account/login?",this,this.onLoginBack,t,"post")},i.onLoginBack=function(t){var e=JSON.parse(t);0==e.status&&(f.instance.isLogin=!0,f.instance.userAccount=this.uiSKin.input_account.text,on.instance.event("LOGIN_SUCESS",this.uiSKin.input_account.text),y.setLocalVar("useraccount",this.uiSKin.input_account.text),y.setLocalVar("userpwd",this.uiSKin.input_pwd.text),v.instance.closeView("VIEW_lOGPANEL"))},i.onRegister=function(){v.instance.openView("VIEW_REGPANEL",!0)},i.onResetpwd=function(){v.instance.openView("VIEW_CHANGEPWD",!0)},i.onEnable=function(){},i.onCloseScene=function(){v.instance.closeView("VIEW_lOGPANEL")},e}(an),zn=function(t){function e(){this.txt=null,this.undercolor="#222222",this.txttype=0,this.ypos=0/0,e.__super.call(this)}s(e,"script.prefabScript.LinkTextControl",t);var i=e.prototype;return i.onStart=function(){this.txt=this.owner,0==this.txttype&&(this.txt.underline=!0,this.txt.underlineColor=this.undercolor),this.ypos=this.txt.y,this.txt.on("mouseover",this,this.onMouseOverHandler),this.txt.on("mouseout",this,this.onMouseOutHandler),this.txt.on("mousedown",this,this.onMouseDownHandler),this.txt.on("click",this,this.onMouseClickHandler)},i.onMouseClickHandler=function(){J.cursor="auto"},i.onMouseDownHandler=function(){1==this.txttype&&(this.txt.color="#74F79B")},i.onMouseOutHandler=function(){J.cursor="auto",1==this.txttype&&(this.txt.y=this.ypos,this.txt.color="#EDFFEC")},i.onMouseOverHandler=function(){J.cursor="hand",1==this.txttype&&(this.txt.y=this.ypos-1,this.txt.color="#FFFFFF")},i.onDestroy=function(){J.cursor="auto"},e}(an),Xn=function(t){function e(){this.uiSkin=null,e.__super.call(this)}s(e,"script.prefabScript.TopBannerControl",t);var i=e.prototype;return i.onEnable=function(){this.uiSkin=this.owner;var t=this.uiSkin.getChildByName("firstPage"),e=this.uiSkin.getChildByName("userName"),i=this.uiSkin.getChildByName("logout"),n=this.uiSkin.getChildByName("myorder");e.text=f.instance.isLogin?f.instance.userAccount:"未登录",t.on("click",this,this.showFirstPage),i.on("click",this,this.showLogOut),n.on("click",this,this.showOrderList)},i.onStart=function(){},i.showOrderList=function(){v.instance.openView("VIEW_USERCENTER",!0,3)},i.showFirstPage=function(){v.instance.openView("VIEW_FIRST_PAGE",!0)},i.showLogOut=function(){R.instance.Request(R.httpUrl+"account/logout?",this,this.onLoginOutBack,"","post")},i.onLoginOutBack=function(t){var e=JSON.parse(t);0==e.status&&(y.setLocalVar("useraccount",""),y.setLocalVar("userpwd",""),f.instance.isLogin=!1,v.instance.openView("VIEW_FIRST_PAGE",!0))},e}(an),Hn=function(t){function e(){this.uiSkin=null,this.param=null,e.__super.call(this)}s(e,"utils.AddMsgControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.inputmsg.maxChars=50,this.uiSkin.btnok.on("click",this,this.onClickOk),this.uiSkin.btncancel.on("click",this,this.onCloseView),this.param&&null!=this.param.msg&&(this.uiSkin.inputmsg.text=this.param.msg)},i.onClickOk=function(){null!=this.param.callback&&this.param.callback.call(this.param.caller,this.uiSkin.inputmsg.text),this.onCloseView()},i.onCloseView=function(){v.instance.closeView("VIEW_ADD_MESSAGE")},e}(an),Yn=function(t){function e(){this.uiSkin=null,e.__super.call(this)}s(e,"script.product.ProductMainControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.productlist.itemRender=ga,this.uiSkin.productlist.vScrollBarSkin="",this.uiSkin.productlist.repeatX=3,this.uiSkin.productlist.spaceY=20,this.uiSkin.productlist.renderHandler=new _(this,this.updateProductList),this.uiSkin.productlist.selectEnable=!1;for(var t=["https://detail.tmall.com/item.htm?id=526318658145&ali_refid=a3_430583_1006:1108235969:N:1MQTVLPp62GPhglCIaZd/g==:d9254f3b567d036adb3b0c3d81c6eac7&ali_trackid=1_d9254f3b567d036adb3b0c3d81c6eac7&spm=a230r.1.14.1","https://detail.tmall.com/item.htm?spm=a230r.1.14.13.3e402ebdwcU30Y&id=555521978270&cm_id=140105335569ed55e27b&abbucket=10","https://detail.tmall.com/item.htm?spm=a230r.1.14.20.3e402ebdwcU30Y&id=563368098306&ns=1&abbucket=10","https://detail.tmall.com/item.htm?spm=a230r.1.14.27.3e402ebdwcU30Y&id=559210560379&ns=1&abbucket=10","https://detail.tmall.com/item.htm?spm=a230r.1.14.76.3e402ebdwcU30Y&id=582945215363&ns=1&abbucket=10","https://detail.tmall.com/item.htm?spm=a230r.1.14.83.3e402ebdwcU30Y&id=565700275650&ns=1&abbucket=10","https://item.taobao.com/item.htm?spm=a230r.1.14.278.3e402ebdwcU30Y&id=18471253099&ns=1&abbucket=10#detail","https://detail.tmall.com/item.htm?spm=a230r.1.14.73.3e402ebdwcU30Y&id=569329939430&ns=1&abbucket=10","https://detail.tmall.com/item.htm?id=571469150299&ali_refid=a3_430583_1006:1110650643:N:J9qj8Ni7SIVwWdQdeSY+dw==:5659d26af13796aa642628f226441b9a&ali_trackid=1_5659d26af13796aa642628f226441b9a&spm=a230r.1.14.1","https://detail.tmall.com/item.htm?spm=a230r.1.14.14.68675639S5nZ2i&id=4043459487&cm_id=140105335569ed55e27b&abbucket=10","https://detail.tmall.com/item.htm?spm=a230r.1.14.46.68675639S5nZ2i&id=537478190853&ns=1&abbucket=10","https://detail.tmall.com/item.htm?spm=a230r.1.14.93.68675639S5nZ2i&id=575639443142&ns=1&abbucket=10&sku_properties=21433:32102","https://detail.tmall.com/item.htm?spm=a230r.1.14.141.68675639S5nZ2i&id=587606286953&ns=1&abbucket=10&sku_properties=21433:21366"],e=["门型x展架广告牌展示架立式易拉宝80x180海报设计落地式定制制作","广告牌展示架kt板展架立式落地式宣传海报支架招聘展板招工牌架子","铝合金亮盖水滴易拉宝广告海报架80 200易拉宝展架设计制作X展架","kt板展架立式落地海报架广告架子支架易拉宝广告牌展示架定制制作","拉网展架签名签到墙展示架立式落地式布艺拉网背景墙海报布广告牌","广告牌展示牌kt板展架展板海报架立牌宣传架子立式水牌落地式招聘","资料架杂志架报刊架书刊架置物宣传架展示架展架报纸收纳架子落地","广告牌展示架kt板展架立式落地式户外双面海报架宣传立牌展板架子","展会橱窗吊旗悬挂杆铝合金海报挂轴杆挂画轴吊挂夹天花吊画广告牌","申佳铝合金A3三证合一营业执照相框挂墙a4摆台工商税务画框证书框","磁吸电梯广告框海报框挂墙广告框架展板海报相框铝合金画框海报框","实木广告框架亚克力相框挂墙免打孔木质海报框教练教师展示墙画框","相框挂墙免打孔洗照片加画框外框创意简约冲印定制来图定做相架框"],i=[],n=0;n<t.length;n++){var s={url:t[n],pid:n};s.pname=e[n],s.allsize=["120*150","160*200"],s.price=35+2*n,i.push(s)}this.uiSkin.productlist.array=i},i.updateProductList=function(t){t.setData(t.dataSource)},e}(an),jn=function(t){function e(){this.uiSkin=null,this.createbox=null,this.directTree=[],this.param=null,this.fileListData=null,this.file=null,this.curFileList=null,e.__super.call(this)}s(e,"script.picUpload.PicManagerControl",t);var i=e.prototype;return i.onStart=function(){this.directTree=[],this.uiSkin=this.owner,this.uiSkin.btnNewFolder.on("click",this,this.onCreateNewFolder),this.uiSkin.btnorder.on("click",this,this.onshowOrder),this.createbox=this.uiSkin.boxNewFolder,this.createbox.visible=!1,this.uiSkin.input_folename.maxChars=10,this.uiSkin.btnCloseInput.on("click",this,this.onCloseCreateFolder),this.uiSkin.picList.itemRender=pa,this.uiSkin.picList.vScrollBarSkin="",this.uiSkin.picList.selectEnable=!1,this.uiSkin.picList.spaceY=0,this.uiSkin.picList.renderHandler=new _(this,this.updatePicInfoItem),this.uiSkin.flder0.visible=!1,this.uiSkin.flder1.visible=!1,this.uiSkin.flder2.visible=!1;for(var t=0;3>t;t++)this.uiSkin["flder"+t].on("click",this,this.onClickTopDirectLbl,[t]);this.uiSkin.btnprevfolder.on("click",this,this.onClickParentFolder),this.uiSkin.btnroot.on("click",this,this.backToRootDir),this.uiSkin.btnUploadPic.on("click",this,this.onShowUploadView),this.uiSkin.filetypeRadio.visible=!1,this.uiSkin.radiosel.on("click",this,this.onSelectAllPic),this.uiSkin.picList.array=[],R.instance.Request(R.httpUrl+"dir/list?",this,this.onGetTopDirListBack,"path=0|","post"),this.initFileOpen(),this.uiSkin.htmltext.style.fontSize=20,this.uiSkin.htmltext.innerHTML="<span color='#222222' size='20'>已选择</span><span color='#FF0000' size='20'>0</span><span color='#222222' size='20'>张图片</span>",this.uiSkin.btnSureCreate.on("click",this,this.onSureCreeate),on.instance.on("SELECT_FOLDER",this,this.onSelectChildFolder),on.instance.on("UPDATE_FILE_LIST",this,this.getFileList),on.instance.on("SELECT_PIC_ORDER",this,this.seletPicToOrder),on.instance.on("BROWER_WINDOW_RESIZE",this,this.onResizeBrower),D.instance.haselectPic={},this.uiSkin.searchInput.on("input",this,this.onSearchInput),this.uiSkin.on("removed",this,this.onRemovedFromStage),this.uiSkin.main_panel.height=Be.clientHeight,this.uiSkin.picList.height=Be.clientHeight-365,D.instance.curFileList=[],D.instance.curSelectDir=D.instance.rootDir,R.instance.Request(R.httpUrl+"group/get-info?",this,this.onGetLeftCapacitBack,null,"post")},i.onResizeBrower=function(){this.uiSkin.main_panel.height=Be.clientHeight,this.uiSkin.picList.height=Be.clientHeight-365},i.onGetLeftCapacitBack=function(t){var e=JSON.parse(t);if(0==e.status){var i=parseInt(e.size)/1024/1024,n=parseInt(e.maxsize)/1024/1024/1024;this.uiSkin.prgcap.value=parseInt(e.size)<parseInt(e.maxsize)?parseInt(e.size)/parseInt(e.maxsize):1,this.uiSkin.leftcapacity.text=i.toFixed(0)+"M/"+n+"G"}},i.onSelectAllPic=function(){var t=D.instance.curFileList;if(null!=t){for(var e=0;e<t.length;e++)if(1==t[e].picType)if(this.uiSkin.radiosel.selected){var i=D.instance.haselectPic.hasOwnProperty(t[e].fid);!i&&y.checkFileIsImg(t[e])&&(D.instance.haselectPic[t[e].fid]=t[e])}else{var i=D.instance.haselectPic.hasOwnProperty(t[e].fid);i&&delete D.instance.haselectPic[t[e].fid]}for(var e=0;e<this.uiSkin.picList.cells.length;e++)null!=this.uiSkin.picList.cells[e].picInfo&&y.checkFileIsImg(this.uiSkin.picList.cells[e].picInfo)&&(this.uiSkin.picList.cells[e].sel.visible=this.uiSkin.radiosel.selected,this.uiSkin.picList.cells[e].sel.selected=this.uiSkin.radiosel.selected);var n,s=0;for(var r in D.instance.haselectPic)n=D.instance.haselectPic[r],s++;this.uiSkin.htmltext.innerHTML="<span color='#222222' size='20'>已选择</span><span color='#FF0000' size='20'>"+s+"</span><span color='#222222' size='20'>张图片</span>"}},i.initFileOpen=function(){var t=this;this.file=Be.document.createElement("input"),this.file.style="filter:alpha(opacity=0);opacity:0;width: 100;height:34px;left:395px;top:-248",this.file.multiple="multiple",this.file.accept=".jpg,.jpeg,.png,.tif",this.file.type="file",this.file.style.position="absolute",this.file.style.zIndex=999,Be.document.body.appendChild(this.file),this.file.onchange=function(){t.fileListData=[];for(var e=0;e<t.file.files.length;e++)t.file.files[e].progress=0,t.fileListData.push(t.file.files[e]);v.instance.openView("VIEW_MYPICPANEL",!1,t.fileListData)}},i.onshowOrder=function(){v.instance.openView("VIEW_PAINT_ORDER",!0)},i.seletPicToOrder=function(t){var e=D.instance.haselectPic.hasOwnProperty(t.fid);e?delete D.instance.haselectPic[t.fid]:D.instance.haselectPic[t.fid]=t;var i,n=0;for(var s in D.instance.haselectPic)i=D.instance.haselectPic[s],n++;this.uiSkin.htmltext.innerHTML="<span color='#222222' size='20'>已选择</span><span color='#FF0000' size='20'>"+n+"</span><span color='#222222' size='20'>张图片</span>"},i.onGetTopDirListBack=function(t){var e=JSON.parse(t);0==e.status&&(D.instance.initTopDirectoryList(e),this.uiSkin.radiosel.selected=!1,this.uiSkin.picList.array=D.instance.topDirectList,this.curFileList=D.instance.topDirectList,D.instance.curFileList=[])},i.getFileList=function(){R.instance.Request(R.httpUrl+"dir/list?",this,this.onGetDirFileListBack,"path="+D.instance.curSelectDir.dpath,"post"),R.instance.Request(R.httpUrl+"group/get-info?",this,this.onGetLeftCapacitBack,null,"post")},i.onGetDirFileListBack=function(t){var e=JSON.parse(t);0==e.status&&(this.uiSkin.radiosel.selected=!1,D.instance.initCurDirFiles(e),this.uiSkin.picList.array=D.instance.curFileList,this.curFileList=D.instance.curFileList)},i.onBackToMain=function(){v.instance.openView("VIEW_FIRST_PAGE",!0)},i.onSearchInput=function(){if(null!=this.curFileList){for(var t=[],e=0;e<this.curFileList.length;e++)this.curFileList[e].directName.indexOf(this.uiSkin.searchInput.text)>=0&&t.push(this.curFileList[e]);this.uiSkin.radiosel.selected=!1,this.uiSkin.picList.array=t}},i.onDestroy=function(){on.instance.off("SELECT_FOLDER",this,this.onSelectChildFolder),on.instance.off("UPDATE_FILE_LIST",this,this.getFileList),on.instance.off("SELECT_PIC_ORDER",this,this.seletPicToOrder),on.instance.off("BROWER_WINDOW_RESIZE",this,this.onResizeBrower),Be.document.body.removeChild(this.file)},i.onRemovedFromStage=function(){on.instance.off("SELECT_FOLDER",this,this.onSelectChildFolder),on.instance.off("UPDATE_FILE_LIST",this,this.getFileList),on.instance.off("SELECT_PIC_ORDER",this,this.seletPicToOrder)},i.onShowUploadView=function(){return null==D.instance.curSelectDir||"0"==D.instance.curSelectDir.directId?(v.showAlert("请先创建一个目录"),void 0):(this.file.click(),this.file.value,void 0)},i.onSureCreeate=function(){if(""!=this.uiSkin.input_folename.text){if(this.directTree.length>0){if(null==D.instance.curSelectDir)return v.showAlert("请选择一个父目录"),void 0;R.instance.Request(R.httpUrl+"dir/create?",this,this.onCreateDirBack,"path="+D.instance.curSelectDir.dpath+"&name="+this.uiSkin.input_folename.text,"post")}else R.instance.Request(R.httpUrl+"dir/create?",this,this.onCreateDirBack,"path=0|&name="+this.uiSkin.input_folename.text,"post");this.createbox.visible=!1}},i.onCreateDirBack=function(t){var e=JSON.parse(t);if(0==e.status){var i=new E(e.dir,0);this.uiSkin.picList.addItem(i),this.uiSkin.radiosel.selected=!1,this.curFileList=this.uiSkin.picList.array}},i.onSlecteDirect=function(){},i.onSelectChildFolder=function(t){D.instance.curSelectDir=t,this.directTree.push(D.instance.curSelectDir),this.updateCurDirectLabel(),this.getFileList()},i.backToRootDir=function(){this.directTree.length<=0||(D.instance.curSelectDir=D.instance.rootDir,this.directTree=[],R.instance.Request(R.httpUrl+"dir/list?",this,this.onGetTopDirListBack,"path=0|","post"),this.updateCurDirectLabel())},i.onClickParentFolder=function(){this.directTree.length>1?(D.instance.curSelectDir=this.directTree[this.directTree.length-2],this.directTree.splice(this.directTree.length-1,1),this.updateCurDirectLabel(),this.getFileList()):this.backToRootDir()},i.onClickTopDirectLbl=function(t){t!=this.directTree.length-1&&(D.instance.curSelectDir=this.directTree[t],this.directTree.splice(t+1,this.directTree.length-t-1),this.updateCurDirectLabel(),this.getFileList())},i.updateCurDirectLabel=function(){this.uiSkin.flder0.visible=!1,this.uiSkin.flder1.visible=!1,this.uiSkin.flder2.visible=!1;for(var t=0;t<this.directTree.length;t++)3>t&&(this.uiSkin["flder"+t].text=this.directTree[t].directName+">",this.uiSkin["flder"+t].visible=!0,t>0&&(this.uiSkin["flder"+t].x=this.uiSkin["flder"+(t-1)].x+this.uiSkin["flder"+(t-1)].textField.textWidth+2))},i.updateDirectItem=function(t){t.setData(t.dataSource)},i.updatePicInfoItem=function(t){t.setData(t.dataSource)},i.onCloseCreateFolder=function(){this.createbox.visible=!1},i.onCreateNewDirect=function(){this.createbox.visible=!0},i.onCreateNewFolder=function(){this.createbox.visible=!0},e}(an),Zn=function(t){function e(){this.uiSkin=null,this.param=null,e.__super.call(this)}s(e,"script.product.ProductMarketControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner;for(var t="<data>",e=0;5>e;++e){t+="<item label='Directory "+(e+1)+"' isOpen='true'>";for(var i=0;5>i;++i)t+="<leaf label='File "+(i+1)+"'/>";t+="</item>"}t+="</data>";var n=ee.parseXMLFromString(t);this.uiSkin.producttree.itemRender=vr,this.uiSkin.producttree.xml=n},e}(an),qn=function(t){function e(){this.uiSkin=null,this.param=null,e.__super.call(this)}s(e,"script.picUpload.PictureCheckControl",t);var n=e.prototype;return n.onStart=function(){this.uiSkin=this.owner,this.uiSkin.closeBtn.on("click",this,this.onClosePanel),this.uiSkin.mainpanel.on("click",this,this.onClosePanel),this.uiSkin.mainpanel.vScrollBarSkin="",null!=this.param&&(this.uiSkin.img.skin="http://large-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/"+this.param.fid+".jpg",this.param.picWidth>this.param.picHeight?(this.uiSkin.img.width=750,this.uiSkin.img.height=750/this.param.picWidth*this.param.picHeight):(this.uiSkin.img.height=750,this.uiSkin.img.width=750/this.param.picHeight*this.param.picWidth))},n.onDestroy=function(){i.loader.clearTextureRes("http://large-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/"+this.param.fid+".jpg")},n.onClosePanel=function(){v.instance.closeView("VIEW_PICTURE_CHECK")},e}(an),Kn=function(t){function e(){this.uiSkin=null,this.param=null,e.__super.call(this)}s(e,"utils.PopUpWindowControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.closebtn.on("click",this,this.onCloseScene),this.uiSkin.msgtxt.text=this.param.msg,null!=this.param.ok&&(this.uiSkin.okbtn.label=this.param.ok),null!=this.param.cancel&&(this.uiSkin.cancelbtn.label=this.param.cancel),this.uiSkin.okbtn.on("click",this,this.onConfirmHandler),this.uiSkin.cancelbtn.on("click",this,this.onCancelHandler)
},i.onConfirmHandler=function(){null!=this.param.callback&&this.param.callback.call(this.param.caller,!0),this.onCloseScene()},i.onCancelHandler=function(){null!=this.param.callback&&this.param.callback.call(this.param.caller,!1),this.onCloseScene()},i.onCloseScene=function(){v.instance.closeView("VIEW_POPUPDIALOG")},e}(an),$n=function(t){function e(){this.uiSkin=null,e.__super.call(this)}s(e,"utils.LoadingPrgControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.prg.value=0,this.uiSkin.prgtxt.text="0%",on.instance.on("UPDATE_LOADING_PROGRESS",this,this.onUpdatePrg)},i.onUpdatePrg=function(t){console.log("prg rec:"+t),this.uiSkin.prg.value=t,this.uiSkin.prgtxt.text=Math.floor(100*t)+"%",t>=1&&v.instance.closeView("VIEW_LOADING_PRO")},i.onDestroy=function(){on.instance.off("UPDATE_LOADING_PROGRESS",this,this.onUpdatePrg)},e}(an),Jn=function(e){function n(){this.uiSkin=null,this.param=null,this.orderlist=null,this.fengeoriginy=0,this.floatpyy=0,this.mianvbox=0,n.__super.call(this)}s(n,"script.order.PaintOrderControl",e);var r=n.prototype;return r.onStart=function(){this.uiSkin=this.owner,this.uiSkin.mainvbox.autoSize=!0,this.uiSkin.btnaddpic.on("click",this,this.onShowSelectPic);var t=1,e=0,n=0;this.uiSkin.commentall.visible=!1,this.uiSkin.batchcomment.visible=!1,this.fengeoriginy=this.uiSkin.fengeimg.y,this.floatpyy=this.uiSkin.floatpt.y,this.mianvbox=this.uiSkin.mainvbox.y,this.orderlist=[];var s;for(var r in D.instance.haselectPic){s=D.instance.haselectPic[r];var a=new x(s);a.indexNum=t++;var o=new Pr(a);this.uiSkin.ordervbox.addChild(o),this.orderlist.push(o),n+=o.height+this.uiSkin.ordervbox.space,e++}this.uiSkin.productNum.text=this.orderlist.length.toString(),this.uiSkin.textTotalPrice.style.fontSize=22,this.uiSkin.textTotalPrice.style.font="SimHei",this.uiSkin.textDeliveryType.style.fontSize=22,this.uiSkin.textDeliveryType.style.font="SimHei",this.uiSkin.textPayPrice.style.fontSize=22,this.uiSkin.textPayPrice.style.font="SimHei",this.uiSkin.ordervbox.size(this.uiSkin.ordervbox.width,n-this.uiSkin.ordervbox.space),D.instance.haselectPic={},this.uiSkin.myaddresstxt.on("click",this,this.onShowSelectAddress),this.uiSkin.batchChange.on("click",this,this.onBatchChangeMaterial),this.uiSkin.selectAll.on("click",this,this.onSelectAll),on.instance.on("SELECT_OUT_ADDRESS",this,this.onSelectedAddress),on.instance.on("SELECT_ORDER_ADDRESS",this,this.onSelectedSelfAddress),on.instance.on("ADD_PIC_FOR_ORDER",this,this.onUpdateOrderPic),on.instance.on("DELETE_PIC_ORDER",this,this.onDeletePicOrder),on.instance.on("SELECT_DELIVERY_TYPE",this,this.updateDeliveryType),on.instance.on("ADJUST_PIC_ORDER_TECH",this,this.onAdjustHeight),on.instance.on("BROWER_WINDOW_RESIZE",this,this.onResizeBrower),on.instance.on("UPDATE_ORDER_ITEM_TECH",this,this.resetOrderInfo),on.instance.on("BATCH_CHANGE_PRODUCT_NUM",this,this.changeProductNum),on.instance.on("PAY_ORDER_SUCESS",this,this.onPaySucess),on.instance.on("CANCEL_PAY_ORDER",this,this.onCancelPay),this.uiSkin.panelout.vScrollBarSkin="",this.uiSkin.deliversp.autoSize=!0,this.uiSkin.height=Be.clientHeight,this.uiSkin.btnordernow.on("click",this,this.onOrderPaint),this.uiSkin.btnsaveorder.on("click",this,this.onSaveOrder),this.uiSkin.panelout.on("dragmove",this,this.onDragMove),this.resetOrderInfo(),null!=f.instance.getDefaultAddress()&&(R.instance.Request(R.httpUrl+"business/manufacturers?client_code=CL10200&addr_id="+f.instance.getDefaultAddress().searchZoneid+"&manufacturer_type=喷印输出中心",this,this.onGetOutPutAddress,null,null),this.uiSkin.myaddresstxt.text=f.instance.getDefaultAddress().addressDetail,I.instance.selectAddress=f.instance.getDefaultAddress()),i.timer.frameLoop(5,this,this.onDragMove)},r.onDragMove=function(){this.uiSkin.floatpt.localToGlobal(new $i(this.uiSkin.floatpt.x,this.uiSkin.floatpt.y),!1).y-294<=0?this.uiSkin.floatdocker.parent!=this.uiSkin&&(this.uiSkin.addChild(this.uiSkin.floatdocker),this.uiSkin.floatdocker.y=0,this.uiSkin.floatdocker.x=320):this.uiSkin.floatdocker.parent!=this.uiSkin.floatpt&&(this.uiSkin.floatpt.addChild(this.uiSkin.floatdocker),this.uiSkin.floatdocker.y=0,this.uiSkin.floatdocker.x=0)},r.resetOrderInfo=function(){for(var t=0,e=0;e<this.orderlist.length;e++)t+=Number(this.orderlist[e].total.text);this.uiSkin.textTotalPrice.innerHTML="<span color='#262B2E' size='20'>折后总额：</span><span color='#FF4400' size='20'>"+t.toFixed(2)+"</span><span color='#262B2E' size='20'>元</span>",this.uiSkin.textDeliveryType.innerHTML="<span color='#262B2E' size='20'>运费总额：</span><span color='#FF4400' size='20'>0</span><span color='#262B2E' size='20'>元</span>",this.uiSkin.textPayPrice.innerHTML="<span color='#262B2E' size='20'>应付总额：</span><span color='#FF4400' size='20'>"+t.toFixed(2)+"</span><span color='#262B2E' size='20'>元</span>"},r.onGetOutPutAddress=function(t){var e=JSON.parse(t);if(!e.hasOwnProperty("status")){for(I.instance.initOutputAddr(e),I.instance.selectFactoryAddress=I.instance.outPutAddr.concat();this.uiSkin.outputbox.numChildren>0;)this.uiSkin.outputbox.removeChildAt(0);if(I.instance.outPutAddr.length>0){for(var i=0;i<I.instance.outPutAddr.length;i++){var n=new lr;this.uiSkin.outputbox.addChild(n),n.checkselect.selected=!0,n.qqContact.on("click",this,this.onClickOpenQQ),n.factorytxt.text=I.instance.selectFactoryAddress[i].name}this.uiSkin.fengeimg.y=this.fengeoriginy+40*(I.instance.outPutAddr.length-1)+(I.instance.outPutAddr.length-2)*this.uiSkin.outputbox.space,this.uiSkin.floatpt.y=this.floatpyy+40*(I.instance.outPutAddr.length-1)+(I.instance.outPutAddr.length-2)*this.uiSkin.outputbox.space,this.uiSkin.mainvbox.y=this.mianvbox+40*(I.instance.outPutAddr.length-1)+(I.instance.outPutAddr.length-2)*this.uiSkin.outputbox.space,R.instance.Request(R.httpUrl+"business/prodcategory?client_code=CL10200&addr_id="+I.instance.selectAddress.searchZoneid,this,this.onGetProductBack,null,null),R.instance.Request(R.httpUrl+"business/deliverylist?manufacturer_code="+I.instance.outPutAddr[0].org_code+"&addr_id="+I.instance.selectAddress.searchZoneid,this,this.onGetDeliveryBack,null,null)}else I.instance.selectFactoryAddress=null,I.instance.productList=[]}},r.onGetDeliveryBack=function(t){for(var e=this,n=JSON.parse(t);this.uiSkin.deliverbox.numChildren>0;)this.uiSkin.deliverbox.removeChildAt(0);if(!n.hasOwnProperty("status")){I.instance.deliveryList=[];for(var s=0;s<n.length;s++){var r=new P(n[s]),a=new ur;a.addresstxt.text=r.deliveryDesc,"送货上门"==r.delivery_name&&(a.btnsel.selected=!0,a.selCheck.selected=!0,I.instance.selectDelivery=r),a.on("click",this,this.onSelectDeliverAdd,[a,r]),this.uiSkin.deliverbox.addChild(a)}}i.timer.frameOnce(2,this,function(){e.uiSkin.deliversp.size(1280,e.uiSkin.deliverbox.height),e.uiSkin.mainvbox.refresh()})},r.onSelectDeliverAdd=function(t,e){for(var i=0;i<this.uiSkin.deliverbox.numChildren;i++){var n=this.uiSkin.deliverbox.getChildAt(i);n&&(n.btnsel.selected=!1,n.selCheck.selected=!1)}t.btnsel.selected=!0,t.selCheck.selected=!0,I.instance.selectDelivery=e},r.onResizeBrower=function(){this.uiSkin.height=Be.clientHeight},r.onShowSelectPic=function(){v.instance.openView("VIEW_SELECT_PIC_TO_ORDER")},r.onShowSelectFactory=function(){v.instance.openView("VIEW_SELECT_FACTORY")},r.onSelectedSelfAddress=function(){I.instance.selectAddress&&(this.uiSkin.myaddresstxt.text=I.instance.selectAddress.addressDetail,R.instance.Request(R.httpUrl+"business/manufacturers?client_code=CL10200&addr_id="+I.instance.selectAddress.searchZoneid+"&manufacturer_type=喷印输出中心",this,this.onGetOutPutAddress,null,null))},r.onSelectedAddress=function(){I.instance.selectFactoryAddress&&R.instance.Request(R.httpUrl+"business/prodcategory?client_code=CL10200&addr_id="+I.instance.selectAddress.searchZoneid,this,this.onGetProductBack,null,null)},r.onGetProductBack=function(t){var e=JSON.parse(t);if(!e.hasOwnProperty("status")){var i=e;I.instance.productList=[];for(var n=[],s=0;s<i.length;s++)if(n.indexOf(i[s].prodCat_name)<0){var r=new m(i[s].prodCat_name);I.instance.productList.push(r),n.push(i[s].prodCat_name)}}},r.onShowSelectAddress=function(){v.instance.openView("VIEW_SELECT_ADDRESS")},r.onShowSelectDelivery=function(){if(this.orderlist.length<=0)return v.showAlert("请先选择图片和工艺"),void 0;var t=this.orderlist[0];return null==t.ordervo.orderData?(v.showAlert("未选择材料工艺"),void 0):(v.instance.openView("VIEW_SELECT_DELIVERY_TYPE",!1,t.ordervo.manufacturer_code),void 0)},r.onSelectAll=function(){for(var t=0;t<this.orderlist.length;t++)this.orderlist[t].checkSel.selected=this.uiSkin.selectAll.selected},r.onBatchChangeMaterial=function(){I.instance.batchChangeMatItems=[];for(var t=0;t<this.orderlist.length;t++)this.orderlist[t].checkSel.selected&&I.instance.batchChangeMatItems.push(this.orderlist[t]);return I.instance.batchChangeMatItems.length<=0?(v.showAlert("请至少选择一个需要更换的产品"),void 0):(v.instance.openView("VIEW_SELECT_MATERIAL"),I.instance.curSelectOrderItem=null,void 0)},r.changeProductNum=function(t){for(var e=0;e<this.orderlist.length;e++)this.orderlist[e].checkSel.selected&&(this.orderlist[e].inputnum.text=t)},r.onUpdateOrderPic=function(){var t=this.uiSkin.ordervbox.numChildren;t++;var e;for(var i in D.instance.haselectPic){e=D.instance.haselectPic[i],this.uiSkin.ordervbox.numChildren>0&&(this.uiSkin.ordervbox.height+=this.uiSkin.ordervbox.space);var n=new x(e);n.indexNum=t++;var s=new Pr(n);this.uiSkin.ordervbox.height+=s.height,this.uiSkin.ordervbox.addChild(s),this.orderlist.push(s)}for(var r=0;r<this.uiSkin.ordervbox.numChildren;r++)0==r?this.uiSkin.ordervbox.getChildAt(0).y=0:this.uiSkin.ordervbox.getChildAt(r).y=this.uiSkin.ordervbox.getChildAt(r-1).y+this.uiSkin.ordervbox.getChildAt(r-1).height+this.uiSkin.ordervbox.space;this.uiSkin.ordervbox.refresh(),D.instance.haselectPic={},this.resetOrderInfo(),this.uiSkin.productNum.text=this.orderlist.length.toString()},r.onDeletePicOrder=function(t){var e=t.ordervo;this.orderlist.indexOf(t)>=0&&this.orderlist.splice(this.orderlist.indexOf(t),1);for(var i=0;i<this.uiSkin.ordervbox.numChildren;i++){var n=this.uiSkin.ordervbox.getChildAt(i).ordervo;n.indexNum>e.indexNum&&n.indexNum--,this.uiSkin.ordervbox.getChildAt(i).updateIndex()}this.uiSkin.ordervbox.removeChild(t),this.uiSkin.ordervbox.height-t.height-this.uiSkin.ordervbox.space<0?this.uiSkin.ordervbox.height=0:this.uiSkin.ordervbox.height-=t.height+this.uiSkin.ordervbox.space,0==this.uiSkin.ordervbox.numChildren&&(this.uiSkin.ordervbox.height=0),this.uiSkin.ordervbox.size(this.uiSkin.ordervbox.width,0),this.uiSkin.ordervbox.refresh(),this.resetOrderInfo(),this.uiSkin.productNum.text=this.orderlist.length.toString()},r.updateDeliveryType=function(){this.resetOrderInfo()},r.onAdjustHeight=function(t){this.uiSkin.ordervbox.height+=t},r.onOrderPaint=function(){var t=this.getOrderData();null!=t&&R.instance.Request(R.httpUrl+"business/placeorder?",this,this.onPlaceOrderBack,{data:JSON.stringify(t)},"post")},r.onSaveOrder=function(){var t=this.getOrderData();null!=t&&R.instance.Request(R.httpUrl+"business/placeorder?",this,this.onSaveOrderBack,{data:JSON.stringify(t)},"post")},r.onSaveOrderBack=function(t){var e=JSON.parse(t);0==e.status&&(v.showAlert("保存订单成功，您可以到我的订单继续支付"),v.instance.openView("VIEW_FIRST_PAGE",!0))},r.onPaySucess=function(){v.instance.openView("VIEW_FIRST_PAGE",!0)},r.onCancelPay=function(){v.instance.openView("VIEW_FIRST_PAGE",!0)},r.onPlaceOrderBack=function(t){var e=JSON.parse(t);if(0==e.status){for(var i=0,n=[],s=0;s<e.orders.length;s++){var r=JSON.parse(e.orders[s]);i+=Number(r.money_paidStr),n.push(r.order_sn)}v.instance.openView("VIEW_SELECT_PAYTYPE_PANEL",!1,{amount:i,orderid:n})}},r.getOrderData=function(){if(this.orderlist.length<=0)return v.showAlert("未选择下单图片"),null;if(null==I.instance.selectDelivery)return v.showAlert("请选择配送方式"),null;for(var t={},e=0;e<this.orderlist.length;e++){var i=this.orderlist[e];if(null==i.ordervo.orderData)return v.showAlert("未选择材料工艺"),null;var n;if(t.hasOwnProperty(i.ordervo.manufacturer_code))n=t[i.ordervo.manufacturer_code];else{n={},n.order_sn=I.getOrderSn(),n.client_code="CL10200",n.consignee=I.instance.selectAddress.receiverName,n.tel=I.instance.selectAddress.phone,n.address=I.instance.selectAddress.proCityArea,n.order_amountStr=0,n.shipping_feeStr="0",n.money_paidStr="0",n.discountStr="0",n.pay_timeStr=y.formatFullDateTime(new Date),n.delivery_dateStr=y.formatFullDateTime(new Date,!1),n.manufacturer_code=i.ordervo.manufacturer_code,n.manufacturer_name=i.ordervo.manufacturer_name;I.instance.selectDelivery&&(n.logistic_code=I.instance.selectDelivery.deliverynet_code,n.logistic_name=I.instance.selectDelivery.deliverynet_name),n.orderItemList=[],t[i.ordervo.manufacturer_code]=n}if(null==this.orderlist[e].ordervo.orderData)return v.showAlert("有图片未选择材料工艺"),null;n.order_amountStr+=this.orderlist[e].getPrice(),""==this.orderlist[e].ordervo.orderData.comments&&(this.orderlist[e].ordervo.orderData.comments=this.uiSkin.commentall.text),this.orderlist[e].ordervo.orderData.item_seq=e+1,n.orderItemList.push(this.orderlist[e].ordervo.orderData)}var s,r=[];for(var a in t)s=t[a],n.money_paidStr=s.order_amountStr.toFixed(2),s.order_amountStr=s.order_amountStr.toFixed(2),r.push(s);return r},r.onClickOpenQQ=function(){t.open("tencent://message/?uin=10987654321")},r.onDestroy=function(){on.instance.off("SELECT_ORDER_ADDRESS",this,this.onSelectedAddress),on.instance.off("ADD_PIC_FOR_ORDER",this,this.onUpdateOrderPic),on.instance.off("DELETE_PIC_ORDER",this,this.onDeletePicOrder),on.instance.off("ADJUST_PIC_ORDER_TECH",this,this.onAdjustHeight),on.instance.off("BROWER_WINDOW_RESIZE",this,this.onResizeBrower),on.instance.off("SELECT_ORDER_ADDRESS",this,this.onSelectedSelfAddress),on.instance.off("SELECT_OUT_ADDRESS",this,this.onSelectedAddress),on.instance.off("SELECT_DELIVERY_TYPE",this,this.updateDeliveryType),on.instance.off("UPDATE_ORDER_ITEM_TECH",this,this.resetOrderInfo),on.instance.off("BATCH_CHANGE_PRODUCT_NUM",this,this.changeProductNum),on.instance.off("PAY_ORDER_SUCESS",this,this.onPaySucess),on.instance.off("CANCEL_PAY_ORDER",this,this.onCancelPay),i.timer.clear(this,this.onDragMove)},r.onClosePanel=function(){v.instance.openView("VIEW_FIRST_PAGE",!0)},n}(an),Qn=function(t){function e(){this.uiSkin=null,this.province=null,this.file=null,this.companyareaId=null,this.curYyzzFile=null,e.__super.call(this)}s(e,"script.usercenter.EnterPrizeInfoControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.provList.itemRender=ua,this.uiSkin.provList.repeatX=1,this.uiSkin.provList.spaceY=2,this.uiSkin.provList.renderHandler=new _(this,this.updateCityList),this.uiSkin.provList.selectEnable=!0,this.uiSkin.provList.selectHandler=new _(this,this.selectProvince),this.uiSkin.provList.refresh(),this.uiSkin.cityList.itemRender=ua,this.uiSkin.cityList.repeatX=1,this.uiSkin.cityList.spaceY=2,this.uiSkin.cityList.selectEnable=!0,this.uiSkin.cityList.renderHandler=new _(this,this.updateCityList),this.uiSkin.cityList.selectHandler=new _(this,this.selectCity),this.uiSkin.areaList.itemRender=ua,this.uiSkin.areaList.selectEnable=!0,this.uiSkin.areaList.repeatX=1,this.uiSkin.areaList.spaceY=2,this.uiSkin.areaList.renderHandler=new _(this,this.updateCityList),this.uiSkin.areaList.selectHandler=new _(this,this.selectArea),this.uiSkin.townList.itemRender=ua,this.uiSkin.townList.selectEnable=!0,this.uiSkin.townList.repeatX=1,this.uiSkin.townList.spaceY=2,this.uiSkin.townList.renderHandler=new _(this,this.updateCityList),this.uiSkin.townList.selectHandler=new _(this,this.selectTown),this.uiSkin.btnSelProv.on("click",this,this.onShowProvince),this.uiSkin.btnSelCity.on("click",this,this.onShowCity),this.uiSkin.btnSelArea.on("click",this,this.onShowArea),this.uiSkin.btnSelTown.on("click",this,this.onShowTown),this.uiSkin.areabox.visible=!1,this.uiSkin.provbox.visible=!1,this.uiSkin.citybox.visible=!1,this.uiSkin.townbox.visible=!1,this.uiSkin.on("click",this,this.hideAddressPanel),this.uiSkin.btnsave.on("click",this,this.onSaveCompanyInfo),this.uiSkin.txt_license.text="",this.uiSkin.account.text=f.instance.userAccount,this.uiSkin.servicetxt.text=f.instance.userAccount,this.uiSkin.shortname.maxChars=6,this.uiSkin.btn_uplicense.on("click",this,this.onUploadlicense),Be.window.uploadApp=this,this.initFileOpen(),this.uiSkin.chargebtn.on("click",this,this.onCharge),R.instance.Request(R.httpUrl+"group/get-addr-list?",this,this.initView,"parentid=0","post"),R.instance.Request(R.httpUrl+"group/get-request?",this,this.getCompanyInfo,null,"post"),R.instance.Request(R.httpUrl+"group/get-info?",this,this.getCompanyInfoBack,null,"post")},i.getCompanyInfoBack=function(t){if(!this.destroyed){var e=JSON.parse(t);0==e.status&&(f.instance.money=Number(e.balance),this.uiSkin.moneytxt.text=f.instance.money.toString()+"元")}},i.onCharge=function(){on.instance.event("SHOW_CHARGE_VIEW")},i.getCompanyInfo=function(t){if(!this.destroyed){var e=JSON.parse(t);if(0==e.status){if(null!=e[0]&&(1==parseInt(e[0].result)?(this.uiSkin.btnsave.disabled=!0,this.uiSkin.btnsave.label="已审核"):0==parseInt(e[0].result)?(this.uiSkin.btnsave.disabled=!0,this.uiSkin.btnsave.label="审核中"):(this.uiSkin.btnsave.disabled=!1,this.uiSkin.btnsave.label="审核失败,请重新提交"),null!=e[0].info&&""!=e[0].info)){var i=JSON.parse(e[0].info);this.uiSkin.input_companyname.text=i.gp_name,this.uiSkin.detail_addr.text=i.gp_addr,this.uiSkin.reditcode.text=i.gp_orgcode,this.uiSkin.txt_license.text=i.gp_license,this.uiSkin.shortname.text=i.gp_shortname}console.log(e)}}},i.initView=function(t){var e=JSON.parse(t);this.uiSkin.provList.array=e.status,this.selectProvince(0)},i.initFileOpen=function(){var t=this;this.file=Be.document.createElement("input"),this.file.style="filter:alpha(opacity=0);opacity:0;width: 100;height:34px;left:1080px;top:-210",this.file.accept=".jpg,.jpeg,.png,.tif",this.file.type="file",this.file.style.position="absolute",this.file.style.zIndex=999,Be.document.body.appendChild(this.file),this.file.onchange=function(){t.curYyzzFile=t.file.files[0],null!=t.curYyzzFile&&(t.uiSkin.txt_license.text=t.curYyzzFile.name)}},i.onDestroy=function(){Be.document.body.removeChild(this.file)},i.onUploadlicense=function(){this.file.click(),this.file.value},i.onSaveCompanyInfo=function(){return null==this.curYyzzFile?(v.showAlert("请选择营业执照"),void 0):this.curYyzzFile.size>=6291456?(v.showAlert("营业执照尺寸不能超过6M"),void 0):"image/jpg"!=this.curYyzzFile.type&&"image/jpeg"!=this.curYyzzFile.type?(v.showAlert("营业执照图片必须为JPG格式"),void 0):""==this.uiSkin.shortname.text?(v.showAlert("请填写企业简称"),void 0):""==this.uiSkin.reditcode.text?(v.showAlert("请填写统一社会征信代码"),void 0):(Be.window.createGroup({urlpath:R.httpUrl+"group/create-group?",cname:this.uiSkin.input_companyname.text,cshortname:this.uiSkin.shortname.text,czoneid:this.companyareaId,caddr:this.uiSkin.detail_addr.text,reditcode:this.uiSkin.reditcode.text,file:this.curYyzzFile}),void 0)},i.onSaveCompnayBack=function(t){if(!this.destroyed){var e=JSON.parse(t);0==e.status?(v.showAlert("提交成功，请等待审核"),this.uiSkin.btnsave.disabled=!0,this.uiSkin.btnsave.label="审核中"):v.showAlert("保存失败")}},i.hideAddressPanel=function(t){t.target instanceof laya.ui.List||(this.uiSkin.provbox.visible=!1,this.uiSkin.citybox.visible=!1,this.uiSkin.areabox.visible=!1,this.uiSkin.townbox.visible=!1,on.instance.event("PAUSE_SCROLL_VIEW",!0))},i.onShowProvince=function(t){this.uiSkin.provbox.visible=!0,this.uiSkin.citybox.visible=!1,this.uiSkin.areabox.visible=!1,this.uiSkin.townbox.visible=!1,on.instance.event("PAUSE_SCROLL_VIEW",!1),t.stopPropagation()},i.onShowCity=function(t){this.uiSkin.provbox.visible=!1,this.uiSkin.citybox.visible=!0,this.uiSkin.areabox.visible=!1,this.uiSkin.townbox.visible=!1,on.instance.event("PAUSE_SCROLL_VIEW",!1),t.stopPropagation()},i.onShowArea=function(t){this.uiSkin.provbox.visible=!1,this.uiSkin.citybox.visible=!1,this.uiSkin.areabox.visible=!0,this.uiSkin.townbox.visible=!1,on.instance.event("PAUSE_SCROLL_VIEW",!1),t.stopPropagation()},i.onShowTown=function(t){this.uiSkin.provbox.visible=!1,this.uiSkin.citybox.visible=!1,this.uiSkin.areabox.visible=!1,this.uiSkin.townbox.visible=!0,on.instance.event("PAUSE_SCROLL_VIEW",!1),t.stopPropagation()},i.updateCityList=function(t){t.setData(t.dataSource)},i.selectProvince=function(t){var e=this;null!=this.uiSkin.provList.array[t]&&(this.province=this.uiSkin.provList.array[t],this.uiSkin.provbox.visible=!1,this.uiSkin.province.text=this.province.areaname,R.instance.Request(R.httpUrl+"group/get-addr-list?",this,function(t){if(null!=e.uiSkin&&null!=e.uiSkin.citytxt&&!e.uiSkin.destroyed){var i=JSON.parse(t);e.uiSkin.cityList.array=i.status,e.uiSkin.cityList.refresh(),e.uiSkin.citytxt.text=e.uiSkin.cityList.array[0].areaname,e.uiSkin.cityList.selectedIndex=0,e.selectCity(0)}},"parentid="+this.province.id,"post"),on.instance.event("PAUSE_SCROLL_VIEW",!0))},i.selectCity=function(t){var e=this;this.uiSkin.citybox.visible=!1,R.instance.Request(R.httpUrl+"group/get-addr-list?",this,function(t){if(null!=e.uiSkin&&null!=e.uiSkin.areatxt&&!e.uiSkin.destroyed){var i=JSON.parse(t);e.uiSkin.areaList.array=i.status,e.uiSkin.areaList.refresh(),e.uiSkin.areatxt.text=e.uiSkin.areaList.array[0].areaname,e.uiSkin.areaList.selectedIndex=0,e.selectArea(0)}},"parentid="+this.uiSkin.cityList.array[t].id,"post"),this.uiSkin.citytxt.text=this.uiSkin.cityList.array[t].areaname,on.instance.event("PAUSE_SCROLL_VIEW",!0)},i.selectArea=function(t){var e=this;on.instance.event("PAUSE_SCROLL_VIEW",!0),-1!=t&&(R.instance.Request(R.httpUrl+"group/get-addr-list?",this,function(t){if(null!=e.uiSkin&&null!=e.uiSkin.towntxt&&!e.uiSkin.destroyed){var i=JSON.parse(t);e.uiSkin.townList.array=i.status,e.uiSkin.townList.refresh(),e.uiSkin.towntxt.text=e.uiSkin.townList.array[0].areaname,e.uiSkin.townList.selectedIndex=0,e.companyareaId=e.uiSkin.townList.array[0].id}},"parentid="+this.uiSkin.areaList.array[t].id,"post"),this.uiSkin.areatxt.text=this.uiSkin.areaList.array[t].areaname,this.uiSkin.areabox.visible=!1)},i.selectTown=function(t){on.instance.event("PAUSE_SCROLL_VIEW",!0),-1!=t&&(this.uiSkin.townbox.visible=!1,this.uiSkin.towntxt.text=this.uiSkin.townList.array[t].areaname,this.companyareaId=this.uiSkin.townList.array[t].id)},e}(an),ts=function(t){function e(){this.uiSkin=null,this.param=null,e.__super.call(this)}s(e,"script.order.PayTypeSelectControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.payall.selected=!0,this.uiSkin.paytype.selectedIndex=0,this.uiSkin.accountmoney.text="0元",this.uiSkin.needpay.text=this.param.amount+"元",this.uiSkin.realpay.text=this.param.amount+"元",R.instance.Request(R.httpUrl+"group/get-info?",this,this.getCompanyInfoBack,null,"post"),this.uiSkin.paybtn.on("click",this,this.onPayOrder),this.uiSkin.cancelbtn.on("click",this,this.onCancel)},i.getCompanyInfoBack=function(t){var e=JSON.parse(t);0==e.status&&(f.instance.money=Number(e.balance),this.uiSkin.accountmoney.text=f.instance.money.toString()+"元")},i.onPayOrder=function(){var t=this.param.orderid.join(",");if(0==this.uiSkin.paytype.selectedIndex)Be.window.open("about:self","_self").location.href=R.httpUrl+"group/recharge?amount=0&orderid="+this.param.orderid;else{if(f.instance.money<this.param.amount)return v.showAlert("余额不足"),void 0;R.instance.Request(R.httpUrl+"group/pay-order?",this,this.payMoneyBack,"orderid="+t,"post")}},i.payMoneyBack=function(t){var e=JSON.parse(t);0==e.status&&(v.showAlert("支付成功"),on.instance.event("PAY_ORDER_SUCESS"),v.instance.closeView("VIEW_SELECT_PAYTYPE_PANEL"))},i.confirmSucess=function(t){t&&(on.instance.event("PAY_ORDER_SUCESS"),v.instance.closeView("VIEW_SELECT_PAYTYPE_PANEL"))},i.onCancel=function(){v.instance.openView("VIEW_POPUPDIALOG",!1,{msg:"确定取消支付吗？取消支付您可以到订单界面查询支付状态或继续支付。",caller:this,callback:this.confirmCancel})},i.confirmCancel=function(t){t&&(v.instance.closeView("VIEW_SELECT_PAYTYPE_PANEL"),on.instance.event("CANCEL_PAY_ORDER"))},e}(an),es=function(t){function e(){this.uiSkin=null,this.param=null,this.inputarr=null,this.focusindex=0,e.__super.call(this)}s(e,"script.login.ResetPwdControl",t);var n=e.prototype;return n.onStart=function(){this.uiSkin=this.owner,this.uiSkin.btnClose.on("click",this,this.onCloseScen),this.inputarr=[this.uiSkin.inputphone,this.uiSkin.inputpwd,this.uiSkin.inputcfmpwd,this.uiSkin.inputcode];for(var t=0;t<this.inputarr.length;t++)this.inputarr[t].on("keydown",this,this.onAccountKeyUp);i.stage.on("focuschange",this,this.onFocusChange),this.uiSkin.inputphone.focus=!0,this.focusindex=0},n.onFocusChange=function(){this.inputarr.indexOf(i.stage.focus.parent)>=0&&(this.focusindex=this.inputarr.indexOf(i.stage.focus.parent))},n.onAccountKeyUp=function(t){9==t.keyCode&&(this.focusindex=++this.focusindex%this.inputarr.length,this.inputarr[this.focusindex].focus=!0),13==t.keyCode},n.onCloseScen=function(){v.instance.closeView("VIEW_CHANGEPWD"),i.stage.off("focuschange",this,this.onFocusChange)},e}(an),is=function(t){function e(){this.uiSkin=null,this.matvo=null,this.param=null,this.selectAttach=null,e.__super.call(this)}s(e,"script.order.SelectAttchesControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.attachList.itemRender=da,this.uiSkin.attachList.vScrollBarSkin="",this.uiSkin.attachList.selectEnable=!0,this.uiSkin.attachList.spaceY=2,this.uiSkin.attachList.renderHandler=new _(this,this.updateAttachClassItem),this.uiSkin.attachList.selectHandler=new _(this,this.onSlecteAttachCat),this.uiSkin.attachList.array=[],this.matvo=this.param,null!=this.matvo.attachList&&this.matvo.attachList.length>0?this.uiSkin.attachList.array=this.matvo.attachList:R.instance.Request(R.httpUrl+"business/acccatlist?prod_code="+I.instance.curSelectMat.prod_code+"&proc_name="+this.matvo.preProc_Name,this,this.onAccCatlistBack,null,null),this.selectAttach=[],this.uiSkin.btncancel.on("click",this,this.onCloseView),this.uiSkin.btnok.on("click",this,this.onSureClose),on.instance.on("ADD_TECH_ATTACH",this,this.onAddAttach)},i.onAccCatlistBack=function(t){var e=JSON.parse(t);e.hasOwnProperty("status")||null!=e[0]&&R.instance.Request(R.httpUrl+"business/accessorylist?manufacturer_code="+I.instance.curSelectMat.manufacturer_code+"&accessoryCat_name="+e[0].accessoryCat_Name,this,this.onGetAccessorylistBack,null,null)},i.onGetAccessorylistBack=function(t){var e=JSON.parse(t);if(e){this.matvo.attachList=[];for(var i=0;i<e.length;i++){var n=new S(e[i]);n.materialItemVo=this.matvo,this.matvo.attachList.push(n)}this.uiSkin.attachList.array=this.matvo.attachList}},i.updateAttachClassItem=function(t){t.setData(t.dataSource)},i.onAddAttach=function(t){this.matvo.selectAttachVoList=[],this.matvo.selectAttachVoList.push(t),this.onCloseView(),on.instance.event("CLOSE_PANEL_VIEW","VIEW_SELECT_ATTACH")},i.onSureClose=function(){return this.uiSkin.attachList.array.length>0&&(null==this.selectAttach||0==this.selectAttach.length)?(v.showAlert("请选择附件"),void 0):(this.matvo.selectAttachVoList=this.selectAttach,this.onCloseView(),on.instance.event("CLOSE_PANEL_VIEW","VIEW_SELECT_ATTACH"),void 0)},i.onSlecteAttachCat=function(t){for(var e=0;e<this.uiSkin.attachList.cells.length;e++)this.uiSkin.attachList.cells[e].ShowSelected(e==t);this.selectAttach=[],this.selectAttach.push(this.uiSkin.attachList.array[t])},i.onCloseView=function(){return this.uiSkin.attachList.array.length>0&&(null==this.selectAttach||0==this.selectAttach.length)?(v.showAlert("请选择附件"),void 0):(this.matvo.selectAttachVoList=this.selectAttach,on.instance.event("CLOSE_PANEL_VIEW","VIEW_SELECT_ATTACH"),v.instance.closeView("VIEW_SELECT_ATTACH"),on.instance.off("ADD_TECH_ATTACH",this,this.onAddAttach),void 0)},e}(an),ns=function(t){function e(){this.uiSkin=null,this.tempaddress=null,e.__super.call(this)}s(e,"script.order.SelectAddressControl",t);var n=e.prototype;return n.onStart=function(){var t=this;this.uiSkin=this.owner,this.uiSkin.list_address.itemRender=ha,this.uiSkin.list_address.vScrollBarSkin="",this.uiSkin.list_address.selectEnable=!0,this.uiSkin.list_address.spaceY=2,this.uiSkin.list_address.renderHandler=new _(this,this.updateAddressItem),this.uiSkin.list_address.selectHandler=new _(this,this.onSlecteAddress),this.uiSkin.btncancel.on("click",this,this.onCloseView),this.uiSkin.btnok.on("click",this,this.onConfirmSelectAddress),this.uiSkin.inputsearch.on("input",this,this.onSearchAddress),this.uiSkin.list_address.array=f.instance.addressList,i.timer.once(10,null,function(){for(var e=t.uiSkin.list_address.cells,i=0;i<e.length;i++)e[i].ShowSelected=e[i].address==I.instance.selectAddress})},n.onSearchAddress=function(){if(""==this.uiSkin.inputsearch.text)return this.uiSkin.list_address.array=f.instance.addressList,void 0;for(var t=[],e=0;e<f.instance.addressList.length;e++)f.instance.addressList[e].addressDetail.indexOf(this.uiSkin.inputsearch.text)>=0&&t.push(f.instance.addressList[e]);this.uiSkin.list_address.array=t},n.onSlecteAddress=function(t){var e=this;this.tempaddress=this.uiSkin.list_address.array[t],i.timer.frameOnce(1,this,function(){var i;for(var n in e.uiSkin.list_address.cells)i=e.uiSkin.list_address.cells[n],i.ShowSelected=i.address==e.uiSkin.list_address.array[t]})},n.updateAddressItem=function(t){t.setData(t.dataSource)},n.onConfirmSelectAddress=function(){null!=this.tempaddress&&(I.instance.selectAddress=this.tempaddress,on.instance.event("SELECT_ORDER_ADDRESS")),this.onCloseView()},n.onCloseView=function(){v.instance.closeView("VIEW_SELECT_ADDRESS")},e}(an),ss=function(t){function e(){this.uiSkin=null,this.tempaddress=null,e.__super.call(this)}s(e,"script.order.SelectFactoryControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.list_address.itemRender=ca,this.uiSkin.list_address.vScrollBarSkin="",this.uiSkin.list_address.selectEnable=!1,this.uiSkin.list_address.spaceY=8,this.uiSkin.list_address.renderHandler=new _(this,this.updateAddressItem),this.uiSkin.list_address.array=I.instance.outPutAddr,this.uiSkin.cancelbtn.on("click",this,this.onCloseView),this.uiSkin.okbtn.on("click",this,this.onConfirmSelectAddress)},i.onSlecteAddress=function(t){if(this.uiSkin.list_address.array[t]!=this.tempaddress){var e;for(var i in this.uiSkin.list_address.cells)e=this.uiSkin.list_address.cells[i],e.ShowSelected=e.address==this.uiSkin.list_address.array[t];this.tempaddress=this.uiSkin.list_address.array[t]}},i.updateAddressItem=function(t){t.setData(t.dataSource)},i.onConfirmSelectAddress=function(){this.onCloseView()},i.onCloseView=function(){v.instance.closeView("VIEW_SELECT_FACTORY")},e}(an),rs=function(t){function e(){this.uiSkin=null,this.param=null,this.tempSelect=null,e.__super.call(this)}s(e,"script.order.SelectDeliveryControl",t);var n=e.prototype;return n.onStart=function(){this.uiSkin=this.owner,this.uiSkin.list_delivery.itemRender=fa,this.uiSkin.list_delivery.vScrollBarSkin="",this.uiSkin.list_delivery.selectEnable=!0,this.uiSkin.list_delivery.spaceY=8,this.uiSkin.list_delivery.renderHandler=new _(this,this.updateAddressItem),this.uiSkin.list_delivery.selectHandler=new _(this,this.onSlecteDelivery),this.uiSkin.list_delivery.array=[],this.uiSkin.cancelbtn.on("click",this,this.onCloseView),this.uiSkin.okbtn.on("click",this,this.onConfirmSelectAddress),null!=this.param&&R.instance.Request(R.httpUrl+"business/deliverylist?manufacturer_code="+this.param+"&addr_id="+I.instance.selectAddress.searchZoneid,this,this.onGetDeliveryBack,null,null)},n.onGetDeliveryBack=function(t){var e=this,n=JSON.parse(t);if(!n.hasOwnProperty("status")){I.instance.deliveryList=[];for(var s=0;s<n.length;s++){var r=new P(n[s]);"送货上门"==r.delivery_name&&(this.tempSelect=r),I.instance.deliveryList.push(r)}null==this.tempSelect&&I.instance.deliveryList.length>0&&(this.tempSelect=I.instance.deliveryList[0]),this.uiSkin.list_delivery.array=I.instance.deliveryList,i.timer.once(10,null,function(){for(var t=e.uiSkin.list_delivery.cells,i=0;i<t.length;i++)t[i].ShowSelected=t[i].deliveryVo==e.tempSelect})}},n.onSlecteDelivery=function(t){var e;for(var i in this.uiSkin.list_delivery.cells)e=this.uiSkin.list_delivery.cells[i],e.ShowSelected=e.deliveryVo==this.uiSkin.list_delivery.array[t];
this.tempSelect=this.uiSkin.list_delivery.array[t]},n.updateAddressItem=function(t){t.setData(t.dataSource)},n.onConfirmSelectAddress=function(){null!=this.tempSelect&&(I.instance.selectDelivery=this.tempSelect,on.instance.event("SELECT_DELIVERY_TYPE")),this.onCloseView()},n.onCloseView=function(){v.instance.closeView("VIEW_SELECT_DELIVERY_TYPE")},e}(an),as=function(t){function e(){this.uiSkin=null,e.__super.call(this)}s(e,"script.usercenter.MyOrderControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.orderList.itemRender=ya,this.uiSkin.orderList.vScrollBarSkin="",this.uiSkin.orderList.repeatX=1,this.uiSkin.orderList.spaceY=2,this.uiSkin.orderList.renderHandler=new _(this,this.updateOrderList),this.uiSkin.orderList.selectEnable=!1,this.uiSkin.orderList.array=[],R.instance.Request(R.httpUrl+"business/list-order?",this,this.onGetOrderListBack,null,"post"),on.instance.on("PAY_ORDER_SUCESS",this,this.onRefreshOrder)},i.onRefreshOrder=function(){R.instance.Request(R.httpUrl+"business/list-order?",this,this.onGetOrderListBack,null,"post")},i.onGetOrderListBack=function(t){if(null!=t&&""!=t){var e=JSON.parse(t);0==e.status&&(this.uiSkin.orderList.array=e.orders.reverse())}},i.updateOrderList=function(t){t.setData(t.dataSource)},i.onDestroy=function(){on.instance.off("PAY_ORDER_SUCESS",this,this.onRefreshOrder)},e}(an),os=function(t){function e(){this.uiSkin=null,this.param=null,e.__super.call(this)}s(e,"script.usercenter.OrderDetailControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.orderoanel.vScrollBarSkin="";var t=JSON.parse(this.param.or_text),e=t.orderItemList;e.sort(this.sortProduct),this.uiSkin.outputtxt.text=t.manufacturer_name,this.uiSkin.orderbox.autoSize=!0;for(var i=0;i<e.length;i++){var n=new zr;this.uiSkin.orderbox.addChild(n),n.y=n.height*i,n.setData(e[i]),n.adjustHeight=this.refrshVbox,n.caller=this}this.uiSkin.orderbox.size(this.uiSkin.orderbox.width,this.uiSkin.orderbox.getBounds().height),this.uiSkin.closebtn.on("click",this,this.onCloseView)},i.sortProduct=function(t,e){return parseInt(t.item_seq)>parseInt(e.item_seq)?1:-1},i.refrshVbox=function(){this.uiSkin.orderbox.refresh(),this.uiSkin.orderbox.size(this.uiSkin.orderbox.width,this.uiSkin.orderbox.getBounds().height)},i.onCloseView=function(){v.instance.closeView("VIEW_ORDER_DETAIL_PANEL")},e}(an),hs=function(t){function e(){this.uiSkin=null,this.province=null,this.verifycode=null,this.param=null,this.phonecode="",this.coutdown=60,this.serviceTxt="尊敬的用户：\n   色彩飞扬是专业的为广告及相关产品委托生产、买卖、交付等提供服务的网站（下称“本网站”），为广告相关产品及其他产品的委托生产、买卖、交付等的双方用户提供居间服务及其他相关服务，在此特别提醒用户认真阅读本《服务协议》(下称“本协议”)中各个条款，并确认是否同意本协议条款。用户的使用行为将视为对本协议的接受，并同意接受本协议各项条款的约束。\n\n一、本协议条款的确认\n   1、本网站的各项服务的所有权归上海红印科技有限公司。本协议内容包括协议正文及所有本网站已经发布或将来可能发布的各类规则。所有规则为协议不可分割的一部分，与本协议正文具有同等法律效力。以任何方式进入本网站即表示用户已充分阅读、理解并同意接受本协议的条款。\n   2、本网站有权根据业务需要酌情修订本协议，并以网站公告或直接更新的形式进行更新，不再单独通知。经修订的协议条款一经公布，即产生效力。如用户不同意相关修订，可以选择停止使用。如用户继续使用本网站，则将视为用户已接受经修订的协议条款。\n\n二、服务要求及保密\n1、用户必须符合下列要求：\n （1）应当是具备完全民事权利能力和与所从事的民事行为相适应的行为能力的自然人、法人或其他组织；\n （2）自行配备上网的所需设备，并自行负担上网及其他与此服务有关的电话、网络等费用；\n （3）按本网站要求完成注册，保证向本网站提供的任何资料、注册信息的真实性、正确性及完整性，保证本网站可以通过上述联系方式与用户进行联系；当上述资料发生变更时，及时更新用户资料；\n （4）账号使用权仅属于初始注册人，禁止赠与、借用、租用、转让或售卖，否则，本网站有权收回账号；\n （5）用户保证各项行为符合各项法律、法规、政策规定，以及本网站各项协议等的要求；\n （6）用户为委托方或买方的，保证遵守印刷、出版等行业的法律、法规、政策规定，且保证要求制作的产品不会侵犯他人的知识产权；\n （7）用户为广告经营者的，应当在注册时验证广告经营资格；若后续资格有变动的，应及时变更登记信息。\n2、本网站对用户的隐私资料进行保护，承诺不会在未获得用户许可的情况下擅自将用户的个人资料信息出租或出售给任何第三方，但以下情况除外：\n （1）为完成用户与第三方交易； \n （2）用户同意让第三方共享资料；\n （3）用户同意公开其个人资料，享受为其提供的商品和服务；\n （4）根据法律的有关规定，或者行政或司法机构的要求，向第三方或者行政、司法机构披露；\n （5）本网站发现用户违反了本网站服务条款或其它规定。\n   若本网站有合理理由怀疑用户资料信息为错误、不实、失效或不完整，本网站有权暂停或终止用户的帐号，并拒绝现在或将来使用本站网络服务的全部或部分，同时保留追索用户不当得利返还的权利。\n\n三、平台服务和地位 \n   本网站仅作为用户物色交易对象，就货物和服务的交易进行协商，以及获取各类与交易相关的居间服务的场所，不涉及用户间因交易而产生的法律关系及法律纠纷。本网站不能控制或保证交易信息的真实性、合法性、准确性，亦不能控制或保证交易所涉及的物品及服务的质量、安全或合法性，以及相关交易各方履行在贸易协议项下的各项义务的能力。但本网站会尽力协助各方履行各自义务。用户注册并选择本网站提供的服务，即视为认可由本网站为其提供居间服务及有关服务的内容，同时认可通过本网站指定的账号或支付平台由本网站监管、代付有关款项。\n\n四、结束服务\n   用户或本网站可随时根据实际情况中断一项或多项网络服务。本网站不需对任何个人或第三方负责而随时中断服务。结束用户服务后，用户使用网络服务的权利马上中止。从那时起，用户没有权利要求本网站，本网站也没有义务传送任何未处理的信息或提供未完成的服务给用户或第三方。用户在使用服务期间因使用服务与其他用户之间发生的关系，不因本协议的终止而终止。\n\n五、服务费用。 \n   本网站保留在征得用户同意后，收取服务费用的权利。用户因进行交易、获取有偿服务等发生的所有应纳税赋，由用户自行承担。\n\n六、广告展示\n   用户在本网站发表宣传资料或参与广告策划，展示商品或服务，都只是在相应的用户之间发生，本网站不承担任何责任。\n\n七、服务内容的所有权\n   本网站有关文字、软件、声音、图片、录象、图表、广告及其他文件的全部内容受版权、商标、和其它财产所有权属于本网站所有，受法律的保护。\n\n八、责任限制\n   如因不可抗力或其他本网站无法控制的原因使本网站无法正常运营的，本网站不承担责任。\n\n九、争议解决和管辖\n   本协议的订立、执行和解释及争议的解决均应适用中国法律。\n如用户与本网站发生任何争议，双方应尽力友好协商解决；协商不成时，任何一方均应向本网站所属公司住所地人民法院提起诉讼。\n",e.__super.call(this)}s(e,"script.login.RegisterCntrol",t);var n=e.prototype;return n.onStart=function(){this.uiSkin=this.owner,this.uiSkin.input_conpwd.maxChars=20,this.uiSkin.input_conpwd.type="password",this.uiSkin.input_phone.maxChars=11,this.uiSkin.input_phone.restrict="0-9",this.uiSkin.input_phonecode.maxChars=6,this.uiSkin.input_pwd.maxChars=20,this.uiSkin.input_pwd.type="password",this.uiSkin.inputCode.maxChars=8,this.uiSkin.sevicepro.leading=5,this.uiSkin.sevicepro.text=this.serviceTxt,this.uiSkin.txtpanel.vScrollBarSkin="",this.uiSkin.contractpanel.height=Be.clientHeight,this.uiSkin.btnGetCode.on("click",this,this.onGetPhoneCode),this.uiSkin.btnClose.on("click",this,this.onCloseScene),this.uiSkin.txtRefresh.on("click",this,this.onRefreshVerify),this.uiSkin.btnReg.on("click",this,this.onRegister),on.instance.on("BROWER_WINDOW_RESIZE",this,this.onResizeBrower),this.uiSkin.okbtn.disabled=!0,this.uiSkin.agreebox.on("click",this,this.onAgreeService),this.uiSkin.okbtn.on("click",this,this.onReadService)},n.onReadService=function(){this.uiSkin.contractpanel.visible=!1,this.verifycode=Be.document.createElement("div"),this.verifycode.id="v_container",this.verifycode.style="width: 200px;height: 50px;left:950px;top:548",this.verifycode.style.left=950-(1920-Be.clientWidth)/2+"px",this.verifycode.style.position="absolute",this.verifycode.style.zIndex=999,Be.document.body.appendChild(this.verifycode),Be.window.loadVerifyCode()},n.onAgreeService=function(){this.uiSkin.okbtn.disabled=!this.uiSkin.agreebox.selected},n.onResizeBrower=function(){null!=this.verifycode&&(this.verifycode.style.left=950-(1920-Be.clientWidth)/2+"px"),this.uiSkin.contractpanel.height=Be.clientHeight},n.onGetPhoneCode=function(){return this.uiSkin.input_phone.text.length<11?(Be.window.alert("请填写正确的手机号"),void 0):(this.uiSkin.btnGetCode.disabled=!0,R.instance.Request(R.httpUrl+"api/getcode?",this,this.onGetPhoneCodeBack,"phone="+this.uiSkin.input_phone.text,"post"),void 0)},n.onGetPhoneCodeBack=function(t){var e=JSON.parse(t);0==e.status?(this.phonecode=e.code,this.uiSkin.btnGetCode.label="60秒后重试",i.timer.loop(1e3,this,this.countdownCode)):this.uiSkin.btnGetCode.disabled=!1,console.log("pho code:"+t)},n.countdownCode=function(){this.coutdown--,this.coutdown>0?this.uiSkin.btnGetCode.label=this.coutdown+"秒后重试":(this.uiSkin.btnGetCode.disabled=!1,this.uiSkin.btnGetCode.label="获取验证码",i.timer.clear(this,this.countdownCode))},n.onRefreshVerify=function(){Be.window.loadVerifyCode()},n.onCloseScene=function(){Be.document.body.removeChild(this.verifycode),i.timer.clear(this,this.countdownCode),v.instance.closeView("VIEW_REGPANEL"),v.instance.openView("VIEW_FIRST_PAGE",!0),on.instance.off("BROWER_WINDOW_RESIZE",this,this.onResizeBrower)},n.onRegister=function(){var t=Be.window.checkCode(this.uiSkin.inputCode.text);if(t){if(this.uiSkin.input_phone.text.length<11)return Be.window.alert("请填写正确的手机号"),void 0;if(this.uiSkin.input_pwd.text.length<6)return Be.window.alert("密码长度至少6位"),void 0;if(this.uiSkin.input_pwd.text!=this.uiSkin.input_conpwd.text)return Be.window.alert("密码确认不对"),void 0;var e="phone="+this.uiSkin.input_phone.text+"&pwd="+this.uiSkin.input_pwd.text+"&code="+this.uiSkin.input_phonecode.text;R.instance.Request(R.httpUrl+"account/create?",this,this.onRegisterBack,e,"post")}else Be.window.alert("验证码错误")},n.onRegisterBack=function(t){var e=JSON.parse(t);0==e.status&&(Be.window.alert("注册成功！"),Be.document.body.removeChild(this.verifycode),on.instance.off("BROWER_WINDOW_RESIZE",this,this.onResizeBrower),v.instance.openView("VIEW_FIRST_PAGE",!0),v.instance.openView("VIEW_lOGPANEL",!1))},e}(an),ls=function(t){function e(){this.uiSkin=null,this.fileListData=null,this.allFileData=null,this.curUploadIndex=0,this.file=null,this.param=null,this.isUploading=!1,this.clientParam=null,this.checkpoint=0,this.callbackparam=null,this.ossFileName=null,this.reupTryTimes=0,e.__super.call(this)}s(e,"script.picUpload.UpLoadAndOrderContrl",t);var n=e.prototype;return n.onStart=function(){this.uiSkin=this.owner,this.uiSkin.btnClose.on("click",this,this.onCloseScene),this.uiSkin.btnOpenFile.on("click",this,this.onClickOpenFile),this.uiSkin.fileList.itemRender=va,this.uiSkin.fileList.vScrollBarSkin="",this.uiSkin.fileList.selectEnable=!1,this.uiSkin.fileList.spaceY=4,this.uiSkin.fileList.renderHandler=new _(this,this.updateFileItem),this.initFileOpen(),this.uiSkin.uploadinfo.visible=!1,this.uiSkin.errortxt.visible=!1,this.uiSkin.goonbtn.visible=!1,this.uiSkin.goonbtn.on("click",this,this.reUploadFile),Be.window.uploadApp=this,null!=this.param&&null!=this.param?(this.uiSkin.fileList.array=this.param,this.fileListData=this.param,this.onClickBegin()):this.uiSkin.fileList.array=[],on.instance.on("CANCAEL_UPLOAD_ITEM",this,this.onDeleteItem),on.instance.on("RE_UPLOAD_FILE",this,this.reUploadFile)},n.reUploadFile=function(){this.uiSkin.errortxt.visible=!1,this.uiSkin.goonbtn.visible=!1,this.onClickBegin()},n.onClickOpenFile=function(){i.timer.clearAll(this),this.file.click(),this.file.value},n.initFileOpen=function(){var t=this;this.file=Be.document.createElement("input"),this.file.style="filter:alpha(opacity=0);opacity:0;width: 100;height:34px;left:395px;top:-248",this.file.multiple="multiple",this.file.accept=".jpg,.jpeg,.png,.tif",this.file.type="file",this.file.style.position="absolute",this.file.style.zIndex=999,Be.document.body.appendChild(this.file),this.file.onchange=function(){if(t.uiSkin.uploadinfo.visible=!1,!(t.isUploading||t.file.files.length<=0)){t.curUploadIndex=0,t.fileListData=[];for(var e=0;e<t.file.files.length;e++)t.file.files[e].progress=0,t.fileListData.push(t.file.files[e]);t.uiSkin.fileList.array=t.fileListData,t.onClickBegin()}}},n.getSendRequest=function(){R.instance.Request(R.httpUrl+"file/authinfo",this,this.onGetAuthor,null,"get")},n.onGetAuthor=function(t){var e=JSON.parse(t);this.clientParam={},this.clientParam.accessKeyId=e.Credentials.AccessKeyId,this.clientParam.accessKeySecret=e.Credentials.AccessKeySecret,this.clientParam.stsToken=e.Credentials.SecurityToken,this.clientParam.endpoint="oss-cn-hangzhou.aliyuncs.com",this.clientParam.bucket="original-image",Be.window.createossClient(this.clientParam),this.onClickBegin()},n.onClickBegin=function(){if(i.timer.clear(this,this.reUploadFile),!this.isUploading){if(null==this.clientParam)return this.getSendRequest(),void 0;this.isUploading=!0,this.onBeginUpload(),this.fileListData.length>0&&(this.uiSkin.uploadinfo.visible=!0,this.uiSkin.uploadinfo.text="正在上传("+this.curUploadIndex+"/"+this.fileListData.length+")")}},n.onBeginUpload=function(){null==this.callbackparam&&this.fileListData&&this.fileListData.length>this.curUploadIndex?R.instance.Request(R.httpUrl+"file/preupload?",this,this.onReadyToUpload,"path="+D.instance.curSelectDir.dpath+"&fname="+this.fileListData[this.curUploadIndex].name,"get"):this.uploadFileImmediate()},n.uploadFileImmediate=function(){this.fileListData&&this.fileListData.length>this.curUploadIndex?Be.window.ossUpload({file:this.fileListData[this.curUploadIndex]},this.checkpoint,this.callbackparam,this.ossFileName):(this.isUploading=!1,this.uiSkin.uploadinfo.text="上传完成，共上传文件"+this.fileListData.length,i.timer.once(5e3,this,this.onCloseScene))},n.onReadyToUpload=function(t){var e=JSON.parse(t);if(0==e.status){this.callbackparam={},this.callbackparam.url=e.CallbackUrl,this.callbackparam.body=e.CallbackBody,this.callbackparam.contentType="application/x-www-form-urlencoded";var i=this.fileListData[this.curUploadIndex].name.split(".");this.ossFileName=e.ObjectName+"."+(null==i[i.length-1]?"jpg":i[i.length-1]),this.uploadFileImmediate()}else 304==e.status&&(this.curUploadIndex++,this.checkpoint=0,this.callbackparam=null,this.ossFileName="",this.onBeginUpload())},n.onCompleteUpload=function(){this.fileListData[this.curUploadIndex]&&(this.fileListData[this.curUploadIndex].progress=100),this.updateProgress(),this.curUploadIndex++,this.uiSkin.uploadinfo.text="正在上传("+this.curUploadIndex+"/"+this.fileListData.length+")",this.checkpoint=0,this.callbackparam=null,this.ossFileName="",this.onBeginUpload()},n.onProgressHandler=function(t,e){this.checkpoint=t,Number(e)>=100&&(e="99"),this.fileListData[this.curUploadIndex]&&(this.fileListData[this.curUploadIndex].progress=Number(e)),this.updateProgress()},n.onUploadError=function(t){this.isUploading=!1,this.clientParam=null,this.reupTryTimes<10&&(i.timer.once(100,this,this.reUploadFile),this.reupTryTimes++),this.uiSkin.errortxt.visible=!0,this.uiSkin.errortxt.text=this.getErrorMsg(t);for(var e=this.uiSkin.fileList.cells,n=0;n<e.length;n++)if(null!=e[n]&&e[n].fileobj==this.fileListData[this.curUploadIndex]){e[n].showReUploadbtn(),this.uiSkin.goonbtn.visible=!0;break}},n.updateProgress=function(){for(var t=this.uiSkin.fileList.cells,e=0;e<t.length;e++)if(null!=t[e]&&t[e].fileobj==this.fileListData[this.curUploadIndex]){t[e].updateProgress();break}},n.updateFileItem=function(t){t.setData(t.dataSource)},n.onDeleteItem=function(t){var e=this.fileListData.indexOf(t.fileobj);if(e!=this.curUploadIndex&&!(t.fileobj.progress>=99)){var e=this.fileListData.indexOf(t.fileobj);this.uiSkin.fileList.deleteItem(e)}},n.getErrorMsg=function(t){switch(t.status){case 0:if("cancel"==t.name)return"主动删除";break;case-1:return"自动重新上传";case 203:return"前端自己给后台回调";case 400:switch(t.code){case"FilePartInterity":case"FilePartNotExist":case"FilePartState":case"InvalidPart":case"InvalidPartOrder":case"InvalidArgument":return"清空断点,重新上传;";case"InvalidBucketName":case"InvalidDigest":case"InvalidEncryptionAlgorithmError":case"InvalidObjectName":case"InvalidPolicyDocument":case"InvalidTargetBucketForLogging":case"MalformedXML":case"RequestIsNotMultiPartContent":return"重新授权;继续上传;";case"RequestTimeout":return"请求超时，请重新上传"}break;case 403:return"授权无效，重新授权";case 411:return"缺少参数";case 404:return"重新授权;继续上传;";case 500:return"OSS内部发生错误,重新上传;";default:return"未知错误，请重新上传"}return""},n.onCloseScene=function(){this.isUploading||(Be.window.uploadApp=null,i.timer.clearAll(this),on.instance.event("UPDATE_FILE_LIST"),on.instance.off("CANCAEL_UPLOAD_ITEM",this,this.onDeleteItem),on.instance.off("RE_UPLOAD_FILE",this,this.reUploadFile),v.instance.closeView("VIEW_MYPICPANEL"),Be.document.body.removeChild(this.file))},e}(an),_s=function(t){function e(){this.uiSkin=null,this.startposx=10,this.param=null,this.itemheight=40,this.itemspaceH=30,this.itemspaceV=20,this.allitemlist=null,this.hasShowItemList=null,this.firstTechlist=null,this.linelist=null,this.hasFinishAllFlow=!1,e.__super.call(this)}s(e,"script.order.SelectMaterialControl",t);var n=e.prototype;return n.onStart=function(){this.hasFinishAllFlow=!1,this.uiSkin=this.owner,this.uiSkin.main_panel.vScrollBarSkin="",this.uiSkin.tablist.itemRender=oa,this.uiSkin.tablist.vScrollBarSkin="",this.uiSkin.tablist.selectEnable=!0,this.uiSkin.tablist.spaceY=2,this.uiSkin.tablist.renderHandler=new _(this,this.updateMatClassItem),this.uiSkin.tablist.selectHandler=new _(this,this.onSlecteMatClass),this.uiSkin.originimg.skin="",this.uiSkin.backimg.skin="",this.uiSkin.qiegeimg.skin="",this.uiSkin.qiegeoriginimg.skin="",null!=this.param&&(this.param.picWidth>this.param.picHeight?(this.uiSkin.originimg.width=250,this.uiSkin.originimg.height=250/this.param.picWidth*this.param.picHeight):(this.uiSkin.originimg.height=250,this.uiSkin.originimg.width=250/this.param.picHeight*this.param.picWidth),this.uiSkin.qiegeimg.width=this.uiSkin.originimg.width,this.uiSkin.qiegeimg.height=this.uiSkin.originimg.height,this.uiSkin.backimg.width=this.uiSkin.originimg.width,this.uiSkin.backimg.height=this.uiSkin.originimg.height,this.uiSkin.qiegeoriginimg.width=this.uiSkin.originimg.width,this.uiSkin.qiegeoriginimg.height=this.uiSkin.originimg.height),this.uiSkin.matlist.itemRender=ma,this.uiSkin.matlist.vScrollBarSkin="",this.uiSkin.matlist.selectEnable=!0,this.uiSkin.matlist.spaceY=10,this.uiSkin.matlist.renderHandler=new _(this,this.updateMatNameItem),this.uiSkin.selecttech.text="无",this.uiSkin.hasSelMat.text="无",this.uiSkin.matlist.array=[],this.uiSkin.tablist.array=I.instance.productList,this.uiSkin.techcontent.vScrollBar.hide=!0,this.uiSkin.techcontent.hScrollBar.hide=!0,this.uiSkin.main_panel.vScrollBarSkin="",this.uiSkin.subtn.on("click",this,this.onSubItemNum),this.uiSkin.addbtn.on("click",this,this.onAddItemNum),this.uiSkin.numinput.on("input",this,this.onNumChange),this.uiSkin.numinput.text="1",this.uiSkin.numinput.restrict="0-9",I.instance.productList&&I.instance.productList.length>0&&(this.uiSkin.tablist.selectedIndex=0,this.uiSkin.tablist.cells[0].ShowSelected=!0),this.uiSkin.box_tech.visible=!1,this.uiSkin.backBtn.label="工艺",this.uiSkin.btncancel.on("click",this,this.onCloseView),this.uiSkin.btnok.on("click",this,this.onConfirmTech),this.uiSkin.backBtn.on("click",this,this.onSwitchPanel),on.instance.on("BROWER_WINDOW_RESIZE",this,this.onResizeBrower),on.instance.on("SHOW_SELECT_TECH",this,this.initTechView),on.instance.on("CLOSE_PANEL_VIEW",this,this.onUpdateTechDes),on.instance.on("CLOSE_PANEL_VIEW",this,this.checkShowEffectImg),this.uiSkin.main_panel.height=Be.clientHeight},n.onSubItemNum=function(){var t=parseInt(this.uiSkin.numinput.text);t>1&&t--,this.uiSkin.numinput.text=t.toString(),this.onNumChange()},n.onAddItemNum=function(){var t=parseInt(this.uiSkin.numinput.text);t++,this.uiSkin.numinput.text=t.toString(),this.onNumChange()},n.onNumChange=function(){on.instance.event("BATCH_CHANGE_PRODUCT_NUM",this.uiSkin.numinput.text)},n.onResizeBrower=function(){this.uiSkin.main_panel.height=Be.clientHeight},n.updateMatClassItem=function(t){t.setData(t.dataSource)},n.onSlecteMatClass=function(t){var e;for(var i in this.uiSkin.tablist.cells)e=this.uiSkin.tablist.cells[i],e.ShowSelected=e.matclassvo==this.uiSkin.tablist.array[t];this.refreshMatList()},n.updateFactoryItem=function(t){t.setData(t.dataSource)},n.onSlecteFactory=function(){this.refreshMatList()},n.refreshMatList=function(){var t=this.uiSkin.tablist.array[this.uiSkin.tablist.selectedIndex];if(null!=t.childMatList){var e=t.childMatList;this.uiSkin.matlist.array=e}else R.instance.Request(R.httpUrl+"business/prodlist?client_code=CL10200&addr_id="+I.instance.selectAddress.searchZoneid+"&prodCat_name="+t.matclassname,this,this.onGetProductListBack,null,null)},n.onGetProductListBack=function(t){var e=JSON.parse(t);if(!e.hasOwnProperty("status")){var i=this.uiSkin.tablist.array[this.uiSkin.tablist.selectedIndex];i.childMatList=[];for(var n=0;n<e.length;n++)i.childMatList.push(new C(e[n]));i.childMatList.sort(this.sortMaterial),this.uiSkin.matlist.array=i.childMatList}},n.sortMaterial=function(t,e){for(var i=t.prod_code,n=e.prod_code,s="",r=0;r<i.length;r++)i.charCodeAt(r)<=57&&i.charCodeAt(r)>=48&&(s+=i[r]);for(var a="",r=0;r<n.length;r++)n.charCodeAt(r)<=57&&n.charCodeAt(r)>=48&&(a+=n[r]);return parseInt(s)<=parseInt(a)?-1:1},n.updateMatNameItem=function(t){t.setData(t.dataSource)},n.onSlecteMat=function(t){var e;for(var i in this.uiSkin.matlist.cells)e=this.uiSkin.matlist.cells[i],e.ShowSelected=e.matvo==this.uiSkin.matlist.array[t]},n.onSwitchPanel=function(){if(this.uiSkin.box_mat.visible){if(null==I.instance.curSelectMat)return v.showAlert("请先选择一种材料"),void 0;this.showTechView()}else this.uiSkin.box_mat.visible=!0,this.uiSkin.box_tech.visible=!1,this.uiSkin.backBtn.label="工艺"},n.showTechView=function(){this.uiSkin.box_mat.visible=!1,this.uiSkin.box_tech.visible=!0,this.uiSkin.backBtn.label="材料",null==I.instance.curSelectMat&&v.showAlert("未选择材料"),null!=I.instance.curSelectMat&&0==I.instance.curSelectMat.prcessCatList.length&&v.showAlert("未获取到工艺流")},n.initTechView=function(){var t=this;this.uiSkin.hasSelMat.text=I.instance.curSelectMat.prod_name,this.uiSkin.mattext.text="已选材料:"+I.instance.curSelectMat.prod_name,this.updateSelectedTech(),this.showTechView(),this.checkShowEffectImg();this.hasShowItemList=[],this.linelist=[],this.firstTechlist=[];for(var e=I.instance.curSelectMat.prcessCatList,i=(this.uiSkin.techcontent.height-e.length*this.itemheight-this.itemspaceV*(e.length-1))/2;this.uiSkin.techcontent.numChildren>0;)this.uiSkin.techcontent.removeChildAt(0);if(e.length>0){var n=I.instance.curSelectMat.manufacturer_code;R.instance.Request(R.httpUrl+"business/procflowlist?manufacturer_code="+n+"&procCat_name="+e[0].procCat_Name,this,function(n){var s=JSON.parse(n);if(!s.hasOwnProperty("status")){I.instance.curSelectProcList=s,e[0].selected=!0,e[0].initProcFlow(s);for(var r=e[0].nextMatList,a=0;a<r.length;a++){var o=new _a;o.setData(r[a]),o.on("click",this,t.onClickMat,[o,r[a]]),o.x=t.startposx,o.y=i,i+=o.height+t.itemspaceV,this.uiSkin.techcontent.addChild(o),t.firstTechlist.push(o),t.hasShowItemList.push(o)}}},null,null)}this.allitemlist=[]},n.drawCurves=function(t,e){var i=new kn;this.uiSkin.techcontent.addChild(i);e.y-t.y;i.graphics.drawLine(0,t.y+.5*this.itemheight,.5*this.itemspaceH,t.y+.5*this.itemheight,"#ff4400",1),i.graphics.drawLine(.5*this.itemspaceH,t.y+.5*this.itemheight,.5*this.itemspaceH,e.y+.5*this.itemheight,"#ff4400",1),i.graphics.drawLine(.5*this.itemspaceH,e.y+.5*this.itemheight,this.itemspaceH,e.y+.5*this.itemheight,"#ff4400",1),i.x=t.x+t.width,this.linelist.push(i)},n.onGetProFlowt=function(t,e){var i=this,n=I.instance.curSelectMat.manufacturer_code;R.instance.Request(R.httpUrl+"business/procflowlist?manufacturer_code="+n+"&procCat_name="+e.procCat_Name,this,function(n){var s=JSON.parse(n);s.hasOwnProperty("status")||(I.instance.curSelectProcList=s,e.initProcFlow(s),i.onClickMat(t,e))},null,null)},n.onClickMat=function(t,e){if(null==e.nextMatList&&e instanceof model.orderModel.ProcessCatVo)return this.onGetProFlowt(t,e),void 0;if(this.hasFinishAllFlow=!1,t.isSelected&&(this.refreshHashowItem(t.x),this.updateSelectedTech()),this.hasShowNextMaterial(e)||this.hideItems(t.x,!0),t.setSelected(!0),t.setTechSelected(!0),e.nextMatList&&e.nextMatList.length>0&&!this.hasShowNextMaterial(e)){var n=e.nextMatList,s=t.y+.5*this.itemheight-(n.length*this.itemheight+this.itemspaceV*(n.length-1))/2;0>s&&(s=0);for(var r=t.x+t.width+this.itemspaceH,a=0;a<n.length;a++){var o=this.getItembox();o.setData(n[a]),this.hasShowItemList.push(o),o.on("click",this,this.onClickMat,[o,n[a]]),o.x=r,o.y=s,this.drawCurves(t,o),s+=o.height+this.itemspaceV,this.uiSkin.techcontent.addChild(o)}null!=o&&o.x+o.width>this.uiSkin.techcontent.width?(this.uiSkin.techcontent.hScrollBar.hide=!1,i.timer.frameOnce(2,this,function(){this.uiSkin.techcontent.scrollTo(o.x+o.width,this.uiSkin.techcontent.vScrollBar.value)})):this.uiSkin.techcontent.hScrollBar.visible=!1,null!=o&&o.y+o.height>this.uiSkin.techcontent.height?(this.uiSkin.techcontent.vScrollBar.hide=!1,i.timer.frameOnce(2,this,function(){this.uiSkin.techcontent.scrollTo(this.uiSkin.techcontent.hScrollBar.value,o.y+o.height)})):null!=o&&o.y<0?(this.uiSkin.techcontent.vScrollBar.hide=!1,i.timer.frameOnce(2,this,function(){this.uiSkin.techcontent.scrollTo(this.uiSkin.techcontent.hScrollBar.value,o.y)})):this.uiSkin.techcontent.vScrollBar.visible=!1}else this.hasFinishAllFlow=!0;"SPPEIJIAN"==e.preProc_attachmentTypeList.toLocaleUpperCase()&&v.instance.openView("VIEW_SELECT_ATTACH",!1,e),this.updateSelectedTech()},n.hasShowNextMaterial=function(t){var e=t.nextMatList;if(null!=e)for(var i=0;i<this.hasShowItemList.length;i++)if(this.hasShowItemList[i].techmainvo==e[0])return!0;return!1},n.onClickAttach=function(t){return t.isSelected?this.hideItems(t.x,!0):this.firstTechlist.indexOf(t)>=0?this.hideItems(t.x,!1):this.hideItems(t.x,!0),t.isSelected?(t.setSelected(!1),t.setTechSelected(!1),this.firstTechlist.indexOf(t)>=0&&this.cancelTech(t.processCatVo.nextMatList),this.updateSelectedTech(),void 0):(t.setSelected(!0),this.updateSelectedTech(),this.hideItems(this.firstTechlist[0].x,!1,!0),void 0)},n.hideItems=function(t,e,i){void 0===i&&(i=!1);for(var n=0;n<this.hasShowItemList.length;n++)this.hasShowItemList[n].x>t?(this.hasShowItemList[n].removeSelf(),this.hasShowItemList[n].setSelected(!1),e&&null!=this.hasShowItemList[n].techmainvo&&(this.hasShowItemList[n].techmainvo.selected=!1),this.allitemlist.push(this.hasShowItemList[n]),this.hasShowItemList[n].offAll(),this.hasShowItemList.splice(n,1),n--):this.hasShowItemList[n].x==t&&(i||this.hasShowItemList[n].setSelected(!1),e&&null!=this.hasShowItemList[n].techmainvo&&(this.hasShowItemList[n].techmainvo.selected=!1));for(var n=0;n<this.linelist.length;n++)this.linelist[n].x>t&&(this.linelist[n].graphics.clear(!0),this.linelist[n].removeSelf(),this.linelist.splice(n,1),n--)},n.refreshHashowItem=function(t){for(var e=0;e<this.hasShowItemList.length;e++)this.hasShowItemList[e].x>t&&(this.hasShowItemList[e].setSelected(!1),null!=this.hasShowItemList[e].techmainvo&&(this.hasShowItemList[e].techmainvo.selected=!1))},n.updateSelectedTech=function(){this.uiSkin.selecttech.text=I.instance.curSelectMat.getTechDes(),this.checkShowEffectImg()},n.cancelTech=function(t){if(t)for(var e=0;e<t.length;e++)t[e].selected=!1,this.cancelTech(t[e].nextMatList)},n.checkShowEffectImg=function(){if(null!=this.param){for(var t=I.instance.curSelectMat.getAllSelectedTech(),e="",i="",n=!1,s=0;s<t.length;s++)"SPTE10320"==t[s].preProc_Code?n=!0:"SPTE10330"==t[s].preProc_Code?e=t[s].attchFileId:"SPTE10420"==t[s].preProc_Code&&(i=t[s].attchFileId);this.uiSkin.originimg.visible=""!=e||n,this.uiSkin.backimg.visible=""!=e||n,""!=e&&(this.uiSkin.originimg.skin="http://large-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/"+this.param.fid+".jpg",this.uiSkin.backimg.skin="http://large-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/"+e+".jpg"),n&&(this.uiSkin.originimg.skin="http://large-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/"+this.param.fid+".jpg",this.uiSkin.backimg.skin="http://large-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/"+this.param.fid+".jpg"),this.uiSkin.qiegeimg.visible=""!=i,this.uiSkin.qiegeoriginimg.visible=""!=i,""!=i&&(this.uiSkin.qiegeoriginimg.skin="http://large-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/"+this.param.fid+".jpg",this.uiSkin.qiegeimg.skin="http://large-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/"+i+".jpg")}},n.getItembox=function(){if(this.allitemlist.length>0)return this.allitemlist.splice(0,1)[0];var t=new _a;return t},n.onConfirmTech=function(){if(!this.hasFinishAllFlow,null==I.instance.curSelectMat||""==I.instance.curSelectMat.getTechDes())return v.showAlert("请选择一个工艺"),void 0;if(I.instance.curSelectOrderItem)I.instance.curSelectOrderItem.changeProduct(I.instance.curSelectMat);else if(I.instance.batchChangeMatItems&&I.instance.batchChangeMatItems.length>0)for(var t=0;t<I.instance.batchChangeMatItems.length;t++)I.instance.batchChangeMatItems[t].changeProduct(I.instance.curSelectMat);on.instance.event("UPDATE_ORDER_ITEM_TECH"),this.onCloseView()},n.onUpdateTechDes=function(t){"VIEW_SELECT_ATTACH"==t&&this.updateSelectedTech()},n.onCloseView=function(){v.instance.closeView("VIEW_SELECT_MATERIAL")},n.onDestroy=function(){on.instance.off("BROWER_WINDOW_RESIZE",this,this.onResizeBrower),on.instance.off("SHOW_SELECT_TECH",this,this.initTechView),on.instance.off("CLOSE_PANEL_VIEW",this,this.onUpdateTechDes),on.instance.off("CLOSE_PANEL_VIEW",this,this.checkShowEffectImg)},e}(an),us=function(t){function e(){this.uiSkin=null,e.__super.call(this)}s(e,"script.usercenter.AddressMgrControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.addlist.itemRender=la,this.uiSkin.addlist.vScrollBarSkin="",this.uiSkin.addlist.repeatX=1,this.uiSkin.addlist.spaceY=0,this.uiSkin.addlist.renderHandler=new _(this,this.updateAddressList),this.uiSkin.addlist.selectEnable=!1;var t=[];this.uiSkin.addlist.array=t,this.uiSkin.btnaddAddress.on("click",this,this.onClickAdd),f.instance.addressList.length<=0?R.instance.Request(R.httpUrl+"group/opt-group-express?",this,this.getMyAddressBack,"opt=list&page=1","post"):this.uiSkin.addlist.array=f.instance.addressList,this.uiSkin.numAddress.text="已经保存"+f.instance.addressList.length+"条地址",on.instance.on("UPDATE_MYADDRESS_LIST",this,this.updateList)},i.updateList=function(){this.uiSkin.addlist.array=f.instance.addressList,this.uiSkin.numAddress.text="已经保存"+f.instance.addressList.length+"条地址"},i.getMyAddressBack=function(t){var e=JSON.parse(t);0==e.status&&(f.instance.initMyAddress(e.data),f.instance.defaultAddId=e["default"],this.uiSkin.addlist.array=f.instance.addressList)},i.onClickAdd=function(){v.instance.openView("VIEW_ADD_NEW_ADDRESS")},i.updateAddressList=function(t){t.setData(t.dataSource)},i.onDestroy=function(){on.instance.off("UPDATE_MYADDRESS_LIST",this,this.updateList)},e}(an),cs=function(t){function e(){this.uiSkin=null,e.__super.call(this)}s(e,"script.usercenter.ChargeControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,this.uiSkin.accout.text=f.instance.userAccount,this.uiSkin.moneytxt.text=f.instance.money.toString(),this.uiSkin.chargeinput.restrict="0-9.",this.uiSkin.chargeinput.maxChars=8,this.uiSkin.tyepgrp.selectedIndex=0,this.uiSkin.confirmcharge.on("click",this,this.onChargeNow)},i.onChargeNow=function(){""==this.uiSkin.chargeinput.text&&v.showAlert("请输入充值金额"),"0"==this.uiSkin.chargeinput.text&&v.showAlert("充值金额不能为0");var t=Number(this.uiSkin.chargeinput.text);Be.window.open(R.httpUrl+"group/recharge?amount="+t+"&orderid=0",null,null,!0),v.instance.openView("VIEW_POPUPDIALOG",!1,{msg:"是否支付成功？",caller:this,callback:this.confirmSucess,ok:"是",cancel:"否"})},i.confirmSucess=function(t){t&&R.instance.Request(R.httpUrl+"group/get-info?",this,this.getCompanyInfoBack,null,"post")},i.getCompanyInfoBack=function(t){var e=JSON.parse(t);0==e.status&&(f.instance.money=Number(e.balance),this.uiSkin.moneytxt.text=f.instance.money.toString())},e}(an),ds=function(t){function e(){this.uiSkin=null,this.province=null,this.zoneid=null,this.areaid=null,this.param=null,this.isAddOrEdit=!0,this.hasinit=!1,e.__super.call(this)}s(e,"script.usercenter.AddressEditControl",t);var i=e.prototype;return i.onStart=function(){this.uiSkin=this.owner,null!=this.param&&this.param instanceof model.users.AddressVo&&(this.isAddOrEdit=!1),this.uiSkin.input_username.maxChars=10,this.uiSkin.input_phone.maxChars=11,this.uiSkin.input_phone.restrict="0-9",this.uiSkin.input_address.maxChars=50,this.uiSkin.provList.itemRender=ua,this.uiSkin.provList.vScrollBarSkin="",this.uiSkin.provList.repeatX=1,this.uiSkin.provList.spaceY=2,this.uiSkin.provList.renderHandler=new _(this,this.updateCityList),this.uiSkin.provList.selectEnable=!0,this.uiSkin.provList.selectHandler=new _(this,this.selectProvince),this.uiSkin.cityList.itemRender=ua,this.uiSkin.cityList.vScrollBarSkin="",this.uiSkin.cityList.repeatX=1,this.uiSkin.cityList.spaceY=2,this.uiSkin.cityList.selectEnable=!0,this.uiSkin.cityList.renderHandler=new _(this,this.updateCityList),this.uiSkin.cityList.selectHandler=new _(this,this.selectCity),this.uiSkin.areaList.itemRender=ua,this.uiSkin.areaList.vScrollBarSkin="",this.uiSkin.areaList.selectEnable=!0,this.uiSkin.areaList.repeatX=1,this.uiSkin.areaList.spaceY=2,this.uiSkin.areaList.renderHandler=new _(this,this.updateCityList),this.uiSkin.areaList.selectHandler=new _(this,this.selectArea),this.uiSkin.townList.itemRender=ua,this.uiSkin.townList.vScrollBarSkin="",this.uiSkin.townList.selectEnable=!0,this.uiSkin.townList.repeatX=1,this.uiSkin.townList.spaceY=2,this.uiSkin.townList.renderHandler=new _(this,this.updateCityList),this.uiSkin.townList.selectHandler=new _(this,this.selectTown),this.uiSkin.btnSelProv.on("click",this,this.onShowProvince),this.uiSkin.btnSelCity.on("click",this,this.onShowCity),this.uiSkin.btnSelArea.on("click",this,this.onShowArea),this.uiSkin.btnSelTown.on("click",this,this.onShowTown),this.uiSkin.areabox.visible=!1,this.uiSkin.provbox.visible=!1,this.uiSkin.citybox.visible=!1,this.uiSkin.townbox.visible=!1,0==this.isAddOrEdit&&(this.uiSkin.input_username.text=this.param.receiverName,this.uiSkin.input_phone.text=this.param.phone,this.uiSkin.input_address.text=this.param.address),this.uiSkin.on("click",this,this.hideAddressPanel),this.uiSkin.btnok.on("click",this,this.onSubmitAdd),this.uiSkin.btncancel.on("click",this,this.onCloseView),R.instance.Request(R.httpUrl+"group/get-addr-list?",this,this.initAddr,"parentid=0","post")
},i.hideAddressPanel=function(t){t.target instanceof laya.ui.List||(this.uiSkin.provbox.visible=!1,this.uiSkin.citybox.visible=!1,this.uiSkin.areabox.visible=!1,this.uiSkin.townbox.visible=!1)},i.onShowProvince=function(t){this.uiSkin.provbox.visible=!0,this.uiSkin.citybox.visible=!1,this.uiSkin.areabox.visible=!1,this.uiSkin.townbox.visible=!1,t.stopPropagation()},i.onShowCity=function(t){this.uiSkin.provbox.visible=!1,this.uiSkin.citybox.visible=!0,this.uiSkin.areabox.visible=!1,this.uiSkin.townbox.visible=!1,t.stopPropagation()},i.onShowArea=function(t){this.uiSkin.provbox.visible=!1,this.uiSkin.citybox.visible=!1,this.uiSkin.areabox.visible=!0,this.uiSkin.townbox.visible=!1,t.stopPropagation()},i.onShowTown=function(t){this.uiSkin.provbox.visible=!1,this.uiSkin.citybox.visible=!1,this.uiSkin.areabox.visible=!1,this.uiSkin.townbox.visible=!0,t.stopPropagation()},i.updateCityList=function(t){t.setData(t.dataSource)},i.initAddr=function(t){var e=JSON.parse(t);this.uiSkin.provList.array=e.status;var i=0;if(0==this.isAddOrEdit){var n=this.param.preAddName.split(" ");if(null!=n[0])for(var s=0;s<this.uiSkin.provList.array.length;s++)if(this.uiSkin.provList.array[s].areaname==n[0]){i=s;break}}this.selectProvince(i)},i.selectProvince=function(t){var e=this;this.province=this.uiSkin.provList.array[t],this.uiSkin.provbox.visible=!1,this.uiSkin.province.text=this.province.areaname,R.instance.Request(R.httpUrl+"group/get-addr-list?",this,function(t){var i=JSON.parse(t);e.uiSkin.cityList.array=i.status,e.uiSkin.cityList.refresh();var n=0;if(0==e.isAddOrEdit&&0==e.hasinit){var s=e.param.preAddName.split(" ");if(null!=s[1])for(var r=0;r<e.uiSkin.cityList.array.length;r++)if(e.uiSkin.cityList.array[r].areaname==s[1]){n=r;break}}e.uiSkin.citytxt.text=e.uiSkin.cityList.array[n].areaname,e.uiSkin.cityList.selectedIndex=n,e.selectCity(n)},"parentid="+this.province.id,"post")},i.selectCity=function(t){var e=this;this.uiSkin.citybox.visible=!1,R.instance.Request(R.httpUrl+"group/get-addr-list?",this,function(t){var i=JSON.parse(t);e.uiSkin.areaList.array=i.status,e.uiSkin.areaList.refresh();var n=0;if(0==e.isAddOrEdit&&0==e.hasinit){var s=e.param.preAddName.split(" ");if(null!=s[2])for(var r=0;r<e.uiSkin.areaList.array.length;r++)if(e.uiSkin.areaList.array[r].areaname==s[2]){n=r;break}}e.uiSkin.areatxt.text=e.uiSkin.areaList.array[n].areaname,e.uiSkin.areaList.selectedIndex=n,e.selectArea(n),e.areaid=e.uiSkin.areaList.array[n].id},"parentid="+this.uiSkin.cityList.array[t].id,"post"),this.uiSkin.citytxt.text=this.uiSkin.cityList.array[t].areaname},i.selectArea=function(t){var e=this;-1!=t&&(this.areaid=this.uiSkin.areaList.array[t].id,R.instance.Request(R.httpUrl+"group/get-addr-list?",this,function(t){var i=JSON.parse(t);e.uiSkin.townList.array=i.status,e.uiSkin.townList.refresh();var n=0;if(0==e.isAddOrEdit&&0==e.hasinit){var s=e.param.preAddName.split(" ");if(null!=s[3])for(var r=0;r<e.uiSkin.townList.array.length;r++)if(e.uiSkin.townList.array[r].areaname==s[3]){n=r;break}}e.hasinit=!0,e.uiSkin.towntxt.text=e.uiSkin.townList.array[n].areaname,e.uiSkin.townList.selectedIndex=n,e.zoneid=e.uiSkin.townList.array[n].id},"parentid="+this.uiSkin.areaList.array[t].id,"post"),this.uiSkin.areatxt.text=this.uiSkin.areaList.array[t].areaname,this.uiSkin.areabox.visible=!1)},i.selectTown=function(t){-1!=t&&(this.uiSkin.townbox.visible=!1,this.uiSkin.towntxt.text=this.uiSkin.townList.array[t].areaname,this.zoneid=this.uiSkin.townList.array[0].id)},i.onSubmitAdd=function(){if(""==this.uiSkin.input_username.text)return v.showAlert("请填写收货人姓名"),void 0;if(""==this.uiSkin.input_phone.text||this.uiSkin.input_phone.text.length<11)return v.showAlert("请填写正确的收货人电话"),void 0;if(""==this.uiSkin.input_address.text)return v.showAlert("请填写具体的地址"),void 0;var t=this.areaid,e=this.uiSkin.province.text+" "+this.uiSkin.citytxt.text+" "+this.uiSkin.areatxt.text+" "+this.uiSkin.towntxt.text,i="opt="+(this.isAddOrEdit?c.ADDRESS_INSERT:c.ADDRESS_UPDATE)+"&cnee="+this.uiSkin.input_username.text+"&pn="+this.uiSkin.input_phone.text+"&zone="+this.zoneid+"|"+t+"&addr="+this.uiSkin.input_address.text+"&zonename="+e;0==this.isAddOrEdit&&(i+="&id="+this.param.id),R.instance.Request(R.httpUrl+"group/opt-group-express?",this,this.addAddressback,i,"post")},i.addAddressback=function(t){var e=JSON.parse(t);0==e.status&&(this.isAddOrEdit?f.instance.addNewAddress(e):f.instance.updateAddress(e),on.instance.event("UPDATE_MYADDRESS_LIST"),v.showAlert("添加地址成功"),this.onCloseView())},i.onCloseView=function(){v.instance.closeView("VIEW_ADD_NEW_ADDRESS")},e}(an),fs=function(t){function e(){this._customRenderCmd=null,this._customCmds=null,this._x=0,this._y=0,this._renderType=0,this._bRepaintCanvas=!1,this._lastContext=null,e.__super.call(this)}s(e,"laya.layagl.ConchSpriteAdpt",t);var r=e.prototype;return r.createData=function(){var t=308;this._conchData=new ParamData(t,!1),this._datai32=this._conchData._int32Data,this._dataf32=this._conchData._float32Data,this._dataf32[4]=1,this._datai32[3]=-1,this._datai32[1]=0,this._datai32[2]=0,this._datai32[22]=4294967295,this._datai32[5]=1,this._dataf32[8]=0,this._dataf32[9]=0,this._dataf32[10]=1,this._dataf32[11]=1,this._dataf32[16]=1,this._dataf32[17]=0,this._dataf32[18]=0,this._dataf32[19]=1,this._dataf32[20]=0,this._dataf32[21]=0,this._datai32[24]=-1,this._datai32[25]=-1,this._datai32[27]=-1,this._datai32[28]=0,this._datai32[29]=0,this._datai32[30]=1e6,this._datai32[31]=1e6,this._datai32[63]=0,this._datai32[71]=1,this._datai32[72]=771,this._datai32[68]=-1},r._createTransform=function(){return Fi.create(new Float32Array(6))},r._setTransform=function(t){var e=this._conchData._float32Data;e[15]=0,e[16]=t.a,e[17]=t.b,e[18]=t.c,e[19]=t.d,e[20]=t.tx,e[21]=t.ty},r._setGraphics=function(t){this._datai32[23]=t._commandEncoder.getPtrID()},r._setGraphicsCallBack=function(){this._callbackFuncObj||(this._callbackFuncObj=new CallbackFuncObj),this._datai32[54]=this._callbackFuncObj.id,this._callbackFuncObj.addCallbackFunc(5,this.updateParticleFromNative.bind(this)),this._datai32[68]=5},r._setCacheAs=function(){O.createCommandEncoder(),this._drawCanvasParamData||(this._drawCanvasParamData=new ParamData(132,!0)),this._callbackFuncObj||(this._callbackFuncObj=new CallbackFuncObj),this._canvasBeginCmd||(this._canvasBeginCmd=we.instance.createCommandEncoder(128,64,!1)),this._canvasEndCmd||(this._canvasEndCmd=we.instance.createCommandEncoder(128,64,!1)),this._datai32[54]=this._callbackFuncObj.id,this._callbackFuncObj.addCallbackFunc(1,this.canvasBeginRenderFromNative.bind(this)),this._callbackFuncObj.addCallbackFunc(2,this.canvasEndRenderFromNative.bind(this)),this._datai32[56]=1,this._datai32[57]=2,this._datai32[58]=this._canvasBeginCmd.getPtrID(),this._datai32[59]=this._canvasEndCmd.getPtrID(),this._datai32[60]=O._DRAW_CANVAS_CMD_ENCODER_.getPtrID(),this._datai32[61]=this._drawCanvasParamData.getPtrID()},r._setX=function(t){this._x=this._dataf32[6]=t,this._renderType|=2,this._setRenderType(this._renderType),this._dataf32[15]=1},r._setY=function(t){this._y=this._dataf32[7]=t,this._renderType|=2,this._setRenderType(this._renderType),this._dataf32[15]=1},r._setPivotX=function(t){this._renderType|=2,this._dataf32[8]=t,this._dataf32[15]=1},r._getPivotX=function(){return this._dataf32[8]},r._setPivotY=function(t){this._renderType|=2,this._dataf32[9]=t,this._dataf32[15]=1},r._getPivotY=function(){return this._dataf32[9]},r._setAlpha=function(t){var e=this.getStyle();e.alpha=t,t=t>1?1:t,t=0>t?0:t;var i=this._datai32[22],n=i>>24;n=255*t,i=16777215&i|n<<24,this._datai32[22]=i,1!==t?this._renderType|=1:this._renderType&=-2,this._setRenderType(this._renderType),this.parentRepaint()},r._setRenderType=function(t){this._datai32[0]=t,bi.GLS[t]||bi.createByRenderType(t),bi.GLSE[t]||bi.createByRenderTypeEnd(t)},r.parentRepaint=function(){},r._getAlpha=function(){return(this._datai32[22]>>>24)/255},r._setScaleX=function(t){this._style.scaleX=this._dataf32[10]=t,this._dataf32[15]=1},r._setScaleY=function(t){this._style.scaleY=this._dataf32[11]=t,this._dataf32[15]=1},r._setSkewX=function(t){this._style.skewX=this._dataf32[12]=t,this._dataf32[15]=1},r._setSkewY=function(t){this._style.skewY=this._dataf32[13]=t,this._dataf32[15]=1},r._setRotation=function(t){this._style.rotation=this._dataf32[14]=t,this._dataf32[15]=1},r._setBgStyleColor=function(t,e,i,n,s){var r=null,a=null;this._drawSimpleRectParamData||(this._drawSimpleRectParamData=new ParamData(104,!0)),r=this._drawSimpleRectParamData._float32Data,a=this._drawSimpleRectParamData._int32Data;var h=o.create(s),l=h.numColor;a[0]=1,a[1]=96;var _=2;r[_++]=t,r[_++]=e,r[_++]=0,r[_++]=0,a[_++]=l,r[_++]=4294967295,r[_++]=t+i,r[_++]=e,r[_++]=0,r[_++]=0,a[_++]=l,r[_++]=4294967295,r[_++]=t+i,r[_++]=e+n,r[_++]=0,r[_++]=0,a[_++]=l,r[_++]=4294967295,r[_++]=t,r[_++]=e+n,r[_++]=0,r[_++]=0,a[_++]=l,r[_++]=4294967295,this._datai32[74]=this._drawSimpleRectParamData.getPtrID(),we.syncBufferToRenderThread(this._drawSimpleRectParamData),this._datai32[73]=he._SIMPLE_RECT_CMDENCODER_.getPtrID()},r._setBorderStyleColor=function(t,e,i,n,s,r){var a=null,h=null;this._drawRectBorderParamData||(this._drawRectBorderParamData=new ParamData(236,!0)),a=this._drawRectBorderParamData._float32Data,h=this._drawRectBorderParamData._int32Data;var l=[],_=[],u=[];l.push(t),l.push(e),l.push(t+i),l.push(e),l.push(t+i),l.push(e+n),l.push(t),l.push(e+n),l.push(t),l.push(e-r/2),ii.createLine2(l,_,r,0,u,!1);var c=l.length;a=this._drawRectBorderParamData._float32Data,h=this._drawRectBorderParamData._int32Data;var d=this._drawRectBorderParamData._int16Data,f=o.create(s),p=f.numColor;h[0]=0,h[1]=120,h[2]=0,h[3]=2*_.length,h[4]=0;for(var m=5,g=0;c>g;g++)a[m++]=u[2*g],a[m++]=u[2*g+1],h[m++]=p;m=70;for(var v=0;v<_.length;v++)d[m++]=_[v];this._datai32[76]=this._drawRectBorderParamData.getPtrID(),we.syncBufferToRenderThread(this._drawRectBorderParamData),this._datai32[75]=he._RECT_BORDER_CMD_ENCODER_.getPtrID()},r._setTextureEx=function(t,e){var i=null,n=null;if(!this._drawSimpleImageData){this._drawSimpleImageData=new ParamData(116,!0),i=this._drawSimpleImageData._float32Data,n=this._drawSimpleImageData._int32Data,n[0]=3,n[1]=33984,n[2]=e?t.bitmap._glTexture.id:0,n[3]=1,n[4]=96;var s=t.uv;i[5]=0,i[6]=0,i[7]=s[0],i[8]=s[1],n[9]=4294967295,n[10]=4294967295,i[11]=0,i[12]=0,i[13]=s[2],i[14]=s[3],n[15]=4294967295,n[16]=4294967295,i[17]=0,i[18]=0,i[19]=s[4],i[20]=s[5],n[21]=4294967295,n[22]=4294967295,i[23]=0,i[24]=0,i[25]=s[6],i[26]=s[7],n[27]=4294967295,n[28]=4294967295}i=this._drawSimpleImageData._float32Data,n=this._drawSimpleImageData._int32Data,n[2]=e?t.bitmap._glTexture.id:0;var r=e?t.width:0,a=e?t.height:0;i[11]=i[17]=r,i[18]=i[24]=a;var o=this._drawSimpleImageData.getPtrID();this._datai32[25]=o,we.syncBufferToRenderThread(this._drawSimpleImageData),this._datai32[24]=he._SIMPLE_TEXTURE_CMDENCODER_.getPtrID()},r._setTexture=function(t){t&&(t.getIsReady()?this._setTextureEx(t,!0):(this._setTextureEx(t,!1),t.on("ready",this,this._setTextureEx,[t,!0])))},r._setCustomRender=function(){this._callbackFuncObj||(this._callbackFuncObj=new CallbackFuncObj),this._customCmds=[],this._callbackFuncObj.addCallbackFunc(0,this.customRenderFromNative.bind(this)),this._customRenderCmd=we.instance.createCommandEncoder(128,64,!0),this._datai32[54]=this._callbackFuncObj.id,this._datai32[55]=0,this._datai32[27]=this._customRenderCmd.getPtrID()},r._setScrollRect=function(t){this._dataf32[28]=0,this._dataf32[29]=0,this._dataf32[30]=t.width,this._dataf32[31]=t.height,this._dataf32[32]=-t.x,this._dataf32[33]=-t.y,t.onPropertyChanged=this._setScrollRect.bind(this)},r._setColorFilter=function(){this._callbackFuncObj||(this._callbackFuncObj=new CallbackFuncObj),this._filterBeginCmd||(this._filterBeginCmd=we.instance.createCommandEncoder(128,64,!1)),this._filterEndCmd||(this._filterEndCmd=we.instance.createCommandEncoder(128,64,!0)),this._datai32[54]=this._callbackFuncObj.id,this._callbackFuncObj.addCallbackFunc(3,this.filterBeginRenderFromNative.bind(this)),this._callbackFuncObj.addCallbackFunc(4,this.filterEndRenderFromNative.bind(this)),this._datai32[65]=3,this._datai32[64]=this._filterBeginCmd.getPtrID(),this._datai32[67]=4,this._datai32[66]=this._filterEndCmd.getPtrID()},r._setMask=function(t){t.cacheAs="bitmap",this._callbackFuncObj||(this._callbackFuncObj=new CallbackFuncObj),this._maskCmd||(this._maskCmd=we.instance.createCommandEncoder(128,64,!1)),this._datai32[54]=this._callbackFuncObj.id,this._callbackFuncObj.addCallbackFunc(6,this.maskRenderFromNative.bind(this)),this._datai32[69]=6,this._datai32[70]=this._maskCmd.getPtrID()},r._adjustTransform=function(){var t=this._transform||(this._transform=this._createTransform());t._bTransform=!0,we.instance.calcMatrixFromScaleSkewRotation(this._conchData._data._ptrID,60,64,24,28,32,36,40,44,48,52,56);var e=this._conchData._float32Data;return t.a=e[16],t.b=e[17],t.c=e[18],t.d=e[19],t.tx=0,t.ty=0,t},r._setBlendMode=function(t){switch(t){case"normal":this._datai32[71]=1,this._datai32[72]=771;break;case"add":case"lighter":this._datai32[71]=1,this._datai32[72]=772;break;case"multiply":this._datai32[71]=774,this._datai32[72]=771;break;case"screen":this._datai32[71]=1,this._datai32[72]=1;break;case"overlay":this._datai32[71]=1,this._datai32[72]=769;break;case"light":this._datai32[71]=1,this._datai32[72]=1;break;case"mask":this._datai32[71]=0,this._datai32[72]=770;break;case"destination-out":this._datai32[71]=0,this._datai32[72]=0;break;default:alert("_setBlendMode Unknown type")}},r.customRenderFromNative=function(){var t=we.instance.getCurrentContext();this._customRenderCmd.beginEncoding(),this._customRenderCmd.clearEncoding(),t._commandEncoder=this._customRenderCmd,t._customCmds=this._customCmds;for(var e=0,i=this._customCmds.length;i>e;e++)this._customCmds[e].recover();this._customCmds.length=0,this.customRender(t,0,0),this._customRenderCmd.endEncoding()},r.canvasBeginRenderFromNative=function(){var t=we.instance,i=null,n=null,s=this._cacheStyle;if(s.canvas&&0==this._datai32[4])i=s.canvas,0!=this._bRepaintCanvas&&(this.setChildrenNativeVisible(!1),this._bRepaintCanvas=!1),this._datai32[63]=1;else{if(this._canvasBeginCmd.beginEncoding(),this._canvasBeginCmd.clearEncoding(),i=laya.layagl.ConchSpriteAdpt.buildCanvas(this,0,0)){this._datai32[63]=0,this._lastContext=t.getCurrentContext(),n=i.context;var r=n._targets;O.setParamData(this._drawCanvasParamData,r,-16,-16,r.width,r.height),t.setCurrentContext(n),n.beginRT(),t.save(),e._tempFloatArrayMatrix[0]=1,e._tempFloatArrayMatrix[1]=0,e._tempFloatArrayMatrix[2]=0,e._tempFloatArrayMatrix[3]=1,e._tempFloatArrayMatrix[4]=16,e._tempFloatArrayMatrix[5]=16,t.setGlobalValue(he.GLOBALVALUE_MATRIX32,8,e._tempFloatArrayMatrix),1!=this._bRepaintCanvas&&(this.setChildrenNativeVisible(!0),this._bRepaintCanvas=!0)}this._canvasBeginCmd.endEncoding()}},r.setChildrenNativeVisible=function(t){for(var e,i=this._children,n=i.length,s=0;n>s;++s)e=i[s],e._datai32[5]=t?1:0,e.setChildrenNativeVisible(t)},r.canvasEndRenderFromNative=function(){var t=we.instance;if(this._canvasEndCmd.beginEncoding(),this._canvasEndCmd.clearEncoding(),this._bRepaintCanvas){var e=we.instance.getCurrentContext();t.restore(),t.setCurrentContext(this._lastContext),t.commitContextToGPU(e),e.endRT(),t.blendFunc(1,771)}this._canvasEndCmd.endEncoding()},r.filterBeginRenderFromNative=function(){var t=this,i=we.instance;this._filterBeginCmd.beginEncoding(),this._filterBeginCmd.clearEncoding();{var n=this._getCacheStyle().filters;n.length}if(n[0]instanceof laya.filters.ColorFilter){i.addShaderMacro(he.SHADER_MACRO_COLOR_FILTER);var s=n[0];i.setGlobalValue(he.GLOBALVALUE_COLORFILTER_COLOR,8,s._mat),i.setGlobalValue(he.GLOBALVALUE_COLORFILTER_ALPHA,8,s._alpha)}else{var r=$i.TEMP,a=fi.create(),o=0,h=0,l=t._isHaveGlowFilter();l&&(o=50,h=25);var _=new He;_.copyFrom(t.getSelfBounds()),_.x+=t.x,_.y+=t.y,_.x-=t.pivotX+4,_.y-=t.pivotY+4;var u=_.x,c=_.y;if(_.width+=o+8,_.height+=o+8,r.x=_.x*a.a+_.y*a.c,r.y=_.y*a.d+_.x*a.b,_.x=r.x,_.y=r.y,r.x=_.width*a.a+_.height*a.c,r.y=_.height*a.d+_.width*a.b,_.width=r.x,_.height=r.y,_.width<=0||_.height<=0)return;var d=t._getCacheStyle().filterCache;d&&oi.releaseRT(d),d=oi.getRT(_.width,_.height),t._getCacheStyle().filterCache=d,e.useRenderTarget(d),e._tempFloatArrayMatrix[0]=1,e._tempFloatArrayMatrix[1]=0,e._tempFloatArrayMatrix[2]=0,e._tempFloatArrayMatrix[3]=1,e._tempFloatArrayMatrix[4]=t.x-u+h,e._tempFloatArrayMatrix[5]=t.y-c+h,i.setGlobalValue(he.GLOBALVALUE_MATRIX32,8,e._tempFloatArrayMatrix)}this._filterBeginCmd.endEncoding()},r.filterEndRenderFromNative=function(){this._filterEndCmd.beginEncoding(),this._filterEndCmd.clearEncoding();var t=we.instance,n=this._getCacheStyle().filters;if(n[0]instanceof laya.filters.ColorFilter);else{t.restore();var s=we.instance.getCurrentContext(),r=ir.currentActive;if(ir.popRT(),n[0]instanceof i.BlurFilter){t.addShaderMacro(he.SHADER_MACRO_BLUR_FILTER);var a=n[0];e._tempFloatArrayBuffer2[0]=r.width,e._tempFloatArrayBuffer2[1]=r.height,t.setGlobalValue(he.GLOBALVALUE_BLURFILTER_BLURINFO,8,e._tempFloatArrayBuffer2),t.setGlobalValue(he.GLOBALVALUE_BLURFILTER_STRENGTH,8,a.getStrenth_sig2_2sig2_native()),s.drawTarget(this._filterEndCmd,r,-4,-4,0,0)}else if(n[0]instanceof i.GlowFilter){var o=r.width,h=r.height,l=oi.getRT(o,h);e.useRenderTarget(l),t.addShaderMacro(he.SHADER_MACRO_GLOW_FILTER);var _=n[0],u=_.getBlurInfo2Native();u[0]=o,u[1]=h,t.setGlobalValue(he.GLOBALVALUE_GLOWFILTER_COLOR,8,_.getColorNative()),t.setGlobalValue(he.GLOBALVALUE_GLOWFILTER_BLURINFO1,8,_.getBlurInfo1Native()),t.setGlobalValue(he.GLOBALVALUE_GLOWFILTER_BLURINFO2,8,u),s.drawTarget(this._filterEndCmd,r,-16,-16,0,0),t.restore(),ir.popRT(),s.drawTarget(this._filterEndCmd,l,-29,-29,0,0),s.drawTarget(this._filterEndCmd,r,-29,-29,0,0)}}this._filterEndCmd.endEncoding(),we.syncBufferToRenderThread(this._filterEndCmd)},r.maskRenderFromNative=function(){this._maskCmd.beginEncoding(),this._maskCmd.clearEncoding();var t=we.instance,i=t.getCurrentContext(),n=this.mask;n&&(n._children.length>0?(t.blockStart(n._conchData),n._renderChilds(i),t.blockEnd(n._conchData)):t.block(n._conchData)),e._tempInt1[0]=772,t.setGlobalValue(he.GLOBALVALUE_BLENDFUNC_SRC,8,e._tempInt1),e._tempInt1[0]=0,t.setGlobalValue(he.GLOBALVALUE_BLENDFUNC_DEST,8,e._tempInt1),this._maskCmd.endEncoding()},r.updateParticleFromNative=function(){this.tempCmd.updateParticle()},e.createMatrix=function(t,e,i,n,s,r,a){return void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=0),void 0===r&&(r=0),new Fi(t,e,i,n,s,r,a)},e.init=function(){ne.__init__(),Re.__init__();var t=kn.prototype,i=e.prototype,n=["_createTransform","_setTransform","_setGraphics","_setGraphicsCallBack","_setCacheAs","_setX","_setY","_setPivotX","_getPivotX","_setPivotY","_getPivotY","_setAlpha","_getAlpha","_setScaleX","_setScaleY","_setSkewX","_setSkewY","_setRotation","_adjustTransform","_setRenderType","_setTexture","_setTextureEx","_setCustomRender","_setScrollRect","_setColorFilter","customRenderFromNative","canvasBeginRenderFromNative","canvasEndRenderFromNative","setChildrenNativeVisible","filterBeginRenderFromNative","filterEndRenderFromNative","updateParticleFromNative","_setMask","maskRenderFromNative","_setBlendMode","_setBgStyleColor","_setBorderStyleColor"],s=0,r=0;r=n.length;var a;for(s=0;r>s;s++)a=n[s],t[a]=i[a];t.createGLBuffer=i.createData,fi._createFun=e.createMatrix;t.render=t.renderToNative=Ds.prototype.renderToNative,t.repaint=t.repaintForNative=Ds.prototype.repaintForNative,t.parentRepaint=t.parentRepaintForNative=Ds.prototype.parentRepaintForNative,t._renderChilds=Ds.prototype._renderChilds,t.writeBlockToNative=Ds.prototype.writeBlockToNative,t._writeBlockChilds=Ds.prototype._writeBlockChilds},e.useRenderTarget=function(t){var i=we.instance;ir.pushRT(),t.start(),i.clearColor(0,0,0,0),i.clear(17664),i.save(),e._tempFloatArrayBuffer2[0]=t.width,e._tempFloatArrayBuffer2[1]=t.height,i.setGlobalValue(he.GLOBALVALUE_VIEWS,8,e._tempFloatArrayBuffer2)},e.buildCanvas=function(t,e,i){var n,s,r,a,o,h,l,_,u,c=t._cacheStyle,d=c.canvas,f=c.cacheAs;return u=c._calculateCacheRect(t,f,e,i),l=u.x,_=u.y,a=c.cacheRect,o=a.width*l,h=a.height*_,s=a.x,r=a.y,"bitmap"===f&&(o>2048||h>2048)?(alert("cache bitmap size larger than 2048,cache ignored"),c.releaseContext(),null):(d||(c.createContext(),d=c.canvas),n=d.context,d.context.sprite=t,(d.width!=o||d.height!=h)&&(d.size(o,h),n._targets&&(n._targets.destroy(),n._targets=null)),"bitmap"===f?d.context.asBitmap=!0:"normal"===f&&(d.context.asBitmap=!1),"normal"===f&&(n.touches=[]),d)},n(e,["_tempFloatArrayBuffer2",function(){return this._tempFloatArrayBuffer2=new Float32Array(2)},"_tempFloatArrayMatrix",function(){return this._tempFloatArrayMatrix=new Float32Array(6)},"_tempInt1",function(){return this._tempInt1=new Int32Array(1)}]),e}(rn),ps=function(t){function e(){e.__super.call(this)}return s(e,"laya.webgl.shader.BaseShader",t),e.activeShader=null,e.bindShader=null,e}(hn),ms=function(t){function e(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,e.__super.call(this),this._glBuffer=we.instance.createBuffer()}s(e,"laya.webgl.utils.Buffer",t);var i=e.prototype;return i._bindForVAO=function(){},i.bind=function(){return!1},i._disposeResource=function(){this._glBuffer&&(we.instance.deleteBuffer(this._glBuffer),this._glBuffer=null),this._setGPUMemory(0)},r(0,i,"bufferUsage",function(){return this._bufferUsage}),e._bindedVertexBuffer=null,e._bindedIndexBuffer=null,e}(hn),gs=function(t){function e(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=dn.ctx,e.__super.call(this),this._onPlayEnd=ee.bind(this.__onPlayEnd,this),this.gain=this.context.createGain?this.context.createGain():this.context.createGainNode()}s(e,"laya.media.webaudio.WebAudioSoundChannel",t);var n=e.prototype;return n.play=function(){if(Gi.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var t=this.context,e=this.gain,i=t.createBufferSource();this.bufferSource=i,i.buffer=this.audioBuffer,i.connect(e),e&&e.disconnect(),e.connect(t.destination),i.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=Be.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.001):this.gain.gain.value=this._volume,0==this.loops&&(i.loop=!0),i.playbackRate.setTargetAtTime?i.playbackRate.setTargetAtTime(Gi.playbackRate,this.context.currentTime,.001):i.playbackRate.value=Gi.playbackRate,i.start(0,this.startTime),this._currentTime=0}},n.__onPlayEnd=function(){return 1==this.loops?(this.completeHandler&&(i.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),this.event("complete"),void 0):(this.loops>0&&this.loops--,this.startTime=0,this.play(),void 0)},n._clearBufferSource=function(){if(this.bufferSource){var t=this.bufferSource;t.stop?t.stop(0):t.noteOff(0),t.disconnect(0),t.onended=null,e._tryCleanFailed||this._tryClearBuffer(t),this.bufferSource=null}},n._tryClearBuffer=function(t){if(Be.onMac)try{t.buffer=dn._miniBuffer}catch(i){e._tryCleanFailed=!0}else try{t.buffer=null}catch(i){e._tryCleanFailed=!0}},n.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,Gi.removeChannel(this),this.completeHandler=null,Gi.autoReleaseSound&&Gi.disposeSoundLater(this.url)},n.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,Gi.removeChannel(this),Gi.autoReleaseSound&&Gi.disposeSoundLater(this.url)},n.resume=function(){this.startTime=this._pauseTime,this.play()},r(0,n,"position",function(){return this.bufferSource?(Be.now()-this._startTime)/1e3+this.startTime:0}),r(0,n,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),r(0,n,"volume",function(){return this._volume},function(t){this.isStopped||(this._volume=t,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(t,this.context.currentTime,.001):this.gain.gain.value=t)}),e._tryCleanFailed=!1,e.SetTargetDelay=.001,e}(ln),vs=function(t){function e(){e.__super.call(this),this._width=-1,this._height=-1}s(e,"laya.resource.Bitmap",t);var i=e.prototype;return i._getSource=function(){throw"Bitmap: must override it."},r(0,i,"width",function(){return this._width}),r(0,i,"height",function(){return this._height}),e}(hn),ys=function(t){function e(t){this._audio=null,this._onEnd=null,this._resumePlay=null,e.__super.call(this),this._onEnd=ee.bind(this.__onEnd,this),this._resumePlay=ee.bind(this.__resumePlay,this),t.addEventListener("ended",this._onEnd),this._audio=t}s(e,"laya.media.h5audio.AudioSoundChannel",t);var n=e.prototype;return n.__onEnd=function(){return 1==this.loops?(this.completeHandler&&(i.systemTimer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),this.event("complete"),void 0):(this.loops>0&&this.loops--,this.startTime=0,this.play(),void 0)},n.__resumePlay=function(){if(this._audio&&this._audio.removeEventListener("canplay",this._resumePlay),!this.isStopped)try{this._audio.currentTime=this.startTime,Be.container.appendChild(this._audio),this._audio.play()}catch(t){this.event("error")}},n.play=function(){this.isStopped=!1;try{this._audio.playbackRate=Gi.playbackRate,this._audio.currentTime=this.startTime}catch(t){return this._audio.addEventListener("canplay",this._resumePlay),void 0}Gi.addChannel(this),Be.container.appendChild(this._audio),"play"in this._audio&&this._audio.play()},n.stop=function(){this.isStopped=!0,Gi.removeChannel(this),this.completeHandler=null,this._audio&&("pause"in this._audio&&Ni.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),Be.onIE||this._audio!=mn._musicAudio&&Ji.recover("audio:"+this.url,this._audio),Be.removeElement(this._audio),this._audio=null)},n.pause=function(){this.isStopped=!0,Gi.removeChannel(this),"pause"in this._audio&&this._audio.pause()},n.resume=function(){this._audio&&(this.isStopped=!1,Gi.addChannel(this),"play"in this._audio&&this._audio.play())},r(0,n,"position",function(){return this._audio?this._audio.currentTime:0}),r(0,n,"duration",function(){return this._audio?this._audio.duration:0}),r(0,n,"volume",function(){return this._audio?this._audio.volume:1},function(t){this._audio&&(this._audio.volume=t)}),e}(ln),Es=function(t){function e(t,i,n){this.texture=null,this._source=null,this._used=null,this._startFindPos=0,this._texW=0,this._texH=0,this._gridNum=0,this.charMaps=[],this._score=0,this._scoreTick=0,this.__destroyed=!1,this._discardTm=0,this.genID=0,this.ArrCharRenderInfo=[],e.__super.call(this),this._texW=t,this._texH=i,this._gridNum=n,this.texture=new V(this),this.setGridNum(n),this.lock=!0}s(e,"laya.webgl.resource.CharPageTexture",t);var n=e.prototype;return n.findAGrid=function(){for(var t=this._startFindPos;t<this._gridNum;t++)if(0==this._used[t]){this._startFindPos=t+1,this._used[t]=1;var e=this.ArrCharRenderInfo[t]=new Ge;return e.tex=this,e.pos=t,e}return null},n.removeGrid=function(t){this.ArrCharRenderInfo[t]&&(this.ArrCharRenderInfo[t].deleted=!0),this._used[t]=0,t<this._startFindPos&&(this._startFindPos=t)},n.removeOld=function(t){for(var e=0,i=null,n=0,s=this.charMaps.length;s>n;n++)if(i=this.charMaps[n]){var r=this;i.forEach(function(i,n,s){i&&i.touchTick<t&&(console.log("remove char "+n),r.removeGrid(i.pos),s.delete(n),e++)})}return e},n.reset=function(){this._discardTm=i.stage.getFrameTm(),this._startFindPos=0,this.charMaps=[],this._score=0,this._scoreTick=0,this.__destroyed=!0,this.ArrCharRenderInfo.forEach(function(t){t.deleted=!0})},n.setGridNum=function(t){if(this._gridNum=t,this._used&&this._used.length==this._gridNum)if(this._used.fill)this._used.fill(0);else for(var e=0;e<this._used.length;e++)this._used[e]=0;else this._used=new Uint8Array(t)},n.recreateResource=function(){if(!this._source){var t=Ni.isConchApp?we.instance.getDefaultCommandEncoder():Oi.mainContext,e=this._source=t.createTexture();this.texture.bitmap._glTexture=this._source,ye.bindTexture(t,3553,e),t.texImage2D(3553,0,6408,this._texW,this._texH,0,6408,5121,null),t.texParameteri(3553,10241,9729),t.texParameteri(3553,10240,9729),t.texParameteri(3553,10242,33071),t.texParameteri(3553,10243,33071)}},n.addChar=function(t,e,i){if(xe.isWan1Wan)return this.addCharCanvas(t,e,i),void 0;!this._source&&this.recreateResource();var n=Ni.isConchApp?we.instance.getDefaultCommandEncoder():Oi.mainContext;ye.bindTexture(n,3553,this._source),!Ni.isConchApp&&n.pixelStorei(37441,!0);var s=t.data;t.data instanceof Uint8ClampedArray&&(s=new Uint8Array(s.buffer)),n.texSubImage2D(3553,0,e,i,t.width,t.height,6408,5121,s),!Ni.isConchApp&&n.pixelStorei(37441,!1)},n.addCharCanvas=function(t,e,i){!this._source&&this.recreateResource();var n=Ni.isConchApp?we.instance.getDefaultCommandEncoder():Oi.mainContext;ye.bindTexture(n,3553,this._source),!Ni.isConchApp&&n.pixelStorei(37441,!0),n.texSubImage2D(3553,0,e,i,6408,5121,t),!Ni.isConchApp&&n.pixelStorei(37441,!1)},n.destroy=function(){console.log("destroy CharPageTexture"),this.__destroyed=!0;var t=Ni.isConchApp?we.instance.getDefaultCommandEncoder():Oi.mainContext;this._source&&t.deleteTexture(this._source),this._source=null,this.ArrCharRenderInfo.forEach(function(t){t.deleted=!0})},n.printDebugInfo=function(){console.log("current page info:"),console.log("  score:",this._score,",tick:",this._scoreTick,",gridnum:",this._gridNum);for(var t=0,e=this.charMaps.length;e>t;t++){var i=this.charMaps[t];if(i){var n="";i.forEach(function(t,e){t&&(n+=e)}),console.log("data[",t,"]:",n)}}},e}(hn),Ss=function(t){function e(){this.autoDestroyAtClosed=!1,this.url=null,this._timer=null,this._viewCreated=!1,this._idMap=null,this._$componentType="Scene",this._$3__param=null,e.__super.call(this),this._setBit(8,!0),e.unDestroyedScenes.push(this),this._scene=this,this.createChildren()}s(e,"laya.display.Scene",t);var n=e.prototype;return n.createChildren=function(){},n.loadScene=function(t){var e=t.indexOf(".")>-1?t:t+".scene?"+(new Date).getTime().toString(),n=i.loader.getRes(e);if(n)this.createView(n);else{i.loader.resetProgress();var s=new Cn;s.on("complete",this,this._onSceneLoaded,[e]),s.on("progress",this,this._onPrgogress),s.load(e)}},n._onPrgogress=function(t){on.instance.event("UPDATE_LOADING_PROGRESS",t)},n._onSceneLoaded=function(t){console.log("加载scene:"+t),this.createView(un.getRes(t))},n.createView=function(t){if(t&&!this._viewCreated){this._viewCreated=!0,pe.createByData(this,t);var e=this.getComponent(an);null!=e&&(e.param=this._$3__param)}},n.getNodeByID=function(t){return this._idMap?this._idMap[t]:null},n.open=function(t,i){void 0===t&&(t=!0),t&&e.closeAll(),e.root.addChild(this.scene),this.onOpened(i)},n.onOpened=function(){},n.close=function(t){this.autoDestroyAtClosed?this.destroy():this.removeSelf(),this.onClosed(t)},n.onClosed=function(){console.log("onClosed")},n.destroy=function(e){void 0===e&&(e=!0),this._idMap=null,t.prototype.destroy.call(this,e);for(var i=laya.display.Scene.unDestroyedScenes,n=0,s=i.length;s>n;n++)if(i[n]===this)return i.splice(n,1),void 0},n._sizeChanged=function(){this.event("resize")},r(0,n,"timer",function(){return this._timer||i.timer},function(t){this._timer=t}),r(0,n,"height",function(){if(this._height)return this._height;for(var t=0,e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._y+i.height*i.scaleY,t))}return t},function(t){i.superGet(kn,this,"height")!=t&&(i.superSet(kn,this,"height",t),this.callLater(this._sizeChanged))}),r(0,n,"param",null,function(t){if(this._$3__param=t,this._viewCreated){var e=this.getComponent(an);null!=e&&(e.param=this._$3__param)}}),r(0,n,"scaleX",t.prototype._$get_scaleX,function(t){i.superGet(kn,this,"scaleX")!=t&&(i.superSet(kn,this,"scaleX",t),this.event("resize"))
}),r(0,n,"scaleY",t.prototype._$get_scaleY,function(t){i.superGet(kn,this,"scaleY")!=t&&(i.superSet(kn,this,"scaleY",t),this.event("resize"))}),r(0,n,"width",function(){if(this._width)return this._width;for(var t=0,e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._x+i.width*i.scaleX,t))}return t},function(t){i.superGet(kn,this,"width")!=t&&(i.superSet(kn,this,"width",t),this.callLater(this._sizeChanged))}),r(1,e,"root",function(){function t(){e._root.size(i.stage.width,i.stage.height),e._root.event("resize")}return e._root||(e._root=i.stage.addChild(new kn),e._root.name="root",i.stage.on("resize",null,t),t()),e._root},laya.display.Sprite._$SET_root),e.load=function(t,n,s){function r(t){e._loadPage&&e._loadPage.event("progress",t),s&&s.runWith(t)}function a(){o.off("progress",null,r);var i=un.getRes(t);if(!i)throw"Can not find scene:"+t;if(!i.props)throw"Scene data is error:"+t;var s=i.props.runtime?i.props.runtime:i.type,a=Pe.getClass(s);if("instance"==i.props.renderType)var h=a.instance||(a.instance=new a);else h=new a;if(!(h&&h instanceof laya.display.Node))throw"Can not find scene:"+s;h.url=t,h._getBit(8)?(h.on("onViewCreated",null,function(){n&&n.runWith(h)}),h.createView(i)):n&&n.runWith(h),e.hideLoadingPage()}i.loader.resetProgress();var o=new Cn;o.on("progress",null,r),o.once("complete",null,a),o.load(t)},e.open=function(t,i,n,s,r){if(void 0===i&&(i=!0),n instanceof laya.utils.Handler){var a=s;s=n,n=a}e.showLoadingPage(),e.load(t,_.create(null,this._onSceneLoaded,[i,s,n]),r)},e._onSceneLoaded=function(t,e,i,n){n.open(t,i),e&&e.runWith(n)},e.close=function(t,e){void 0===e&&(e="");for(var i=!1,n=laya.display.Scene.unDestroyedScenes,s=0,r=n.length;r>s;s++){var a=n[s];a.parent&&a.url===t&&a.name==e&&(a.close(),i=!0)}return i},e.closeAll=function(){for(var t=laya.display.Scene.root,e=0,i=t.numChildren;i>e;e++){var n=t.getChildAt(0);n instanceof laya.display.Scene&&n.close()}},e.destroy=function(t,e){void 0===e&&(e="");for(var i=!1,n=laya.display.Scene.unDestroyedScenes,s=0,r=n.length;r>s;s++){var a=n[s];a.url===t&&a.name==e&&(a.destroy(),i=!0)}return i},e.gc=function(t){hn.destroyUnusedResources(t)},e.setLoadingPage=function(t){e._loadPage!=t&&(e._loadPage=t)},e.showLoadingPage=function(t,n){void 0===n&&(n=500),e._loadPage&&(i.systemTimer.clear(null,e._showLoading),i.systemTimer.clear(null,e._hideLoading),i.systemTimer.once(n,null,e._showLoading,[t],!1))},e._showLoading=function(t){i.stage.addChild(e._loadPage),e._loadPage.onOpened(t)},e._hideLoading=function(){e._loadPage.close()},e.hideLoadingPage=function(t){void 0===t&&(t=500),e._loadPage&&(i.systemTimer.clear(null,e._showLoading),i.systemTimer.clear(null,e._hideLoading),i.systemTimer.once(t,null,e._hideLoading))},e.unDestroyedScenes=[],e._root=null,e._loadPage=null,e}(kn),As=function(t){function e(){this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,e.__super.call(this),this._anchorX=0/0,this._anchorY=0/0,this._widget=An.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}s(e,"laya.ui.UIComponent",t);var n=e.prototype;return n.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._dataSource=null,this._tag=null,this._toolTip=null},n.preinitialize=function(){},n.createChildren=function(){},n.initialize=function(){},n.measureWidth=function(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._x+i.width*i.scaleX,t))}return t},n.commitMeasure=function(){},n.measureHeight=function(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._y+i.height*i.scaleY,t))}return t},n._sizeChanged=function(){isNaN(this._anchorX)||(this.pivotX=this.anchorX*this.width),isNaN(this._anchorY)||(this.pivotY=this.anchorY*this.height),this.event("resize"),this._widget!==An.EMPTY&&this._widget.resetLayout()},n.onMouseOver=function(){i.stage.event("showtip",this._toolTip)},n.onMouseOut=function(){i.stage.event("hidetip",this._toolTip)},n._getWidget=function(){return this._widget===An.EMPTY&&(this._widget=this.addComponent(An)),this._widget},n.onCompResize=function(){this._sizeChanged()},n._childChanged=function(e){this.callLater(this._sizeChanged),t.prototype._childChanged.call(this,e)},r(0,n,"centerY",function(){return this._widget.centerY},function(t){t!=this._widget.centerY&&(this._getWidget().centerY=t)}),r(0,n,"width",function(){return this._width?this._width:this.measureWidth()},function(t){i.superGet(kn,this,"width")!=t&&(i.superSet(kn,this,"width",t),this.callLater(this._sizeChanged))}),r(0,n,"bottom",function(){return this._widget.bottom},function(t){t!=this._widget.bottom&&(this._getWidget().bottom=t)}),r(0,n,"height",function(){return this._height?this._height:this.measureHeight()},function(t){i.superGet(kn,this,"height")!=t&&(i.superSet(kn,this,"height",t),this.callLater(this._sizeChanged))}),r(0,n,"left",function(){return this._widget.left},function(t){t!=this._widget.left&&(this._getWidget().left=t)}),r(0,n,"dataSource",function(){return this._dataSource},function(t){this._dataSource=t;for(var e in this._dataSource)this.hasOwnProperty(e)&&"function"!=typeof this[e]&&(this[e]=this._dataSource[e])}),r(0,n,"centerX",function(){return this._widget.centerX},function(t){t!=this._widget.centerX&&(this._getWidget().centerX=t)}),r(0,n,"top",function(){return this._widget.top},function(t){t!=this._widget.top&&(this._getWidget().top=t)}),r(0,n,"right",function(){return this._widget.right},function(t){t!=this._widget.right&&(this._getWidget().right=t)}),r(0,n,"tag",function(){return this._tag},function(t){this._tag=t}),r(0,n,"toolTip",function(){return this._toolTip},function(t){this._toolTip!=t&&(this._toolTip=t,null!=t?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),r(0,n,"gray",function(){return this._gray},function(t){t!==this._gray&&(this._gray=t,Ne.gray(this,t))}),r(0,n,"disabled",function(){return this._disabled},function(t){t!==this._disabled&&(this.gray=this._disabled=t,this.mouseEnabled=!t)}),r(0,n,"scaleX",t.prototype._$get_scaleX,function(t){i.superGet(kn,this,"scaleX")!=t&&(i.superSet(kn,this,"scaleX",t),this.event("resize"))}),r(0,n,"scaleY",t.prototype._$get_scaleY,function(t){i.superGet(kn,this,"scaleY")!=t&&(i.superSet(kn,this,"scaleY",t),this.event("resize"))}),r(0,n,"anchorX",function(){return this._anchorX},function(t){this._anchorX!=t&&(this._anchorX=t,this.callLater(this._sizeChanged))}),r(0,n,"anchorY",function(){return this._anchorY},function(t){this._anchorY!=t&&(this._anchorY=t,this.callLater(this._sizeChanged))}),e}(kn),Cs=function(e){function a(){this._clipPoint=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=0,this._startY=0,this._words=null,this._charSize={},this._valign="top",this._color="#000000",a.__super.call(this),this._fontSize=a.defaultFontSize,this._font=a.defaultFont,this.overflow="visible",this._style=Dn.EMPTY}s(a,"laya.display.Text",e);var o=a.prototype;return o.getStyle=function(){return this._style===Dn.EMPTY&&(this._style=Dn.create()),this._style},o._getTextStyle=function(){return this._style===Dn.EMPTY&&(this._style=Dn.create()),this._style},o.destroy=function(t){void 0===t&&(t=!0),e.prototype.destroy.call(this,t),this._clipPoint=null,this._lines=null,this._lineWidths=null,this._words=null,this._charSize=null},o._getBoundPointsM=function(t){void 0===t&&(t=!1);var e=He.TEMP;return e.setTo(0,0,this.width,this.height),e._getBoundPoints()},o.getGraphicBounds=function(t){void 0===t&&(t=!1);var e=He.TEMP;return e.setTo(0,0,this.width,this.height),e},o._getCSSStyle=function(){return this._style},o.lang=function(t){if(t=a.langPacks&&a.langPacks[t]?a.langPacks[t]:t,arguments.length<2)this._text=t;else{for(var e=0,i=arguments.length;i>e;e++)t=t.replace("{"+e+"}",arguments[e+1]);this._text=t}},o._getContextFont=function(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(Be.onIPhone?laya.display.Text.fontFamilyMap[this.font]||this.font:this.font)},o._isPassWordMode=function(){var t=this._style,e=t.asPassword;return"prompt"in this&&this.prompt==this._text&&(e=!1),e},o._getPassWordTxt=function(t){var e,i=t.length;e="";for(var n=i;n>0;n--)e+="●";return e},o._renderText=function(){var t=this.padding,e=this._lines.length;"visible"!=this.overflow&&(e=Math.min(e,Math.floor((this.height-t[0]-t[2])/(this.leading+this._charSize.height))+1));var i=this.scrollY/(this._charSize.height+this.leading)|0,n=this.graphics;n.clear(!0);var s=this._getContextFont();Be.context.font=s;var r=t[3],a="left",o=this._lines,h=this.leading+this._charSize.height,l=this._style.currBitmapFont;l&&(h=this.leading+l.getMaxHeight());var _=t[0];if(!l&&this._width>0&&this._textWidth<=this._width&&("right"==this.align?(a="right",r=this._width-t[1]):"center"==this.align&&(a="center",r=.5*this._width+t[3]-t[1])),this._height>0){var u=this._textHeight>this._height?"top":this.valign;"middle"===u?_=.5*(this._height-e*h)+t[0]-t[2]:"bottom"===u&&(_=this._height-e*h-t[2])}var c=this._style;if(l&&l.autoScaleSize)var d=l.fontSize/this.fontSize;if(this._clipPoint){if(n.save(),l&&l.autoScaleSize){var f=0,p=0;f=this._width?this._width-t[3]-t[1]:this._textWidth,p=this._height?this._height-t[0]-t[2]:this._textHeight,f*=d,p*=d,n.clipRect(t[3],t[0],f,p)}else n.clipRect(t[3],t[0],this._width?this._width-t[3]-t[1]:this._textWidth,this._height?this._height-t[0]-t[2]:this._textHeight);this.repaint()}var m=c.asPassword;"prompt"in this&&this.prompt==this._text&&(m=!1);for(var g=0,v=0,y=Math.min(this._lines.length,e+i)||1,E=i;y>E;E++){var S,A=o[E];if(m){var C=A.length;A="";for(var D=C;D>0;D--)A+="●"}if(null==A&&(A=""),g=r-(this._clipPoint?this._clipPoint.x:0),v=_+h*E-(this._clipPoint?this._clipPoint.y:0),this.underline&&this._drawUnderline(a,g,v,E),l){var x=this.width;l.autoScaleSize&&(x=this.width*d),l._drawText(A,this,g,v,this.align,x)}else Ni.isWebGL?(this._words||(this._words=[]),S=this._words.length>E-i?this._words[E-i]:new Le,S.setText(A)):S=A,c.stroke?n.fillBorderText(S,g,v,s,this.color,c.strokeColor,c.stroke,a):n.fillText(S,g,v,s,this.color,a)}if(l&&l.autoScaleSize){var R=1/d;this.scale(R,R)}this._clipPoint&&n.restore(),this._startX=r,this._startY=_},o._drawUnderline=function(t,e,i,n){var s=this._lineWidths[n];switch(t){case"center":e-=s/2;break;case"right":e-=s;break;case"left":}i+=this._charSize.height,this._graphics.drawLine(e,i,e+s,i,this.underlineColor||this.color,1)},o.typeset=function(){return this._isChanged=!1,this._text?(Ni.isConchApp?t.conchTextCanvas.font=this._getContextFont():Be.context.font=this._getContextFont(),this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this._parseLines(this._getPassWordTxt(this._text)):this._parseLines(this._text),this._evalTextSize(),this._checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new $i(0,0)):this._clipPoint=null,this._renderText(),void 0):(this._clipPoint=null,this._textWidth=this._textHeight=0,this.graphics.clear(!0),void 0)},o._evalTextSize=function(){var t=0/0,e=0/0;t=Math.max.apply(this,this._lineWidths),e=this._style.currBitmapFont?this._lines.length*(this._style.currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],(t!=this._textWidth||e!=this._textHeight)&&(this._textWidth=t,this._textHeight=e)},o._checkEnabledViewportOrNot=function(){return"scroll"==this.overflow&&(this._width>0&&this._textWidth>this._width||this._height>0&&this._textHeight>this._height)},o.changeText=function(t){this._text!==t&&(this.lang(t+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},o._parseLines=function(e){var i=this.wordWrap||"hidden"==this.overflow;if(i)var n=this._getWordWrapWidth();var s=this._style.currBitmapFont;if(s)this._charSize.width=s.getMaxWidth(),this._charSize.height=s.getMaxHeight();else{var r=null;r=Ni.isConchApp?t.conchTextCanvas.measureText(this._testWord):Be.context.measureText(a._testWord),this._charSize.width=r.width,this._charSize.height=r.height||this.fontSize}for(var o=e.replace(/\r\n/g,"\n").split("\n"),h=0,l=o.length;l>h;h++){var _=o[h];i?this._parseLine(_,n):(this._lineWidths.push(this._getTextWidth(_)),this._lines.push(_))}},o._parseLine=function(t,e){var i,n=(Be.context,this._lines),s=0,r=0/0,a=0/0,o=0;if(r=this._getTextWidth(t),e>=r)return n.push(t),this._lineWidths.push(r),void 0;r=this._charSize.width,s=Math.floor(e/r),0==s&&(s=1),r=this._getTextWidth(t.substring(0,s)),a=r;for(var h=s,l=t.length;l>h;h++)if(r=this._getTextWidth(t.charAt(h)),a+=r,a>e)if(this.wordWrap){var _=t.substring(o,h);if(_.charCodeAt(_.length-1)<255&&(i=/(?:\w|-)+$/.exec(_),i&&(h=i.index+o,0==i.index?h+=_.length:_=t.substring(o,h))),n.push(_),this._lineWidths.push(a-r),o=h,!(l>h+s)){n.push(t.substring(o,l)),this._lineWidths.push(this._getTextWidth(n[n.length-1])),o=-1;break}h+=s,r=this._getTextWidth(t.substring(o,h)),a=r,h--}else if("hidden"==this.overflow)return n.push(t.substring(0,h)),this._lineWidths.push(this._getTextWidth(n[n.length-1])),void 0;this.wordWrap&&-1!=o&&(n.push(t.substring(o,l)),this._lineWidths.push(this._getTextWidth(n[n.length-1])))},o._getTextWidth=function(e){var i=this._style.currBitmapFont;return i?i.getTextWidth(e):Ni.isConchApp?t.conchTextCanvas.measureText(e).width:Be.context.measureText(e).width},o._getWordWrapWidth=function(){var t=this.padding,e=0/0,i=this._style.currBitmapFont;return e=i&&i.autoScaleSize?this._width*(i.fontSize/this.fontSize):this._width,0>=e&&(e=this.wordWrap?100:Be.width),0>=e&&(e=100),e-t[3]-t[1]},o.getCharPoint=function(t,e){this._isChanged&&i.systemTimer.runCallLater(this,this.typeset);for(var n=0,s=this._lines,r=0,a=0,o=s.length;o>a;a++){if(n+=s[a].length,n>t){var h=a;break}r=n}var l=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;Be.context.font=l;var _=this._getTextWidth(this._text.substring(r,t)),u=e||new $i;return u.setTo(this._startX+_-(this._clipPoint?this._clipPoint.x:0),this._startY+h*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},r(0,o,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(t){t!=this._width&&(i.superSet(kn,this,"width",t),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}),r(0,o,"textWidth",function(){return this._isChanged&&i.systemTimer.runCallLater(this,this.typeset),this._textWidth}),r(0,o,"height",function(){return this._height?this._height:this.textHeight},function(t){t!=this._height&&(i.superSet(kn,this,"height",t),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}),r(0,o,"textHeight",function(){return this._isChanged&&i.systemTimer.runCallLater(this,this.typeset),this._textHeight}),r(0,o,"padding",function(){return this._style.padding},function(t){if("string"==typeof t){var e;e=t.split(",");var i=0,n=0;for(n=e.length;e.length<4;)e.push(0);for(i=0;n>i;i++)e[i]=parseFloat(e[i])||0;t=e}this._getTextStyle().padding=t,this.isChanged=!0}),r(0,o,"bold",function(){return this._style.bold},function(t){this._getTextStyle().bold=t,this.isChanged=!0}),r(0,o,"text",function(){return this._text||""},function(t){this._text!==t&&(this.lang(t+""),this.isChanged=!0,this.event("change"),this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}),r(0,o,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),r(0,o,"font",function(){return this._font},function(t){this._style.currBitmapFont&&(this._getTextStyle().currBitmapFont=null,this.scale(1,1)),a._bitmapFonts&&a._bitmapFonts[t]&&(this._getTextStyle().currBitmapFont=a._bitmapFonts[t]),this._font=t,this.isChanged=!0}),r(0,o,"fontSize",function(){return this._fontSize},function(t){this._fontSize!=t&&(this._fontSize=t,this.isChanged=!0)}),r(0,o,"italic",function(){return this._style.italic},function(t){this._getTextStyle().italic=t,this.isChanged=!0}),r(0,o,"align",function(){return this._style.align},function(t){this._getTextStyle().align=t,this.isChanged=!0}),r(0,o,"valign",function(){return this._valign},function(t){this._valign=t,this.isChanged=!0}),r(0,o,"wordWrap",function(){return this._style.wordWrap},function(t){this._getTextStyle().wordWrap=t,this.isChanged=!0}),r(0,o,"leading",function(){return this._style.leading},function(t){this._getTextStyle().leading=t,this.isChanged=!0}),r(0,o,"bgColor",function(){return this._style.bgColor},function(t){this._getTextStyle().bgColor=t,this._renderType|=128,this._setBgStyleColor(0,0,this.width,this.height,t),this._setRenderType(this._renderType),this.isChanged=!0}),r(0,o,"borderColor",function(){return this._style.borderColor},function(t){this._getTextStyle().borderColor=t,this._renderType|=128,this._setBorderStyleColor(0,0,this.width,this.height,t,1),this._setRenderType(this._renderType),this.isChanged=!0}),r(0,o,"stroke",function(){return this._style.stroke},function(t){this._getTextStyle().stroke=t,this.isChanged=!0}),r(0,o,"strokeColor",function(){return this._style.strokeColor},function(t){this._getTextStyle().strokeColor=t,this.isChanged=!0}),r(0,o,"isChanged",null,function(t){this._isChanged!==t&&(this._isChanged=t,t&&i.systemTimer.callLater(this,this.typeset))}),r(0,o,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(t){if(!("scroll"!=this.overflow||this.textWidth<this._width)&&this._clipPoint){t=t<this.padding[3]?this.padding[3]:t;var e=this._textWidth-this._width;t=t>e?e:t,this._clipPoint.x=t,this._renderText()}}),r(0,o,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(t){if(!("scroll"!=this.overflow||this.textHeight<this._height)&&this._clipPoint){t=t<this.padding[0]?this.padding[0]:t;var e=this._textHeight-this._height;t=t>e?e:t,this._clipPoint.y=t,this._renderText()}}),r(0,o,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),r(0,o,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),r(0,o,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),r(0,o,"underlineColor",function(){return this._style.underlineColor},function(t){this._getTextStyle().underlineColor=t,this._isChanged||this._renderText()}),r(0,o,"underline",function(){return this._style.underline},function(t){this._getTextStyle().underline=t}),a.defaultFontStr=function(){return a.defaultFontSize+"px "+a.defaultFont},a.registerBitmapFont=function(t,e){a._bitmapFonts||(a._bitmapFonts={}),a._bitmapFonts[t]=e},a.unregisterBitmapFont=function(t,e){if(void 0===e&&(e=!0),a._bitmapFonts&&a._bitmapFonts[t]){var i=a._bitmapFonts[t];e&&i.destroy(),delete a._bitmapFonts[t]}},a.VISIBLE="visible",a.SCROLL="scroll",a.HIDDEN="hidden",a.defaultFontSize=12,a.defaultFont="Arial",a.langPacks=null,a.isComplexText=!1,a._testWord="游",a._bitmapFonts=null,a.CharacterCache=!0,a.RightToLeft=!1,n(a,["fontFamilyMap",function(){return this.fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),a}(kn),Ds=function(t){function e(){e.__super.call(this)}s(e,"laya.layagl.ConchSprite",t);var i=e.prototype;return i.parentRepaintForNative=function(t){void 0===t&&(t=2);var e=this._parent;e&&(e._conchData._int32Data[4]&t)!=t&&(e._conchData._int32Data[4]|=t,e.parentRepaintForNative(t))},i.renderToNative=function(t){var e=t.gl,i=we.getFrameCount()-1,n=this._conchData._int32Data,s=n[4];this._children.length>0?i!=n[3]||s>0&&1==(1&s)?(e.blockStart(this._conchData),this._renderChilds(t),e.blockEnd(this._conchData)):e.copyCmdBuffer(this._conchData._int32Data[1],this._conchData._int32Data[2]):e.block(this._conchData)},i.writeBlockToNative=function(){var t=we.instance;this._children.length>0?(t.blockStart(this._conchData),this._writeBlockChilds(),t.blockEnd(this._conchData)):t.block(this._conchData)},i._renderChilds=function(t){var e,i=this._children,n=0,s=i.length,r=this._style;if(r.viewport)for(var a=r.viewport,o=a.x,h=a.y,l=a.right,_=a.bottom,u=0/0,c=0/0;s>n;++n)(e=i[n])._visible&&(u=e._x)<l&&u+e.width>o&&(c=e._y)<_&&c+e.height>h&&e.renderToNative(t);else for(;s>n;++n)(e=i[n])._visible&&e.renderToNative(t)},i._writeBlockChilds=function(){var t,e=this._children,i=0,n=e.length,s=this._style;if(s.viewport)for(var r=s.viewport,a=r.x,o=r.y,h=r.right,l=r.bottom,_=0/0,u=0/0;n>i;++i)(t=e[i])._visible&&(_=t._x)<h&&_+t.width>a&&(u=t._y)<l&&u+t.height>o&&t.writeBlockToNative();else for(;n>i;++i)(t=e[i])._visible&&t.writeBlockToNative()},i.repaintForNative=function(t){void 0===t&&(t=2),(this._conchData._int32Data[4]&t)!=t&&(this._conchData._int32Data[4]|=t,this.parentRepaintForNative(t))},e}(kn),xs=function(t){function e(){this._element=null,this._recList=[],this._innerHTML=null,this._repaintState=0,e.__super.call(this),this._element=new Ln,this._element.repaintHandler=new _(this,this._htmlDivRepaint),this.mouseEnabled=!0,this.on("click",this,this._onMouseClick)}s(e,"laya.html.dom.HTMLDivElement",t);var i=e.prototype;return i.destroy=function(e){void 0===e&&(e=!0),this._element&&this._element.reset(),this._element=null,this._doClears(),t.prototype.destroy.call(this,e)},i._htmlDivRepaint=function(t){void 0===t&&(t=!1),t?this._repaintState<2&&(this._repaintState=2):this._repaintState<1&&(this._repaintState=1),this._repaintState>0&&this._setGraphicDirty()},i._updateGraphicWork=function(){switch(this._repaintState){case 1:this._updateGraphic();break;case 2:this._refresh()}},i._setGraphicDirty=function(){this.callLater(this._updateGraphicWork)},i._doClears=function(){if(this._recList){var t,e=0,i=this._recList.length;for(e=0;i>e;e++)t=this._recList[e],t.recover();this._recList.length=0}},i._updateGraphic=function(){this._doClears(),this.graphics.clear(!0),this._repaintState=0,this._element.drawToGraphic(this.graphics,-this._element.x,-this._element.y,this._recList);var t=this._element.getBounds();t&&this.setSelfBounds(t),this.size(t.width,t.height)},i._refresh=function(){this._repaintState=1,this._innerHTML&&(this._element.innerHTML=this._innerHTML),this._setGraphicDirty()},i._onMouseClick=function(){var t,e=this.mouseX,i=this.mouseY,n=0,s=0;for(s=this._recList.length,n=0;s>n;n++)t=this._recList[n],t.rec.contains(e,i)&&this._eventLink(t.href)},i._eventLink=function(t){this.event("link",[t])},r(0,i,"style",function(){return this._element.style}),r(0,i,"innerHTML",null,function(t){this._innerHTML!=t&&(this._repaintState=1,this._innerHTML=t,this._element.innerHTML=t,this._setGraphicDirty())}),r(0,i,"contextWidth",function(){return this._element.contextWidth}),r(0,i,"contextHeight",function(){return this._element.contextHeight}),e}(kn),Rs=function(t){function e(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._actionName=null,this._controlNode=null,e.__super.call(this),this._interval=Ti.animationInterval,this._setBitUp(16)}s(e,"laya.display.AnimationBase",t);var i=e.prototype;return i.play=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=!0),void 0===i&&(i=""),this._isPlaying=!0,this._actionName=i,this.index="string"==typeof t?this._getFrameByLabel(t):t,this.loop=e,this._isReverse=1===this.wrapMode,0==this.index&&this._isReverse&&(this.index=this.count-1),this.interval>0&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},i._getFrameByLabel=function(t){for(var e=0;e<this._count;e++){var i=this._labels[e];if(i&&i.indexOf(t)>-1)return e}return 0},i._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),this.event("complete"),void 0;2==this.wrapMode?(this._index=this._count>0?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),this.event("complete"),void 0;2==this.wrapMode?(this._index=this._count-2>=0?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},i._setControlNode=function(t){this._controlNode&&(this._controlNode.off("display",this,this._resumePlay),this._controlNode.off("undisplay",this,this._resumePlay)),this._controlNode=t,t&&t!=this&&(t.on("display",this,this._resumePlay),t.on("undisplay",this,this._resumePlay))},i._setDisplay=function(e){t.prototype._setDisplay.call(this,e),this._resumePlay()},i._resumePlay=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},i.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},i.addLabel=function(t,e){this._labels||(this._labels={}),this._labels[e]||(this._labels[e]=[]),this._labels[e].push(t)},i.removeLabel=function(t){if(t){if(this._labels)for(var e in this._labels)this._removeLabelFromList(this._labels[e],t)}else this._labels=null},i._removeLabelFromList=function(t,e){if(t)for(var i=t.length-1;i>=0;i--)t[i]==e&&t.splice(i,1)},i.gotoAndStop=function(t){this.index="string"==typeof t?this._getFrameByLabel(t):t,this.stop()},i._displayToIndex=function(){},i.clear=function(){return this.stop(),this._labels=null,this},r(0,i,"interval",function(){return this._interval},function(t){this._interval!=t&&(this._frameRateChanged=!0,this._interval=t,this._isPlaying&&t>0&&this.timerLoop(t,this,this._frameLoop,null,!0,!0))}),r(0,i,"isPlaying",function(){return this._isPlaying}),r(0,i,"index",function(){return this._index},function(t){if(this._index=t,this._displayToIndex(t),this._labels&&this._labels[t])for(var e=this._labels[t],i=0,n=e.length;n>i;i++)this.event("label",e[i])}),r(0,i,"count",function(){return this._count}),e.WRAP_POSITIVE=0,e.WRAP_REVERSE=1,e.WRAP_PINGPONG=2,e}(kn),Ts=function(e){function a(){function t(){"hidden"==Be.document[s]?(e._isVisibility=!1,n._isInputting()&&(Ws.inputElement.target.focus=!1)):e._isVisibility=!0,e.renderingEnabled=e._isVisibility,n.event("visibilitychange")}this.focus=null,this._frameRate="fast",this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._safariOffsetY=0,this._frameStartTime=0,this._isFocused=!1,this._isVisibility=!1,this._wgColor=[0,0,0,1],this._scene3Ds=[],this._globalRepaintSet=!1,this._globalRepaintGet=!1,a.__super.call(this),this.offset=new $i,this._canvasTransform=new fi,this._previousOrientation=Be.window.orientation;var e=this;this.transform=fi.create(),this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._setBit(128,!0),this._setBit(2,!0),this._isFocused=!0,this._isVisibility=!0;var i=Be.window,n=this;i.addEventListener("focus",function(){e._isFocused=!0,n.event("focus"),n.event("focuschange")}),i.addEventListener("blur",function(){e._isFocused=!1,n.event("blur"),n.event("focuschange"),n._isInputting()&&(Ws.inputElement.target.focus=!1)});var s="visibilityState",r="visibilitychange",o=i.document;"undefined"!=typeof o.hidden?(r="visibilitychange",s="visibilityState"):"undefined"!=typeof o.mozHidden?(r="mozvisibilitychange",s="mozVisibilityState"):"undefined"!=typeof o.msHidden?(r="msvisibilitychange",s="msVisibilityState"):"undefined"!=typeof o.webkitHidden&&(r="webkitvisibilitychange",s="webkitVisibilityState"),i.document.addEventListener(r,t),i.addEventListener("resize",function(){var t=Be.window.orientation;null!=t&&t!=e._previousOrientation&&n._isInputting()&&(Ws.inputElement.target.focus=!1),e._previousOrientation=t,n._isInputting()||(Be.onSafari&&(n._safariOffsetY=(Be.window.__innerHeight||Be.document.body.clientHeight||Be.document.documentElement.clientHeight)-Be.window.innerHeight),n._resetCanvas())}),i.addEventListener("orientationchange",function(){n._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),Be.onMobile&&this.on("mousedown",this,this._onmouseMove)}s(a,"laya.display.Stage",e);var h=a.prototype;return h._isInputting=function(){return Be.onMobile&&Ws.isInputting},h._changeCanvasSize=function(){this.setScreenSize(Be.clientWidth*Be.pixelRatio,Be.clientHeight*Be.pixelRatio)},h._resetCanvas=function(){this.screenAdaptationEnabled&&this._changeCanvasSize()},h.setScreenSize=function(t,e){var i=!1;if("none"!==this._screenMode){var n=1>t/e?"vertical":"horizontal";if(i=n!==this._screenMode){var s=e;e=t,t=s}}this.canvasRotation=i;var r=Ni._mainCanvas,a=r.source.style,o=this._canvasTransform.identity(),h=this._scaleMode,l=t/this.designWidth,_=e/this.designHeight,u=this.designWidth,c=this.designHeight,d=t,f=e,p=Be.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,h){case"noscale":l=_=1,d=this.designWidth,f=this.designHeight;break;case"showall":l=_=Math.min(l,_),u=d=Math.round(this.designWidth*l),c=f=Math.round(this.designHeight*_);break;case"noborder":l=_=Math.max(l,_),d=Math.round(this.designWidth*l),f=Math.round(this.designHeight*_);break;case"full":l=_=1,this._width=u=t,this._height=c=e;break;case"fixedwidth":_=l,this._height=c=Math.round(e/l);break;case"fixedheight":l=_,this._width=u=Math.round(t/_);break;case"fixedauto":t/e<this.designWidth/this.designHeight?(_=l,this._height=c=Math.round(e/l)):(l=_,this._width=u=Math.round(t/_))}l*=this.scaleX,_*=this.scaleY,1===l&&1===_?this.transform.identity():(this.transform.a=this._formatData(l/(d/u)),this.transform.d=this._formatData(_/(f/c))),Ni.isConchApp&&(this._conchData._float32Data[10]=this._formatData(l/(d/u)),this._conchData._float32Data[11]=this._formatData(_/(f/c)),this._conchData._float32Data[15]=1),r.size(u,c),qi.changeWebGLSize(u,c),o.scale(d/u/p,f/c/p),this.offset.x="left"===this._alignH?0:"right"===this._alignH?t-d:.5*(t-d)/p,this.offset.y="top"===this._alignV?0:"bottom"===this._alignV?e-f:.5*(e-f)/p,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),o.translate(this.offset.x,this.offset.y),this._safariOffsetY&&o.translate(0,this._safariOffsetY),this.canvasDegree=0,i&&("horizontal"===this._screenMode?(o.rotate(Math.PI/2),o.translate(e/p,0),this.canvasDegree=90):(o.rotate(-Math.PI/2),o.translate(0,t/p),this.canvasDegree=-90)),o.a=this._formatData(o.a),o.d=this._formatData(o.d),o.tx=this._formatData(o.tx),o.ty=this._formatData(o.ty),a.transformOrigin=a.webkitTransformOrigin=a.msTransformOrigin=a.mozTransformOrigin=a.oTransformOrigin="0px 0px 0px",a.transform=a.webkitTransform=a.msTransform=a.mozTransform=a.oTransform="matrix("+o.toString()+")",this._safariOffsetY&&o.translate(0,-this._safariOffsetY),o.translate(parseInt(a.left)||0,parseInt(a.top)||0),this.visible=!0,this._repaint|=2,this.event("resize")},h._formatData=function(t){return Math.abs(t)<1e-6?0:Math.abs(1-t)<.001?t>0?1:-1:t},h.getMousePoint=function(){return $i.TEMP.setTo(this.mouseX,this.mouseY)},h.repaint=function(t){void 0===t&&(t=2),this._repaint|=t},h.repaintForNative=function(t){void 0===t&&(t=2),this._conchData._int32Data[4]|=t},h.parentRepaint=function(t){void 0===t&&(t=2)},h._loop=function(){return this._globalRepaintGet=this._globalRepaintSet,this._globalRepaintSet=!1,this.render(Ni._context,0,0),!0},h.getFrameTm=function(){return this._frameStartTime},h._onmouseMove=function(){this._mouseMoveTime=Be.now()},h.getTimeFromFrameStart=function(){return Be.now()-this._frameStartTime},h.render=function(t,i,n){if(a._dbgSprite.graphics.clear(),"sleep"===this._frameRate){var s=Be.now();if(!(s-this._frameStartTime>=1e3))return;this._frameStartTime=s}else{if(!this._visible)return this._renderCount++,this._renderCount%5===0&&(Ai.I._update(),wi.loopCount++,this._updateTimers()),void 0;
this._frameStartTime=Be.now()}this._renderCount++;var r="mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate,o="slow"!==r,h=this._renderCount%2===0;if(wi.renderSlow=!o,(o||h)&&(Ai.I._update(),wi.loopCount++,!Ni.isConchApp&&Ni.isWebGL&&this.renderingEnabled)){for(var l=0,_=this._scene3Ds.length;_>l;l++)this._scene3Ds[l]._update();t.clear(),e.prototype.render.call(this,t,i,n),wi._show&&wi._sp&&wi._sp.render(t,i,n)}a._dbgSprite.render(t,0,0),(o||!h)&&(this.renderingEnabled&&(Ni.isWebGL?(qi.clear(this._bgColor),t.flush(),yi.instance&&yi.getInstance().endDispose()):(qi.clear(this._bgColor),e.prototype.render.call(this,t,i,n),wi._show&&wi._sp&&wi._sp.render(t,i,n),Ni.isConchApp&&t.gl.commit())),this._updateTimers())},h._updateTimers=function(){i.systemTimer._update(),i.startTimer._update(),i.physicsTimer._update(),i.updateTimer._update(),i.lateTimer._update(),i.timer._update()},h.renderToNative=function(t,n,s){return this._renderCount++,wi.loopCount++,this._visible?(Ai.I._update(),i.systemTimer._update(),i.startTimer._update(),i.physicsTimer._update(),i.updateTimer._update(),i.lateTimer._update(),i.timer._update(),this.renderingEnabled&&(qi.clear(this._bgColor),e.prototype.render.call(this,t,n,s),wi._show&&wi._sp&&wi._sp.render(t,n,s),t.gl.commit()),void 0):(this._renderCount%5===0&&(Ai.I._update(),wi.loopCount++,i.systemTimer._update(),i.startTimer._update(),i.physicsTimer._update(),i.updateTimer._update(),i.lateTimer._update(),i.timer._update()),void 0)},h._requestFullscreen=function(){var t=Be.document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},h._fullScreenChanged=function(){i.stage.event("fullscreenchange")},h.exitFullscreen=function(){var t=Be.document;t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen()},h.isGlobalRepaint=function(){return this._globalRepaintGet},h.setGlobalRepaint=function(){this._globalRepaintSet=!0},r(0,h,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),r(0,h,"width",e.prototype._$get_width,function(t){this.designWidth=t,i.superSet(kn,this,"width",t),i.systemTimer.callLater(this,this._changeCanvasSize)}),r(0,h,"isFocused",function(){return this._isFocused}),r(0,h,"alignH",function(){return this._alignH},function(t){this._alignH=t,i.systemTimer.callLater(this,this._changeCanvasSize)}),r(0,h,"height",e.prototype._$get_height,function(t){this.designHeight=t,i.superSet(kn,this,"height",t),i.systemTimer.callLater(this,this._changeCanvasSize)}),r(0,h,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||this._createTransform()},e.prototype._$set_transform),r(0,h,"isVisibility",function(){return this._isVisibility}),r(0,h,"scaleMode",function(){return this._scaleMode},function(t){this._scaleMode=t,i.systemTimer.callLater(this,this._changeCanvasSize)}),r(0,h,"alignV",function(){return this._alignV},function(t){this._alignV=t,i.systemTimer.callLater(this,this._changeCanvasSize)}),r(0,h,"bgColor",function(){return this._bgColor},function(t){this._bgColor=t,Ni.isWebGL&&(this._wgColor=t?o.create(t).arrColor:null),Be.onLimixiu?this._wgColor=o.create(t).arrColor:Ni.canvas.style.background=t?t:"none",Ni.isConchApp&&(this._renderType|=128,this._setBgStyleColor(0,0,this.width,this.height,t),this._setRenderType(this._renderType))}),r(0,h,"mouseX",function(){return Math.round(_e.instance.mouseX/this.clientScaleX)}),r(0,h,"mouseY",function(){return Math.round(_e.instance.mouseY/this.clientScaleY)}),r(0,h,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),r(0,h,"screenMode",function(){return this._screenMode},function(t){this._screenMode=t}),r(0,h,"visible",e.prototype._$get_visible,function(t){if(this.visible!==t){i.superSet(kn,this,"visible",t);var e=Ni._mainCanvas.source.style;e.visibility=t?"visible":"hidden"}}),r(0,h,"fullScreenEnabled",null,function(t){var e=Be.document,i=Ni.canvas;t?(i.addEventListener("mousedown",this._requestFullscreen),i.addEventListener("touchstart",this._requestFullscreen),e.addEventListener("fullscreenchange",this._fullScreenChanged),e.addEventListener("mozfullscreenchange",this._fullScreenChanged),e.addEventListener("webkitfullscreenchange",this._fullScreenChanged),e.addEventListener("msfullscreenchange",this._fullScreenChanged)):(i.removeEventListener("mousedown",this._requestFullscreen),i.removeEventListener("touchstart",this._requestFullscreen),e.removeEventListener("fullscreenchange",this._fullScreenChanged),e.removeEventListener("mozfullscreenchange",this._fullScreenChanged),e.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),e.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),r(0,h,"frameRate",function(){return Ni.isConchApp?this._frameRateNative:this._frameRate},function(e){if(Ni.isConchApp){switch(e){case"fast":t.conch.config.setLimitFPS(60);break;case"mouse":t.conch.config.setMouseFrame(2e3);break;case"slow":t.conch.config.setSlowFrame(!0);break;case"sleep":t.conch.config.setLimitFPS(1)}this._frameRateNative=e}else this._frameRate=e}),a.SCALE_NOSCALE="noscale",a.SCALE_EXACTFIT="exactfit",a.SCALE_SHOWALL="showall",a.SCALE_NOBORDER="noborder",a.SCALE_FULL="full",a.SCALE_FIXED_WIDTH="fixedwidth",a.SCALE_FIXED_HEIGHT="fixedheight",a.SCALE_FIXED_AUTO="fixedauto",a.ALIGN_LEFT="left",a.ALIGN_RIGHT="right",a.ALIGN_CENTER="center",a.ALIGN_TOP="top",a.ALIGN_MIDDLE="middle",a.ALIGN_BOTTOM="bottom",a.SCREEN_NONE="none",a.SCREEN_HORIZONTAL="horizontal",a.SCREEN_VERTICAL="vertical",a.FRAME_FAST="fast",a.FRAME_SLOW="slow",a.FRAME_MOUSE="mouse",a.FRAME_SLEEP="sleep",n(a,["_dbgSprite",function(){return this._dbgSprite=new kn}]),a}(kn),bs=function(t){function e(){this.lockLayer=null,this.popupEffect=function(t){t.scale(1,1),ri.from(t,{x:i.stage.width/2,y:i.stage.height/2,scaleX:0,scaleY:0},300,Ve.backOut,_.create(this,this.doOpen,[t]))},this.closeEffect=function(t){ri.to(t,{x:i.stage.width/2,y:i.stage.height/2,scaleX:0,scaleY:0},300,Ve.strongOut,_.create(this,this.doClose,[t]))},e.__super.call(this),this.maskLayer=new kn,this.popupEffectHandler=new _(this,this.popupEffect),this.closeEffectHandler=new _(this,this.closeEffect),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,i.stage.addChild(this),i.stage.on("resize",this,this._onResize),Ui.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}s(e,"laya.ui.DialogManager",t);var n=e.prototype;return n._closeOnSide=function(){var t=this.getChildAt(this.numChildren-1);t instanceof laya.ui.Dialog&&t.close()},n.setLockView=function(t){this.lockLayer||(this.lockLayer=new Us,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(i.stage.width,i.stage.height)),this.lockLayer.removeChildren(),t&&(t.centerX=t.centerY=0,this.lockLayer.addChild(t))},n._onResize=function(){var t=this.maskLayer.width=i.stage.width,e=this.maskLayer.height=i.stage.height;this.lockLayer&&this.lockLayer.size(t,e),this.maskLayer.graphics.clear(!0),this.maskLayer.graphics.drawRect(0,0,t,e,Ui.popupBgColor),this.maskLayer.alpha=Ui.popupBgAlpha;for(var n=this.numChildren-1;n>-1;n--){var s=this.getChildAt(n);s.isPopupCenter&&this._centerDialog(s)}},n._centerDialog=function(t){t.x=Math.round((i.stage.width-t.width>>1)+t.pivotX),t.y=Math.round((i.stage.height-t.height>>1)+t.pivotY)},n.open=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1),e&&this._closeAll(),t.isPopupCenter&&this._centerDialog(t),this.addChild(t),(t.isModal||this._getBit(32))&&i.timer.callLater(this,this._checkMask),n&&null!=t.popupEffect?t.popupEffect.runWith(t):this.doOpen(t),this.event("open")},n.doOpen=function(t){t.onOpened(t._param)},n.lock=function(t){this.lockLayer&&(t?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},n.close=function(t){t.isShowEffect&&null!=t.closeEffect?t.closeEffect.runWith([t]):this.doClose(t),this.event("close")},n.doClose=function(t){t.removeSelf(),t.isModal&&this._checkMask(),t.closeHandler&&t.closeHandler.runWith(t.closeType),t.onClosed(t.closeType),t.autoDestroyAtClosed&&t.destroy()},n.closeAll=function(){this._closeAll(),this.event("close")},n._closeAll=function(){for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);e&&null!=e.close&&this.doClose(e)}},n.getDialogsByGroup=function(t){for(var e=[],i=this.numChildren-1;i>-1;i--){var n=this.getChildAt(i);n&&n.group===t&&e.push(n)}return e},n.closeByGroup=function(t){for(var e=[],i=this.numChildren-1;i>-1;i--){var n=this.getChildAt(i);n&&n.group===t&&(n.close(),e.push(n))}return e},n._checkMask=function(){this.maskLayer.removeSelf();for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);if(e&&e.isModal)return this.addChildAt(this.maskLayer,t),void 0}},e}(kn),Ps=function(t){function e(){this._maxsize=0,this._upload=!0,this._uploadSize=0,this._bufferSize=0,this._u8Array=null,e.__super.call(this),this.lock=!0}s(e,"laya.webgl.utils.Buffer2D",t);var i=e.prototype;return i.setByteLength=function(t){this._byteLength!==t&&(t<=this._bufferSize||this._resizeBuffer(2*t+256,!0),this._byteLength=t)},i.needSize=function(t){var e=this._byteLength;if(t){var i=this._byteLength+t;i<=this._bufferSize||this._resizeBuffer(i<<1,!0),this._byteLength=i}return e},i._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),wi.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this._setGPUMemory(this._buffer.byteLength),this._buffer=this._buffer.slice(0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,we.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this._setGPUMemory(this._uploadSize)),we.instance.bufferSubData(this._bufferType,0,this._buffer)},i._bufferSubData=function(t,e,i){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this._maxsize=Math.max(this._maxsize,this._byteLength),wi.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this._setGPUMemory(this._buffer.byteLength),this._buffer=this._buffer.slice(0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,we.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this._setGPUMemory(this._uploadSize)),e||i){var n=this._buffer.slice(e,i);we.instance.bufferSubData(this._bufferType,t,n)}else we.instance.bufferSubData(this._bufferType,t,this._buffer)},i._checkArrayUse=function(){},i._bind_uploadForVAO=function(){return this._upload?(this._upload=!1,this._bindForVAO(),this._bufferData(),!0):!1},i._bind_upload=function(){return this._upload?(this._upload=!1,this.bind(),this._bufferData(),!0):!1},i._bind_subUpload=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this._upload?(this._upload=!1,this.bind(),this._bufferSubData(t,e,i),!0):!1},i._resizeBuffer=function(t,e){if(t<this._buffer.byteLength)return this;if(this._setGPUMemory(t),e&&this._buffer&&this._buffer.byteLength>0){var i=new ArrayBuffer(t),n=this._u8Array&&this._u8Array.buffer==this._buffer?this._u8Array:new Uint8Array(this._buffer);this._u8Array=new Uint8Array(i),this._u8Array.set(n,0),this._buffer=i}else this._buffer=new ArrayBuffer(t);return this._checkArrayUse(),this._upload=!0,this._bufferSize=this._buffer.byteLength,this},i.append=function(t){this._upload=!0;var e,i=0;i=t.byteLength,t instanceof Uint8Array?(this._resizeBuffer(this._byteLength+i,!0),e=new Uint8Array(this._buffer,this._byteLength)):t instanceof Uint16Array?(this._resizeBuffer(this._byteLength+i,!0),e=new Uint16Array(this._buffer,this._byteLength)):t instanceof Float32Array&&(this._resizeBuffer(this._byteLength+i,!0),e=new Float32Array(this._buffer,this._byteLength)),e.set(t,0),this._byteLength+=i,this._checkArrayUse()},i.appendU16Array=function(t,e){this._resizeBuffer(this._byteLength+2*e,!0);for(var i=new Uint16Array(this._buffer,this._byteLength,e),n=0;e>n;n++)i[n]=t[n];this._byteLength+=2*e,this._checkArrayUse()},i.appendEx=function(t,e){this._upload=!0;var i,n=0;n=t.byteLength,this._resizeBuffer(this._byteLength+n,!0),i=new e(this._buffer,this._byteLength),i.set(t,0),this._byteLength+=n,this._checkArrayUse()},i.appendEx2=function(t,e,i,n){void 0===n&&(n=1),this._upload=!0;var s,r=0;r=i*n,this._resizeBuffer(this._byteLength+r,!0),s=new e(this._buffer,this._byteLength);var a=0;for(a=0;i>a;a++)s[a]=t[a];this._byteLength+=r,this._checkArrayUse()},i.getBuffer=function(){return this._buffer},i.setNeedUpload=function(){this._upload=!0},i.getNeedUpload=function(){return this._upload},i.upload=function(){var t=this._bind_upload();return we.instance.bindBuffer(this._bufferType,null),34962==this._bufferType&&(ms._bindedVertexBuffer=null),34963==this._bufferType&&(ms._bindedIndexBuffer=null),ps.activeShader=null,t},i.subUpload=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0);var n=this._bind_subUpload();return we.instance.bindBuffer(this._bufferType,null),34962==this._bufferType&&(ms._bindedVertexBuffer=null),34963==this._bufferType&&(ms._bindedIndexBuffer=null),ps.activeShader=null,n},i._disposeResource=function(){t.prototype._disposeResource.call(this),this._upload=!0,this._uploadSize=0},i.clear=function(){this._byteLength=0,this._upload=!0},r(0,i,"bufferLength",function(){return this._buffer.byteLength}),r(0,i,"byteLength",null,function(t){this.setByteLength(t)}),e.__int__=function(){},e.FLOAT32=4,e.SHORT=2,e}(ms),Ls=function(t){function e(t,i,n,s,r){if(this._attribInfo=null,this.customCompile=!1,this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},e.__super.call(this),!t||!i)throw"Shader Error";this._attribInfo=r,Ni.isConchApp&&(this.customCompile=!0),this._id=++e._count,this._vs=t,this._ps=i,this._nameMap=s?s:{},null!=n&&(e.sharders[n]=this),this.recreateResource(),this.lock=!0}s(e,"laya.webgl.shader.Shader",t);var i=e.prototype;return i.recreateResource=function(){this._compile(),this._setGPUMemory(0)},i._disposeResource=function(){Oi.mainContext.deleteShader(this._vshader),Oi.mainContext.deleteShader(this._pshader),Oi.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this._setGPUMemory(0),this._curActTexIndex=0},i._compile=function(){if(this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var t;this.customCompile&&(t=ce.preGetParams(this._vs,this._ps));var i=Oi.mainContext;this._program=i.createProgram(),this._vshader=e._createShader(i,this._vs,35633),this._pshader=e._createShader(i,this._ps,35632),i.attachShader(this._program,this._vshader),i.attachShader(this._program,this._pshader);var n,s,r=0,a=0,o=this._attribInfo?this._attribInfo.length:0;for(r=0;o>r;r+=2)i.bindAttribLocation(this._program,this._attribInfo[r+1],this._attribInfo[r]);if(i.linkProgram(this._program),!this.customCompile&&!i.getProgramParameter(this._program,35714))throw i.getProgramInfoLog(this._program);var h=this.customCompile?t.uniforms.length:i.getProgramParameter(this._program,35718);for(r=0;h>r;r++){var l=this.customCompile?t.uniforms[r]:i.getActiveUniform(this._program,r);s=i.getUniformLocation(this._program,l.name),n={vartype:"uniform",glfun:null,ivartype:1,location:s,name:l.name,type:l.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},n.name.indexOf("[0]")>0&&(n.name=n.name.substr(0,n.name.length-3),n.isArray=!0,n.location=i.getUniformLocation(this._program,n.name)),this._params.push(n)}for(r=0,a=this._params.length;a>r;r++)switch(n=this._params[r],n.indexOfParams=r,n.index=1,n.value=[n.location,null],n.codename=n.name,n.name=this._nameMap[n.codename]?this._nameMap[n.codename]:n.codename,this._paramsMap[n.name]=n,n._this=this,n.uploadedValue=[],n.type){case 5124:n.fun=n.isArray?this._uniform1iv:this._uniform1i;break;case 5126:n.fun=n.isArray?this._uniform1fv:this._uniform1f;break;case 35664:n.fun=n.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:n.fun=n.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:n.fun=n.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:n.fun=this._uniform_sampler2D;break;case 35680:n.fun=this._uniform_samplerCube;break;case 35676:n.glfun=i.uniformMatrix4fv,n.fun=this._uniformMatrix4fv;break;case 35670:n.fun=this._uniform1i;break;case 35674:case 35675:throw new Error("compile shader err!");default:throw new Error("compile shader err!")}}},i.getUniform=function(t){return this._paramsMap[t]},i._uniform1f=function(t,e){var i=t.uploadedValue;return i[0]!==e?(Oi.mainContext.uniform1f(t.location,i[0]=e),1):0},i._uniform1fv=function(t,e){if(e.length<4){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(Oi.mainContext.uniform1fv(t.location,e),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],1):0}return Oi.mainContext.uniform1fv(t.location,e),1},i._uniform_vec2=function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]?(Oi.mainContext.uniform2f(t.location,i[0]=e[0],i[1]=e[1]),1):0},i._uniform_vec2v=function(t,e){if(e.length<2){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(Oi.mainContext.uniform2fv(t.location,e),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],1):0}return Oi.mainContext.uniform2fv(t.location,e),1},i._uniform_vec3=function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]?(Oi.mainContext.uniform3f(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2]),1):0},i._uniform_vec3v=function(t,e){return Oi.mainContext.uniform3fv(t.location,e),1},i._uniform_vec4=function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(Oi.mainContext.uniform4f(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),1):0},i._uniform_vec4v=function(t,e){return Oi.mainContext.uniform4fv(t.location,e),1},i._uniformMatrix2fv=function(t,e){return Oi.mainContext.uniformMatrix2fv(t.location,!1,e),1},i._uniformMatrix3fv=function(t,e){return Oi.mainContext.uniformMatrix3fv(t.location,!1,e),1},i._uniformMatrix4fv=function(t,e){return Oi.mainContext.uniformMatrix4fv(t.location,!1,e),1},i._uniform1i=function(t,e){var i=t.uploadedValue;return i[0]!==e?(Oi.mainContext.uniform1i(t.location,i[0]=e),1):0},i._uniform1iv=function(t,e){return Oi.mainContext.uniform1iv(t.location,e),1},i._uniform_ivec2=function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]?(Oi.mainContext.uniform2i(t.location,i[0]=e[0],i[1]=e[1]),1):0},i._uniform_ivec2v=function(t,e){return Oi.mainContext.uniform2iv(t.location,e),1},i._uniform_vec3i=function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]?(Oi.mainContext.uniform3i(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2]),1):0},i._uniform_vec3vi=function(t,e){return Oi.mainContext.uniform3iv(t.location,e),1},i._uniform_vec4i=function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(Oi.mainContext.uniform4i(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),1):0},i._uniform_vec4vi=function(t,e){return Oi.mainContext.uniform4iv(t.location,e),1},i._uniform_sampler2D=function(t,e){var i=Oi.mainContext,n=t.uploadedValue;return null==n[0]?(n[0]=this._curActTexIndex,i.uniform1i(t.location,this._curActTexIndex),ye.activeTexture(i,33984+this._curActTexIndex),ye.bindTexture(i,3553,e),this._curActTexIndex++,1):(ye.activeTexture(i,33984+n[0]),ye.bindTexture(i,3553,e),0)},i._uniform_samplerCube=function(t,e){var i=Oi.mainContext,n=t.uploadedValue;return null==n[0]?(n[0]=this._curActTexIndex,i.uniform1i(t.location,this._curActTexIndex),ye.activeTexture(i,33984+this._curActTexIndex),ye.bindTexture(i,34067,e),this._curActTexIndex++,1):(ye.activeTexture(i,33984+n[0]),ye.bindTexture(i,34067,e),0)},i._noSetValue=function(t){console.log("no....:"+t.name)},i.uploadOne=function(t,e){ye.useProgram(Oi.mainContext,this._program);var i=this._paramsMap[t];i.fun.call(this,i,e)},i.uploadTexture2D=function(t){var e=ye;e._activeTextures[0]!==t&&(e.bindTexture(Oi.mainContext,e.TEXTURE_2D,t),e._activeTextures[0]=t)},i.upload=function(t,e){ps.activeShader=ps.bindShader=this;var i=Oi.mainContext;ye.useProgram(i,this._program),this._reCompile?(e=this._params,this._reCompile=!1):e=e||this._params;for(var n,s,r=e.length,a=0,o=0;r>o;o++)n=e[o],null!==(s=t[n.name])&&(a+=n.fun.call(this,n,s));wi.shaderCall+=a},i.uploadArray=function(t,e,i){ps.activeShader=this,ps.bindShader=this,ye.useProgram(Oi.mainContext,this._program);for(var n,s,r=(this._params,0),a=e-2;a>=0;a-=2)s=this._paramsMap[t[a]],s&&(n=t[a+1],null!=n&&(i&&i[s.name]&&i[s.name].bind(),r+=s.fun.call(this,s,n)));wi.shaderCall+=r},i.getParams=function(){return this._params},i.setAttributesLocation=function(t){this._attribInfo=t},e.getShader=function(t){return e.sharders[t]},e.create=function(t,i,n,s,r){return new e(t,i,n,s,r)},e.withCompile=function(t,i,n,s){if(n&&e.sharders[n])return e.sharders[n];var r=e._preCompileShader[2e-4*t];if(!r)throw new Error("withCompile shader err!"+t);return r.createShader(i,n,s,null)},e.withCompile2D=function(t,i,n,s,r,a){if(s&&e.sharders[s])return e.sharders[s];var o=e._preCompileShader[2e-4*t+i];if(!o)throw new Error("withCompile shader err!"+t+" "+i);return o.createShader(n,s,r,a)},e.addInclude=function(t,e){ce.addInclude(t,e)},e.preCompile=function(t,i,n,s){var r=2e-4*t;e._preCompileShader[r]=new ce(i,n,s)},e.preCompile2D=function(t,i,n,s,r){var a=2e-4*t+i;e._preCompileShader[a]=new ce(n,s,r)},e._createShader=function(t,e,i){var n=t.createShader(i);return t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,35713)?n:(console.log(t.getShaderInfoLog(n)),null)},e._count=0,e._preCompileShader={},e.SHADERNAME2ID=2e-4,e.sharders=new Array(32),n(e,["nameKey",function(){return this.nameKey=new ci}]),e}(ps),Is=function(t){function e(t){e.__super.call(this),void 0===t&&(t=!1),this._source=t||!Ni.isWebGL?Be.createElement("canvas"):this,this.lock=!0}s(e,"laya.resource.HTMLCanvas",t);var i=e.prototype;return i._getSource=function(){return this._source},i.clear=function(){this._ctx&&this._ctx.clear(),this._texture&&(this._texture.destroy(),this._texture=null)},i.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null},i.release=function(){},i._setContext=function(t){this._ctx=t},i.getContext=function(){return this.context},i.getMemSize=function(){return 0},i.size=function(t,e){(this._width!=t||this._height!=e||this._source&&(this._source.width!=t||this._source.height!=e))&&(this._width=t,this._height=e,this._setGPUMemory(t*e*4),this._ctx&&this._ctx.size&&this._ctx.size(t,e),this._source&&(this._source.height=e,this._source.width=t),this._texture&&(this._texture.destroy(),this._texture=null))},i.getTexture=function(){return this._texture||(this._texture=new _n(this,_n.DEF_UV)),this._texture},i.toBase64=function(t,e,i){if(this._source)if(Ni.isConchApp&&this._source.toBase64)this._source.toBase64(t,e,i);else{var n=this._source.toDataURL(t,e);i(n)}},r(0,i,"source",function(){return this._source}),r(0,i,"context",function(){return this._ctx?this._ctx:(this._ctx=Ni.isWebGL&&this._source==this?new laya.webgl.canvas.WebGLContext2D:this._source.getContext(Ni.isConchApp?"layagl":"2d"),this._ctx._canvas=this,this._ctx)}),e}(vs),Ms=function(t){function e(){e.__super.call(this)}s(e,"laya.resource.HTMLImage",t);var i=e.prototype;return i.loadImageSource=function(t){var e=t.width,i=t.height;if(0>=e||0>=i)throw new Error("HTMLImage:width or height must large than 0.");this._width=e,this._height=i,this._source=t,this._setGPUMemory(e*i*4),this._activeResource()},i._disposeResource=function(){this._source&&(this._source=null,this._setGPUMemory(0))},i._getSource=function(){return this._source},e.create=function(){return new e},e}(vs),ws=function(t){function e(t,i){e.__super.call(this),this._wrapModeU=0,this._wrapModeV=0,this._filterMode=1,this._readyed=!1,this._width=-1,this._height=-1,this._format=t,this._mipmap=i,this._anisoLevel=1,this._glTexture=we.instance.createTexture()}s(e,"laya.webgl.resource.BaseTexture",t);var i=e.prototype;return i._isPot=function(t){return 0===(t&t-1)},i._getGLFormat=function(){var t=0;switch(this._format){case 0:t=6407;break;case 1:t=6408;break;case 2:t=6406;break;case 3:if(!ye._compressedTextureS3tc)throw"BaseTexture: not support DXT1 format.";t=ye._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case 4:if(!ye._compressedTextureS3tc)throw"BaseTexture: not support DXT5 format.";t=ye._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;case 5:if(!ye._compressedTextureEtc1)throw"BaseTexture: not support ETC1RGB format.";t=ye._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;break;case 9:if(!ye._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_2BPPV format.";t=ye._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 10:if(!ye._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_2BPPV format.";t=ye._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;break;case 11:if(!ye._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_4BPPV format.";t=ye._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 12:if(!ye._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_4BPPV format.";t=ye._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;default:throw"BaseTexture: unknown texture format."}return t},i._setFilterMode=function(t){var e=we.instance;switch(ye.bindTexture(e,this._glTextureType,this._glTexture),t){case 0:this._mipmap&&this._isPot(this._width)&&this._isPot(this._height)?e.texParameteri(this._glTextureType,10241,9984):e.texParameteri(this._glTextureType,10241,9728),e.texParameteri(this._glTextureType,10240,9728);break;case 1:this._mipmap&&this._isPot(this._width)&&this._isPot(this._height)?e.texParameteri(this._glTextureType,10241,9985):e.texParameteri(this._glTextureType,10241,9729),e.texParameteri(this._glTextureType,10240,9729);break;case 2:this._mipmap&&this._isPot(this._width)&&this._isPot(this._height)?e.texParameteri(this._glTextureType,10241,9987):e.texParameteri(this._glTextureType,10241,9729),e.texParameteri(this._glTextureType,10240,9729);break;default:throw new Error("BaseTexture:unknown filterMode value.")}},i._setWarpMode=function(t,e){var i=we.instance;if(ye.bindTexture(i,this._glTextureType,this._glTexture),this._isPot(this._width)&&this._isPot(this._height))switch(e){case 0:i.texParameteri(this._glTextureType,t,10497);break;case 1:i.texParameteri(this._glTextureType,t,33071)}else i.texParameteri(this._glTextureType,t,33071)},i._setAnisotropy=function(t){var e=ye._extTextureFilterAnisotropic;if(e){t=Math.max(t,1);var i=we.instance;ye.bindTexture(i,this._glTextureType,this._glTexture),t=Math.min(i.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT),t),i.texParameterf(this._glTextureType,e.TEXTURE_MAX_ANISOTROPY_EXT,t)}},i._disposeResource=function(){this._glTexture&&(we.instance.deleteTexture(this._glTexture),this._glTexture=null,this._setGPUMemory(0))},i._getSource=function(){return this._readyed?this._glTexture:null},r(0,i,"wrapModeU",function(){return this._wrapModeU},function(t){this._wrapModeU!==t&&(this._wrapModeU=t,-1!==this._width&&this._setWarpMode(10242,t))}),r(0,i,"mipmap",function(){return this._mipmap}),r(0,i,"format",function(){return this._format}),r(0,i,"wrapModeV",function(){return this._wrapModeV},function(t){this._wrapModeV!==t&&(this._wrapModeV=t,-1!==this._height&&this._setWarpMode(10243,t))}),r(0,i,"defaulteTexture",function(){throw"BaseTexture:must override it."}),r(0,i,"filterMode",function(){return this._filterMode},function(t){t!==this._filterMode&&(this._filterMode=t,-1!==this._width&&-1!==this._height&&this._setFilterMode(t))}),r(0,i,"anisoLevel",function(){return this._anisoLevel},function(t){t!==this._anisoLevel&&(this._anisoLevel=Math.max(1,Math.min(16,t)),-1!==this._width&&-1!==this._height&&this._setAnisotropy(t))}),e.WARPMODE_REPEAT=0,e.WARPMODE_CLAMP=1,e.FILTERMODE_POINT=0,e.FILTERMODE_BILINEAR=1,e.FILTERMODE_TRILINEAR=2,e.FORMAT_R8G8B8=0,e.FORMAT_R8G8B8A8=1,e.FORMAT_ALPHA8=2,e.FORMAT_DXT1=3,e.FORMAT_DXT5=4,e.FORMAT_ETC1RGB=5,e.FORMAT_PVRTCRGB_2BPPV=9,e.FORMAT_PVRTCRGBA_2BPPV=10,e.FORMAT_PVRTCRGB_4BPPV=11,e.FORMAT_PVRTCRGBA_4BPPV=12,e.FORMAT_DEPTH_16=0,e.FORMAT_STENCIL_8=1,e.FORMAT_DEPTHSTENCIL_16_8=2,e.FORMAT_DEPTHSTENCIL_NONE=3,e}(vs),Os=function(t){function e(){this._watchMap={},this._widget=null,this._dataSource=null,this._anchorX=0/0,this._anchorY=0/0,this._widget=An.EMPTY,e.__super.call(this)}s(e,"laya.ui.View",t);var n=e.prototype;return n.destroy=function(e){void 0===e&&(e=!0),this._watchMap=null,t.prototype.destroy.call(this,e)},n.changeData=function(t){var e=this._watchMap[t];if(e)for(var i=0,n=e.length;n>i;i++){var s=e[i];s.exe(this)}},n._sizeChanged=function(){isNaN(this._anchorX)||(this.pivotX=this.anchorX*this.width),isNaN(this._anchorY)||(this.pivotY=this.anchorY*this.height),this.event("resize")},n._getWidget=function(){return this._widget===An.EMPTY&&(this._widget=this.addComponent(An)),this._widget},n.loadUI=function(t){var i=e.uiMap[t];e.uiMap&&this.createView(i)},r(0,n,"anchorX",function(){return this._anchorX},function(t){this._anchorX!=t&&(this._anchorX=t,this.callLater(this._sizeChanged))}),r(0,n,"centerX",function(){return this._widget.centerX},function(t){t!=this._widget.centerX&&(this._getWidget().centerX=t)}),r(0,n,"top",function(){return this._widget.top},function(t){t!=this._widget.top&&(this._getWidget().top=t)}),r(0,n,"bottom",function(){return this._widget.bottom},function(t){t!=this._widget.bottom&&(this._getWidget().bottom=t)}),r(0,n,"dataSource",function(){return this._dataSource},function(t){this._dataSource=t;for(var e in t){var i=this.getChildByName(e);i instanceof laya.ui.UIComponent?i.dataSource=t[e]:this.hasOwnProperty(e)&&"function"!=typeof this[e]&&(this[e]=t[e])}}),r(0,n,"left",function(){return this._widget.left},function(t){t!=this._widget.left&&(this._getWidget().left=t)}),r(0,n,"right",function(){return this._widget.right},function(t){t!=this._widget.right&&(this._getWidget().right=t)}),r(0,n,"anchorY",function(){return this._anchorY},function(t){this._anchorY!=t&&(this._anchorY=t,this.callLater(this._sizeChanged))}),r(0,n,"centerY",function(){return this._widget.centerY},function(t){t!=this._widget.centerY&&(this._getWidget().centerY=t)}),e.regComponent=function(t,e){Pe.regClass(t,e)},e.regViewRuntime=function(t,e){Pe.regClass(t,e)},e.regUI=function(t,e){i.loader.cacheRes(t,e)},e.uiMap={},e.__init$=function(){Pe.regShortClassName([qr,Gs,Sa,qs,Us,$r,Gs,jr,Ys,Hs,As,Zr,aa,Zs,Xs,Hr,ta,$s,ea,Da,zs,Ks,Ca,Jr,e,Xr,na,ra,ia,Aa,Ea,kn,Js,Cs,Qr])},e}(Ss),Bs=function(t){function e(){this.bgimg=null,this.fileimg=null,this.numindex=null,this.filename=null,this.price=null,this.total=null,this.operatebox=null,this.addmsg=null,this.deleteorder=null,this.hascomment=null,this.editbox=null,this.editwidth=null,this.editheight=null,this.architype=null,this.matbox=null,this.mattxt=null,this.changemat=null,this.checkSel=null,this.numbox=null,this.inputnum=null,this.addbtn=null,this.subtn=null,e.__super.call(this)}s(e,"ui.order.OrderItemUI",t);var i=e.prototype;return i.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"Scene",props:{width:1280},compId:2,child:[{type:"Image",props:{y:0,x:0,width:1280,"var":"bgimg",skin:"commers/inputbg.png",sizeGrid:"5,5,5,5",height:82},compId:26},{type:"Image",props:{y:40,x:143,width:80,"var":"fileimg",skin:"comp/image.png",height:80,anchorY:.5,anchorX:.5},compId:4},{type:"Label",props:{y:35,x:53,width:30,"var":"numindex",text:"1",height:21,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:3},{type:"Label",props:{y:0,x:195,wordWrap:!0,width:118,"var":"filename",valign:"middle",text:"PP纸无背胶（海报、展架）.tif",overflow:"hidden",height:82,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:5},{type:"Label",props:{y:38.5,x:816,width:58,"var":"price",text:"175.2",fontSize:16,font:"SimHei",color:"#152326",bold:!0,align:"center"},compId:15},{type:"Label",props:{y:34,x:1083,"var":"total",text:"12680",fontSize:16,font:"SimHei",color:"#262B2E",bold:!0,align:"center"},compId:17},{type:"Box",props:{y:9,x:1191,"var":"operatebox"},compId:21,child:[{type:"Text",props:{"var":"addmsg",text:"添加备注",fontSize:16,font:"SimHei",color:"#262B2E",runtime:"laya.display.Text"},compId:18},{type:"Text",props:{y:15,x:0,"var":"deleteorder",text:"删除订单",fontSize:16,font:"SimHei",color:"#262B2E",runtime:"laya.display.Text"},compId:19},{type:"Label",props:{y:-13,x:65,width:14,"var":"hascomment",valign:"middle",text:"'''",height:17,fontSize:24,font:"Helvetica",color:"#39B25A",align:"center"},compId:36}]},{type:"Box",props:{y:12,x:488,"var":"editbox"},compId:22,child:[{type:"Label",props:{y:1,width:58,text:"宽(cm)",height:21,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:8},{type:"Label",props:{y:38,x:0,width:58,text:"高(cm)",height:21,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:9},{type:"TextInput",props:{x:58,width:74,"var":"editwidth",text:"16",skin:"commers/inputbg.png",sizeGrid:"5,5,5,5",mouseEnabled:!1,height:22,fontSize:16,font:"SimHei",color:"#262B2E"},compId:10},{type:"TextInput",props:{y:39,x:58,width:74,"var":"editheight",text:"16",skin:"commers/inputbg.png",sizeGrid:"3,3,3,3",mouseEnabled:!1,height:22,fontSize:16,font:"SimHei",color:"#262B2E"},compId:11}]},{type:"VBox",props:{y:29.5,x:635,space:0},compId:24,child:[{type:"Label",props:{y:7,x:0,wordWrap:!0,width:176,"var":"architype",valign:"top",text:"户外材料--白胶车贴",height:30,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:12}]},{type:"Sprite",props:{y:15,x:320,width:158,"var":"matbox",height:43},compId:25,child:[{type:"Label",props:{width:187,"var":"mattxt",text:"展架专用布",height:21,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:6},{type:"Text",props:{y:25,x:59,"var":"changemat",text:"更换材料",presetID:1,fontSize:16,font:"SimHei",color:"#39B25A",isPresetRoot:!0,runtime:"laya.display.Text"},compId:27,child:[{type:"Script",props:{presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:28}]}]},{type:"CheckBox",props:{y:36,x:14,"var":"checkSel",skin:"commers/multicheck.png",scaleY:1,scaleX:1},compId:31},{type:"Sprite",props:{y:30,x:950,"var":"numbox"},compId:35,child:[{type:"TextInput",props:{y:1,x:19,width:40,"var":"inputnum",text:"10",skin:"commers/inputbg.png",sizeGrid:"3,3,3,3",height:22,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:16},{type:"Button",props:{x:60,"var":"addbtn",skin:"order/addbtn.png"},compId:33},{type:"Button",props:{"var":"subtn",skin:"order/subtbn.png"},compId:34}]}],loadList:["commers/inputbg.png","comp/image.png","prefabs/LinksText.prefab","commers/multicheck.png","order/addbtn.png","order/subtbn.png"],loadList3D:[]},e
}(Ss),Ns=function(t){function e(){this.panel_main=null,this.btnUpload=null,this.paintOrderBtn=null,this.btnproduct=null,this.btnUserCenter=null,this.txt_login=null,this.txt_reg=null,this.enterinfo=null,this.linktobus=null,e.__super.call(this)}s(e,"ui.LoginViewUI",t);var i=e.prototype;return i.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"Scene",props:{width:1920,height:1080},compId:2,child:[{type:"Image",props:{top:0,sizeGrid:"5,5,5,5",right:0,left:0,bottom:0},compId:29,child:[{type:"Rect",props:{width:1920,lineWidth:1,height:1080,fillColor:"#f8f6f6"},compId:60}]},{type:"Panel",props:{x:0,width:1920,"var":"panel_main",top:0,height:1080},compId:3,child:[{type:"Sprite",props:{y:0,width:1920,texture:"mainpage/mainbg.jpg",height:1080},compId:12},{type:"Sprite",props:{y:22,x:320,texture:"commers/logotxt.png",scaleY:1,scaleX:1},compId:11},{type:"Label",props:{y:370,x:680,width:560,text:"广告全产业链生态平台",height:77,fontSize:56,font:"Microsoft YaHei",color:"#FFFFFF"},compId:18},{type:"Text",props:{y:34,x:541,width:92,"var":"btnUpload",text:"我的图库",presetID:1,height:26,fontSize:20,font:"Microsoft YaHei",color:"#EDFFEC",isPresetRoot:!0,runtime:"laya.display.Text"},compId:40,child:[{type:"Script",props:{txttype:1,presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:41}]},{type:"Text",props:{y:34,x:661,width:92,"var":"paintOrderBtn",text:"喷印下单",presetID:1,height:26,fontSize:20,font:"Microsoft YaHei",color:"#EDFFEC",isPresetRoot:!0,runtime:"laya.display.Text"},compId:42,child:[{type:"Script",props:{txttype:1,presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:43}]},{type:"Text",props:{y:34,x:781,width:92,"var":"btnproduct",text:"商品下单",presetID:1,height:26,fontSize:20,font:"Microsoft YaHei",color:"#EDFFEC",isPresetRoot:!0,runtime:"laya.display.Text"},compId:48,child:[{type:"Script",props:{txttype:1,presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:49}]},{type:"Text",props:{y:34,x:901,width:92,text:"视觉资料",presetID:1,height:26,fontSize:20,font:"Microsoft YaHei",color:"#EDFFEC",isPresetRoot:!0,runtime:"laya.display.Text"},compId:50,child:[{type:"Script",props:{txttype:1,presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:51}]},{type:"Text",props:{y:34,x:1021,width:92,"var":"btnUserCenter",text:"用户中心",presetID:1,height:26,fontSize:20,font:"Microsoft YaHei",color:"#EDFFEC",isPresetRoot:!0,runtime:"laya.display.Text"},compId:52,child:[{type:"Script",props:{txttype:1,presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:53}]},{type:"Text",props:{y:34,x:1365,width:140,"var":"txt_login",text:"登陆",presetID:1,overflow:"hidden",height:26,fontSize:20,font:"Microsoft YaHei",color:"#EDFFEC",align:"right",isPresetRoot:!0,runtime:"laya.display.Text"},compId:54,child:[{type:"Script",props:{txttype:1,presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:55}]},{type:"Text",props:{y:34,x:1512,width:73,"var":"txt_reg",text:"[注册]",presetID:1,height:26,fontSize:20,font:"Microsoft YaHei",color:"#EDFFEC",align:"left",isPresetRoot:!0,runtime:"laya.display.Text"},compId:56,child:[{type:"Script",props:{txttype:1,presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:57}]},{type:"Label",props:{y:464,x:525,width:869,text:"All-in Industrial Internet Platform of Advertising Industry",height:42,fontSize:32,font:"Microsoft YaHei",color:"#EDFFEC"},compId:58},{type:"Label",props:{y:534,x:443,width:1033,text:"开放 Open/智能 Intelligent/协同 Collaborative/共享 Shared",height:55,fontSize:38,font:"Helvetica",color:"#FCFA64",bold:!0},compId:59}]},{type:"Script",props:{runtime:"script.MainPageControl"},compId:27},{type:"Box",props:{y:940,x:0,"var":"enterinfo",right:0,left:0},compId:65,child:[{type:"Image",props:{skin:"commers/blackbg.png",sizeGrid:"2,2,2,2",right:0,left:0,height:80,bottom:0,alpha:.5},compId:62},{type:"Label",props:{y:5,wordWrap:!0,width:1920,text:"Copyright  2019 CMYK.com.cn All Rights Reserved版权所有-色彩飞扬    \\n沪ICP备19015835号-1   本站法律顾问：夏瑜律师    色彩飞扬是网络服务平台，若您的权利被侵害，请联系 wwwcmykvip@163.com",right:0,left:0,leading:20,height:77,fontSize:20,font:"Arial",color:"#f6f6ee",bold:!1,align:"center"},compId:63},{type:"Button",props:{x:314,"var":"linktobus",stateNum:1,skin:"commers/lz2.jpg",scaleY:.8,scaleX:.8,label:"label",bottom:9},compId:66}]}],loadList:["mainpage/mainbg.jpg","commers/logotxt.png","prefabs/LinksText.prefab","commers/blackbg.png","commers/lz2.jpg"],loadList3D:[]},e}(Ss),ks=function(t){function e(){this.zhuanq=null,e.__super.call(this)}s(e,"ui.WaitRespondPanelUI",t);var i=e.prototype;return i.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"Scene",props:{width:1920,mouseEnabled:!0,height:1080},compId:2,child:[{type:"Image",props:{top:0,skin:"commers/blackbg.png",sizeGrid:"3,3,3,3",right:0,mouseEnabled:!0,left:0,bottom:0,alpha:.1},compId:3},{type:"Image",props:{y:540,x:960,"var":"zhuanq",skin:"commers/circlebg.png",anchorY:.5,anchorX:.5,alpha:.9},compId:4}],loadList:["commers/blackbg.png","commers/circlebg.png"],loadList3D:[]},e}(Ss),Fs=function(t){function e(){this.orderList=null,e.__super.call(this)}s(e,"ui.usercenter.MyOrdersPanelUI",t);var i=e.prototype;return i.createChildren=function(){t.prototype.createChildren.call(this),this.loadScene("usercenter/MyOrdersPanel")},e}(Ss),Vs=function(t){function e(){this.bgimg=null,this.picimg=null,this.itemseq=null,this.money=null,this.comment=null,this.commentmark=null,this.widthtxt=null,this.heighttxt=null,this.matname=null,this.pronum=null,this.detailbtn=null,this.tech=null,this.detailbox=null,this.txtDetailInfo=null,e.__super.call(this)}s(e,"ui.usercenter.OrderQuestItemUI",t);var i=e.prototype;return i.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"Scene",props:{width:1e3,height:0},compId:2,child:[{type:"Image",props:{y:0,x:0,width:1e3,"var":"bgimg",skin:"commers/inputbg.png",sizeGrid:"5,5,5,5",height:165},compId:3,child:[{type:"Image",props:{y:42,x:143,width:80,"var":"picimg",skin:"comp/image.png",height:80,anchorY:.5,anchorX:.5},compId:27},{type:"Label",props:{y:35,x:41,width:30,"var":"itemseq",text:"1",height:21,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:28},{type:"Label",props:{y:26.5,x:798,width:58,"var":"money",text:"175.2",fontSize:16,font:"SimHei",color:"#152326",bold:!0,align:"center"},compId:30},{type:"Box",props:{y:26.5,x:888,"var":"comment"},compId:31,child:[{type:"Text",props:{text:"备注",fontSize:16,font:"SimHei",color:"#262B2E",runtime:"laya.display.Text"},compId:35},{type:"Label",props:{y:-13,x:36,width:14,"var":"commentmark",valign:"middle",text:"'''",height:17,fontSize:24,font:"Helvetica",color:"#39B25A",align:"center"},compId:37}]},{type:"Box",props:{y:12,x:395},compId:32,child:[{type:"Label",props:{y:1,width:58,text:"宽(cm)",height:21,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:38},{type:"Label",props:{y:29,x:0,width:58,text:"高(cm)",height:21,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:39},{type:"Label",props:{y:1,x:58,width:46,"var":"widthtxt",text:"10000",height:21,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:48},{type:"Label",props:{y:29,x:58,width:46,"var":"heighttxt",text:"10",height:21,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:49}]},{type:"Sprite",props:{y:15,x:217,width:158,height:43},compId:33,child:[{type:"Label",props:{y:0,x:0,wordWrap:!0,width:187,"var":"matname",valign:"middle",text:"展架专用布",height:42,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:42}]},{type:"Label",props:{y:21,x:738,width:53,"var":"pronum",valign:"middle",text:"10",height:30,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:50},{type:"Text",props:{y:27,x:959,"var":"detailbtn",text:"详情",presetID:1,fontSize:16,font:"SimHei",color:"#52B232",isPresetRoot:!0,runtime:"laya.display.Text"},compId:51,child:[{type:"Script",props:{presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:52}]},{type:"Label",props:{y:5,x:517,wordWrap:!0,width:203,"var":"tech",valign:"middle",text:"10",height:60,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:53}]},{type:"VBox",props:{y:91,"var":"detailbox",space:0,right:5,left:2},compId:13,child:[{type:"Label",props:{y:0,x:0,wordWrap:!0,width:991,"var":"txtDetailInfo",valign:"top",text:"产品状态",height:71,fontSize:18,align:"left"},compId:21}]}],loadList:["commers/inputbg.png","comp/image.png","prefabs/LinksText.prefab"],loadList3D:[]},e}(Ss),Us=function(t){function e(){e.__super.call(this)}s(e,"laya.ui.Box",t);var n=e.prototype;return i.imps(n,{"laya.ui.IBox":!0}),r(0,n,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t;for(var e in t){var i=this.getChildByName(e);i?i.dataSource=t[e]:this.hasOwnProperty(e)&&"function"!=typeof this[e]&&(this[e]=t[e])}}),e}(As),Ws=function(t){function e(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",e.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow="scroll",this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}s(e,"laya.display.Input",t);var a=e.prototype;return a.setSelection=function(t,e){this.focus=!0,laya.display.Input.inputElement.selectionStart=t,laya.display.Input.inputElement.selectionEnd=e},a._onUnDisplay=function(){this.focus=!1},a._onMouseDown=function(){this.focus=!0},a._syncInputTransform=function(){var t=this.nativeInput,n=ee.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),s=this._width-this.padding[1]-this.padding[3],r=this._height-this.padding[0]-this.padding[2];Ni.isConchApp?(t.setScale(n.scaleX,n.scaleY),t.setSize(s,r),t.setPos(n.x,n.y)):(e.inputContainer.style.transform=e.inputContainer.style.webkitTransform="scale("+n.scaleX+","+n.scaleY+") rotate("+i.stage.canvasDegree+"deg)",t.style.width=s+"px",t.style.height=r+"px",e.inputContainer.style.left=n.x+"px",e.inputContainer.style.top=n.y+"px")},a.select=function(){this.nativeInput.select()},a._setInputMethod=function(){e.input.parentElement&&e.inputContainer.removeChild(e.input),e.area.parentElement&&e.inputContainer.removeChild(e.area),e.inputElement=this._multiline?e.area:e.input,e.inputContainer.appendChild(e.inputElement),Cs.RightToLeft&&(e.inputElement.style.direction="rtl")},a._focusIn=function(){laya.display.Input.isInputting=!0;var t=this.nativeInput;this._focus=!0;var e=t.style;e.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),t.readOnly=!this._editable,Ni.isConchApp&&(t.setType(this._type),t.setForbidEdit(!this._editable)),t.maxLength=this._maxChars;this.padding;if(t.type=this._type,t.value=this._content,t.placeholder=this._prompt,i.stage.off("keydown",this,this._onKeyDown),i.stage.on("keydown",this,this._onKeyDown),i.stage.focus=this,this.event("focus"),Be.onPC&&t.focus(),!Be.onMiniGame){{this._text}this._text=null}this.typeset(),t.setColor(this._originColor),t.setFontSize(this.fontSize),t.setFontFace(Be.onIPhone?Cs.fontFamilyMap[this.font]||this.font:this.font),Ni.isConchApp&&t.setMultiAble&&t.setMultiAble(this._multiline),e.lineHeight=this.leading+this.fontSize+"px",e.fontStyle=this.italic?"italic":"normal",e.fontWeight=this.bold?"bold":"normal",e.textAlign=this.align,e.padding="0 0",this._syncInputTransform(),!Ni.isConchApp&&Be.onPC&&i.systemTimer.frameLoop(1,this,this._syncInputTransform)},a._setPromptColor=function(){e.promptStyleDOM=Be.getElementById("promptStyle"),e.promptStyleDOM||(e.promptStyleDOM=Be.createElement("style"),e.promptStyleDOM.setAttribute("id","promptStyle"),Be.document.head.appendChild(e.promptStyleDOM)),e.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},a._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(i.superSet(Cs,this,"text",this._content),i.superSet(Cs,this,"color",this._originColor)):(i.superSet(Cs,this,"text",this._prompt),i.superSet(Cs,this,"color",this._promptColor)),i.stage.off("keydown",this,this._onKeyDown),i.stage.focus=null,this.event("blur"),this.event("change"),Ni.isConchApp&&this.nativeInput.blur(),Be.onPC&&i.systemTimer.clear(this,this._syncInputTransform)},a._onKeyDown=function(t){13===t.keyCode&&(Be.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},a.changeText=function(e){this._content=e,this._focus?(this.nativeInput.value=e||"",this.event("change")):t.prototype.changeText.call(this,e)},r(0,a,"color",t.prototype._$get_color,function(t){this._focus&&this.nativeInput.setColor(t),i.superSet(Cs,this,"color",this._content?t:this._promptColor),this._originColor=t}),r(0,a,"multiline",function(){return this._multiline},function(t){this._multiline=t,this.valign=t?"top":"middle"}),r(0,a,"maxChars",function(){return this._maxChars},function(t){0>=t&&(t=1e5),this._maxChars=t}),r(0,a,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(t){i.superSet(Cs,this,"color",this._originColor),t+="",this._focus?(this.nativeInput.value=t||"",this.event("change")):(this._multiline||(t=t.replace(/\r?\n/g,"")),this._content=t,t?i.superSet(Cs,this,"text",t):(i.superSet(Cs,this,"text",this._prompt),i.superSet(Cs,this,"color",this.promptColor)))}),r(0,a,"nativeInput",function(){return this._multiline?e.area:e.input}),r(0,a,"prompt",function(){return this._prompt},function(t){!this._text&&t&&i.superSet(Cs,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?i.superSet(Cs,this,"text",this._text==this._prompt?t:this._text):i.superSet(Cs,this,"text",t),this._prompt=Cs.langPacks&&Cs.langPacks[t]?Cs.langPacks[t]:t}),r(0,a,"focus",function(){return this._focus},function(t){var i=this.nativeInput;this._focus!==t&&(t?(i.target?i.target._focusOut():this._setInputMethod(),i.target=this,this._focusIn()):(i.target=null,this._focusOut(),Be.document.body.scrollTop=0,i.blur(),Ni.isConchApp?i.setPos(-1e4,-1e4):e.inputContainer.contains(i)&&e.inputContainer.removeChild(i)))}),r(0,a,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(t){t?(t="[^"+t+"]",t.indexOf("^^")>-1&&(t=t.replace("^^","")),this._restrictPattern=new RegExp(t,"g")):this._restrictPattern=null}),r(0,a,"editable",function(){return this._editable},function(t){this._editable=t,Ni.isConchApp&&e.input.setForbidEdit(!t)}),r(0,a,"promptColor",function(){return this._promptColor},function(t){this._promptColor=t,this._content||i.superSet(Cs,this,"color",t)}),r(0,a,"type",function(){return this._type},function(t){this._getTextStyle().asPassword="password"===t?!0:!1,this._type=t}),e.__init__=function(){e._createInputElement(),Be.onMobile&&Ni.canvas.addEventListener(e.IOS_IFRAME?Be.onMiniGame?"touchend":"click":"touchend",e._popupInputMethod)},e._popupInputMethod=function(){if(laya.display.Input.isInputting){var t=laya.display.Input.inputElement;t.focus()}},e._createInputElement=function(){e._initInput(e.area=Be.createElement("textarea")),e._initInput(e.input=Be.createElement("input")),e.inputContainer=Be.createElement("div"),e.inputContainer.style.position="absolute",e.inputContainer.style.zIndex=1e5,Be.container.appendChild(e.inputContainer),e.inputContainer.setPos=function(t,i){e.inputContainer.style.left=t+"px",e.inputContainer.style.top=i+"px"}},e._initInput=function(t){var i=t.style;i.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",i.resize="none",i.backgroundColor="transparent",i.border="none",i.outline="none",i.zIndex=1,t.addEventListener("input",e._processInputting),t.addEventListener("mousemove",e._stopEvent),t.addEventListener("mousedown",e._stopEvent),t.addEventListener("touchmove",e._stopEvent),t.setFontFace=function(e){t.style.fontFamily=e},Ni.isConchApp||(t.setColor=function(e){t.style.color=e},t.setFontSize=function(e){t.style.fontSize=e+"px"})},e._processInputting=function(){var t=laya.display.Input.inputElement.target;if(t){var e=laya.display.Input.inputElement.value;t._restrictPattern&&(e=e.replace(/\u2006|\x27/g,""),t._restrictPattern.test(e)&&(e=e.replace(t._restrictPattern,""),laya.display.Input.inputElement.value=e)),t._text=e,t.event("input")}},e._stopEvent=function(t){"touchmove"==t.type&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},e.TYPE_TEXT="text",e.TYPE_PASSWORD="password",e.TYPE_EMAIL="email",e.TYPE_URL="url",e.TYPE_NUMBER="number",e.TYPE_RANGE="range",e.TYPE_DATE="date",e.TYPE_MONTH="month",e.TYPE_WEEK="week",e.TYPE_TIME="time",e.TYPE_DATE_TIME="datetime",e.TYPE_DATE_TIME_LOCAL="datetime-local",e.TYPE_SEARCH="search",e.input=null,e.area=null,e.inputElement=null,e.inputContainer=null,e.confirmButton=null,e.promptStyleDOM=null,e.inputHeight=45,e.isInputting=!1,e.stageMatrix=null,n(e,["IOS_IFRAME",function(){return this.IOS_IFRAME=Be.onIOS&&Be.window.top!=Be.window.self}]),e}(Cs),Gs=function(t){function e(t,i){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,e.__super.call(this),this._labelColors=tn.buttonLabelColors,this._stateNum=tn.buttonStateNum,void 0===i&&(i=""),this.skin=t,this.label=i}s(e,"laya.ui.Button",t);var a=e.prototype;return i.imps(a,{"laya.ui.ISelect":!0}),a.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(e),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},a.createChildren=function(){this.graphics=this._bitmap=new Mn},a.createText=function(){this._text||(this._text=new Cs,this._text.overflow="hidden",this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},a.initialize=function(){1!==this._mouseState&&(this.mouseEnabled=!0,this._setBit(64,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},a.onMouse=function(t){return this.toggle===!1&&this._selected?void 0:"click"===t.type?(this.toggle&&(this.selected=!this._selected),this._clickHandler&&this._clickHandler.run(),void 0):(!this._selected&&(this.state=e.stateMap[t.type]),void 0)},a._skinLoaded=function(){this.callLater(this.changeClips),this._setStateChanged(),this._sizeChanged(),this.event("loaded")},a.changeClips=function(){var t=un.getRes(this._skin);if(!t)return console.log("lose skin",this._skin),void 0;var e=t.sourceWidth,i=t.sourceHeight/this._stateNum;t.$_GID||(t.$_GID=ee.getGID());var n=t.$_GID+"-"+this._stateNum,s=Ce.I.get(n);if(ee.isOkTextureList(s)||(s=null),s)this._sources=s;else{if(this._sources=[],1===this._stateNum)this._sources.push(t);else for(var r=0;r<this._stateNum;r++)this._sources.push(_n.createFromTexture(t,0,i*r,e,i));Ce.I.set(n,this._sources)}this._autoSize?(this._bitmap.width=this._width||e,this._bitmap.height=this._height||i,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=e)},a.measureWidth=function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))},a.measureHeight=function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height},a.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var t=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[t]),this.label&&(this._text.color=this._labelColors[t],this._strokeColors&&(this._text.strokeColor=this._strokeColors[t]))},a._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},r(0,a,"skin",function(){return this._skin},function(t){this._skin!=t&&(this._skin=t,t?un.getRes(t)?this._skinLoaded():i.loader.load(this._skin,_.create(this,this._skinLoaded),null,"image",1):this._skinLoaded())}),r(0,a,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(t){this.createText(),this._text.padding=Ne.fillArray(tn.labelPadding,t,Number)}),r(0,a,"state",function(){return this._state},function(t){this._state!=t&&(this._state=t,this._setStateChanged())}),r(0,a,"text",function(){return this.createText(),this._text}),r(0,a,"stateNum",function(){return this._stateNum},function(t){"string"==typeof t&&(t=parseInt(t)),this._stateNum!=t&&(this._stateNum=1>t?1:t>3?3:t,this.callLater(this.changeClips))}),r(0,a,"label",function(){return this._text?this._text.text:null},function(t){(this._text||t)&&(this.createText(),this._text.text!=t&&(t&&!this._text.parent&&this.addChild(this._text),this._text.text=(t+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),r(0,a,"labelSize",function(){return this.createText(),this._text.fontSize},function(t){this.createText(),this._text.fontSize=t}),r(0,a,"selected",function(){return this._selected},function(t){this._selected!=t&&(this._selected=t,this.state=this._selected?2:0,this.event("change"))}),r(0,a,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(t){this._strokeColors=Ne.fillArray(tn.buttonLabelColors,t,String),this._setStateChanged()}),r(0,a,"labelColors",function(){return this._labelColors.join(",")},function(t){this._labelColors=Ne.fillArray(tn.buttonLabelColors,t,String),this._setStateChanged()}),r(0,a,"labelStroke",function(){return this.createText(),this._text.stroke},function(t){this.createText(),this._text.stroke=t}),r(0,a,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(t){this.createText(),this._text.strokeColor=t}),r(0,a,"labelBold",function(){return this.createText(),this._text.bold},function(t){this.createText(),this._text.bold=t}),r(0,a,"labelFont",function(){return this.createText(),this._text.font},function(t){this.createText(),this._text.font=t}),r(0,a,"labelAlign",function(){return this.createText(),this._text.align},function(t){this.createText(),this._text.align=t}),r(0,a,"clickHandler",function(){return this._clickHandler},function(t){this._clickHandler=t}),r(0,a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(t){this._bitmap.sizeGrid=Ne.fillArray(tn.defaultSizeGrid,t,Number)}),r(0,a,"width",t.prototype._$get_width,function(t){i.superSet(As,this,"width",t),this._autoSize&&(this._bitmap.width=t,this._text&&(this._text.width=t))}),r(0,a,"height",t.prototype._$get_height,function(t){i.superSet(As,this,"height",t),this._autoSize&&(this._bitmap.height=t,this._text&&(this._text.height=t))}),r(0,a,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.label=t+"":i.superSet(As,this,"dataSource",t)}),r(0,a,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(t){this._bitmap._offset=t?Ne.fillArray([1,1],t,Number):[]}),n(e,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),e}(As),zs=function(t){function e(t){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=0/0,this._hide=!1,this._clickOnly=!0,this._offsets=null,this.isLockedFun=null,this.triggerDownDragLimit=null,this.triggerUpDragLimit=null,e.__super.call(this),this._showButtons=Ui.showButtons,this._touchScrollEnable=Ui.touchScrollEnable,this._mouseWheelEnable=Ui.mouseWheelEnable,this.skin=t,this.max=1}s(e,"laya.ui.ScrollBar",t);var n=e.prototype;return n.destroy=function(e){void 0===e&&(e=!0),this.stopScroll(),this.target=null,t.prototype.destroy.call(this,e),this.upButton&&this.upButton.destroy(e),this.downButton&&this.downButton.destroy(e),this.slider&&this.slider.destroy(e),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},n.createChildren=function(){this.addChild(this.slider=new Ks),this.addChild(this.upButton=new Gs),this.addChild(this.downButton=new Gs)},n.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},n.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},n.onButtonMouseDown=function(t){var e=t.currentTarget===this.upButton;this.slide(e),i.timer.once(tn.scrollBarDelayTime,this,this.startLoop,[e]),i.stage.once("mouseup",this,this.onStageMouseUp)},n.startLoop=function(t){i.timer.frameLoop(1,this,this.slide,[t])},n.slide=function(t){t?this.value-=this._scrollSize:this.value+=this._scrollSize},n.onStageMouseUp=function(){i.timer.clear(this,this.startLoop),i.timer.clear(this,this.slide)},n._skinLoaded=function(){this.slider.skin=this._skin,this.callLater(this.changeScrollBar),this._sizeChanged(),this.event("loaded")},n.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},n._sizeChanged=function(){t.prototype._sizeChanged.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},n.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},n.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider._y+this.slider.height:this.downButton.x=this.slider._x+this.slider.width},n.measureWidth=function(){return this.slider.isVertical?this.slider.width:100},n.measureHeight=function(){return this.slider.isVertical?100:this.slider.height},n.setScroll=function(t,e,i){this.runCallLater(this._sizeChanged),this.slider.setSlider(t,e,i),this.slider.bar.visible=e>0,!this._hide&&this.autoHide&&(this.visible=!1)},n.onTargetMouseWheel=function(t){this.value-=t.delta*this._scrollSize,this.target=this._target},n.onTargetMouseDown=function(t){(!this.isLockedFun||this.isLockedFun(t))&&(this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $i),this._lastPoint.setTo(i.stage.mouseX,i.stage.mouseY),i.timer.clear(this,this.tweenMove),ri.clearTween(this),i.stage.once("mouseup",this,this.onStageMouseUp2),i.stage.once("mouseout",this,this.onStageMouseUp2),i.timer.frameLoop(1,this,this.loop))},n.startDragForce=function(){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $i),this._lastPoint.setTo(i.stage.mouseX,i.stage.mouseY),i.timer.clear(this,this.tweenMove),ri.clearTween(this),i.stage.once("mouseup",this,this.onStageMouseUp2),i.stage.once("mouseout",this,this.onStageMouseUp2),i.timer.frameLoop(1,this,this.loop)},n.cancelDragOp=function(){i.stage.off("mouseup",this,this.onStageMouseUp2),i.stage.off("mouseout",this,this.onStageMouseUp2),i.timer.clear(this,this.loop),this._target.mouseEnabled=!0},n.loop=function(){var t=i.stage.mouseY,e=i.stage.mouseX;if(this._lastOffset=this.isVertical?t-this._lastPoint.y:e-this._lastPoint.x,this._clickOnly){if(!(Math.abs(this._lastOffset*(this.isVertical?i.stage._canvasTransform.getScaleY():i.stage._canvasTransform.getScaleX()))>1))return;if(this._clickOnly=!1,0==this.value&&this._lastOffset>0&&this.triggerDownDragLimit&&this.triggerDownDragLimit())return this.cancelDragOp(),void 0;if(this.value==this.max&&this._lastOffset<0&&this.triggerUpDragLimit&&this.triggerUpDragLimit())return this.cancelDragOp(),void 0;this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=e,this._lastPoint.y=t,0!==this._lastOffset&&(this._checkElastic||(this.elasticDistance>0?this._checkElastic||0==this._lastOffset||(this._lastOffset>0&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},n.onStageMouseUp2=function(){if(i.stage.off("mouseup",this,this.onStageMouseUp2),i.stage.off("mouseout",this,this.onStageMouseUp2),i.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?ri.to(this,{value:this.min},this.elasticBackTime,Ve.sineOut,_.create(this,this.elasticOver)):this._value>this.max&&ri.to(this,{value:this.max},this.elasticBackTime,Ve.sineOut,_.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?i.stage.mouseY-this._lastPoint.y:i.stage.mouseX-this._lastPoint.x);for(var t=0,e=Math.min(this._offsets.length,3),n=0;e>n;n++)t+=this._offsets[this._offsets.length-1-n];if(this._lastOffset=t/e,t=Math.abs(this._lastOffset),2>t)return this.event("end"),void 0;t>60&&(this._lastOffset=this._lastOffset>0?60:-60);var s=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));i.timer.frameLoop(1,this,this.tweenMove,[s])}},n.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&ri.to(this,{alpha:0},500),this.event("end")},n.tweenMove=function(t){this._lastOffset*=this.rollRatio;var e=0/0;if(t>0&&(this._lastOffset>0&&this.value<=this.min?(this._isElastic=!0,e=.5*-(this.min-t-this.value),this._lastOffset>e&&(this._lastOffset=e)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,e=.5*-(this.max+t-this.value),this._lastOffset<e&&(this._lastOffset=e))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(i.timer.clear(this,this.tweenMove),this._isElastic)return this._value<this.min?ri.to(this,{value:this.min},this.elasticBackTime,Ve.sineOut,_.create(this,this.elasticOver)):this._value>this.max?ri.to(this,{value:this.max},this.elasticBackTime,Ve.sineOut,_.create(this,this.elasticOver)):this.elasticOver(),void 0;this.event("end"),!this.hide&&this.autoHide&&ri.to(this,{alpha:0},500)}},n.stopScroll=function(){this.onStageMouseUp2(null),i.timer.clear(this,this.tweenMove),ri.clearTween(this)},r(0,n,"thumbPercent",function(){return this._thumbPercent},function(t){this.runCallLater(this.changeScrollBar),this.runCallLater(this._sizeChanged),t=t>=1?.99:t,this._thumbPercent=t,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*t,tn.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*t,tn.scrollBarMinNum))
}),r(0,n,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):i.superSet(As,this,"dataSource",t)}),r(0,n,"skin",function(){return this._skin},function(t){this._skin!=t&&(this._skin=t,this._skin&&!un.getRes(this._skin)?i.loader.load([this._skin,this._skin.replace(".png","$up.png"),this._skin.replace(".png","$down.png"),this._skin.replace(".png","$bar.png")],_.create(this,this._skinLoaded)):this._skinLoaded())}),r(0,n,"max",function(){return this.slider.max},function(t){this.slider.max=t}),r(0,n,"min",function(){return this.slider.min},function(t){this.slider.min=t}),r(0,n,"value",function(){return this._value},function(t){t!==this._value&&(this._value=t,this._isElastic||(this.slider._value!=t&&(this.slider._value=t,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),r(0,n,"isVertical",function(){return this.slider.isVertical},function(t){this.slider.isVertical=t}),r(0,n,"sizeGrid",function(){return this.slider.sizeGrid},function(t){this.slider.sizeGrid=t}),r(0,n,"scrollSize",function(){return this._scrollSize},function(t){this._scrollSize=t}),r(0,n,"target",function(){return this._target},function(t){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),this._target=t,t&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),r(0,n,"hide",function(){return this._hide},function(t){this._hide=t,this.visible=!t}),r(0,n,"showButtons",function(){return this._showButtons},function(t){this._showButtons=t,this.callLater(this.changeScrollBar)}),r(0,n,"touchScrollEnable",function(){return this._touchScrollEnable},function(t){this._touchScrollEnable=t,this.target=this._target}),r(0,n,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(t){this._mouseWheelEnable=t,this.target=this._target}),r(0,n,"tick",function(){return this.slider.tick},function(t){this.slider.tick=t}),e}(As),Xs=function(t){function e(t){this._tf=null,e.__super.call(this),void 0===t&&(t=""),this.text=t}s(e,"laya.ui.Label",t);var n=e.prototype;return n.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._tf=null},n.createChildren=function(){this.addChild(this._tf=new Cs)},n.changeText=function(t){this._tf.changeText(t)},n.measureWidth=function(){return this._tf.width},n.measureHeight=function(){return this._tf.height},r(0,n,"padding",function(){return this._tf.padding.join(",")},function(t){this._tf.padding=Ne.fillArray(tn.labelPadding,t,Number)}),r(0,n,"bold",function(){return this._tf.bold},function(t){this._tf.bold=t}),r(0,n,"align",function(){return this._tf.align},function(t){this._tf.align=t}),r(0,n,"text",function(){return this._tf.text},function(t){this._tf.text!=t&&(t&&(t=Ne.adptString(t+"")),this._tf.text=t,this.event("change"),this._width&&this._height||this.onCompResize())}),r(0,n,"italic",function(){return this._tf.italic},function(t){this._tf.italic=t}),r(0,n,"wordWrap",function(){return this._tf.wordWrap},function(t){this._tf.wordWrap=t}),r(0,n,"font",function(){return this._tf.font},function(t){this._tf.font=t}),r(0,n,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.text=t+"":i.superSet(As,this,"dataSource",t)}),r(0,n,"color",function(){return this._tf.color},function(t){this._tf.color=t}),r(0,n,"valign",function(){return this._tf.valign},function(t){this._tf.valign=t}),r(0,n,"leading",function(){return this._tf.leading},function(t){this._tf.leading=t}),r(0,n,"fontSize",function(){return this._tf.fontSize},function(t){this._tf.fontSize=t}),r(0,n,"bgColor",function(){return this._tf.bgColor},function(t){this._tf.bgColor=t}),r(0,n,"borderColor",function(){return this._tf.borderColor},function(t){this._tf.borderColor=t}),r(0,n,"stroke",function(){return this._tf.stroke},function(t){this._tf.stroke=t}),r(0,n,"strokeColor",function(){return this._tf.strokeColor},function(t){this._tf.strokeColor=t}),r(0,n,"textField",function(){return this._tf}),r(0,n,"width",function(){return this._width||this._tf.text?i.superGet(As,this,"width"):0},function(t){i.superSet(As,this,"width",t),this._tf.width=t}),r(0,n,"height",function(){return this._height||this._tf.text?i.superGet(As,this,"height"):0},function(t){i.superSet(As,this,"height",t),this._tf.height=t}),r(0,n,"overflow",function(){return this._tf.overflow},function(t){this._tf.overflow=t}),r(0,n,"underline",function(){return this._tf.underline},function(t){this._tf.underline=t}),r(0,n,"underlineColor",function(){return this._tf.underlineColor},function(t){this._tf.underlineColor=t}),e}(As),Hs=function(t){function e(t,i){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=0/0,this._listHeight=0/0,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,e.__super.call(this),this._itemColors=tn.comboBoxItemColors,this.skin=t,this.labels=i}s(e,"laya.ui.ComboBox",t);var n=e.prototype;return n.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._button&&this._button.destroy(e),this._list&&this._list.destroy(e),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},n.createChildren=function(){this.addChild(this._button=new Gs),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},n._createList=function(){this._list=new Hr,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},n._setListEvent=function(){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=_.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},n.onListDown=function(t){t.stopPropagation()},n.onScrollBarDown=function(t){t.stopPropagation()},n.onButtonMouseDown=function(){this.callLater(this.switchTo,[!this._isOpen])},n.measureWidth=function(){return this._button.width},n.measureHeight=function(){return this._button.height},n.changeList=function(){this._listChanged=!1;var t=this.width-2,e=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:t,height:this._itemHeight,fontSize:this._itemSize,color:e}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},n.onlistItemMouse=function(t,e){var i=t.type;if("mouseover"===i||"mouseout"===i){if(this._isCustomList)return;var n=this._list.getCell(e);if(!n)return;var s=n.getChildByName("label");s&&("mouseover"===i?(s.bgColor=this._itemColors[0],s.color=this._itemColors[1]):(s.bgColor=null,s.color=this._itemColors[2]))}else"click"===i&&(this.selectedIndex=e,this.isOpen=!1)},n.switchTo=function(t){this.isOpen=t},n.changeOpen=function(){this.isOpen=!this._isOpen},n.changeItem=function(){if(this._itemChanged=!1,this._listHeight=this._labels.length>0?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var t=this._list.graphics;t.clear(!0),t.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}var e=this._list.array||[];e.length=0;for(var i=0,n=this._labels.length;n>i;i++)e.push({label:this._labels[i]});this._list.height=this._listHeight,this._list.array=e},n.changeSelected=function(){this._button.label=this.selectedLabel},n._onStageMouseWheel=function(t){this._list&&!this._list.contains(t.target)&&this.removeList(null)},n.removeList=function(){i.stage.off("mousedown",this,this.removeList),i.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},r(0,n,"selectedIndex",function(){return this._selectedIndex},function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this._labels.length>0?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[se.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),r(0,n,"skin",function(){return this._button.skin},function(t){this._button.skin!=t&&(this._button.skin=t,this._listChanged=!0)}),r(0,n,"visibleNum",function(){return this._visibleNum},function(t){this._visibleNum=t,this._listChanged=!0}),r(0,n,"width",t.prototype._$get_width,function(t){i.superSet(As,this,"width",t),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),r(0,n,"selectedLabel",function(){return this._selectedIndex>-1&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(t){this.selectedIndex=this._labels.indexOf(t)}),r(0,n,"labels",function(){return this._labels.join(",")},function(t){this._labels.length>0&&(this.selectedIndex=-1),t?this._labels=t.split(","):this._labels.length=0,this._itemChanged=!0}),r(0,n,"height",t.prototype._$get_height,function(t){i.superSet(As,this,"height",t),this._button.height=this._height}),r(0,n,"selectHandler",function(){return this._selectHandler},function(t){this._selectHandler=t}),r(0,n,"labelBold",function(){return this._button.text.bold},function(t){this._button.text.bold=t}),r(0,n,"itemColors",function(){return String(this._itemColors)},function(t){this._itemColors=Ne.fillArray(this._itemColors,t,String),this._listChanged=!0}),r(0,n,"itemSize",function(){return this._itemSize},function(t){this._itemSize=t,this._listChanged=!0}),r(0,n,"scrollBar",function(){return this.list.scrollBar}),r(0,n,"isOpen",function(){return this._isOpen},function(t){if(this._isOpen!=t)if(this._isOpen=t,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var e=this.localToGlobal($i.TEMP.setTo(0,0)),n=e.y+this._button.height;n=n+this._listHeight<=i.stage.height?n:e.y-this._listHeight,this._list.pos(e.x,n),this._list.zOrder=1001,i._currentStage.addChild(this._list),i.stage.once("mousedown",this,this.removeList),i.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),r(0,n,"scrollBarSkin",function(){return this._scrollBarSkin},function(t){this._scrollBarSkin=t}),r(0,n,"sizeGrid",function(){return this._button.sizeGrid},function(t){this._button.sizeGrid=t}),r(0,n,"button",function(){return this._button}),r(0,n,"list",function(){return this._list||this._createList(),this._list},function(t){t&&(t.removeSelf(),this._isCustomList=!0,this._list=t,this._setListEvent(t),this._itemHeight=t.getCell(0).height+t.spaceY)}),r(0,n,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t,"number"==typeof t&&Math.floor(t)==t||"string"==typeof t?this.selectedIndex=parseInt(t):t instanceof Array?this.labels=t.join(","):i.superSet(As,this,"dataSource",t)}),r(0,n,"labelColors",function(){return this._button.labelColors},function(t){this._button.labelColors!=t&&(this._button.labelColors=t)}),r(0,n,"labelPadding",function(){return this._button.text.padding.join(",")},function(t){this._button.text.padding=Ne.fillArray(tn.labelPadding,t,Number)}),r(0,n,"labelSize",function(){return this._button.text.fontSize},function(t){this._button.text.fontSize=t}),r(0,n,"labelFont",function(){return this._button.text.font},function(t){this._button.text.font=t}),r(0,n,"stateNum",function(){return this._button.stateNum},function(t){this._button.stateNum=t}),e}(As),Ys=function(t){function e(t,i,n){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,e.__super.call(this),void 0===i&&(i=1),void 0===n&&(n=1),this._clipX=i,this._clipY=n,this.skin=t}s(e,"laya.ui.Clip",t);var n=e.prototype;return n.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},n.dispose=function(){this.destroy(!0),i.loader.clearRes(this._skin)},n.createChildren=function(){this.graphics=this._bitmap=new Mn},n._onDisplay=function(){this._isPlaying?this._getBit(128)?this.play():this.stop():this._autoPlay&&this.play()},n._skinLoaded=function(){this._setClipChanged(),this._sizeChanged(),this.event("loaded")},n.changeClip=function(){if(this._clipChanged=!1,this._skin){var t=un.getRes(this._skin);t?this.loadComplete(this._skin,t):i.loader.load(this._skin,_.create(this,this.loadComplete,[this._skin]))}},n.loadComplete=function(t,e){if(t===this._skin&&e){var i=this._clipWidth||Math.ceil(e.sourceWidth/this._clipX),n=this._clipHeight||Math.ceil(e.sourceHeight/this._clipY),s=this._skin+i+n,r=Ce.I.get(s);if(ee.isOkTextureList(r)||(r=null),r)this._sources=r;else{this._sources=[];for(var a=0;a<this._clipY;a++)for(var o=0;o<this._clipX;o++)this._sources.push(_n.createFromTexture(e,i*o,n*a,i,n));Ce.I.set(s,this._sources)}this.index=this._index,this.event("loaded"),this.onCompResize()}},n.measureWidth=function(){return this.runCallLater(this.changeClip),this._bitmap.width},n.measureHeight=function(){return this.runCallLater(this.changeClip),this._bitmap.height},n.play=function(t,e){void 0===t&&(t=0),void 0===e&&(e=-1),this._isPlaying=!0,this.index=t,this._toIndex=e,this._index++,i.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},n._loop=function(){this._visible&&this._sources&&(this._index++,this._toIndex>-1&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},n.stop=function(){this._isPlaying=!1,i.timer.clear(this,this._loop),this.event("complete")},n._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},r(0,n,"interval",function(){return this._interval},function(t){this._interval!=t&&(this._interval=t,this._isPlaying&&this.play())}),r(0,n,"skin",function(){return this._skin},function(t){this._skin!=t&&(this._skin=t,t?un.getRes(t)?this._skinLoaded():i.loader.load(this._skin,_.create(this,this._skinLoaded),null,"image",1):this._bitmap.source=null)}),r(0,n,"sources",function(){return this._sources},function(t){this._sources=t,this.index=this._index,this.event("loaded")}),r(0,n,"clipX",function(){return this._clipX},function(t){this._clipX=t||1,this._setClipChanged()}),r(0,n,"clipY",function(){return this._clipY},function(t){this._clipY=t||1,this._setClipChanged()}),r(0,n,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),r(0,n,"clipWidth",function(){return this._clipWidth},function(t){this._clipWidth=t,this._setClipChanged()}),r(0,n,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(t){this._bitmap.sizeGrid=Ne.fillArray(tn.defaultSizeGrid,t,Number)}),r(0,n,"group",function(){return this._group},function(t){t&&this._skin&&un.setGroup(this._skin,t),this._group=t}),r(0,n,"clipHeight",function(){return this._clipHeight},function(t){this._clipHeight=t,this._setClipChanged()}),r(0,n,"width",t.prototype._$get_width,function(t){i.superSet(As,this,"width",t),this._bitmap.width=t}),r(0,n,"height",t.prototype._$get_height,function(t){i.superSet(As,this,"height",t),this._bitmap.height=t}),r(0,n,"index",function(){return this._index},function(t){this._index=t,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[t]),this.event("change")}),r(0,n,"autoPlay",function(){return this._autoPlay},function(t){this._autoPlay!=t&&(this._autoPlay=t,t?this.play():this.stop())}),r(0,n,"isPlaying",function(){return this._isPlaying},function(t){this._isPlaying=t}),r(0,n,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t,"number"==typeof t&&Math.floor(t)==t||"string"==typeof t?this.index=parseInt(t):i.superSet(As,this,"dataSource",t)}),r(0,n,"bitmap",function(){return this._bitmap}),e}(As),js=function(t){function e(){this._targetDic=null,this._animationData=null,this._usedFrames=null,e.__super.call(this),null===e._sortIndexFun&&(e._sortIndexFun=Oe.sortByKey("index",!1,!0))}s(e,"laya.display.FrameAnimation",t);var i=e.prototype;return i._setUp=function(t,e){this._targetDic=t,this._animationData=e,this.interval=1e3/e.frameRate,e.parsed?(this._count=e.count,this._labels=e.labels,this._usedFrames=e.animationNewFrames):(this._usedFrames=[],this._calculateDatas(),e.parsed=!0,e.labels=this._labels,e.count=this._count,e.animationNewFrames=this._usedFrames)},i.clear=function(){return t.prototype.clear.call(this),this._targetDic=null,this._animationData=null,this},i._displayToIndex=function(t){if(this._animationData){0>t&&(t=0),t>this._count&&(t=this._count);var e=this._animationData.nodes,i=0,n=e.length;for(i=0;n>i;i++)this._displayNodeToFrame(e[i],t)}},i._displayNodeToFrame=function(t,e,i){i||(i=this._targetDic);var n=i[t.target];if(n){var s,r,a,o=t.frames,h=t.keys,l=0,_=h.length;for(l=0;_>l;l++)s=h[l],r=o[s],a=r.length>e?r[e]:r[r.length-1],n[s]=a;var u=t.funkeys;_=u.length;var c;if(0!=_)for(l=0;_>l;l++)s=u[l],c=o[s],void 0!==c[e]&&n[s]&&n[s].apply(n,c[e])}},i._calculateDatas=function(){if(this._animationData){var t,e=this._animationData.nodes,i=0,n=e.length;for(this._count=0,i=0;n>i;i++)t=e[i],this._calculateKeyFrames(t);this._count+=1}},i._calculateKeyFrames=function(t){var i,n,s=t.keyframes,r=t.target;t.frames||(t.frames={}),t.keys?t.keys.length=0:t.keys=[],t.funkeys?t.funkeys.length=0:t.funkeys=[],t.initValues||(t.initValues={});for(i in s){var a=-1!=i.indexOf("()");if(n=s[i],a&&(i=i.substr(0,i.length-2)),t.frames[i]||(t.frames[i]=[]),a){t.funkeys.push(i);for(var o=t.frames[i],h=0;h<n.length;h++){var l=n[h];o[l.index]=l.value,l.index>this._count&&(this._count=l.index)}}else this._targetDic&&this._targetDic[r]&&(t.initValues[i]=this._targetDic[r][i]),n.sort(e._sortIndexFun),t.keys.push(i),this._calculateNodePropFrames(n,t.frames[i],i,r)}},i.resetNodes=function(){if(this._targetDic&&this._animationData){var t,e,i=this._animationData.nodes,n=0,s=i.length;for(n=0;s>n;n++)if(t=i[n],e=t.initValues){var r=this._targetDic[t.target];if(r){var a;for(a in e)r[a]=e[a]}}}},i._calculateNodePropFrames=function(t,e){var i=0,n=t.length-1;for(e.length=t[n].index+1,i=0;n>i;i++)this._dealKeyFrame(t[i]),this._calculateFrameValues(t[i],t[i+1],e);0==n&&(e[0]=t[0].value,this._usedFrames&&(this._usedFrames[t[0].index]=!0)),this._dealKeyFrame(t[i])},i._dealKeyFrame=function(t){t.label&&""!=t.label&&this.addLabel(t.label,t.index)},i._calculateFrameValues=function(t,e,i){var n,s=0,r=t.index,a=e.index,o=t.value,h=e.value-t.value,l=a-r,_=this._usedFrames;if(a>this._count&&(this._count=a),t.tween)for(n=Ve[t.tweenMethod],null==n&&(n=Ve.linearNone),s=r;a>s;s++)i[s]=n(s-r,o,h,l),_&&(_[s]=!0);else for(s=r;a>s;s++)i[s]=o;_&&(_[t.index]=!0,_[e.index]=!0),i[e.index]=e.value},e._sortIndexFun=null,e}(Rs),Zs=function(t){function e(t){this._bitmap=null,this._skin=null,this._group=null,e.__super.call(this),this.skin=t}s(e,"laya.ui.Image",t);var n=e.prototype;return n.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null},n.dispose=function(){this.destroy(!0),i.loader.clearRes(this._skin)},n.createChildren=function(){this.graphics=this._bitmap=new Mn,this._bitmap.autoCacheCmd=!1},n.setSource=function(t,e){t===this._skin&&e&&(this.source=e,this.onCompResize())},n.measureWidth=function(){return this._bitmap.width},n.measureHeight=function(){return this._bitmap.height},r(0,n,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t,"string"==typeof t?this.skin=t:i.superSet(As,this,"dataSource",t)}),r(0,n,"source",function(){return this._bitmap.source},function(t){this._bitmap&&(this._bitmap.source=t,this.event("loaded"),this.repaint())}),r(0,n,"skin",function(){return this._skin},function(t){if(this._skin!=t)if(this._skin=t,t){var e=un.getRes(t);e?(this.source=e,this.onCompResize()):i.loader.load(this._skin,_.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),r(0,n,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(t){this._bitmap.sizeGrid=Ne.fillArray(tn.defaultSizeGrid,t,Number)}),r(0,n,"group",function(){return this._group},function(t){t&&this._skin&&un.setGroup(this._skin,t),this._group=t}),r(0,n,"width",t.prototype._$get_width,function(t){i.superSet(As,this,"width",t),this._bitmap.width=0==t?1e-7:t}),r(0,n,"height",t.prototype._$get_height,function(t){i.superSet(As,this,"height",t),this._bitmap.height=0==t?1e-7:t}),e}(As),qs=function(t){function e(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,e.__super.call(this)}s(e,"laya.ui.ColorPicker",t);var n=e.prototype;return n.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._colorPanel&&this._colorPanel.destroy(e),this._colorButton&&this._colorButton.destroy(e),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},n.createChildren=function(){this.addChild(this._colorButton=new Gs),this._colorPanel=new Us,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new kn),this._colorPanel.addChild(this._colorBlock=new kn),this._colorPanel.addChild(this._colorInput=new Ws)},n.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},n.onPanelMouseDown=function(t){t.stopPropagation()},n.changePanel=function(){this._panelChanged=!1;var t=this._colorPanel.graphics;t.clear(!0),t.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,t=this._colorTiles.graphics,t.clear(!0);for(var e=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],i=0;12>i;i++)for(var n=0;20>n;n++){var s=0;s=0===n?e[i]:1===n?0:51*(((3*i+n/6)%3<<0)+3*(i/6<<0))<<16|n%6*51<<8|(i<<0)%6*51;var r=Ne.toColor(s);this._colors.push(r);var a=n*this._gridSize,o=i*this._gridSize;t.drawRect(a,o,this._gridSize,this._gridSize,r,"#000000")}},n.onColorButtonClick=function(){this._colorPanel.parent?this.close():this.open()},n.open=function(){var t=this.localToGlobal(new $i),e=t.x+this._colorPanel.width<=i.stage.width?t.x:i.stage.width-this._colorPanel.width,n=t.y+this._colorButton.height;n=n+this._colorPanel.height<=i.stage.height?n:t.y-this._colorPanel.height,this._colorPanel.pos(e,n),this._colorPanel.zOrder=1001,i._currentStage.addChild(this._colorPanel),i.stage.on("mousedown",this,this.removeColorBox)},n.close=function(){i.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},n.removeColorBox=function(){this.close()},n.onColorFieldKeyDown=function(t){13==t.keyCode&&(this.selectedColor=this._colorInput.text?this._colorInput.text:null,this.close(),t.stopPropagation())},n.onColorInputChange=function(){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},n.onColorTilesClick=function(){this.selectedColor=this.getColorByMouse(),this.close()},n.onColorTilesMouseMove=function(){this._colorInput.focus=!1;var t=this.getColorByMouse();this._colorInput.text=t,this.drawBlock(t)},n.getColorByMouse=function(){var t=this._colorTiles.getMousePoint(),e=Math.floor(t.x/this._gridSize),i=Math.floor(t.y/this._gridSize);return this._colors[20*i+e]},n.drawBlock=function(t){var e=this._colorBlock.graphics;e.clear(!0);var i=t?t:"#ffffff";e.drawRect(0,0,50,20,i,this._borderColor),t||e.drawLine(0,0,50,20,"#ff0000")},n.changeColor=function(){var t=this.graphics;t.clear(!0);var e=this._selectedColor||"#000000";t.drawRect(0,0,this._colorButton.width,this._colorButton.height,e)},n._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},r(0,n,"inputBgColor",function(){return this._inputBgColor},function(t){this._inputBgColor=t,this._setPanelChanged()}),r(0,n,"selectedColor",function(){return this._selectedColor},function(t){this._selectedColor!=t&&(this._selectedColor=this._colorInput.text=t,this.drawBlock(t),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",se.EMPTY.setTo("change",this,this)))}),r(0,n,"skin",function(){return this._colorButton.skin},function(t){this._colorButton.once("loaded",this,this.changeColor),this._colorButton.skin=t}),r(0,n,"bgColor",function(){return this._bgColor},function(t){this._bgColor=t,this._setPanelChanged()}),r(0,n,"borderColor",function(){return this._borderColor},function(t){this._borderColor=t,this._setPanelChanged()}),r(0,n,"inputColor",function(){return this._inputColor},function(t){this._inputColor=t,this._setPanelChanged()}),e}(As),Ks=function(t){function e(t){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=0/0,this._ty=0/0,this._maxMove=0/0,this._globalSacle=null,e.__super.call(this),this.skin=t}s(e,"laya.ui.Slider",t);var a=e.prototype;return a.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._bg&&this._bg.destroy(e),this._bar&&this._bar.destroy(e),this._progress&&this._progress.destroy(e),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},a.createChildren=function(){this.addChild(this._bg=new Zs),this.addChild(this._bar=new Gs)},a.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},a.onBarMouseDown=function(){this._globalSacle||(this._globalSacle=new $i),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=i.stage.mouseX,this._ty=i.stage.mouseY,i.stage.on("mousemove",this,this.mouseMove),i.stage.once("mouseup",this,this.mouseUp),i.stage.once("mouseout",this,this.mouseUp),this.showValueText()},a.showValueText=function(){if(this.showLabel){var t=laya.ui.Slider.label;this.addChild(t),t.textField.changeText(this._value+""),this.isVertical?(t.x=this._bar._x+20,t.y=.5*(this._bar.height-t.height)+this._bar._y):(t.y=this._bar._y-20,t.x=.5*(this._bar.width-t.width)+this._bar._x)}},a.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},a.mouseUp=function(){i.stage.off("mousemove",this,this.mouseMove),i.stage.off("mouseup",this,this.mouseUp),i.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},a.mouseMove=function(){var t=this._value;this.isVertical?(this._bar.y+=(i.stage.mouseY-this._ty)/this._globalSacle.y,this._bar._y>this._maxMove?this._bar.y=this._maxMove:this._bar._y<0&&(this._bar.y=0),this._value=this._bar._y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar._y+.5*this._bar.height)):(this._bar.x+=(i.stage.mouseX-this._tx)/this._globalSacle.x,this._bar._x>this._maxMove?this._bar.x=this._maxMove:this._bar._x<0&&(this._bar.x=0),this._value=this._bar._x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar._x+.5*this._bar.width)),this._tx=i.stage.mouseX,this._ty=i.stage.mouseY;var e=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*e)/e,this._value!=t&&this.sendChangeEvent(),this.showValueText()},a.sendChangeEvent=function(t){void 0===t&&(t="change"),this.event(t),this.changeHandler&&this.changeHandler.runWith(this._value)},a._skinLoaded=function(){this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var t=this._skin.replace(".png","$progress.png");un.getRes(t)&&(this._progress||(this.addChild(this._progress=new Zs),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=t),this.setBarPoint(),this.callLater(this.changeValue),this._sizeChanged(),this.event("loaded")},a.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},a.measureWidth=function(){return Math.max(this._bg.width,this._bar.width)},a.measureHeight=function(){return Math.max(this._bg.height,this._bar.height)},a._sizeChanged=function(){t.prototype._sizeChanged.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},a.setSlider=function(t,e,i){this._value=-1,this._min=t,this._max=e>t?e:t,this.value=t>i?t:i>e?e:i},a.changeValue=function(){var t=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*t)/t,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var e=this._max-this._min;0===e&&(e=1),this.isVertical?(this._bar.y=(this._value-this._min)/e*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar._y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/e*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar._x+.5*this._bar.width))},a.onBgMouseDown=function(){var t=this._bg.getMousePoint();this.value=this.isVertical?t.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:t.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},r(0,a,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):i.superSet(As,this,"dataSource",t)}),r(0,a,"skin",function(){return this._skin},function(t){this._skin!=t&&(this._skin=t,this._skin&&!un.getRes(this._skin)?i.loader.load([this._skin,this._skin.replace(".png","$bar.png")],_.create(this,this._skinLoaded)):this._skinLoaded())}),r(0,a,"tick",function(){return this._tick},function(t){this._tick!=t&&(this._tick=t,this.callLater(this.changeValue))}),r(0,a,"sizeGrid",function(){return this._bg.sizeGrid},function(t){this._bg.sizeGrid=t,this._bar.sizeGrid=t,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),r(0,a,"allowClickBack",function(){return this._allowClickBack},function(t){this._allowClickBack!=t&&(this._allowClickBack=t,t?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),r(0,a,"max",function(){return this._max},function(t){this._max!=t&&(this._max=t,this.callLater(this.changeValue))}),r(0,a,"min",function(){return this._min},function(t){this._min!=t&&(this._min=t,this.callLater(this.changeValue))}),r(0,a,"bar",function(){return this._bar}),r(0,a,"value",function(){return this._value},function(t){if(this._value!=t){var e=this._value;this._value=t,this.changeValue(),this._value!=e&&this.sendChangeEvent()
}}),n(e,["label",function(){return this.label=new Xs}]),e}(As),$s=function(t){function e(t){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,e.__super.call(this),this.skin=t}s(e,"laya.ui.ProgressBar",t);var n=e.prototype;return n.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._bg&&this._bg.destroy(e),this._bar&&this._bar.destroy(e),this._bg=this._bar=null,this.changeHandler=null},n.createChildren=function(){this.addChild(this._bg=new Zs),this.addChild(this._bar=new Zs),this._bar._bitmap.autoCacheCmd=!1},n._skinLoaded=function(){this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue),this._sizeChanged(),this.event("loaded")},n.measureWidth=function(){return this._bg.width},n.measureHeight=function(){return this._bg.height},n.changeValue=function(){if(this.sizeGrid){var t=this.sizeGrid.split(","),e=Number(t[3]),i=Number(t[1]),n=this.width-e-i,s=n*this._value;this._bar.width=e+i+s,this._bar.visible=this._bar.width>e+i}else this._bar.width=this.width*this._value},r(0,n,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):i.superSet(As,this,"dataSource",t)}),r(0,n,"skin",function(){return this._skin},function(t){this._skin!=t&&(this._skin=t,this._skin&&!un.getRes(this._skin)?i.loader.load(this._skin,_.create(this,this._skinLoaded),null,"image",1):this._skinLoaded())}),r(0,n,"height",t.prototype._$get_height,function(t){i.superSet(As,this,"height",t),this._bg.height=this._height,this._bar.height=this._height}),r(0,n,"bar",function(){return this._bar}),r(0,n,"value",function(){return this._value},function(t){this._value!=t&&(t=t>1?1:0>t?0:t,this._value=t,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(t))}),r(0,n,"bg",function(){return this._bg}),r(0,n,"sizeGrid",function(){return this._bg.sizeGrid},function(t){this._bg.sizeGrid=this._bar.sizeGrid=t}),r(0,n,"width",t.prototype._$get_width,function(t){i.superSet(As,this,"width",t),this._bg.width=this._width,this.callLater(this.changeValue)}),e}(As),Js=function(t){function e(){this._frames=null,this._url=null,e.__super.call(this),this._setControlNode(this)}s(e,"laya.display.Animation",t);var n=e.prototype;return n.destroy=function(t){void 0===t&&(t=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,t),this._frames=null,this._labels=null},n.play=function(e,i,n){void 0===e&&(e=0),void 0===i&&(i=!0),void 0===n&&(n=""),n&&this._setFramesFromCache(n,!0),t.prototype.play.call(this,e,i,n)},n._setFramesFromCache=function(t,i){if(void 0===i&&(i=!1),this._url&&(t=this._url+"#"+t),t&&e.framesMap[t]){var n=e.framesMap[t];return n instanceof Array?(this._frames=e.framesMap[t],this._count=this._frames.length):(n.nodeRoot&&(e.framesMap[t]=sa.parseAnimationByData(n),n=e.framesMap[t]),this._frames=n.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=n.interval),this._labels=this._copyLabels(n.labels)),!0}return i&&console.log("ani not found:",t),!1},n._copyLabels=function(t){if(!t)return null;var e;e={};var i;for(i in t)e[i]=ee.copyArray([],t[i]);return e},n._frameLoop=function(){this._visible&&this._style.alpha>.01&&this._frames&&t.prototype._frameLoop.call(this)},n._displayToIndex=function(t){this._frames&&(this.graphics=this._frames[t])},n.clear=function(){return t.prototype.clear.call(this),this.stop(),this.graphics=null,this._frames=null,this._labels=null,this},n.loadImages=function(t,i){return void 0===i&&(i=""),this._url="",this._setFramesFromCache(i)||(this.frames=e.framesMap[i]?e.framesMap[i]:e.createFrames(t,i)),this},n.loadAtlas=function(t,n,s){function r(i){t===i&&(a.frames=e.framesMap[s]?e.framesMap[s]:e.createFrames(t,s),n&&n.run())}void 0===s&&(s=""),this._url="";var a=this;return a._setFramesFromCache(s)||(un.getAtlas(t)?r(t):i.loader.load(t,_.create(null,r,[t]),null,"atlas")),this},n.loadAnimation=function(t,e,n){this._url=t;var s=this;return this._actionName||(this._actionName=""),s._setFramesFromCache(this._actionName)?(s._setFramesFromCache(this._actionName,!0),this.index=0,e&&e.run()):!n||un.getAtlas(n)?this._loadAnimationData(t,e,n):i.loader.load(n,_.create(this,this._loadAnimationData,[t,e,n]),null,"atlas"),this},n._loadAnimationData=function(t,n,s){function r(i){if(un.getRes(i)&&t===i){var s;if(e.framesMap[t+"#"])o._setFramesFromCache(a._actionName,!0),a.index=0,a._resumePlay();else{var r=sa.parseAnimationData(un.getRes(t));if(!r)return;var h,l=r.animationList,_=0,u=l.length;for(_=0;u>_;_++)s=l[_],e.framesMap[t+"#"+s.name]=s,h||(h=s);h&&(e.framesMap[t+"#"]=h,o._setFramesFromCache(a._actionName,!0),a.index=0),a._resumePlay()}n&&n.run()}}var a=this;if(s&&!un.getAtlas(s))return console.warn("atlas load fail:"+s),void 0;var o=this;un.getRes(t)?r(t):i.loader.load(t,_.create(null,r,[t]),null,"json"),un.clearRes(t)},r(0,n,"frames",function(){return this._frames},function(t){this._frames=t,t&&(this._count=t.length,this._actionName&&this._setFramesFromCache(this._actionName,!0),this.index=this._index)}),r(0,n,"autoPlay",null,function(t){t?this.play():this.stop()}),r(0,n,"source",null,function(t){t.indexOf(".ani")>-1?this.loadAnimation(t):t.indexOf(".json")>-1||t.indexOf("als")>-1||t.indexOf("atlas")>-1?this.loadAtlas(t):this.loadImages(t.split(","))}),r(0,n,"autoAnimation",null,function(t){this.play(0,!0,t)}),e.createFrames=function(t,i){var n;if("string"==typeof t){var s=un.getAtlas(t);if(s&&s.length){n=[];for(var r=0,a=s.length;a>r;r++){var o=new ze;o.drawImage(un.getRes(s[r]),0,0),n.push(o)}}}else if(t instanceof Array)for(n=[],r=0,a=t.length;a>r;r++)o=new ze,o.loadImage(t[r],0,0),n.push(o);return i&&(e.framesMap[i]=n),n},e.clearCache=function(t){var i,n=e.framesMap,s=t+"#";for(i in n)(i===t||0===i.indexOf(s))&&delete e.framesMap[i]},e.framesMap={},e}(Rs),Qs=function(t){function e(t,i){this._floatArray32=null,this._uint32Array=null,this._vertexStride=0,e.__super.call(this),this._vertexStride=t,this._bufferUsage=i,this._bufferType=34962,this._buffer=new ArrayBuffer(8),this._floatArray32=new Float32Array(this._buffer),this._uint32Array=new Uint32Array(this._buffer)}s(e,"laya.webgl.utils.VertexBuffer2D",t);var i=e.prototype;return i.getFloat32Array=function(){return this._floatArray32},i.appendArray=function(t){var e=this._byteLength>>2;this.setByteLength(this._byteLength+4*t.length);var i=this.getFloat32Array();i.set(t,e),this._upload=!0},i._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer)),this._uint32Array&&(this._uint32Array=new Uint32Array(this._buffer))},i.deleteBuffer=function(){this._disposeResource()},i._bindForVAO=function(){we.instance.bindBuffer(34962,this._glBuffer)},i.bind=function(){return ms._bindedVertexBuffer!==this._glBuffer?(we.instance.bindBuffer(34962,this._glBuffer),ms._bindedVertexBuffer=this._glBuffer,!0):!1},i.destroy=function(){laya.resource.Resource.prototype.destroy.call(this),this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},r(0,i,"vertexStride",function(){return this._vertexStride}),e.create=function(t,i){return void 0===i&&(i=35048),new e(t,i)},e}(Ps),tr=function(t){function e(t){this._uint16Array=null,void 0===t&&(t=35044),e.__super.call(this),this._bufferUsage=t,this._bufferType=34963,this._buffer=new ArrayBuffer(8)}s(e,"laya.webgl.utils.IndexBuffer2D",t);var i=e.prototype;return i._checkArrayUse=function(){this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},i.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},i._bindForVAO=function(){we.instance.bindBuffer(34963,this._glBuffer)},i.bind=function(){return ms._bindedIndexBuffer!==this._glBuffer?(we.instance.bindBuffer(34963,this._glBuffer),ms._bindedIndexBuffer=this._glBuffer,!0):!1},i.destory=function(){this._uint16Array=null,this._buffer=null},i.disposeResource=function(){this._disposeResource()},e.create=function(t){return void 0===t&&(t=35044),new e(t)},e}(Ps),er=function(t){function e(t,i,n,s,r){this._params2dQuick2=null,this._shaderValueWidth=0,this._shaderValueHeight=0,e.__super.call(this,t,i,n,s,r)}s(e,"laya.webgl.shader.d2.Shader2X",t);var i=e.prototype;return i._disposeResource=function(){t.prototype._disposeResource.call(this),this._params2dQuick2=null},i.upload2dQuick2=function(t){this.upload(t,this._params2dQuick2||this._make2dQuick2())},i._make2dQuick2=function(){if(!this._params2dQuick2){this._params2dQuick2=[];for(var t,e=this._params,i=0,n=e.length;n>i;i++)t=e[i],"size"!==t.name&&this._params2dQuick2.push(t)}return this._params2dQuick2},e.create=function(t,i,n,s,r){return new e(t,i,n,s,r)},e}(Ls),ir=function(t){function e(t,i,n,s){this._mgrKey=0,void 0===n&&(n=0),void 0===s&&(s=0),e.__super.call(this,n,!1),this._glTextureType=3553,this._width=t,this._height=i,this._depthStencilFormat=s,this._create(t,i)}s(e,"laya.webgl.resource.RenderTexture2D",t);var i=e.prototype;return i.getIsReady=function(){return!0},i._create=function(t,e){var i=we.instance;this._frameBuffer=i.createFramebuffer(),ye.bindTexture(i,this._glTextureType,this._glTexture);var n=this._getGLFormat();if(i.texImage2D(this._glTextureType,0,n,t,e,0,n,5121,null),this._setGPUMemory(t*e*4),i.bindFramebuffer(36160,this._frameBuffer),i.framebufferTexture2D(36160,36064,3553,this._glTexture,0),3!==this._depthStencilFormat)switch(this._depthStencilBuffer=i.createRenderbuffer(),i.bindRenderbuffer(36161,this._depthStencilBuffer),this._depthStencilFormat){case 0:i.renderbufferStorage(36161,33189,t,e),i.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 1:i.renderbufferStorage(36161,36168,t,e),i.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 2:i.renderbufferStorage(36161,34041,t,e),i.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer);break;default:console.log("RenderTexture: unkonw depth format.")}i.bindFramebuffer(36160,null),i.bindRenderbuffer(36161,null),this._setWarpMode(10242,this._wrapModeU),this._setWarpMode(10243,this._wrapModeV),this._setFilterMode(this._filterMode),this._setAnisotropy(this._anisoLevel),this._readyed=!0,this._activeResource()},i.generateMipmap=function(){this._isPot(this.width)&&this._isPot(this.height)?(this._mipmap=!0,we.instance.generateMipmap(this._glTextureType),this._setFilterMode(this._filterMode),this._setGPUMemory(this.width*this.height*4*(1+1/3))):(this._mipmap=!1,this._setGPUMemory(this.width*this.height*4))},i.start=function(){var t=we.instance;we.instance.bindFramebuffer(36160,this._frameBuffer),e._currentActive=this,this._readyed=!0,t.viewport(0,0,this._width,this._height),this._lastWidth=pi.width,this._lastHeight=pi.height,pi.width=this._width,pi.height=this._height,ps.activeShader=null},i.end=function(){we.instance.bindFramebuffer(36160,null),e._currentActive=null,this._readyed=!0},i.restore=function(){var t=we.instance;this._lastRT!=e._currentActive&&(we.instance.bindFramebuffer(36160,this._lastRT?this._lastRT._frameBuffer:null),e._currentActive=this._lastRT),this._readyed=!0,t.viewport(0,0,this._lastWidth,this._lastHeight),pi.width=this._lastWidth,pi.height=this._lastHeight,ps.activeShader=null},i.clear=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1);var s=we.instance;s.clearColor(t,e,i,n);var r=16384;switch(this._depthStencilFormat){case 33189:r|=256;break;case 36168:r|=1024;break;case 34041:r|=256,r|=1024}s.clear(r)},i.getData=function(t,e,i,n){var s=we.instance;s.bindFramebuffer(36160,this._frameBuffer);var r=36053===s.checkFramebufferStatus(36160);if(!r)return s.bindFramebuffer(36160,null),null;var a=new Uint8Array(this._width*this._height*4),o=this._getGLFormat();return s.readPixels(t,e,i,n,o,5121,a),s.bindFramebuffer(36160,null),a},i._disposeResource=function(){if(this._frameBuffer){var t=we.instance;t.deleteTexture(this._glTexture),t.deleteFramebuffer(this._frameBuffer),t.deleteRenderbuffer(this._depthStencilBuffer),this._glTexture=null,this._frameBuffer=null,this._depthStencilBuffer=null,this._setGPUMemory(0)}},r(0,i,"depthStencilFormat",function(){return this._depthStencilFormat}),r(0,i,"defaulteTexture",function(){return nr.grayTexture}),r(0,i,"sourceWidth",function(){return this._width}),r(0,i,"sourceHeight",function(){return this._height}),r(0,i,"offsetX",function(){return 0}),r(0,i,"offsetY",function(){return 0}),r(1,e,"currentActive",function(){return e._currentActive},laya.webgl.resource.BaseTexture._$SET_currentActive),e.pushRT=function(){e.rtStack.push({rt:e._currentActive,w:pi.width,h:pi.height})},e.popRT=function(){var t=we.instance,i=e.rtStack.pop();i&&(e._currentActive!=i.rt&&(we.instance.bindFramebuffer(36160,i.rt?i.rt._frameBuffer:null),e._currentActive=i.rt),t.viewport(0,0,i.w,i.h),pi.width=i.w,pi.height=i.h)},e._currentActive=null,e.rtStack=[],n(e,["defuv",function(){return this.defuv=[0,0,1,0,1,1,0,1]},"flipyuv",function(){return this.flipyuv=[0,1,1,1,1,0,0,0]}]),e}(ws),nr=function(t){function e(t,i,n,s,r){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=!0),void 0===r&&(r=!1),e.__super.call(this,n,s),this._glTextureType=3553,this._width=t,this._height=i,this._canRead=r,this._setWarpMode(10242,this._wrapModeU),this._setWarpMode(10243,this._wrapModeV),Ti.is2DPixelArtGame&&(this._filterMode=0),this._setFilterMode(this._filterMode),this._setAnisotropy(this._anisoLevel)}s(e,"laya.webgl.resource.Texture2D",t);var n=e.prototype;return n._calcualatesCompressedDataSize=function(t,e,i){switch(t){case 3:case 5:return(e+3>>2)*(i+3>>2)*8;case 4:return(e+3>>2)*(i+3>>2)*16;case 11:case 12:return Math.floor((Math.max(e,8)*Math.max(i,8)*4+7)/8);case 9:case 10:return Math.floor((Math.max(e,16)*Math.max(i,8)*2+7)/8);default:return 0}},n._pharseDDS=function(t){var e=827611204,i=894720068,n=4,s=131072,r=542327876,a=31,o=0,h=1,l=2,_=3,u=4,c=7,d=20,f=21,p=new Int32Array(t,0,a);if(p[o]!=r)throw"Invalid magic number in DDS header";if(!(p[d]&n))throw"Unsupported format, must contain a FourCC code";var m=p[f];switch(this._format){case 3:if(m!==e)throw"the FourCC code is not same with texture format.";break;case 4:if(m!==i)throw"the FourCC code is not same with texture format.";break;default:throw"unknown texture format."}var g=1;if(p[l]&s){if(g=Math.max(1,p[c]),!this._mipmap)throw"the mipmap is not same with Texture2D."}else if(this._mipmap)throw"the mipmap is not same with Texture2D.";var v=p[u],y=p[_];if(this._width!==v||this._height!==y)throw"the width or height is not same with Texture2D.";var E=p[h]+4;this._upLoadCompressedTexImage2D(t,v,y,g,E,0)},n._pharseKTX=function(t){var e=13,i=4,n=7,s=6,r=11,a=12,o=new Uint8Array(t,0,12);if(171!=o[0]||75!=o[1]||84!=o[2]||88!=o[3]||32!=o[4]||49!=o[5]||49!=o[6]||187!=o[7]||13!=o[8]||10!=o[9]||26!=o[10]||10!=o[11])throw"Invalid fileIdentifier in KTX header";var h=new Int32Array(o.buffer,o.length,e),l=h[i],_=this._getGLFormat();switch(this._format){case 5:if(l!==_)throw"the format  is not same with texture format FORMAT_ETC1RGB.";break;default:throw"unknown texture format."}var u=h[r],c=h[s],d=h[n];if(this._width!==c||this._height!==d)throw"the width or height is not same with Texture2D.";var f=64+h[a];this._upLoadCompressedTexImage2D(t,c,d,u,f,4)},n._pharsePVR=function(t){var e=0,i=1,n=2,s=3,r=6,a=55727696,o=13,h=0,l=2,_=6,u=7,c=11,d=12,f=new Int32Array(t,0,o);if(f[h]!=a)throw"Invalid magic number in PVR header";var p=f[l];switch(this._format){case 5:if(p!==r)throw"the format  is not same with texture format FORMAT_ETC1RGB.";break;case 9:if(p!==e)throw"the format  is not same with texture format FORMAT_PVRTCRGB_2BPPV.";break;case 11:if(p!==n)throw"the format  is not same with texture format FORMAT_PVRTCRGB_4BPPV.";break;case 10:if(p!==i)throw"the format  is not same with texture format FORMAT_PVRTCRGBA_2BPPV.";break;case 12:if(p!==s)throw"the format  is not same with texture format FORMAT_PVRTCRGBA_4BPPV.";break;default:throw"unknown texture format."}var m=f[c],g=f[u],v=f[_];if(this._width!==g||this._height!==v)throw"the width or height is not same with Texture2D.";var y=f[d]+52;this._upLoadCompressedTexImage2D(t,g,v,m,y,0)},n._upLoadCompressedTexImage2D=function(t,e,i,n,s,r){var a=we.instance,o=this._glTextureType;ye.bindTexture(a,o,this._glTexture);for(var h=this._getGLFormat(),l=s,_=0;n>_;_++){l+=r;var u=this._calcualatesCompressedDataSize(this._format,e,i),c=new Uint8Array(t,l,u);a.compressedTexImage2D(o,_,h,e,i,0,c),e>>=1,i>>=1,l+=u}var d=l;this._setGPUMemory(d),this._readyed=!0,this._activeResource()},n.loadImageSource=function(t,e){void 0===e&&(e=!1);var i=t.width,n=t.height;this._width=i,this._height=n,this._setWarpMode(10242,this._wrapModeU),this._setWarpMode(10243,this._wrapModeV),this._setFilterMode(this._filterMode);var s=we.instance;ye.bindTexture(s,this._glTextureType,this._glTexture);var r=this._getGLFormat();Ni.isConchApp?(t.setPremultiplyAlpha(e),s.texImage2D(this._glTextureType,0,6408,6408,5121,t)):(e&&s.pixelStorei(37441,!0),s.texImage2D(this._glTextureType,0,r,r,5121,t),e&&s.pixelStorei(37441,!1)),this._mipmap&&this._isPot(i)&&this._isPot(n)?(s.generateMipmap(this._glTextureType),this._setGPUMemory(i*n*4*(1+1/3))):this._setGPUMemory(i*n*4),this._canRead&&(Ni.isConchApp?this._pixels=new Uint8Array(t._nativeObj.getImageData(0,0,i,n)):(Be.canvas.size(i,n),Be.canvas.clear(),Be.context.drawImage(t,0,0,i,n),this._pixels=new Uint8Array(Be.context.getImageData(0,0,i,n).data.buffer))),this._readyed=!0,this._activeResource()},n.setPixels=function(t,e){if(void 0===e&&(e=0),!t)throw"Texture2D:pixels can't be null.";var i=this._width,n=this._height,s=we.instance,r=this._glTextureType;ye.bindTexture(s,r,this._glTexture);var a=this._getGLFormat();s.texImage2D(r,e,a,i,n,0,a,5121,t),this._mipmap&&this._isPot(i)&&this._isPot(n)?(s.generateMipmap(r),this._setGPUMemory(i*n*4*(1+1/3))):this._setGPUMemory(i*n*4),this._canRead&&(this._pixels=t),this._readyed=!0,this._activeResource()},n.setCompressData=function(t){switch(this._format){case 3:case 4:this._pharseDDS(t);break;case 5:this._pharseKTX(t);break;case 9:case 10:case 11:case 12:this._pharsePVR(t);break;default:throw"Texture2D:unkonwn format."}},n._recoverResource=function(){},n.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},r(0,n,"defaulteTexture",function(){return laya.webgl.resource.Texture2D.grayTexture}),e.__init__=function(){var t=new Uint8Array(3);t[0]=128,t[1]=128,t[2]=128,e.grayTexture=new e(1,1,0,!1,!1),e.grayTexture.setPixels(t),e.grayTexture.lock=!0},e._parse=function(t,i,n){var s=n?new e(n[0],n[1],n[2],n[3],n[4]):new e(0,0);switch(i&&(s.wrapModeU=i.wrapModeU,s.wrapModeV=i.wrapModeV,s.filterMode=i.filterMode,s.anisoLevel=i.anisoLevel),s._format){case 0:case 1:s.loadImageSource(t);break;case 3:case 4:case 5:case 9:case 10:case 11:case 12:s.setCompressData(t);break;default:throw"Texture2D:unkonwn format."}return s},e.load=function(t,e){i.loader.create(t,e,null,"TEXTURE2D")},e.grayTexture=null,e}(ws),sr=function(t){function e(){this.btnadd=null,this.inputsearch=null,this.btnsearch=null,this.list_address=null,this.btnok=null,this.btncancel=null,e.__super.call(this)}s(e,"ui.order.SelectAddressPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("order/SelectAddressPanel")},e}(Os),rr=function(t){function e(){this.conName=null,this.phonetxt=null,this.detailaddr=null,this.btnDel=null,this.btnEdit=null,this.btndefault=null,e.__super.call(this)}s(e,"ui.usercenter.AddressItemUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:886,height:90},compId:2,child:[{type:"Image",props:{top:0,skin:"commers/inputbg.png",sizeGrid:"3,3,3,3",right:0,left:0,bottom:0},compId:17},{type:"Label",props:{y:36,x:12,width:145,"var":"conName",valign:"middle",text:"徐建华",height:24,fontSize:18,font:"SimHei",color:"#354052",align:"left"},compId:3},{type:"Label",props:{y:34,x:156,width:156,"var":"phonetxt",valign:"middle",text:"13564113173",height:24,fontSize:18,font:"SimHei",color:"#354052",align:"left"},compId:5},{type:"Label",props:{y:0,x:316,wordWrap:!0,width:368,"var":"detailaddr",valign:"middle",text:"上海市浦东新区周浦镇瑞浦路612弄23号1001室",height:90,fontSize:18,font:"SimHei",color:"#354052",align:"left"},compId:6},{type:"Text",props:{y:36,x:750,"var":"btnDel",text:"删除",presetID:1,fontSize:16,font:"SimHei",color:"#354052",isPresetRoot:!0,runtime:"laya.display.Text"},compId:8,child:[{type:"Script",props:{presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:9}]},{type:"Text",props:{y:36,x:731,width:8,text:"|",presetID:1,height:16,fontSize:16,font:"SimHei",color:"#354052",isPresetRoot:!0,runtime:"laya.display.Text"},compId:14},{type:"Text",props:{y:36,x:688,"var":"btnEdit",text:"编辑",presetID:1,fontSize:16,font:"SimHei",color:"#354052",isPresetRoot:!0,runtime:"laya.display.Text"},compId:7,child:[{type:"Script",props:{presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:4}]},{type:"Text",props:{y:36,x:792,text:"|",presetID:1,fontSize:16,font:"SimHei",color:"#354052",isPresetRoot:!0,runtime:"laya.display.Text"},compId:16},{type:"Text",props:{y:36,x:811,width:47,"var":"btndefault",text:"设为默认",presetID:1,height:12,fontSize:16,font:"SimHei",color:"#354052",isPresetRoot:!0,runtime:"laya.display.Text"},compId:11,child:[{type:"Script",props:{presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:12}]}],loadList:["commers/inputbg.png","prefabs/LinksText.prefab"],loadList3D:[]},e}(Os),ar=function(t){function e(){this.bg=null,this.productname=null,e.__super.call(this)}s(e,"ui.login.CityAreaItemUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:170,height:26},compId:2,child:[{type:"Image",props:{"var":"bg",top:0,skin:"commers/grayback.jpg",right:0,left:0,bottom:0},compId:5},{type:"Label",props:{width:170,"var":"productname",valign:"middle",top:0,text:"江西省",left:0,height:24,fontSize:16,font:"SimHei",color:"#262B2E",align:"center"},compId:3}],loadList:["commers/grayback.jpg"],loadList3D:[]},e}(Os),or=function(t){function e(){this.list_address=null,this.okbtn=null,this.cancelbtn=null,e.__super.call(this)}s(e,"ui.order.SelectFactoryPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("order/SelectFactoryPanel")},e}(Os),hr=function(t){function e(){this.accout=null,this.moneytxt=null,this.chargeinput=null,this.tyepgrp=null,this.confirmcharge=null,e.__super.call(this)}s(e,"ui.usercenter.ChargePanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("usercenter/ChargePanel")},e}(Os),lr=function(t){function e(){this.qqContact=null,this.factorytxt=null,this.checkselect=null,e.__super.call(this)}s(e,"ui.order.OutPutCenterUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:0,height:40},compId:2,child:[{type:"Box",props:{y:0,x:0},compId:3,child:[{type:"Button",props:{y:0,x:600,width:128,"var":"qqContact",skin:"commers/btn1.png",sizeGrid:"3,3,3,3",labelSize:18,labelFont:"SimHei",labelColors:"#FFFFFF,#FFFFFF,#FFFFFF",label:"qq交谈",height:40},compId:5},{type:"Text",props:{y:5,x:68,"var":"factorytxt",text:"更改输出中心",presetID:1,fontSize:22,font:"SimHei",color:"#39B25A",isPresetRoot:!0,runtime:"laya.display.Text"},compId:6,child:[{type:"Script",props:{txttype:2,presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:7}]},{type:"CheckBox",props:{y:11,x:19,"var":"checkselect",skin:"commers/multicheck.png",scaleY:1,scaleX:1,mouseEnabled:!1,labelSize:20},compId:8}]}],loadList:["commers/btn1.png","prefabs/LinksText.prefab","commers/multicheck.png"],loadList3D:[]},e}(Os),_r=function(t){function e(){this.selbtn=null,e.__super.call(this)}s(e,"ui.order.TabChooseBtnUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{},compId:2,child:[{type:"Button",props:{y:0,x:0,width:194,"var":"selbtn",stateNum:3,skin:"order/selection.png",sizeGrid:"3,3,3,3",labelSize:16,labelFont:"SimHei",labelColors:"#262B2E,#463B4E,#262B2E",label:"户内PP背胶（户内写真）",height:42},compId:3}],loadList:["order/selection.png"],loadList3D:[]},e}(Os),ur=(function(t){function e(){this.firstPage=null,this.myorder=null,this.userName=null,this.logout=null,e.__super.call(this)}s(e,"ui.TopBannerUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:1920},compId:2,child:[{type:"Sprite",props:{y:0,x:0,texture:"commers/bgimg.jpg"},compId:3},{type:"Sprite",props:{y:18,x:320,texture:"commers/logotxt.png"},compId:4},{type:"Label",props:{y:28,x:512,text:"|",fontSize:20,font:"Microsoft YaHei",color:"#fdf9f9"},compId:5},{type:"Text",props:{y:28,x:528,width:40,"var":"firstPage",text:"首页",rotation:0,presetID:1,height:20,fontSize:20,font:"Microsoft YaHei",color:"#f8f0ef",isPresetRoot:!0,runtime:"laya.display.Text"},compId:6,child:[{type:"Script",props:{undercolor:"#FFFFFF",txttype:1,presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:7}]},{type:"Text",props:{y:28,x:998,"var":"myorder",text:"我的订单",presetID:1,fontSize:20,font:"Microsoft YaHei",color:"#f8f0ef",isPresetRoot:!0,runtime:"laya.display.Text"},compId:8,child:[{type:"Script",props:{undercolor:"#FFFFFF",txttype:1,presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:9}]},{type:"Text",props:{y:28,x:1095,width:121,"var":"userName",text:"13800000000",presetID:1,overflow:"hidden",fontSize:20,font:"Microsoft YaHei",color:"#EDFFEC",align:"right",isPresetRoot:!0,runtime:"laya.display.Text"},compId:10,child:[{type:"Script",props:{txttype:1,presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:12}]},{type:"Text",props:{y:28,x:1223,width:73,"var":"logout",text:"[退出]",presetID:1,fontSize:20,font:"Microsoft YaHei",color:"#EDFFEC",align:"left",isPresetRoot:!0,runtime:"laya.display.Text"},compId:11,child:[{type:"Script",props:{txttype:1,presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:13}]},{type:"Label",props:{y:28,x:1083,text:"|",fontSize:20,font:"Microsoft YaHei",color:"#fdf9f9"},compId:14},{type:"Script",props:{runtime:"script.prefabScript.TopBannerControl"},compId:15}],loadList:["commers/bgimg.jpg","commers/logotxt.png","prefabs/LinksText.prefab"],loadList3D:[]},e}(Os),function(t){function e(){this.btnsel=null,this.selCheck=null,this.addresstxt=null,e.__super.call(this)}s(e,"ui.order.OrderAddressItemUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{},compId:2,child:[{type:"Button",props:{y:0,x:0,width:1090,"var":"btnsel",skin:"order/chooseadd.png",sizeGrid:"3,3,3,3",height:50},compId:6},{type:"Radio",props:{y:17,x:22,"var":"selCheck",skin:"commers/checksingle.png",mouseEnabled:!1},compId:7},{type:"Label",props:{y:17,x:60,"var":"addresstxt",text:"浙江省 金华市 义乌市 抽成街道",mouseEnabled:!1,height:18,fontSize:18,font:"SimHei",color:"#262B2E"},compId:8}],loadList:["order/chooseadd.png","commers/checksingle.png"],loadList3D:[]},e}(Os)),cr=function(t){function e(){this.servicetxt=null,this.chargebtn=null,this.moneytxt=null,this.account=null,this.reditcode=null,this.shortname=null,this.input_companyname=null,this.btnSelProv=null,this.province=null,this.btnSelCity=null,this.citytxt=null,this.btnSelArea=null,this.areatxt=null,this.detail_addr=null,this.txt_license=null,this.btn_uplicense=null,this.provbox=null,this.provList=null,this.citybox=null,this.cityList=null,this.areabox=null,this.areaList=null,this.btnsave=null,this.btnSelTown=null,this.towntxt=null,this.townbox=null,this.townList=null,e.__super.call(this)}s(e,"ui.usercenter.EnterPrizeInfoPaneUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("usercenter/EnterPrizeInfoPane")},e}(Os),dr=function(t){function e(){this.panelout=null,this.firstPage=null,this.myorder=null,this.userName=null,this.logout=null,this.myaddresstxt=null,this.outputbox=null,this.fengeimg=null,this.floatpt=null,this.floatdocker=null,this.selectAll=null,this.productNum=null,this.btnaddpic=null,this.batchChange=null,this.mainvbox=null,this.ordervbox=null,this.deliversp=null,this.deliverbox=null,this.batchcomment=null,this.commentall=null,this.textTotalPrice=null,this.textDeliveryType=null,this.textPayPrice=null,this.btnsaveorder=null,this.btnordernow=null,e.__super.call(this)}s(e,"ui.PaintOrderPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("PaintOrderPanel")},e}(Os),fr=function(t){function e(){this.btnaddAddress=null,this.addlist=null,this.numAddress=null,e.__super.call(this)}s(e,"ui.usercenter.AddressMgrPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("usercenter/AddressMgrPanel")},e}(Os),pr=function(t){function e(){this.mainpanel=null,this.orderoanel=null,this.orderbox=null,this.closebtn=null,this.outputtxt=null,e.__super.call(this)}s(e,"ui.usercenter.OrderDetailPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("usercenter/OrderDetailPanel")},e}(Os),mr=function(t){function e(){this.cancelbtn=null,this.paybtn=null,this.accountmoney=null,this.needpay=null,this.payall=null,this.paytype=null,this.realpay=null,e.__super.call(this)}s(e,"ui.order.ConfirmOrderPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("order/ConfirmOrderPanel")},e}(Os),gr=function(t){function e(){this.techBtn=null,e.__super.call(this)}s(e,"ui.order.TechorItemUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{},compId:2,child:[{type:"Button",props:{y:0,x:0,width:140,"var":"techBtn",skin:"order/selection.png",sizeGrid:"3,3,3,3",labelSize:16,labelFont:"SimHei",labelColors:"#262B2E,#262B2E,#262B2E",label:"户内PP背胶",height:40},compId:9}],loadList:["order/selection.png"],loadList3D:[]},e}(Os),vr=function(t){function e(){e.__super.call(this)}s(e,"ui.product.TreeClipUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:0,height:0},compId:2,child:[{type:"Clip",props:{y:0,x:13,skin:"comp/clip_selectBox.png",name:"selectBox",clipY:2,clipX:1},compId:3},{type:"Clip",props:{y:4,x:14,skin:"comp/clip_tree_folder.png",name:"folder",clipY:3,clipX:1},compId:4},{type:"Clip",props:{y:5,x:0,skin:"comp/clip_tree_arrow.png",name:"arrow",clipY:3,clipX:1},compId:5},{type:"Label",props:{y:1,x:33,width:76,valign:"middle",text:"商品名称",name:"label",height:16},compId:6}],loadList:["comp/clip_selectBox.png","comp/clip_tree_folder.png","comp/clip_tree_arrow.png"],loadList3D:[]},e}(Os),yr=function(t){function e(){this.bgimg=null,this.input_account=null,this.input_pwd=null,this.btn_login=null,this.closebtn=null,this.txt_forget=null,this.txt_reg=null,e.__super.call(this)}s(e,"ui.login.LogPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("login/LogPanel")},e}(Os),Er=function(t){function e(){this.flder0=null,this.htmltext=null,this.radiosel=null,this.btnroot=null,this.btnprevfolder=null,this.searchInput=null,this.filetypeRadio=null,this.btnok=null,this.picList=null,this.flder1=null,this.flder2=null,this.btncancel=null,e.__super.call(this)
}s(e,"ui.order.SelectPicPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("order/SelectPicPanel")},e}(Os),Sr=function(t){function e(){this.inputmsg=null,this.btnok=null,this.btncancel=null,e.__super.call(this)}s(e,"ui.order.AddCommentPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("order/AddCommentPanel")},e}(Os),Ar=function(t){function e(){this.bgimg=null,this.input_phone=null,this.input_pwd=null,this.input_conpwd=null,this.inputCode=null,this.txtRefresh=null,this.input_phonecode=null,this.btnGetCode=null,this.btnClose=null,this.btnReg=null,this.contractpanel=null,this.txtpanel=null,this.sevicepro=null,this.agreebox=null,this.okbtn=null,e.__super.call(this)}s(e,"ui.login.RegisterPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("login/RegisterPanel")},e}(Os),Cr=function(t){function e(){this.outimg=null,this.foldname=null,e.__super.call(this)}s(e,"ui.picManager.DirectItemUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,width:160,"var":"outimg",skin:"commers/blackbg.png",sizeGrid:"5,5,5,5",height:30,alpha:.7},compId:3},{type:"Label",props:{y:4,x:0,width:159,"var":"foldname",valign:"middle",text:"我的图片",height:24,fontSize:20,color:"#eff8f1",alpha:1,align:"center"},compId:5}],loadList:["commers/blackbg.png"],loadList3D:[]},e}(Os),Dr=function(t){function e(){this.btnok=null,this.btncancel=null,this.input_username=null,this.input_phone=null,this.btnSelProv=null,this.province=null,this.btnSelCity=null,this.citytxt=null,this.btnSelArea=null,this.areatxt=null,this.input_address=null,this.provbox=null,this.provList=null,this.citybox=null,this.cityList=null,this.areabox=null,this.areaList=null,this.btnSelTown=null,this.towntxt=null,this.townbox=null,this.townList=null,e.__super.call(this)}s(e,"ui.usercenter.NewAddressPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("usercenter/NewAddressPanel")},e}(Os),xr=function(t){function e(){this.attachList=null,this.btnok=null,this.btncancel=null,e.__super.call(this)}s(e,"ui.order.SelectAttchPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("order/SelectAttchPanel")},e}(Os),Rr=function(t){function e(){this.list_delivery=null,this.okbtn=null,this.cancelbtn=null,e.__super.call(this)}s(e,"ui.order.SelectDeliveryPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("order/SelectDeliveryPanel")},e}(Os),Tr=function(t){function e(){this.img=null,this.filename=null,this.btndelete=null,this.fileinfo=null,this.picClassTxt=null,this.colorspacetxt=null,this.sel=null,e.__super.call(this)}s(e,"ui.picManager.PicShortItemUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:128,height:214},compId:2,child:[{type:"Image",props:{y:64,x:64,width:108,"var":"img",skin:"upload/fold.png",height:101,anchorY:.5,anchorX:.5},compId:3},{type:"Label",props:{y:130,wordWrap:!0,width:124,"var":"filename",valign:"middle",text:"名称.jpg 宽 3256 名称",right:2,overflow:"hidden",left:2,height:28,fontSize:16,font:"Helvetica",color:"#262B2E",align:"center"},compId:4},{type:"Button",props:{y:2,x:103,"var":"btndelete",stateNum:1,skin:"upload/deletebtn.png",label:"X"},compId:7},{type:"Label",props:{y:162,wordWrap:!0,width:128,"var":"fileinfo",valign:"top",text:"名称.jpg 宽 3256/n可以啊",right:0,overflow:"scroll",left:0,height:52,fontSize:16,font:"Helvetica",color:"#262B2E",align:"center"},compId:8},{type:"Label",props:{y:107,x:0,wordWrap:!0,width:48,"var":"picClassTxt",valign:"middle",text:"JPEG",height:21,fontSize:16,font:"SimHei",color:"#262B2E",bgColor:"#FFFFFFC9",align:"left"},compId:9},{type:"Label",props:{y:107,wordWrap:!0,width:48,"var":"colorspacetxt",valign:"middle",text:"CMYK",right:0,height:21,fontSize:16,font:"SimHei",color:"#262B2E",bgColor:"#FFFFFFC9",align:"right"},compId:11},{type:"Button",props:{y:5,x:9,"var":"sel",skin:"upload/imgselect.png"},compId:12}],loadList:["upload/fold.png","upload/deletebtn.png","upload/imgselect.png"],loadList3D:[]},e}(Os),br=function(t){function e(){this.panel_main=null,this.firstPage=null,this.myorder=null,this.userName=null,this.logout=null,this.bannertitile=null,this.sp_container=null,this.btntxt0=null,this.btntxt1=null,this.btntxt5=null,this.btntxt6=null,this.btntxt2=null,this.btntxt3=null,this.btntxt4=null,this.btntxt7=null,this.btntxt8=null,this.toptitle=null,e.__super.call(this)}s(e,"ui.usercenter.UserMainPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:1920,height:1080},compId:2,child:[{type:"Image",props:{top:0,skin:"commers/grayback.jpg",sizeGrid:"3,3,3,3",right:0,left:0,bottom:0},compId:3},{type:"Panel",props:{y:0,"var":"panel_main",right:0,left:0,height:1080},compId:4,child:[{type:"Box",props:{presetID:1,y:0,x:0,isPresetRoot:!0},compId:53,child:[{type:"Sprite",props:{presetID:2,y:0,x:0,texture:"commers/bgimg.jpg"},compId:54},{type:"Sprite",props:{presetID:3,y:18,x:332,texture:"commers/logotxt.png"},compId:55},{type:"Label",props:{presetID:4,y:28,x:524,text:"|",fontSize:20,font:"Microsoft YaHei",color:"#FFFFFF"},compId:5},{type:"Text",props:{presetID:5,y:28,x:540,isPresetRoot:!0,width:40,"var":"firstPage",text:"首页",rotation:0,name:"firstPage",height:20,fontSize:20,font:"Microsoft YaHei",color:"#FFFFFF",runtime:"laya.display.Text"},compId:6,child:[{type:"Script",props:{presetID:6,undercolor:"#FFFFFF",txttype:1,runtime:"script.prefabScript.LinkTextControl"},compId:7}]},{type:"Text",props:{presetID:7,y:28,x:1320,isPresetRoot:!0,"var":"myorder",text:"我的订单",name:"myorder",fontSize:20,font:"Microsoft YaHei",color:"#FFFFFF",runtime:"laya.display.Text"},compId:8,child:[{type:"Script",props:{presetID:8,undercolor:"#FFFFFF",txttype:1,runtime:"script.prefabScript.LinkTextControl"},compId:9}]},{type:"Text",props:{presetID:9,y:28,x:1417,isPresetRoot:!0,width:140,"var":"userName",text:"13800000000",overflow:"hidden",name:"userName",height:20,fontSize:20,font:"Microsoft YaHei",color:"#FFFFFF",align:"right",runtime:"laya.display.Text"},compId:10,child:[{type:"Script",props:{presetID:10,txttype:1,runtime:"script.prefabScript.LinkTextControl"},compId:12}]},{type:"Text",props:{presetID:11,y:28,x:1562,isPresetRoot:!0,width:73,"var":"logout",text:"[退出]",name:"logout",fontSize:20,font:"Microsoft YaHei",color:"#FFFFFF",align:"left",runtime:"laya.display.Text"},compId:11,child:[{type:"Script",props:{presetID:12,txttype:1,runtime:"script.prefabScript.LinkTextControl"},compId:13}]},{type:"Label",props:{presetID:13,y:28,x:1405,text:"|",fontSize:20,font:"Microsoft YaHei",color:"#FFFFFF"},compId:14},{type:"Script",props:{presetID:14,runtime:"script.prefabScript.TopBannerControl"},compId:15}]},{type:"Image",props:{y:108,x:340,width:278,skin:"commers/commonpopbg.png",sizeGrid:"3,3,3,3",height:940,alpha:1},compId:59},{type:"Label",props:{y:114,x:757,"var":"bannertitile",text:"企业资料",fontSize:14,font:"SimHei",color:"#BEBDBD"},compId:49},{type:"Sprite",props:{y:229,x:637,width:963,"var":"sp_container",height:725},compId:50},{type:"VBox",props:{y:138,x:364,space:42},compId:87,child:[{type:"Box",props:{},compId:62,child:[{type:"Image",props:{skin:"usercenter/setting.png"},compId:60},{type:"Label",props:{x:28,text:"企业设置",fontSize:22,font:"SimHei",color:"#5b6779",bold:!0},compId:17},{type:"VBox",props:{y:59,x:29,space:40},compId:26,child:[{type:"Label",props:{"var":"btntxt0",text:"企业资料",fontSize:24,font:"SimHei",color:"#272524",align:"center"},compId:18},{type:"Label",props:{y:64,"var":"btntxt1",text:"收货地址",fontSize:24,font:"SimHei",color:"#272524",align:"center"},compId:19},{type:"Image",props:{y:100,width:190,skin:"commers/cutline.png"},compId:61}]}]},{type:"Box",props:{y:506},compId:72,child:[{type:"Image",props:{skin:"usercenter/accounticon.png"},compId:73},{type:"Label",props:{x:28,text:"账户管理",fontSize:22,font:"SimHei",color:"#5b6779",bold:!0},compId:74},{type:"VBox",props:{y:59,x:29,space:40},compId:75,child:[{type:"Label",props:{x:0,"var":"btntxt5",text:"账户充值",fontSize:24,font:"SimHei",color:"#272524",align:"center"},compId:76},{type:"Label",props:{y:64,x:0,"var":"btntxt6",text:"我的账单",fontSize:24,font:"SimHei",color:"#272524",align:"center"},compId:77},{type:"Image",props:{y:100,x:0,width:190,skin:"commers/cutline.png"},compId:79}]}]},{type:"Box",props:{y:221},compId:63,child:[{type:"Image",props:{skin:"usercenter/ordericon.png"},compId:64},{type:"Label",props:{x:28,text:"订单管理",fontSize:22,font:"SimHei",color:"#5b6779",bold:!0},compId:65},{type:"VBox",props:{y:59,x:29,space:40},compId:66,child:[{type:"Label",props:{x:0,"var":"btntxt2",text:"购物车",fontSize:24,font:"SimHei",color:"#272524",align:"center"},compId:67},{type:"Label",props:{y:64,x:0,"var":"btntxt3",text:"我的订单",fontSize:24,font:"SimHei",color:"#272524",align:"center"},compId:68},{type:"Label",props:{y:110,x:0,"var":"btntxt4",text:"委托订单",fontSize:24,font:"SimHei",color:"#272524",align:"center"},compId:71},{type:"Image",props:{y:150,x:0,width:190,skin:"commers/cutline.png"},compId:69}]}]},{type:"Box",props:{y:723},compId:80,child:[{type:"Image",props:{skin:"usercenter/personmanage.png"},compId:81},{type:"Label",props:{x:28,text:"个人管理",fontSize:22,font:"SimHei",color:"#5b6779",bold:!0},compId:82},{type:"VBox",props:{y:59,x:29,space:40},compId:83,child:[{type:"Label",props:{x:0,"var":"btntxt7",text:"我的图库",fontSize:24,font:"SimHei",color:"#272524",align:"center"},compId:84},{type:"Label",props:{y:64,x:0,"var":"btntxt8",text:"修改密码",fontSize:24,font:"SimHei",color:"#272524",align:"center"},compId:85}]}]}]},{type:"Sprite",props:{y:110,x:636,texture:"commers/firstpagicon.png"},compId:95},{type:"Label",props:{y:114,x:669,text:"/ 用户中心",fontSize:14,font:"SimHei",color:"#52B232"},compId:96},{type:"Image",props:{y:157,x:637,width:200,skin:"commers/commonpopbg.png",sizeGrid:"3,3,3,3",height:72},compId:98},{type:"Label",props:{y:182,x:694,"var":"toptitle",text:"企业资料",fontSize:22,font:"SimHei",color:"#52B232"},compId:97}]},{type:"Script",props:{runtime:"script.usercenter.UserMainControl"},compId:51}],loadList:["commers/grayback.jpg","prefabs/TopBanner.prefab","commers/commonpopbg.png","usercenter/setting.png","commers/cutline.png","usercenter/accounticon.png","usercenter/ordericon.png","usercenter/personmanage.png","commers/firstpagicon.png"],loadList3D:[]},e}(Os),Pr=function(t){function e(t){this.ordervo=null,e.__super.call(this),this.ordervo=t,this.initItem()}s(e,"script.order.PicOrderItem",t);var i=e.prototype;return i.initItem=function(){this.numindex.text=this.ordervo.indexNum.toString(),this.fileimg.skin="http://small-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/"+this.ordervo.picinfo.fid+".jpg",this.subtn.on("click",this,this.onSubItemNum),this.addbtn.on("click",this,this.onAddItemNum),this.hascomment.visible=!1,this.addmsg.visible=!1,this.ordervo.picinfo.picWidth>this.ordervo.picinfo.picHeight?(this.fileimg.width=100,this.fileimg.height=100/this.ordervo.picinfo.picWidth*this.ordervo.picinfo.picHeight):(this.fileimg.height=100,this.fileimg.width=100/this.ordervo.picinfo.picHeight*this.ordervo.picinfo.picWidth),this.fileimg.on("doubleclick",this,this.onShowBigImg),this.editwidth.text=this.ordervo.picinfo.picPhysicWidth.toString(),this.editheight.text=this.ordervo.picinfo.picPhysicHeight.toString(),this.filename.text=this.ordervo.picinfo.directName,this.architype.text=this.ordervo.techStr,this.total.text="0",this.deleteorder.underline=!0,this.deleteorder.underlineColor="#222222",this.inputnum.text="1",this.inputnum.restrict="0-9",this.deleteorder.on("click",this,this.onDeleteOrder),this.addmsg.underline=!0,this.addmsg.underlineColor="#222222",this.price.text="0",this.addmsg.on("click",this,this.onAddComment),this.mattxt.text="",this.changemat.underline=!0,this.changemat.underlineColor="#222222",this.changemat.on("click",this,this.onShowMaterialView),this.inputnum.on("input",this,this.onNumChange),this.architype.height=this.architype.textField.textHeight>80?this.architype.textField.textHeight:80,this.height=this.architype.height>80?this.architype.height+35:113,this.bgimg.height=this.height,this.alighComponet()},i.onSubItemNum=function(){var t=parseInt(this.inputnum.text);t>1&&t--,this.inputnum.text=t.toString(),this.onNumChange()},i.onAddItemNum=function(){var t=parseInt(this.inputnum.text);t++,this.inputnum.text=t.toString(),this.onNumChange()},i.onShowBigImg=function(){v.instance.openView("VIEW_PICTURE_CHECK",!1,this.ordervo.picinfo)},i.onAddComment=function(){v.instance.openView("VIEW_ADD_MESSAGE",!1,{msg:this.ordervo.comment,caller:this,callback:this.onAddMsgBack})},i.onAddMsgBack=function(t){this.ordervo.comment=t,this.hascomment.visible=""!=this.ordervo.comment,this.ordervo.orderData&&(this.ordervo.orderData.comments=this.ordervo.comment)},i.alighComponet=function(){this.checkSel.y=(this.height-26)/2,this.numindex.y=(this.height-this.numindex.height)/2,this.fileimg.y=this.height/2,this.filename.y=(this.height-this.filename.height)/2,this.matbox.y=(this.height-42)/2,this.editbox.y=(this.height-this.editbox.height)/2,this.numbox.y=this.height/2-12,this.price.y=(this.height-this.price.height)/2,this.total.y=(this.height-this.total.height)/2,this.operatebox.y=(this.height-this.operatebox.height)/2-10},i.updateIndex=function(){this.numindex.text=this.ordervo.indexNum.toString()},i.onDeleteOrder=function(){on.instance.event("DELETE_PIC_ORDER",this)},i.onNumChange=function(){this.total.text=(parseInt(this.inputnum.text)*this.ordervo.orderPrice).toFixed(2).toString(),this.ordervo.orderData&&(this.ordervo.orderData.item_number=parseInt(this.inputnum.text)),on.instance.event("UPDATE_ORDER_ITEM_TECH")},i.onShowMaterialView=function(){v.instance.openView("VIEW_SELECT_MATERIAL",!1,this.ordervo.picinfo),I.instance.curSelectOrderItem=this,I.instance.batchChangeMatItems=[]},i.changeProduct=function(t){this.updateOrderData(t);var e=this.ordervo.picinfo.picPhysicHeight*this.ordervo.picinfo.picPhysicWidth/1e4,i=2*(this.ordervo.picinfo.picPhysicHeight+this.ordervo.picinfo.picPhysicWidth)/100;.1>e&&(e=.1),this.price.text="平方米"==t.measure_unit?(t.getTotalPrice(e,i)/e).toFixed(2):(t.getTotalPrice(e,i)/i).toFixed(2),this.total.text=(parseInt(this.inputnum.text)*t.getTotalPrice(e,i)).toFixed(2)+"",this.mattxt.text=t.prod_name;var n=this.height;this.architype.text=t.getTechDes(),this.architype.height=this.architype.textField.textHeight>80?this.architype.textField.textHeight:80,this.height=this.architype.height>80?this.architype.height+35:113,this.bgimg.height=this.height,this.alighComponet(),on.instance.event("ADJUST_PIC_ORDER_TECH",this.height-n)},i.getPrice=function(){return parseInt(this.inputnum.text)*this.ordervo.orderPrice},i.updateOrderData=function(t){var e=this.ordervo.picinfo.picPhysicHeight*this.ordervo.picinfo.picPhysicWidth/1e4,i=2*(this.ordervo.picinfo.picPhysicHeight+this.ordervo.picinfo.picPhysicWidth)/100;.1>e&&(e=.1),this.ordervo.orderPrice=t.getTotalPrice(e,i),this.ordervo.manufacturer_code=t.manufacturer_code,this.ordervo.manufacturer_name=t.manufacturer_name;var n={};n.prod_name=t.prod_name,n.prod_code=t.prod_code,n.prod_description="",n.LWH=this.ordervo.picinfo.picPhysicWidth+"/"+this.ordervo.picinfo.picPhysicHeight+"/1",n.weightStr=1,n.item_number=parseInt(this.inputnum.text),n.item_priceStr=this.ordervo.orderPrice.toString(),n.item_status="1",n.comments=this.ordervo.comment,n.imagefile_path="http://original-image.oss-cn-hangzhou.aliyuncs.com/"+this.ordervo.picinfo.fid+"."+this.ordervo.picinfo.picClass,n.previewImage_path="http://large-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/"+this.ordervo.picinfo.fid+".jpg",n.thumbnails_path="http://small-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/"+this.ordervo.picinfo.fid+".jpg",n.procInfoList=t.getProInfoList(),this.ordervo.orderData=n},e}(Bs),Lr=function(t){function e(){this.matbtn=null,e.__super.call(this)}s(e,"ui.order.MaterialNameItemUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{},compId:2,child:[{type:"Button",props:{y:0,x:0,width:179,"var":"matbtn",skin:"commers/btn2.png",sizeGrid:"3,3,3,3",labelSize:16,labelFont:"SimHei",labelColors:"#262B2E,#52B232,#49AA2D",labelAlign:"center",label:"户内PP背胶（户内写真）",height:40},compId:8}],loadList:["commers/btn2.png"],loadList3D:[]},e}(Os),Ir=function(t){function e(){this.main_panel=null,this.firstPage=null,this.myorder=null,this.userName=null,this.logout=null,this.btnUploadPic=null,this.btnNewFolder=null,this.flder0=null,this.htmltext=null,this.radiosel=null,this.searchInput=null,this.filetypeRadio=null,this.prgcap=null,this.leftcapacity=null,this.btnorder=null,this.picList=null,this.btnroot=null,this.flder1=null,this.flder2=null,this.boxNewFolder=null,this.input_folename=null,this.btnSureCreate=null,this.btnCloseInput=null,this.btnprevfolder=null,e.__super.call(this)}s(e,"ui.PicManagePanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("PicManagePanel")},e}(Os),Mr=function(t){function e(){this.pimg=null,e.__super.call(this)}s(e,"ui.product.ProductItemUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:0,height:0},compId:2,child:[{type:"Image",props:{y:0,x:0,width:314,"var":"pimg",height:417},compId:3}],loadList:[],loadList3D:[]},e}(Os),wr=function(t){function e(){this.main_panel=null,this.backBtn=null,this.box_mat=null,this.matlist=null,this.tablist=null,this.hasSelMat=null,this.box_tech=null,this.techcontent=null,this.mattext=null,this.selecttech=null,this.backimg=null,this.originimg=null,this.qiegeoriginimg=null,this.qiegeimg=null,this.btnok=null,this.btncancel=null,this.numinput=null,this.addbtn=null,this.subtn=null,e.__super.call(this)}s(e,"ui.order.SelectMaterialPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("order/SelectMaterialPanel")},e}(Os),Or=function(t){function e(){this.productimg=null,this.proname=null,this.size0=null,this.size1=null,this.pricetxt=null,this.numinput=null,this.btnbuy=null,this.btnclose=null,e.__super.call(this)}s(e,"ui.product.BuyProductPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("product/BuyProductPanel")},e}(Os),Br=function(t){function e(){this.inputphone=null,this.inputpwd=null,this.inputcfmpwd=null,this.inputcode=null,this.btngetcode=null,this.btnClose=null,this.btnok=null,e.__super.call(this)}s(e,"ui.login.ResetPwdPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("login/ResetPwdPanel")},e}(Os),Nr=function(t){function e(){this.bgimg=null,this.uploadinfo=null,this.btnClose=null,this.goonbtn=null,this.errortxt=null,this.btnOpenFile=null,this.fileList=null,e.__super.call(this)}s(e,"ui.uploadpic.UpLoadPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("uploadpic/UpLoadPanel")},e}(Os),kr=function(t){function e(){this.prgbar=null,this.filename=null,this.prog=null,this.filesize=null,this.btncancel=null,this.finishimg=null,this.reUploadBtn=null,e.__super.call(this)}s(e,"ui.uploadpic.UpLoadItemUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:0,x:0,width:1084,texture:"commers/cutline.png",height:1},compId:12},{type:"Sprite",props:{y:1,x:0,width:800,"var":"prgbar",texture:"upload/prgbg.png",height:76,sizeGrid:"2,2,2,2"},compId:14},{type:"Label",props:{y:30.5,x:92.5,width:445,"var":"filename",text:"文件名",overflow:"hidden",height:21,fontSize:16,font:"SimHei",color:"#262B2E",align:"left"},compId:3},{type:"Label",props:{y:30.5,x:776.5,width:70,"var":"prog",text:"10%",height:18,fontSize:16,font:"SimHei",color:"#262B2E"},compId:6},{type:"Label",props:{y:30.5,x:674.5,width:78,"var":"filesize",text:"12k",height:21,fontSize:16,font:"SimHei",color:"#262B2E",align:"right"},compId:7},{type:"Button",props:{y:32.5,x:1020.5,"var":"btncancel",stateNum:1,skin:"upload/btnclose.png"},compId:9},{type:"Sprite",props:{y:20,x:32,texture:"upload/imgicon.png"},compId:11},{type:"Sprite",props:{y:76,x:0,width:1084,texture:"commers/cutline.png",height:1},compId:13},{type:"Sprite",props:{y:28.5,x:776.5,"var":"finishimg",texture:"upload/finishicon.png"},compId:15},{type:"Button",props:{y:32,x:855,"var":"reUploadBtn",stateNum:1,skin:"upload/startbtn.png"},compId:16}],loadList:["commers/cutline.png","upload/prgbg.png","upload/btnclose.png","upload/imgicon.png","upload/finishicon.png","upload/startbtn.png"],loadList3D:[]},e}(Os),Fr=function(t){function e(){this.mainpanel=null,this.firstPage=null,this.myorder=null,this.userName=null,this.logout=null,this.productlist=null,e.__super.call(this)}s(e,"ui.product.ProductOrderPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("product/ProductOrderPanel")},e}(Os),Vr=(function(t){function e(){this.firstPage=null,this.myorder=null,this.userName=null,this.logout=null,this.producttree=null,this.productlist=null,this.haschooselist=null,e.__super.call(this)}s(e,"ui.product.ProductMarketPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("product/ProductMarketPanel")},e}(Os),function(t){function e(){this.msgtxt=null,this.okbtn=null,this.cancelbtn=null,this.closebtn=null,e.__super.call(this)}s(e,"ui.PopUpDialogUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("PopUpDialog")},e}(Os)),Ur=function(t){function e(){this.prg=null,this.prgtxt=null,e.__super.call(this)}s(e,"ui.login.LoadingPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:1920,height:1080},compId:2,child:[{type:"ProgressBar",props:{y:445,x:587,width:818,"var":"prg",skin:"comp/progress.png",sizeGrid:"2,1,1,2",height:14},compId:3},{type:"Label",props:{y:400,x:781.5,width:357,"var":"prgtxt",text:"10%",height:31,fontSize:24,color:"#f3e4e4",align:"center"},compId:4},{type:"Script",props:{runtime:"utils.LoadingPrgControl"},compId:5}],loadList:["comp/progress.png"],loadList3D:[]},e}(Os),Wr=function(t){function e(){this.orderid=null,this.ordertime=null,this.productnum=null,this.paymoney=null,this.orderstatus=null,this.detailbtn=null,this.deletebtn=null,this.payagain=null,e.__super.call(this)}s(e,"ui.usercenter.OrderListItemUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:0,height:0},compId:2,child:[{type:"Image",props:{y:0,x:0,width:747,skin:"commers/inputbg.png",sizeGrid:"3,3,3,3",height:28},compId:12},{type:"Label",props:{y:0,x:0,width:108,"var":"orderid",valign:"middle",text:"18014398509481987",height:29,fontSize:16,font:"SimHei",align:"center"},compId:3},{type:"Label",props:{y:0,x:148,width:161,"var":"ordertime",valign:"middle",text:"2019-05-22 15:30:00",height:29,fontSize:16,font:"SimHei",align:"center"},compId:4},{type:"Label",props:{y:0,x:328,width:63,"var":"productnum",valign:"middle",text:"1",height:29,fontSize:16,font:"SimHei",align:"center"},compId:5},{type:"Label",props:{y:0,x:412,width:74,"var":"paymoney",valign:"middle",text:"17.88",height:29,fontSize:16,font:"SimHei",align:"center"},compId:6},{type:"Label",props:{y:0,x:508,width:74,"var":"orderstatus",valign:"middle",text:"已支付",height:29,fontSize:16,font:"SimHei",align:"center"},compId:7},{type:"Text",props:{y:3,x:615,"var":"detailbtn",text:"详情",presetID:1,fontSize:16,font:"SimHei",color:"#ef0e0b",isPresetRoot:!0,runtime:"laya.display.Text"},compId:8,child:[{type:"Script",props:{presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:9}]},{type:"Text",props:{y:3,x:658,"var":"deletebtn",text:"删除",presetID:1,fontSize:16,font:"SimHei",color:"#ef0e0b",isPresetRoot:!0,runtime:"laya.display.Text"},compId:10,child:[{type:"Script",props:{presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:11}]},{type:"Text",props:{y:3,x:700,"var":"payagain",text:"支付",presetID:1,fontSize:16,font:"SimHei",color:"52B232",isPresetRoot:!0,runtime:"laya.display.Text"},compId:13,child:[{type:"Script",props:{presetID:2,runtime:"script.prefabScript.LinkTextControl"},compId:14}]}],loadList:["commers/inputbg.png","prefabs/LinksText.prefab"],loadList3D:[]},e}(Os),Gr=function(t){function e(){this.imgbg=null,this.mainpanel=null,this.img=null,this.closeBtn=null,e.__super.call(this)}s(e,"ui.picManager.PicCheckPanelUI",t);var i=e.prototype;return i.createChildren=function(){laya.display.Scene.prototype.createChildren.call(this),this.loadScene("picManager/PicCheckPanel")},e}(Os),zr=function(t){function e(){this.adjustHeight=null,this.caller=null,this.ordata=null,e.__super.call(this)}s(e,"script.usercenter.QuestOrderItem",t);var i=e.prototype;return i.setData=function(t){this.itemseq.text=t.item_seq,this.picimg.skin=t.thumbnails_path,this.ordata=t,this.matname.text=t.prod_name;var e=t.LWH.split("/");this.widthtxt.text=e[0],this.heighttxt.text=e[1],this.pronum.text=t.item_number+"";for(var i="",n=0;n<t.procInfoList.length;n++)i+=t.procInfoList[n].proc_description+"-";this.tech.text=i.substr(0,i.length-1),this.money.text=(Number(t.item_priceStr)*Number(t.item_number)).toFixed(2),this.commentmark.visible=""!=t.comments,this.comment.on("click",this,this.onShowComment),this.detailbox.visible=!1,this.bgimg.height=90,this.detailbtn.on("click",this,this.onClickShowDetail)},i.onShowComment=function(){v.instance.openView("VIEW_ADD_MESSAGE",!1,{msg:this.ordata.comments})},i.onClickShowDetail=function(){this.detailbox.visible=!this.detailbox.visible,this.bgimg.height=this.detailbox.visible?165:90,this.adjustHeight.call(this.caller)},i.hideDetail=function(){this.detailbox.visible=!1,this.bgimg.height=90},e}(Vs),Xr=function(t){function e(){this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this.isShowEffect=!0,this.isPopupCenter=!0,this.closeType=null,this._dragArea=null,this._param=null,e.__super.call(this),this.popupEffect=e.manager.popupEffectHandler,this.closeEffect=e.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)}s(e,"laya.ui.Dialog",t);var n=e.prototype;return n._dealDragArea=function(){var t=this.getChildByName("drag");t&&(this.dragArea=t._x+","+t._y+","+t.width+","+t.height,t.removeSelf())},n._onMouseDown=function(){var t=this.getMousePoint();this._dragArea.contains(t.x,t.y)?this.startDrag():this.stopDrag()},n._onClick=function(t){var e=t.target;if(e)switch(e.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":return this.close(e.name),void 0}},n.open=function(t,i){void 0===t&&(t=!0),this._dealDragArea(),this._param=i,e.manager.open(this,t,this.isShowEffect),e.manager.lock(!1)},n.close=function(t){this.closeType=t,e.manager.close(this)},n.destroy=function(e){void 0===e&&(e=!0),this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this._dragArea=null,t.prototype.destroy.call(this,e)},n.show=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0),this._open(!1,t,e)},n.popup=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0),this._open(!0,t,e)},n._open=function(t,i,n){this.isModal=t,this.isShowEffect=n,e.manager.lock(!0),this.open(i)},r(0,n,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(t){if(t){var e=Ne.fillArray([0,0,0,0],t,Number);this._dragArea=new He(e[0],e[1],e[2],e[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),r(0,n,"isPopup",function(){return null!=this.parent}),r(0,n,"zOrder",t.prototype._$get_zOrder,function(t){i.superSet(Os,this,"zOrder",t),e.manager._checkMask()}),r(1,e,"manager",function(){return e._manager=e._manager||new bs},function(t){e._manager=t}),e.setLockView=function(t){e.manager.setLockView(t)},e.lock=function(t){e.manager.lock(t)},e.closeAll=function(){e.manager.closeAll()},e.getDialogsByGroup=function(t){return e.manager.getDialogsByGroup(t)},e.closeByGroup=function(t){return e.manager.closeByGroup(t)},e.CLOSE="close",e.CANCEL="cancel",e.SURE="sure",e.NO="no",e.YES="yes",e.OK="ok",e._manager=null,e}(Os),Hr=function(t){function e(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._$componentType="List",this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._usedCache=null,e.__super.call(this),this._cells=[],this._offset=new $i}s(e,"laya.ui.List",t);var n=e.prototype;return i.imps(n,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),n.destroy=function(t){void 0===t&&(t=!0),this._content&&this._content.destroy(t),this._scrollBar&&this._scrollBar.destroy(t),laya.ui.UIComponent.prototype.destroy.call(this,t),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},n.createChildren=function(){this.addChild(this._content=new Us)},n.onScrollStart=function(){this._usedCache||(this._usedCache=i.superGet(Us,this,"cacheAs")),i.superSet(Us,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},n.onScrollEnd=function(){i.superSet(Us,this,"cacheAs",this._usedCache)},n._removePreScrollBar=function(){var t=this.removeChildByName("scrollBar");t&&t.destroy(!0)},n.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var t=this._getOneCell(),e=t.width+this._spaceX||1,i=t.height+this._spaceY||1;this._width>0&&(this._repeatX2=this._isVertical?Math.round(this._width/e):Math.ceil(this._width/e)),this._height>0&&(this._repeatY2=this._isVertical?Math.ceil(this._height/i):Math.round(this._height/i));var n=this._width?this._width:e*this.repeatX-this._spaceX,s=this._height?this._height:i*this.repeatY-this._spaceY;this._cellSize=this._isVertical?i:e,this._cellOffset=this._isVertical?i*Math.max(this._repeatY2,this._repeatY)-s-this._spaceY:e*Math.max(this._repeatX2,this._repeatX)-n-this._spaceX,this._isVertical&&this.vScrollBarSkin?this._scrollBar.height=s:!this._isVertical&&this.hScrollBarSkin&&(this._scrollBar.width=n),this.setContentSize(n,s);var r=this._isVertical?this.repeatX:this.repeatY,a=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,r,a),this._createdLine=a,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},n._getOneCell=function(){if(0===this._cells.length){var t=this.createItem();if(this._offset.setTo(t._x,t._y),this.cacheContent)return t;this._cells.push(t)}return this._cells[0]
},n._createItems=function(t,e,i){var n=this._content,s=this._getOneCell(),r=s.width+this._spaceX,a=s.height+this._spaceY;if(this.cacheContent){var o=new Us;o.cacheAs="normal",o.pos((this._isVertical?0:t)*r,(this._isVertical?t:0)*a),this._content.addChild(o),n=o}else{for(var h=[],l=this._cells.length-1;l>-1;l--){var _=this._cells[l];_.removeSelf(),h.push(_)}this._cells.length=0}for(var u=t;i>u;u++)for(var c=0;e>c;c++)s=h&&h.length?h.pop():this.createItem(),s.x=(this._isVertical?c:u)*r-n._x,s.y=(this._isVertical?u:c)*a-n._y,s.name="item"+(u*e+c),n.addChild(s),this.addCell(s)},n.createItem=function(){var t=[];if("function"==typeof this._itemRender)var e=new this._itemRender;else e=pe.createComp(this._itemRender,null,null,t);if(0==t.length&&e._watchMap){var i=e._watchMap;for(var n in i)for(var s=i[n],r=0;r<s.length;r++){var a=s[r];t.push(a.comp,a.prop,a.value)}}return t.length&&(e._$bindData=t),e},n.addCell=function(t){t.on("click",this,this.onCellMouse),t.on("rightclick",this,this.onCellMouse),t.on("mouseover",this,this.onCellMouse),t.on("mouseout",this,this.onCellMouse),t.on("mousedown",this,this.onCellMouse),t.on("mouseup",this,this.onCellMouse),this._cells.push(t)},n._afterInited=function(){this.initItems()},n.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;var t=0;t=0;for(var e=0;1e4>e;e++){var i=this.getChildByName("item"+e);{if(!i)break;this.addCell(i),t++}}this.repeatY=t}},n.setContentSize=function(t,e){this._content.width=t,this._content.height=e,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content._style.scrollRect||(this._content.scrollRect=He.create()),this._content._style.scrollRect.setTo(-this._offset.x,-this._offset.y,t,e),this._content.scrollRect=this._content.scrollRect),this.event("resize")},n.onCellMouse=function(t){"mousedown"===t.type&&(this._isMoved=!1);var e=t.currentTarget,i=this._startIndex+this._cells.indexOf(e);0>i||("click"===t.type||"rightclick"===t.type?this.selectEnable&&!this._isMoved?this.selectedIndex=i:this.changeCellState(e,!0,0):"mouseover"!==t.type&&"mouseout"!==t.type||this._selectedIndex===i||this.changeCellState(e,"mouseover"===t.type,0),this.mouseHandler&&this.mouseHandler.runWith([t,i]))},n.changeCellState=function(t,e,i){var n=t.getChildByName("selectBox");n&&(this.selectEnable=!0,n.visible=e,n.index=i)},n._sizeChanged=function(){laya.ui.UIComponent.prototype._sizeChanged.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},n.onScrollBarChange=function(){this.runCallLater(this.changeCells);var t=this._scrollBar.value,e=this._isVertical?this.repeatX:this.repeatY,i=this._isVertical?this.repeatY:this.repeatX,n=Math.floor(t/this._cellSize);if(this.cacheContent)r=i+1,this._createdLine-n<r&&(this._createItems(this._createdLine,e,this._createdLine+r),this.renderItems(this._createdLine*e,0),this._createdLine+=r);else{var s=n*e,r=0;if(s>this._startIndex){r=s-this._startIndex;var a=!0,o=this._startIndex+e*(i+1);this._isMoved=!0}else s<this._startIndex&&(r=this._startIndex-s,a=!1,o=this._startIndex-1,this._isMoved=!0);for(var h=0;r>h;h++){if(a){var l=this._cells.shift();this._cells[this._cells.length]=l;var _=o+h}else l=this._cells.pop(),this._cells.unshift(l),_=o-h;var u=Math.floor(_/e)*this._cellSize;this._isVertical?l.y=u:l.x=u,this.renderItem(l,_)}this._startIndex=s,this.changeSelectStatus()}var c=this._content._style.scrollRect;this._isVertical?(c.y=t-this._offset.y,c.x=-this._offset.x):(c.y=-this._offset.y,c.x=t-this._offset.x),this._content.scrollRect=c},n.posCell=function(t,e){if(this._scrollBar){var i=this._isVertical?this.repeatX:this.repeatY,n=(this._isVertical?this.repeatY:this.repeatX,Math.floor(e/i)*this._cellSize);this._isVertical?t._y=n:t.x=n}},n.changeSelectStatus=function(){for(var t=0,e=this._cells.length;e>t;t++)this.changeCellState(this._cells[t],this._selectedIndex===this._startIndex+t,1)},n.renderItems=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);for(var i=t,n=e||this._cells.length;n>i;i++)this.renderItem(this._cells[i],this._startIndex+i);this.changeSelectStatus()},n.renderItem=function(t,e){this._array&&e>=0&&e<this._array.length?(t.visible=!0,t._$bindData?(t._dataSource=this._array[e],this._bindData(t,this._array[e])):t.dataSource=this._array[e],this.cacheContent||this.posCell(t,e),this.hasListener("render")&&this.event("render",[t,e]),this.renderHandler&&this.renderHandler.runWith([t,e])):(t.visible=!1,t.dataSource=null)},n._bindData=function(t,e){for(var i=t._$bindData,n=0,s=i.length;s>n;n++){var r=i[n++],a=i[n++],o=i[n],h=Ne.getBindFun(o);r[a]=h.call(this,e)}},n.updateArray=function(t){if(this._array=t,this._scrollBar){var e=t.length,i=this._isVertical?this.repeatX:this.repeatY,n=this._isVertical?this.repeatY:this.repeatX,s=Math.ceil(e/i);this._scrollBar.thumbPercent=n/s,this._scrollBar.slider._max=(s-n)*this._cellSize+this._cellOffset}},n.refresh=function(){this.array=this._array},n.getItem=function(t){return t>-1&&t<this._array.length?this._array[t]:null},n.changeItem=function(t,e){t>-1&&t<this._array.length&&(this._array[t]=e,t>=this._startIndex&&t<this._startIndex+this._cells.length&&this.renderItem(this.getCell(t),t))},n.setItem=function(t,e){this.changeItem(t,e)},n.addItem=function(t){this._array.push(t),this.array=this._array},n.addItemAt=function(t,e){this._array.splice(e,0,t),this.array=this._array},n.deleteItem=function(t){this._array.splice(t,1),this.array=this._array},n.getCell=function(t){return this.runCallLater(this.changeCells),t>-1&&this._cells?this._cells[(t-this._startIndex)%this._cells.length]:null},n.scrollTo=function(t){if(this._scrollBar){var e=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(t/e)*this._cellSize}else this.startIndex=t},n.tweenTo=function(t,e,i){if(void 0===e&&(e=200),this._scrollBar){this._scrollBar.stopScroll();var n=this._isVertical?this.repeatX:this.repeatY;ri.to(this._scrollBar,{value:Math.floor(t/n)*this._cellSize},e,null,i,0,!0)}else this.startIndex=t,i&&i.run()},n._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},n.commitMeasure=function(){this.runCallLater(this.changeCells)},r(0,n,"cacheAs",t.prototype._$get_cacheAs,function(t){i.superSet(Us,this,"cacheAs",t),this._scrollBar&&(this._usedCache=null,"none"!==t?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),r(0,n,"content",function(){return this._content}),r(0,n,"height",t.prototype._$get_height,function(t){t!=this._height&&(i.superSet(Us,this,"height",t),this._setCellChanged())}),r(0,n,"itemRender",function(){return this._itemRender},function(t){if(this._itemRender!=t){this._itemRender=t;for(var e=this._cells.length-1;e>-1;e--)this._cells[e].destroy();this._cells.length=0,this._setCellChanged()}}),r(0,n,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(t){this._removePreScrollBar();var e=new na;e.name="scrollBar",e.right=0,t&&" "!=t&&(e.skin=t),this.scrollBar=e,this.addChild(e),this._setCellChanged()}),r(0,n,"page",function(){return this._page},function(t){this._page=t,this._array&&(this._page=t>0?t:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),r(0,n,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(t){this._removePreScrollBar();var e=new Zr;e.name="scrollBar",e.bottom=0,t&&" "!=t&&(e.skin=t),this.scrollBar=e,this.addChild(e),this._setCellChanged()}),r(0,n,"repeatX",function(){return this._repeatX>0?this._repeatX:this._repeatX2>0?this._repeatX2:1},function(t){this._repeatX=t,this._setCellChanged()}),r(0,n,"scrollBar",function(){return this._scrollBar},function(t){this._scrollBar!=t&&(this._scrollBar=t,t&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange)))}),r(0,n,"width",t.prototype._$get_width,function(t){t!=this._width&&(i.superSet(Us,this,"width",t),this._setCellChanged())}),r(0,n,"repeatY",function(){return this._repeatY>0?this._repeatY:this._repeatY2>0?this._repeatY2:1},function(t){this._repeatY=t,this._setCellChanged()}),r(0,n,"spaceX",function(){return this._spaceX},function(t){this._spaceX=t,this._setCellChanged()}),r(0,n,"spaceY",function(){return this._spaceY},function(t){this._spaceY=t,this._setCellChanged()}),r(0,n,"selectedIndex",function(){return this._selectedIndex},function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(t),this.startIndex=this._startIndex)}),r(0,n,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(t){this.selectedIndex=this._array.indexOf(t)}),r(0,n,"length",function(){return this._array?this._array.length:0}),r(0,n,"selection",function(){return this.getCell(this._selectedIndex)},function(t){this.selectedIndex=this._startIndex+this._cells.indexOf(t)}),r(0,n,"startIndex",function(){return this._startIndex},function(t){this._startIndex=t>0?t:0,this.callLater(this.renderItems)}),r(0,n,"array",function(){return this._array},function(t){this.runCallLater(this.changeCells),this._array=t||[];var e=this._array.length;if(this.totalPage=Math.ceil(e/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<e?this._selectedIndex:e-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var i=this._isVertical?this.repeatX:this.repeatY,n=this._isVertical?this.repeatY:this.repeatX,s=Math.ceil(e/i),r=this._cellOffset>0?this.totalPage+1:this.totalPage;r>1?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=n/s,this._scrollBar.setScroll(0,(s-n)*this._cellSize+this._cellOffset,this._scrollBar.value),this._scrollBar.target=this._content):(this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content)}}),r(0,n,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t,"number"==typeof t&&Math.floor(t)==t||"string"==typeof t?this.selectedIndex=parseInt(t):t instanceof Array?this.array=t:i.superSet(Us,this,"dataSource",t)}),r(0,n,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),e}(Us),Yr=function(t){function e(){this._space=0,this._align="none",this._itemChanged=!1,e.__super.call(this)}s(e,"laya.ui.LayoutBox",t);var i=e.prototype;return i.addChild=function(t){return t.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,t)},i.onResize=function(){this._setItemChanged()},i.addChildAt=function(t,e){return t.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,t,e)},i.removeChildAt=function(t){return this.getChildAt(t).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,t)},i.refresh=function(){this._setItemChanged()},i.changeItems=function(){this._itemChanged=!1},i.sortItem=function(t){t&&t.sort(function(t,e){return t.y-e.y})},i._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},r(0,i,"space",function(){return this._space},function(t){this._space=t,this._setItemChanged()}),r(0,i,"align",function(){return this._align},function(t){this._align=t,this._setItemChanged()}),e}(Us),jr=function(t){function e(t,i){void 0===i&&(i=""),e.__super.call(this,t,i)}s(e,"laya.ui.CheckBox",t);var n=e.prototype;return n.preinitialize=function(){laya.ui.UIComponent.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},n.initialize=function(){t.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},r(0,n,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t,"boolean"==typeof t?this.selected=t:"string"==typeof t?this.selected="true"===t:i.superSet(Gs,this,"dataSource",t)}),e}(Gs),Zr=function(t){function e(){e.__super.call(this)}s(e,"laya.ui.HScrollBar",t);var i=e.prototype;return i.initialize=function(){t.prototype.initialize.call(this),this.slider.isVertical=!1},e}(zs),qr=function(t){function e(){this._items=null,this._selectedIndex=0,e.__super.call(this),this._setIndexHandler=_.create(this,this.setIndex,null,!1)}s(e,"laya.ui.ViewStack",t);var n=e.prototype;return i.imps(n,{"laya.ui.IItem":!0}),n.setItems=function(t){this.removeChildren();for(var e=0,i=0,n=t.length;n>i;i++){var s=t[i];s&&(s.name="item"+e,this.addChild(s),e++)}this.initItems()},n.addItem=function(t){t.name="item"+this._items.length,this.addChild(t),this.initItems()},n._afterInited=function(){this.initItems()},n.initItems=function(){this._items=[];for(var t=0;1e4>t;t++){var e=this.getChildByName("item"+t);if(null==e)break;this._items.push(e),e.visible=t==this._selectedIndex}},n.setSelect=function(t,e){this._items&&t>-1&&t<this._items.length&&(this._items[t].visible=e)},n.setIndex=function(t){this.selectedIndex=t},r(0,n,"dataSource",t.prototype._$get_dataSource,function(t){if(this._dataSource=t,"number"==typeof t&&Math.floor(t)==t||"string"==typeof t)this.selectedIndex=parseInt(t);else for(var e in this._dataSource)this.hasOwnProperty(e)&&(this[e]=this._dataSource[e])}),r(0,n,"selectedIndex",function(){return this._selectedIndex},function(t){this._selectedIndex!=t&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=t,this.setSelect(this._selectedIndex,!0))}),r(0,n,"selection",function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(t){this.selectedIndex=this._items.indexOf(t)}),r(0,n,"items",function(){return this._items}),r(0,n,"setIndexHandler",function(){return this._setIndexHandler},function(t){this._setIndexHandler=t}),e}(Us),Kr=function(t){function e(t,i){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=0/0,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,e.__super.call(this),this.skin=i,this.labels=t}s(e,"laya.ui.UIGroup",t);var n=e.prototype;return i.imps(n,{"laya.ui.IItem":!0}),n.preinitialize=function(){this.mouseEnabled=!0},n.destroy=function(t){void 0===t&&(t=!0),laya.ui.UIComponent.prototype.destroy.call(this,t),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},n.addItem=function(t,e){void 0===e&&(e=!0);var i=t,n=this._items.length;if(i.name="item"+n,this.addChild(i),this.initItems(),e&&n>0){var s=this._items[n-1];"horizontal"==this._direction?i.x=s._x+s.width+this._space:i.y=s._y+s.height+this._space}else e&&(i.x=0,i.y=0);return n},n.delItem=function(t,e){void 0===e&&(e=!0);var i=this._items.indexOf(t);if(-1!=i){var n=t;this.removeChild(n);for(var s=i+1,r=this._items.length;r>s;s++){var a=this._items[s];a.name="item"+(s-1),e&&("horizontal"==this._direction?a.x-=n.width+this._space:a.y-=n.height+this._space)}if(this.initItems(),this._selectedIndex>-1){var o=0;o=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=o}}},n._afterInited=function(){this.initItems()},n.initItems=function(){this._items||(this._items=[]),this._items.length=0;for(var t=0;1e4>t;t++){var e=this.getChildByName("item"+t);if(null==e)break;this._items.push(e),e.selected=t===this._selectedIndex,e.clickHandler=_.create(this,this.itemClick,[t],!1)}},n.itemClick=function(t){this.selectedIndex=t},n.setSelect=function(t,e){this._items&&t>-1&&t<this._items.length&&(this._items[t].selected=e)},n._skinLoaded=function(){this._setLabelChanged(),this.event("loaded")},n.createItem=function(){return null},n.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var t=0,e=0,i=this._items.length;i>e;e++){var n=this._items[e];this._skin&&(n.skin=this._skin),this._labelColors&&(n.labelColors=this._labelColors),this._labelSize&&(n.labelSize=this._labelSize),this._labelStroke&&(n.labelStroke=this._labelStroke),this._labelStrokeColor&&(n.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(n.strokeColors=this._strokeColors),this._labelBold&&(n.labelBold=this._labelBold),this._labelPadding&&(n.labelPadding=this._labelPadding),this._labelAlign&&(n.labelAlign=this._labelAlign),this._stateNum&&(n.stateNum=this._stateNum),this._labelFont&&(n.labelFont=this._labelFont),"horizontal"===this._direction?(n.y=0,n.x=t,t+=n.width+this._space):(n.x=0,n.y=t,t+=n.height+this._space)}this._sizeChanged()},n.commitMeasure=function(){this.runCallLater(this.changeLabels)},n._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},r(0,n,"labelStrokeColor",function(){return this._labelStrokeColor},function(t){this._labelStrokeColor!=t&&(this._labelStrokeColor=t,this._setLabelChanged())}),r(0,n,"skin",function(){return this._skin},function(t){this._skin!=t&&(this._skin=t,this._skin&&!un.getRes(this._skin)?i.loader.load(this._skin,_.create(this,this._skinLoaded),null,"image",1):this._skinLoaded())}),r(0,n,"selectedIndex",function(){return this._selectedIndex},function(t){this._selectedIndex!=t&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=t,this.setSelect(t,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),r(0,n,"labels",function(){return this._labels},function(t){if(this._labels!=t){if(this._labels=t,this.removeChildren(),this._setLabelChanged(),this._labels)for(var e=this._labels.split(","),i=0,n=e.length;n>i;i++){var s=this.createItem(this._skin,e[i]);s.name="item"+i,this.addChild(s)}this.initItems()}}),r(0,n,"strokeColors",function(){return this._strokeColors},function(t){this._strokeColors!=t&&(this._strokeColors=t,this._setLabelChanged())}),r(0,n,"labelColors",function(){return this._labelColors},function(t){this._labelColors!=t&&(this._labelColors=t,this._setLabelChanged())}),r(0,n,"labelStroke",function(){return this._labelStroke},function(t){this._labelStroke!=t&&(this._labelStroke=t,this._setLabelChanged())}),r(0,n,"labelSize",function(){return this._labelSize},function(t){this._labelSize!=t&&(this._labelSize=t,this._setLabelChanged())}),r(0,n,"stateNum",function(){return this._stateNum},function(t){this._stateNum!=t&&(this._stateNum=t,this._setLabelChanged())}),r(0,n,"labelBold",function(){return this._labelBold},function(t){this._labelBold!=t&&(this._labelBold=t,this._setLabelChanged())}),r(0,n,"labelFont",function(){return this._labelFont},function(t){this._labelFont!=t&&(this._labelFont=t,this._setLabelChanged())}),r(0,n,"labelPadding",function(){return this._labelPadding},function(t){this._labelPadding!=t&&(this._labelPadding=t,this._setLabelChanged())}),r(0,n,"direction",function(){return this._direction},function(t){this._direction=t,this._setLabelChanged()}),r(0,n,"space",function(){return this._space},function(t){this._space=t,this._setLabelChanged()}),r(0,n,"items",function(){return this._items}),r(0,n,"selection",function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(t){this.selectedIndex=this._items.indexOf(t)}),r(0,n,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t,"number"==typeof t&&Math.floor(t)==t||"string"==typeof t?this.selectedIndex=parseInt(t):t instanceof Array?this.labels=t.join(","):i.superSet(Us,this,"dataSource",t)}),e}(Us),$r=function(t){function e(){this._oldW=0,this._oldH=0,e.__super.call(this)}s(e,"laya.ui.ScaleBox",t);var n=e.prototype;return n.onEnable=function(){i.stage.on("resize",this,this.onResize),this.onResize()},n.onDisable=function(){i.stage.off("resize",this,this.onResize)},n.onResize=function(){if(this.width>0&&this.height>0){var t=Math.min(i.stage.width/this._oldW,i.stage.height/this._oldH);i.superSet(Us,this,"width",i.stage.width),i.superSet(Us,this,"height",i.stage.height),this.scale(t,t)}},r(0,n,"width",t.prototype._$get_width,function(t){i.superSet(Us,this,"width",t),this._oldW=t}),r(0,n,"height",t.prototype._$get_height,function(t){i.superSet(Us,this,"height",t),this._oldH=t}),e}(Us),Jr=function(t){function e(t){this._bg=null,this._skin=null,e.__super.call(this),void 0===t&&(t=""),this.text=t,this.skin=this.skin}s(e,"laya.ui.TextInput",t);var n=e.prototype;return n.preinitialize=function(){this.mouseEnabled=!0},n.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._bg&&this._bg.destroy(),this._bg=null},n.createChildren=function(){this.addChild(this._tf=new Ws),this._tf.padding=tn.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},n._onFocus=function(){this.event("focus",this)},n._onBlur=function(){this.event("blur",this)},n._onInput=function(){this.event("input",this)},n._onEnter=function(){this.event("enter",this)},n.initialize=function(){this.width=128,this.height=22},n._skinLoaded=function(){this._bg||(this.graphics=this._bg=new Mn),this._bg.source=un.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height),this._sizeChanged(),this.event("loaded")},n.select=function(){this._tf.select()},n.setSelection=function(t,e){this._tf.setSelection(t,e)},r(0,n,"text",t.prototype._$get_text,function(t){this._tf.text!=t&&(t+="",this._tf.text=t,this.event("change"))}),r(0,n,"bg",function(){return this._bg},function(t){this.graphics=this._bg=t}),r(0,n,"multiline",function(){return this._tf.multiline},function(t){this._tf.multiline=t}),r(0,n,"skin",function(){return this._skin},function(t){this._skin!=t&&(this._skin=t,this._skin&&!un.getRes(this._skin)?i.loader.load(this._skin,_.create(this,this._skinLoaded),null,"image",1):this._skinLoaded())}),r(0,n,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(t){this._bg||(this.graphics=this._bg=new Mn),this._bg.sizeGrid=Ne.fillArray(tn.defaultSizeGrid,t,Number)}),r(0,n,"width",t.prototype._$get_width,function(t){i.superSet(Xs,this,"width",t),this._bg&&(this._bg.width=t)}),r(0,n,"height",t.prototype._$get_height,function(t){i.superSet(Xs,this,"height",t),this._bg&&(this._bg.height=t)}),r(0,n,"editable",function(){return this._tf.editable},function(t){this._tf.editable=t}),r(0,n,"restrict",function(){return this._tf.restrict},function(t){this._tf.restrict=t}),r(0,n,"prompt",function(){return this._tf.prompt},function(t){this._tf.prompt=t}),r(0,n,"promptColor",function(){return this._tf.promptColor},function(t){this._tf.promptColor=t}),r(0,n,"maxChars",function(){return this._tf.maxChars},function(t){this._tf.maxChars=t}),r(0,n,"focus",function(){return this._tf.focus},function(t){this._tf.focus=t}),r(0,n,"type",function(){return this._tf.type},function(t){this._tf.type=t}),e}(Xs),Qr=function(t){function e(t,i){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,e.__super.call(this),t&&(this.skin=t),i&&(this.sheet=i)}s(e,"laya.ui.FontClip",t);var n=e.prototype;return n.createChildren=function(){this._bitmap=new Mn,this.on("loaded",this,this._onClipLoaded)},n._onClipLoaded=function(){this.callLater(this.changeValue)},n.changeValue=function(){if(this._sources&&this._valueArr){this.graphics.clear(!0);var t;if(t=this._sources[0]){var e="horizontal"===this._direction;e?(this._wordsW=this._valueArr.length*(t.sourceWidth+this.spaceX),this._wordsH=t.sourceHeight):(this._wordsW=t.sourceWidth,this._wordsH=(t.sourceHeight+this.spaceY)*this._valueArr.length);var i=0;if(this._width)switch(this._align){case"center":i=.5*(this._width-this._wordsW);break;case"right":i=this._width-this._wordsW;break;default:i=0}for(var n=0,s=this._valueArr.length;s>n;n++){var r=this._indexMap[this._valueArr.charAt(n)];this.sources[r]&&(t=this.sources[r],e?this.graphics.drawImage(t,i+n*(t.sourceWidth+this.spaceX),0,t.sourceWidth,t.sourceHeight):this.graphics.drawImage(t,0+i,n*(t.sourceHeight+this.spaceY),t.sourceWidth,t.sourceHeight))}this._width||(this._widget.resetLayoutX(),this.callLater(this._sizeChanged)),this._height||(this._widget.resetLayoutY(),this.callLater(this._sizeChanged))}}},n.measureWidth=function(){return this._wordsW},n.measureHeight=function(){return this._wordsH},n.destroy=function(e){void 0===e&&(e=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),t.prototype.destroy.call(this,e)},r(0,n,"sheet",function(){return this._sheet},function(t){t+="",this._sheet=t;var e=t.split(" ");this._clipX=String(e[0]).length,this.clipY=e.length,this._indexMap={};for(var i=0;i<this._clipY;i++)for(var n=e[i].split(""),s=0,r=n.length;r>s;s++)this._indexMap[n[s]]=i*this._clipX+s}),r(0,n,"height",t.prototype._$get_height,function(t){i.superSet(Ys,this,"height",t),this.callLater(this.changeValue)}),r(0,n,"direction",function(){return this._direction},function(t){this._direction=t,this.callLater(this.changeValue)}),r(0,n,"value",function(){return this._valueArr?this._valueArr:""},function(t){t+="",this._valueArr=t,this.callLater(this.changeValue)}),r(0,n,"width",t.prototype._$get_width,function(t){i.superSet(Ys,this,"width",t),this.callLater(this.changeValue)}),r(0,n,"spaceX",function(){return this._spaceX},function(t){this._spaceX=t,"horizontal"===this._direction&&this.callLater(this.changeValue)}),r(0,n,"spaceY",function(){return this._spaceY},function(t){this._spaceY=t,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),r(0,n,"align",function(){return this._align},function(t){this._align=t,this.callLater(this.changeValue)}),e}(Ys),ta=function(t){function e(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,this._usedCache=null,e.__super.call(this),this.width=this.height=100}s(e,"laya.ui.Panel",t);var n=e.prototype;return n.destroy=function(t){void 0===t&&(t=!0),laya.ui.UIComponent.prototype.destroy.call(this,t),this._content&&this._content.destroy(t),this._vScrollBar&&this._vScrollBar.destroy(t),this._hScrollBar&&this._hScrollBar.destroy(t),this._vScrollBar=null,this._hScrollBar=null,this._content=null},n.destroyChildren=function(){this._content.destroyChildren()},n.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new Us)},n.addChild=function(t){return t.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(t)},n.onResize=function(){this._setScrollChanged()},n.addChildAt=function(t,e){return t.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(t,e)},n.removeChild=function(t){return t.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(t)},n.removeChildAt=function(t){return this.getChildAt(t).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(t)},n.removeChildren=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=2147483647),this._content.removeChildren(t,e),this._setScrollChanged(),this},n.getChildAt=function(t){return this._content.getChildAt(t)},n.getChildByName=function(t){return this._content.getChildByName(t)},n.getChildIndex=function(t){return this._content.getChildIndex(t)},n.changeScroll=function(){this._scrollChanged=!1;var t=this.contentWidth||1,e=this.contentHeight||1,i=this._vScrollBar,n=this._hScrollBar,s=i&&e>this._height,r=n&&t>this._width,a=s?this._width-i.width:this._width,o=r?this._height-n.height:this._height;i&&(i.x=this._width-i.width,i.y=0,i.height=this._height-(r?n.height:0),i.scrollSize=Math.max(.033*this._height,1),i.thumbPercent=o/e,i.setScroll(0,e-o,i.value)),n&&(n.x=0,n.y=this._height-n.height,n.width=this._width-(s?i.width:0),n.scrollSize=Math.max(.033*this._width,1),n.thumbPercent=a/t,n.setScroll(0,t-a,n.value))},n._sizeChanged=function(){laya.ui.UIComponent.prototype._sizeChanged.call(this),this.setContentSize(this._width,this._height)},n.setContentSize=function(t,e){var i=this._content;i.width=t,i.height=e,i._style.scrollRect||(i.scrollRect=He.create()),i._style.scrollRect.setTo(0,0,t,e),i.scrollRect=i.scrollRect},n.onScrollBarChange=function(t){var e=this._content._style.scrollRect;if(e){var i=Math.round(t.value);t.isVertical?e.y=i:e.x=i,this._content.scrollRect=e}},n.scrollTo=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.vScrollBar&&(this.vScrollBar.value=e),this.hScrollBar&&(this.hScrollBar.value=t)},n.refresh=function(){this.changeScroll()},n.onScrollStart=function(){this._usedCache||(this._usedCache=i.superGet(Us,this,"cacheAs")),i.superSet(Us,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},n.onScrollEnd=function(){i.superSet(Us,this,"cacheAs",this._usedCache)},n._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},r(0,n,"numChildren",function(){return this._content.numChildren}),r(0,n,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(t){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new Zr),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=t}),r(0,n,"contentWidth",function(){for(var t=0,e=this._content.numChildren-1;e>-1;e--){var i=this._content.getChildAt(e);t=Math.max(i._x+i.width*i.scaleX,t)}return t}),r(0,n,"contentHeight",function(){for(var t=0,e=this._content.numChildren-1;e>-1;e--){var i=this._content.getChildAt(e);t=Math.max(i._y+i.height*i.scaleY,t)}return t}),r(0,n,"width",t.prototype._$get_width,function(t){i.superSet(Us,this,"width",t),this._setScrollChanged()}),r(0,n,"hScrollBar",function(){return this._hScrollBar}),r(0,n,"content",function(){return this._content}),r(0,n,"height",t.prototype._$get_height,function(t){i.superSet(Us,this,"height",t),this._setScrollChanged()}),r(0,n,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(t){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new na),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),t&&" "!=t&&(this._vScrollBar.skin=t)}),r(0,n,"vScrollBar",function(){return this._vScrollBar}),r(0,n,"cacheAs",t.prototype._$get_cacheAs,function(t){i.superSet(Us,this,"cacheAs",t),this._usedCache=null,"none"!==t?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),e}(Us),ea=function(t){function e(t,i){this._value=null,void 0===i&&(i=""),e.__super.call(this,t,i)}s(e,"laya.ui.Radio",t);var i=e.prototype;return i.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._value=null},i.preinitialize=function(){laya.ui.UIComponent.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},i.initialize=function(){t.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},i.onClick=function(){this.selected=!0},r(0,i,"value",function(){return null!=this._value?this._value:this.label},function(t){this._value=t}),e}(Gs),ia=function(t){function e(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,e.__super.call(this),this.width=this.height=200}s(e,"laya.ui.Tree",t);var n=e.prototype;return i.imps(n,{"laya.ui.IRender":!0}),n.destroy=function(t){void 0===t&&(t=!0),laya.ui.UIComponent.prototype.destroy.call(this,t),this._list&&this._list.destroy(t),this._list=null,this._source=null,this._renderHandler=null
},n.createChildren=function(){this.addChild(this._list=new Hr),this._list.renderHandler=_.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},n.onListChange=function(){this.event("change")},n.getArray=function(){var t,e=[];for(var i in this._source)t=this._source[i],this.getParentOpenStatus(t)&&(t.x=this._spaceLeft*this.getDepth(t),e.push(t));return e},n.getDepth=function(t,e){return void 0===e&&(e=0),null==t.nodeParent?e:this.getDepth(t.nodeParent,e+1)},n.getParentOpenStatus=function(t){var e=t.nodeParent;return null==e?!0:e.isOpen?null!=e.nodeParent?this.getParentOpenStatus(e):!0:!1},n.renderItem=function(t,e){var i=t.dataSource;if(i){t.left=i.x;var n=t.getChildByName("arrow");n&&(i.hasChild?(n.visible=!0,n.index=i.isOpen?1:0,n.tag=e,n.off("click",this,this.onArrowClick),n.on("click",this,this.onArrowClick)):n.visible=!1);var s=t.getChildByName("folder");s&&(s.index=2==s.clipY?i.isDirectory?0:1:i.isDirectory?i.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([t,e])}},n.onArrowClick=function(t){var e=t.currentTarget,i=e.tag;this._list.array[i].isOpen=!this._list.array[i].isOpen,this.event("open"),this._list.array=this.getArray()},n.setItemState=function(t,e){this._list.array[t]&&(this._list.array[t].isOpen=e,this._list.array=this.getArray())},n.fresh=function(){this._list.array=this.getArray(),this.repaint()},n.parseXml=function(t,e,i,n){var s,r=t.childNodes,a=r.length;if(!n){s={};var o,h=t.attributes;for(var l in h){o=h[l];var _=o.nodeName,u=o.nodeValue;s[_]="true"==u?!0:"false"==u?!1:u}s.nodeParent=i,a>0&&(s.isDirectory=!0),s.hasChild=a>0,e.push(s)}for(var c=0;a>c;c++){var d=r[c];this.parseXml(d,e,s,!1)}},n.parseOpenStatus=function(t,e){for(var i=0,n=e.length;n>i;i++){var s=e[i];if(s.isDirectory)for(var r=0,a=t.length;a>r;r++){var o=t[r];if(o.isDirectory&&this.isSameParent(o,s)&&s.label==o.label){s.isOpen=o.isOpen;break}}}},n.isSameParent=function(t,e){return null==t.nodeParent&&null==e.nodeParent?!0:null==t.nodeParent||null==e.nodeParent?!1:t.nodeParent.label==e.nodeParent.label?this.isSameParent(t.nodeParent,e.nodeParent):!1},n.filter=function(t){if(Boolean(t)){var e=[];this.getFilterSource(this._source,e,t),this._list.array=e}else this._list.array=this.getArray()},n.getFilterSource=function(t,e,i){i=i.toLocaleLowerCase();var n;for(var s in t)n=t[s],!n.isDirectory&&String(n.label).toLowerCase().indexOf(i)>-1&&(n.x=0,e.push(n)),n.child&&n.child.length>0&&this.getFilterSource(n.child,e,i)},r(0,n,"spaceBottom",function(){return this._list.spaceY},function(t){this._list.spaceY=t}),r(0,n,"keepStatus",function(){return this._keepStatus},function(t){this._keepStatus=t}),r(0,n,"itemRender",function(){return this._list.itemRender},function(t){this._list.itemRender=t}),r(0,n,"array",function(){return this._list.array},function(t){this._keepStatus&&this._list.array&&t&&this.parseOpenStatus(this._list.array,t),this._source=t,this._list.array=this.getArray()}),r(0,n,"mouseHandler",function(){return this._list.mouseHandler},function(t){this._list.mouseHandler=t}),r(0,n,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t,i.superSet(Us,this,"dataSource",t)}),r(0,n,"source",function(){return this._source}),r(0,n,"scrollBar",function(){return this._list.scrollBar}),r(0,n,"list",function(){return this._list}),r(0,n,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(t){this._list.vScrollBarSkin=t}),r(0,n,"renderHandler",function(){return this._renderHandler},function(t){this._renderHandler=t}),r(0,n,"selectedIndex",function(){return this._list.selectedIndex},function(t){this._list.selectedIndex=t}),r(0,n,"spaceLeft",function(){return this._spaceLeft},function(t){this._spaceLeft=t}),r(0,n,"selectedItem",function(){return this._list.selectedItem},function(t){this._list.selectedItem=t}),r(0,n,"width",t.prototype._$get_width,function(t){i.superSet(Us,this,"width",t),this._list.width=t}),r(0,n,"height",t.prototype._$get_height,function(t){i.superSet(Us,this,"height",t),this._list.height=t}),r(0,n,"xml",null,function(t){var e=[];this.parseXml(t.childNodes[0],e,null,!0),this.array=e}),r(0,n,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),e}(Us),na=function(t){function e(){e.__super.call(this)}return s(e,"laya.ui.VScrollBar",t),e}(zs),sa=function(t){function e(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,e.__super.call(this)}var i;s(e,"laya.utils.GraphicAnimation",t);var r=e.prototype;return r._parseNodeList=function(t){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[t.compId]=t.props,t.compId&&this._nodeList.push(t.compId);var e=t.child;if(e){var i=0,n=e.length;for(i=0;n>i;i++)this._parseNodeList(e[i])}},r._calGraphicData=function(t){this._setUp(null,t),this._createGraphicData()},r._createGraphicData=function(){var t=[],e=0,i=this.count,n=this._usedFrames;n||(n=[]);var s;for(e=0;i>e;e++)(n[e]||!s)&&(s=this._createFrameGraphic(e)),t.push(s);this._gList=t},r._createFrameGraphic=function(t){var i=new ze;return e._rootMatrix||(e._rootMatrix=new fi),this._updateNodeGraphic(this._rootNode,t,e._rootMatrix,i),i},r._updateNodeGraphic=function(t,e,i,n,s){void 0===s&&(s=1);var r;r=this._nodeGDic[t.compId]=this._getNodeGraphicData(t.compId,e,this._nodeGDic[t.compId]),r.resultTransform||(r.resultTransform=new fi);var a;a=r.resultTransform,fi.mul(r.transform,i,a);var o,h=r.alpha*s;if(!(.01>h)){r.skin&&(o=this._getTextureByUrl(r.skin),o&&(a._checkTransform()?(n.drawTexture(o,0,0,r.width,r.height,a,h),r.resultTransform=null):n.drawTexture(o,a.tx,a.ty,r.width,r.height,null,h)));var l=t.child;if(l){var _=0,u=0;for(u=l.length,_=0;u>_;_++)this._updateNodeGraphic(l[_],e,a,n,h)}}},r._updateNoChilds=function(t,e){if(t.skin){var i=this._getTextureByUrl(t.skin);if(i){var n=t.transform;n._checkTransform();var s=!1;s=!n._bTransform,s?e.drawTexture(i,n.tx,n.ty,t.width,t.height,null,t.alpha):e.drawTexture(i,0,0,t.width,t.height,n.clone(),t.alpha)}}},r._updateNodeGraphic2=function(t,e,i){var n;if(n=this._nodeGDic[t.compId]=this._getNodeGraphicData(t.compId,e,this._nodeGDic[t.compId]),!t.child)return this._updateNoChilds(n,i),void 0;var s=n.transform;s._checkTransform();var r=!1;r=!s._bTransform;var a=!1;a=r&&(0!=s.tx||0!=s.ty);var o=!1;o=s._bTransform||1!=n.alpha,o&&i.save(),1!=n.alpha&&i.alpha(n.alpha),r?a&&i.translate(s.tx,s.ty):i.transform(s.clone());var h,l=t.child;if(n.skin&&(h=this._getTextureByUrl(n.skin),h&&i.drawImage(h,0,0,n.width,n.height)),l){var _=0,u=0;for(u=l.length,_=0;u>_;_++)this._updateNodeGraphic2(l[_],e,i)}o?i.restore():r?a&&i.translate(-s.tx,-s.ty):i.transform(s.clone().invert())},r._calculateKeyFrames=function(e){t.prototype._calculateKeyFrames.call(this,e),this._nodeIDAniDic[e.target]=e},r.getNodeDataByID=function(t){return this._nodeIDAniDic[t]},r._getParams=function(t,i,n,s){var r=e._temParam;r.length=i.length;var a=0,o=i.length;for(a=0;o>a;a++)r[a]=this._getObjVar(t,i[a][0],n,i[a][1],s);return r},r._getObjVar=function(t,e,i,n,s){if(t.hasOwnProperty(e)){var r=t[e];return i>=r.length&&(i=r.length-1),t[e][i]}return s.hasOwnProperty(e)?s[e]:n},r._getNodeGraphicData=function(t,n,s){s||(s=new i),s.transform?s.transform.identity():s.transform=new fi;var r=this.getNodeDataByID(t);if(!r)return s;var a=r.frames,o=this._getParams(a,e._drawTextureCmd,n,this._nodeDefaultProps[t]),h=o[0],l=0/0,_=0/0,u=o[5],c=o[6],d=o[13],f=o[14],p=o[7],m=o[8],g=o[9],v=o[11],y=o[12];l=o[3],_=o[4],(0==l||0==_)&&(h=null),-1==l&&(l=0),-1==_&&(_=0);var E;s.skin=h,s.width=l,s.height=_,h&&(E=this._getTextureByUrl(h),E?(l||(l=E.sourceWidth),_||(_=E.sourceHeight)):console.warn("lost skin:",h,",you may load pics first")),s.alpha=o[10];var S=s.transform;0!=d&&(u=d*l),0!=f&&(c=f*_),(0!=u||0!=c)&&S.translate(-u,-c);var A=null;if(g||1!==p||1!==m||v||y){A=e._tempMt,A.identity(),A._bTransform=!0;var C=.0174532922222222*(g-v),D=.0174532922222222*(g+y),x=Math.cos(D),R=Math.sin(D),T=Math.sin(C),b=Math.cos(C);A.a=p*x,A.b=p*R,A.c=-m*T,A.d=m*b,A.tx=A.ty=0}return A&&(S=fi.mul(S,A,S)),S.translate(o[1],o[2]),s},r._getTextureByUrl=function(t){return un.getRes(t)},r.setAniData=function(t,i){if(t.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=t,this._parseNodeList(t);var n,s={},r=[],a=t.animations,o=0,h=a.length;for(o=0;h>o;o++)if(n=a[o],this._labels=null,(!i||i==n.name)&&n){try{this._calGraphicData(n)}catch(l){console.warn("parse animation fail:"+n.name+",empty animation created"),this._gList=[]}var _={};_.interval=1e3/n.frameRate,_.frames=this._gList,_.labels=this._labels,_.name=n.name,r.push(_),s[n.name]=_}this.animationList=r,this.animationDic=s}e._temParam.length=0},r.parseByData=function(t){var e,i;e=t.nodeRoot,i=t.aniO,delete t.nodeRoot,delete t.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=e,this._parseNodeList(e),this._labels=null;try{this._calGraphicData(i)}catch(n){console.warn("parse animation fail:"+i.name+",empty animation created"),this._gList=[]}var s=t;return s.interval=1e3/i.frameRate,s.frames=this._gList,s.labels=this._labels,s.name=i.name,s},r.setUpAniData=function(t){if(t.animations){var e,i={},n=[],s=t.animations,r=0,a=s.length;for(r=0;a>r;r++)if(e=s[r]){var o={};o.name=e.name,o.aniO=e,o.nodeRoot=t,n.push(o),i[e.name]=o}this.animationList=n,this.animationDic=i}},r._clear=function(){this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic=null},e.parseAnimationByData=function(t){e._I||(e._I=new e);var i;return i=e._I.parseByData(t),e._I._clear(),i},e.parseAnimationData=function(t){e._I||(e._I=new e),e._I.setUpAniData(t);var i;return i={},i.animationList=e._I.animationList,i.animationDic=e._I.animationDic,e._I._clear(),i},e._temParam=[],e._I=null,e._rootMatrix=null,n(e,["_drawTextureCmd",function(){return this._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]]},"_tempMt",function(){return this._tempMt=new fi}]),e.__init$=function(){i=function(){function t(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=0/0,this.height=0/0,this.alpha=1}return s(t,""),t}()},e}(js),ra=function(t){function e(){e.__super.call(this)}return s(e,"laya.ui.VSlider",t),e}(Ks),aa=function(t){function e(t){e.__super.call(this,t),this.isVertical=!1}return s(e,"laya.ui.HSlider",t),e}(Ks),oa=function(t){function e(){this.matclassvo=null,e.__super.call(this)}s(e,"script.order.MaterialClassBtn",t);var i=e.prototype;return i.setData=function(t){this.matclassvo=t,this.selbtn.label=this.matclassvo.matclassname},r(0,i,"ShowSelected",null,function(t){this.selbtn.selected=t}),e}(_r),ha=function(t){function e(){this.address=null,e.__super.call(this)}s(e,"script.order.SelAddressItem",t);var i=e.prototype;return i.setData=function(t){this.address=t,this.addresstxt.text=this.address.addressDetail,this.ShowSelected=!1},r(0,i,"ShowSelected",null,function(t){this.btnsel.selected=t,this.selCheck.selected=t}),e}(ur),la=function(t){function e(){this.addvo=null,e.__super.call(this)}s(e,"script.usercenter.CompanyAddressItem",t);var i=e.prototype;return i.setData=function(t){this.addvo=t,this.conName.text=t.receiverName,this.phonetxt.text=t.phone,this.detailaddr.text=t.proCityArea,this.btnDel.on("click",this,this.onDeleteAddr),this.btnEdit.on("click",this,this.onEditAddr),this.btndefault.on("click",this,this.onSetDefaultAddr),this.btndefault.visible=f.instance.defaultAddId!=this.addvo.id},i.onDeleteAddr=function(){v.instance.openView("VIEW_POPUPDIALOG",!1,{msg:"确定删除该地址吗？",caller:this,callback:this.confirmDelete})},i.confirmDelete=function(t){t&&R.instance.Request(R.httpUrl+"group/opt-group-express?",this,this.delMyAddressBack,"opt=delete&id="+this.addvo.id,"post")},i.delMyAddressBack=function(t){var e=JSON.parse(t);0==e.status&&(f.instance.deleteAddr(e.id),on.instance.event("UPDATE_MYADDRESS_LIST"))},i.onEditAddr=function(){v.instance.openView("VIEW_ADD_NEW_ADDRESS",!1,this.addvo)},i.onSetDefaultAddr=function(){R.instance.Request(R.httpUrl+"group/opt-group-express?",this,this.defaultAddressBack,"opt=default&id="+this.addvo.id,"post")},i.defaultAddressBack=function(t){var e=JSON.parse(t);0==e.status&&(f.instance.defaultAddId=this.addvo.id,on.instance.event("UPDATE_MYADDRESS_LIST"))},e}(rr),_a=(function(t){function e(){this.factorydata=null,e.__super.call(this)}s(e,"script.order.FactoryChooseBtn",t);var i=e.prototype;return i.setData=function(t){this.factorydata=t,this.selbtn.label=this.factorydata.name,this.selbtn.skin="commers/btn3.png",this.setSelected(this.factorydata==I.instance.selectFactoryInMat)},i.setSelected=function(t){this.selbtn.selected=t},e}(_r),function(t){function e(){this.techmainvo=null,this.isSelected=!1,this.processCatVo=null,this.attachVo=null,e.__super.call(this)}s(e,"script.order.TechBoxItem",t);var i=e.prototype;return i.setData=function(t){this.processCatVo=null,this.techmainvo=t,this.initView(),t.selected?this.setSelected(!0):this.setSelected(!1)},i.setAttachVo=function(t){this.processCatVo=null,this.techmainvo=null,this.attachVo=t,this.techBtn.label=this.attachVo.accessory_name,this.setSelected(!1)},i.setProcessData=function(t){this.techmainvo=null,this.processCatVo=t,this.techBtn.label=t.procCat_Name.split("-")[0]},i.initView=function(){this.techBtn.label=this.techmainvo.preProc_Name},i.setSelected=function(t){this.techBtn.selected=t,this.isSelected=t},i.setTechSelected=function(t){null!=this.techmainvo?(this.techmainvo.selected=t,t&&null!=this.techmainvo.preProc_attachmentTypeList&&""!=this.techmainvo.preProc_attachmentTypeList&&"SPNO"!=this.techmainvo.preProc_attachmentTypeList.toLocaleUpperCase()&&"SPPEIJIAN"!=this.techmainvo.preProc_attachmentTypeList.toLocaleUpperCase()?v.instance.openView("VIEW_SELECT_PIC_TO_ORDER",!1,this.techmainvo):(this.techmainvo.attchMentFileId="",this.techmainvo.attchFileId="",this.techmainvo.selectAttachVoList=null)):this.processCatVo.selected=t},i.onClickTech=function(){},e}(gr)),ua=function(t){function e(){this.areaVo=null,e.__super.call(this),this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut),this.bg.visible=!1}s(e,"script.login.CityAreaItem",t);var i=e.prototype;return i.onMouseOver=function(){this.bg.visible=!0},i.onMouseOut=function(){this.bg.visible=!1},i.setData=function(t){this.areaVo=t,this.productname.text=this.areaVo.areaname},e}(ar),ca=function(t){function e(){this.factoryvo=null,e.__super.call(this)}s(e,"script.order.SelFactoryItem",t);var i=e.prototype;return i.setData=function(t){this.factoryvo=t,this.addresstxt.text=this.factoryvo.name+"("+this.factoryvo.addr+")",this.ShowSelected=null!=I.instance.selectFactoryAddress&&I.instance.selectFactoryAddress.indexOf(this.factoryvo)>=0?!0:!1,this.on("click",this,this.onClickSelect)},i.onClickSelect=function(){this.btnsel.selected?null!=I.instance.selectFactoryAddress&&I.instance.selectFactoryAddress.indexOf(this.factoryvo)>=0&&I.instance.selectFactoryAddress.splice(I.instance.selectFactoryAddress.indexOf(this.factoryvo),1):(null==I.instance.selectFactoryAddress&&(I.instance.selectFactoryAddress=[]),I.instance.selectFactoryAddress.indexOf(this.factoryvo)<0&&I.instance.selectFactoryAddress.push(this.factoryvo)),this.ShowSelected=!this.btnsel.selected},r(0,i,"ShowSelected",null,function(t){this.btnsel.selected=t,this.selCheck.selected=t}),e}(ur),da=function(t){function e(){this.attachCatVo=null,e.__super.call(this)}s(e,"script.order.SelectAttachBtn",t);var i=e.prototype;return i.setData=function(t){this.attachCatVo=t,this.selbtn.label=this.attachCatVo.accessory_name,this.selbtn.on("doubleclick",this,this.onSelectSure)},i.onSelectSure=function(){on.instance.event("ADD_TECH_ATTACH",this.attachCatVo)},i.ShowSelected=function(t){this.selbtn.selected=t},e}(_r),fa=function(t){function e(){this.deliveryVo=null,e.__super.call(this)}s(e,"script.order.DeliveryTypeItem",t);var i=e.prototype;return i.setData=function(t){this.deliveryVo=t,this.addresstxt.text=this.deliveryVo.deliveryDesc},r(0,i,"ShowSelected",null,function(t){this.btnsel.selected=t,this.selCheck.selected=t}),e}(ur),pa=function(t){function e(){this.picInfo=null,this.trytime=0,e.__super.call(this)}s(e,"script.picUpload.PicInfoItem",t);var n=e.prototype;return n.setData=function(t){if(this.picInfo=t,this.offAll(),this.on("doubleclick",this,this.onDoubleClick),this.on("click",this,this.onClickHandler),this.on("mouseover",this,this.onMouseOverHandler),this.on("mouseout",this,this.onMouseOutHandler),this.btndelete.visible=!1,this.btndelete.on("click",this,this.onDeleteHandler),this.trytime=0,this.sel.visible=D.instance.haselectPic.hasOwnProperty(this.picInfo.fid),this.sel.selected=this.sel.visible,0==this.picInfo.picType||"JPEG"!=this.picInfo.picClass.toLocaleUpperCase()&&"JPG"!=this.picInfo.picClass.toLocaleUpperCase()&&"TIF"!=this.picInfo.picClass.toLocaleUpperCase()&&"PNG"!=this.picInfo.picClass.toLocaleUpperCase())this.img.skin="upload/fold.png",this.filename.text=this.picInfo.directName,this.fileinfo.visible=!1,this.picClassTxt.visible=!1,this.colorspacetxt.visible=!1,this.img.width=108,this.img.height=101;else{if(this.fileinfo.visible=!0,this.filename.text=this.picInfo.directName,this.picInfo.isProcessing)return this.fileinfo.text="处理中...",this.img.skin="upload/fold.png",this.picClassTxt.visible=!1,this.colorspacetxt.visible=!1,this.img.width=108,this.img.height=101,void 0;this.picInfo.picWidth>this.picInfo.picHeight?(this.img.width=128,this.img.height=128/this.picInfo.picWidth*this.picInfo.picHeight):(this.img.height=128,this.img.width=128/this.picInfo.picHeight*this.picInfo.picWidth),"upload/fold.png"!=this.img.skin&&i.loader.clearTextureRes(this.img.skin),this.img.skin=null,this.img.skin="http://small-thumbnail-image.oss-cn-hangzhou.aliyuncs.com/"+this.picInfo.fid+".jpg";var e="宽:"+this.picInfo.picPhysicWidth+";高:"+this.picInfo.picPhysicHeight+"\n";e+="dpi:"+this.picInfo.dpi,this.fileinfo.text=e,this.picClassTxt.text=this.picInfo.picClass.toLocaleUpperCase(),this.picClassTxt.visible=!0,this.colorspacetxt.text=this.picInfo.colorspace.toLocaleUpperCase(),this.colorspacetxt.visible=!0}},n.onDeleteHandler=function(t){t.stopPropagation(),1==this.picInfo.picType?v.instance.openView("VIEW_POPUPDIALOG",!1,{msg:"确定删除该图片吗？",caller:this,callback:this.confirmDelete}):v.instance.openView("VIEW_POPUPDIALOG",!1,{msg:"确定删除该目录吗？",caller:this,callback:this.confirmDelete})},n.confirmDelete=function(t){t&&(this.sel.visible&&on.instance.event("SELECT_PIC_ORDER",this.picInfo),1==this.picInfo.picType?R.instance.Request(R.httpUrl+"file/remove?",this,this.onDeleteFileBack,"fid="+this.picInfo.fid,"post"):R.instance.Request(R.httpUrl+"dir/remove?",this,this.onDeleteFileBack,"path="+this.picInfo.dpath,"post"))},n.onDeleteFileBack=function(t){var e=JSON.parse(t);0==e.status&&on.instance.event("UPDATE_FILE_LIST")},n.onMouseOutHandler=function(){this.btndelete.visible=!1},n.onMouseOverHandler=function(){this.btndelete.visible=!0},n.onClickHandler=function(){1==this.picInfo.picType&&(this.sel.visible=!this.sel.visible,this.sel.selected=this.sel.visible,on.instance.event("SELECT_PIC_ORDER",this.picInfo))},n.onDoubleClick=function(){0==this.picInfo.picType?on.instance.event("SELECT_FOLDER",this.picInfo):v.instance.openView("VIEW_PICTURE_CHECK",!1,this.picInfo)},e}(Tr),ma=function(t){function e(){this.matvo=null,e.__super.call(this)}s(e,"script.order.MaterialItem",t);var i=e.prototype;return i.setData=function(t){this.matvo=t,this.matbtn.label=this.matvo.prod_name,this.on("click",this,this.onClickMat)},i.onClickMat=function(){null!=this.matvo.prcessCatList&&this.matvo.prcessCatList.length>0?(this.matvo.resetData(),I.instance.curSelectMat=this.matvo,on.instance.event("SHOW_SELECT_TECH")):R.instance.Request(R.httpUrl+"business/processcatlist?prod_code="+this.matvo.prod_code,this,this.onGetProcessListBack,null,null)},i.onGetProcessListBack=function(t){var e=JSON.parse(t);if(!e.hasOwnProperty("status")){I.instance.curSelectMat=this.matvo,I.instance.curSelectMat.prcessCatList=[];for(var i=0;i<e.length;i++)I.instance.curSelectMat.prcessCatList.push(new A(e[i]));on.instance.event("SHOW_SELECT_TECH")}},r(0,i,"ShowSelected",null,function(){}),e}(Lr),ga=(function(t){function e(){this.isSeleted=!1,this.directData=null,e.__super.call(this)}s(e,"script.picUpload.DirectFolderItem",t);var i=e.prototype;return i.setData=function(t){this.directData=t,this.foldname.text=t.directName,this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)},i.onMouseOut=function(){this.isSeleted||(this.foldname.color="#FFFFFF")},i.onMouseOver=function(){this.isSeleted||(this.foldname.color="#FF0000")},r(0,i,"ShowSelected",null,function(t){this.isSeleted=t,this.foldname.color=t?"#FF0000":"#FFFFFF"}),e}(Cr),function(t){function e(){this.purl=null,e.__super.call(this)}s(e,"script.product.ProductItemView",t);var i=e.prototype;return i.setData=function(t){this.pimg.skin="product/p"+(1+t.pid)+".jpg",this.purl=t.url,this.pdata=t,this.pimg.on("click",this,this.onJumptoTaobao)},i.onJumptoTaobao=function(){v.instance.openView("VIEW_BUY_PRODUCT_VIEW",!1,this.pdata)},e}(Mr)),va=function(t){function e(){this.fileobj=null,e.__super.call(this)}s(e,"script.picUpload.FileUpLoadItem",t);var i=e.prototype;return i.setData=function(t){this.fileobj=t,this.filename.text=t.name,this.prog.text="0%",this.finishimg.visible=!1;var e=Math.floor(t.size/1048576),i="";i=e>0?(t.size/1048576).toFixed(2).toString()+"m":(t.size/1024).toFixed(2).toString()+"k",this.reUploadBtn.visible=!1,this.filesize.text=i,this.btncancel.on("click",this,this.onCancelUpload),this.reUploadBtn.on("click",this,this.onReUpload),this.updateProgress()},i.showReUploadbtn=function(){this.reUploadBtn.visible=!0},i.onReUpload=function(){on.instance.event("RE_UPLOAD_FILE",this)},i.onCancelUpload=function(){on.instance.event("CANCAEL_UPLOAD_ITEM",this)},i.updateProgress=function(){if(null!=this.fileobj){var t=Number(this.fileobj.progress);t>=100?(t=100,this.finishimg.visible=!0,this.prog.visible=!1):this.prog.visible=!0,this.prgbar.width=t/100*1084,this.prog.text=t+"%"}},e}(kr),ya=function(t){function e(){this.orderdata=null,e.__super.call(this)}s(e,"script.usercenter.OrderCheckListItem",t);var i=e.prototype;return i.setData=function(t){this.orderdata=t,this.orderid.text=this.orderdata.or_id,this.ordertime.text=this.orderdata.or_date;var e=parseInt(this.orderdata.or_status);0==e?(this.orderstatus.text="未支付",this.orderstatus.color="#FF0000",this.payagain.visible=!0):1==e&&(this.orderstatus.text="已支付",this.orderstatus.color="#52B232",this.payagain.visible=!1);var i=JSON.parse(this.orderdata.or_text);this.paymoney.text=Number(i.money_paidStr).toFixed(2),this.productnum.text=i.orderItemList.length+"",this.detailbtn.on("click",this,this.onShowDetail),this.deletebtn.on("click",this,this.onClickDelete),this.payagain.on("click",this,this.onClickPay)},i.onShowDetail=function(){v.instance.openView("VIEW_ORDER_DETAIL_PANEL",!1,this.orderdata)},i.onClickDelete=function(){v.instance.openView("VIEW_POPUPDIALOG",!1,{msg:"订单删除之后将无法恢复，确定删除吗？",caller:this,callback:this.confirmDelete,ok:"确定",cancel:"取消"})},i.confirmDelete=function(){R.instance.Request(R.httpUrl+"business/cancelorder?",this,this.deleteOrderBack,null,"get")},i.deleteOrderBack=function(t){var e=JSON.parse(t);0==e.status},i.onClickPay=function(){v.instance.openView("VIEW_SELECT_PAYTYPE_PANEL",!1,{amount:Number(this.paymoney.text),orderid:[this.orderdata.or_id]})},e}(Wr),Ea=function(t){function e(){e.__super.call(this)}s(e,"laya.ui.VBox",t);var n=e.prototype;return n.changeItems=function(){this._itemChanged=!1;for(var t=[],e=0,i=0,n=this.numChildren;n>i;i++){var s=this.getChildAt(i);s&&(t.push(s),e=this._width?this._width:Math.max(e,s.width*s.scaleX))}this.sortItem(t);var r=0;for(i=0,n=t.length;n>i;i++)s=t[i],s.y=r,r+=s.height*s.scaleY+this._space,"left"==this._align?s.x=0:"center"==this._align?s.x=.5*(e-s.width*s.scaleX):"right"==this._align&&(s.x=e-s.width*s.scaleX);this._sizeChanged()},r(0,n,"width",t.prototype._$get_width,function(t){this._width!=t&&(i.superSet(Yr,this,"width",t),this.callLater(this.changeItems))}),e.NONE="none",e.LEFT="left",e.CENTER="center",e.RIGHT="right",e}(Yr),Sa=function(t){function e(t){this._vScrollBar=null,this._hScrollBar=null,void 0===t&&(t=""),e.__super.call(this,t),this.on("change",this,this._onTextChange)}s(e,"laya.ui.TextArea",t);var n=e.prototype;return n._onTextChange=function(){this.callLater(this.changeScroll)},n.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this,e),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},n.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},n.onVBarChanged=function(){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},n.onHBarChanged=function(){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},n.changeScroll=function(){var t=this._vScrollBar&&this._tf.maxScrollY>0,e=this._hScrollBar&&this._tf.maxScrollX>0,i=t?this._width-this._vScrollBar.width:this._width,n=e?this._height-this._hScrollBar.height:this._height,s=this._tf.padding||tn.labelPadding;this._tf.width=i,this._tf.height=n,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-s[2],this._vScrollBar.y=s[1],this._vScrollBar.height=this._height-(e?this._hScrollBar.height:0)-s[1]-s[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=n/Math.max(this._tf.textHeight,n),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=t),this._hScrollBar&&(this._hScrollBar.x=s[0],this._hScrollBar.y=this._height-this._hScrollBar.height-s[3],this._hScrollBar.width=this._width-(t?this._vScrollBar.width:0)-s[0]-s[2],this._hScrollBar.scrollSize=Math.max(.033*i,1),this._hScrollBar.thumbPercent=i/Math.max(this._tf.textWidth,i),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=e)},n.scrollTo=function(t){this.commitMeasure(),this._tf.scrollY=t},r(0,n,"scrollY",function(){return this._tf.scrollY}),r(0,n,"width",t.prototype._$get_width,function(t){i.superSet(Jr,this,"width",t),this.callLater(this.changeScroll)}),r(0,n,"hScrollBar",function(){return this._hScrollBar}),r(0,n,"height",t.prototype._$get_height,function(t){i.superSet(Jr,this,"height",t),this.callLater(this.changeScroll)}),r(0,n,"maxScrollX",function(){return this._tf.maxScrollX}),r(0,n,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(t){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new na),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=t}),r(0,n,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(t){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new Zr),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=t}),r(0,n,"vScrollBar",function(){return this._vScrollBar}),r(0,n,"maxScrollY",function(){return this._tf.maxScrollY}),r(0,n,"scrollX",function(){return this._tf.scrollX}),e}(Jr),Aa=function(t){function e(){e.__super.call(this)}s(e,"laya.ui.HBox",t);var n=e.prototype;return n.sortItem=function(t){t&&t.sort(function(t,e){return t.x-e.x})},n.changeItems=function(){this._itemChanged=!1;for(var t=[],e=0,i=0,n=this.numChildren;n>i;i++){var s=this.getChildAt(i);s&&(t.push(s),e=this._height?this._height:Math.max(e,s.height*s.scaleY))}this.sortItem(t);var r=0;for(i=0,n=t.length;n>i;i++)s=t[i],s.x=r,r+=s.width*s.scaleX+this._space,"top"==this._align?s.y=0:"middle"==this._align?s.y=.5*(e-s.height*s.scaleY):"bottom"==this._align&&(s.y=e-s.height*s.scaleY);this._sizeChanged()},r(0,n,"height",t.prototype._$get_height,function(t){this._height!=t&&(i.superSet(Yr,this,"height",t),this.callLater(this.changeItems))}),e.NONE="none",e.TOP="top",e.MIDDLE="middle",e.BOTTOM="bottom",e}(Yr),Ca=function(t){function e(){e.__super.call(this)}s(e,"laya.ui.Tab",t);var i=e.prototype;return i.createItem=function(t,e){return new Gs(t,e)},e}(Kr),Da=function(t){function e(){e.__super.call(this)}s(e,"laya.ui.RadioGroup",t);var i=e.prototype;return i.createItem=function(t,e){return new ea(t,e)},e}(Kr);i.__init([l,xe,Ai,Os,d,cn,Ee,pe,sa,Ei,hi,pn,on]),new T}(window,document,t)},{}]},{},[1]);